# src\App.jsx
```
// src/App.jsx
import { Routes, Route, Navigate } from 'react-router-dom';
import PlatformDashboard from './views/platform/PlatformDashboard';
import { MobileGuard, DesktopGuard } from './components/guards/DeviceProtection';
import { EventProvider } from './contexts/EventContext';

// Placeholder çµ„ä»¶ï¼ˆä¹‹å¾Œå¯¦ç¾ï¼‰
const PhonePlaceholder = () => (
  <div style={{ padding: '2rem', textAlign: 'center' }}>
    <h2>æ‰‹æ©Ÿç‰ˆé¦–é </h2>
    <p>æ­¤åŠŸèƒ½å°‡åœ¨ç¬¬äºŒéšæ®µå¯¦ç¾</p>
  </div>
);

const DesktopPlaceholder = () => (
  <div style={{ padding: '2rem', textAlign: 'center' }}>
    <h2>æ¡Œæ©Ÿç‰ˆé¦–é </h2>
    <p>æ­¤åŠŸèƒ½å°‡åœ¨ç¬¬äºŒéšæ®µå¯¦ç¾</p>
  </div>
);

function App() {
  return (
    <Routes>
      {/* Platform Admin è·¯ç”± */}
      <Route path="/platform/admin" element={
        <DesktopGuard>
          <PlatformDashboard />
        </DesktopGuard>
      } />

      {/* æ´»å‹•è·¯ç”± - æ‰‹æ©Ÿç‰ˆ */}
      <Route path="/:orgCode-:eventCode/phone" element={
        <MobileGuard>
          <EventProvider>
            <PhonePlaceholder />
          </EventProvider>
        </MobileGuard>
      } />

      {/* æ´»å‹•è·¯ç”± - æ¡Œæ©Ÿç‰ˆ */}
      <Route path="/:orgCode-:eventCode/desktop" element={
        <DesktopGuard>
          <EventProvider>
            <DesktopPlaceholder />
          </EventProvider>
        </DesktopGuard>
      } />

      {/* é è¨­è·¯ç”± */}
      <Route path="/" element={<Navigate to="/platform/admin" replace />} />
      
      {/* 404 */}
      <Route path="*" element={
        <div style={{ padding: '2rem', textAlign: 'center' }}>
          <h1>404</h1>
          <p>é é¢ä¸å­˜åœ¨</p>
        </div>
      } />
    </Routes>
  );
}

export default App;
```

# src\main.jsx
```
// src/main.jsx
import React from 'react';
import ReactDOM from 'react-dom/client';
import { BrowserRouter } from 'react-router-dom';
import App from './App';
import './index.css';

ReactDOM.createRoot(document.getElementById('root')).render(
  <React.StrictMode>
    <BrowserRouter>
      <App />
    </BrowserRouter>
  </React.StrictMode>
);
```

# src\index.css
```
/* src/index.css */
* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

body {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 
               'Helvetica Neue', Arial, sans-serif;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#root {
  min-height: 100vh;
}

/* æ—‹è½‰å‹•ç•« */
@keyframes spin {
  from {
    transform: rotate(0deg);
  }
  to {
    transform: rotate(360deg);
  }
}

/* æŒ‰éˆ• hover æ•ˆæœ */
button:hover {
  opacity: 0.9;
  transform: translateY(-1px);
}

button:active {
  transform: translateY(0);
}

button:disabled {
  opacity: 0.6;
  cursor: not-allowed;
}

/* è¼¸å…¥æ¡† focus æ•ˆæœ */
input:focus,
textarea:focus,
select:focus {
  outline: none;
  border-color: #667eea;
  box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
}
```

# src\App.css
```
#root {
  max-width: 1280px;
  margin: 0 auto;
  padding: 2rem;
  text-align: center;
}

.logo {
  height: 6em;
  padding: 1.5em;
  will-change: filter;
  transition: filter 300ms;
}
.logo:hover {
  filter: drop-shadow(0 0 2em #646cffaa);
}
.logo.react:hover {
  filter: drop-shadow(0 0 2em #61dafbaa);
}

@keyframes logo-spin {
  from {
    transform: rotate(0deg);
  }
  to {
    transform: rotate(360deg);
  }
}

@media (prefers-reduced-motion: no-preference) {
  a:nth-of-type(2) .logo {
    animation: logo-spin infinite 20s linear;
  }
}

.card {
  padding: 2em;
}

.read-the-docs {
  color: #888;
}
```

# src\views\platform\PlatformDashboard.jsx
```
import { useState, useEffect } from 'react';
import { db } from '../../config/firebase';
import { collection, getDocs, addDoc, serverTimestamp } from 'firebase/firestore';

const PlatformDashboard = () => {
  const [organizations, setOrganizations] = useState([]);
  const [loading, setLoading] = useState(true);
  const [showCreateOrg, setShowCreateOrg] = useState(false);
  const [showCreateEvent, setShowCreateEvent] = useState(false);
  const [selectedOrg, setSelectedOrg] = useState(null);

  useEffect(() => {
    loadOrganizations();
  }, []);

  const loadOrganizations = async () => {
    try {
      setLoading(true);
      const orgsSnapshot = await getDocs(collection(db, 'organizations'));
      const orgsData = await Promise.all(
        orgsSnapshot.docs.map(async (orgDoc) => {
          const orgData = orgDoc.data();
          
          const eventsSnapshot = await getDocs(
            collection(db, 'organizations', orgDoc.id, 'events')
          );
          const events = eventsSnapshot.docs.map(eventDoc => ({
            id: eventDoc.id,
            ...eventDoc.data()
          }));

          return {
            id: orgDoc.id,
            ...orgData,
            events
          };
        })
      );
      setOrganizations(orgsData);
    } catch (error) {
      console.error('åŠ è½½ç»„ç»‡å¤±è´¥:', error);
      alert('åŠ è½½ç»„ç»‡å¤±è´¥: ' + error.message);
    } finally {
      setLoading(false);
    }
  };

  if (loading) {
    return (
      <div style={styles.container}>
        <div style={styles.loadingCard}>
          <div style={styles.spinner}></div>
          <p>åŠ è½½ä¸­...</p>
        </div>
      </div>
    );
  }

  return (
    <div style={styles.container}>
      <div style={styles.header}>
        <div>
          <h1 style={styles.title}>ğŸ¯ Platform ç®¡ç†ä¸­å¿ƒ</h1>
          <p style={styles.subtitle}>ç®¡ç†æ‰€æœ‰ç»„ç»‡å’Œæ´»åŠ¨</p>
        </div>
        <button
          style={styles.primaryButton}
          onClick={() => setShowCreateOrg(true)}
        >
          + åˆ›å»ºæ–°ç»„ç»‡
        </button>
      </div>

      <div style={styles.statsGrid}>
        <StatCard
          title="æ€»ç»„ç»‡æ•°"
          value={organizations.length}
          icon="ğŸ¢"
          color="#667eea"
        />
        <StatCard
          title="æ€»æ´»åŠ¨æ•°"
          value={organizations.reduce((sum, org) => sum + org.events.length, 0)}
          icon="ğŸ“…"
          color="#764ba2"
        />
        <StatCard
          title="æ´»è·ƒæ´»åŠ¨"
          value={organizations.reduce(
            (sum, org) => sum + org.events.filter(e => e.status === 'active').length,
            0
          )}
          icon="âœ¨"
          color="#10b981"
        />
        <StatCard
          title="æ€»ç”¨æˆ·æ•°"
          value={organizations.reduce((sum, org) => sum + (org.statistics?.totalUsers || 0), 0)}
          icon="ğŸ‘¥"
          color="#f59e0b"
        />
      </div>

      <div style={styles.orgList}>
        {organizations.length === 0 ? (
          <div style={styles.emptyState}>
            <div style={{ fontSize: '64px', marginBottom: '1rem' }}>ğŸ“¦</div>
            <h3>è¿˜æ²¡æœ‰ç»„ç»‡</h3>
            <p style={{ color: '#6b7280', marginBottom: '1.5rem' }}>
              ç‚¹å‡»ä¸Šæ–¹æŒ‰é’®åˆ›å»ºç¬¬ä¸€ä¸ªç»„ç»‡
            </p>
          </div>
        ) : (
          organizations.map(org => (
            <OrganizationCard
              key={org.id}
              organization={org}
              onCreateEvent={(org) => {
                setSelectedOrg(org);
                setShowCreateEvent(true);
              }}
              onReload={loadOrganizations}
            />
          ))
        )}
      </div>

      {showCreateOrg && (
        <CreateOrganizationModal
          onClose={() => setShowCreateOrg(false)}
          onSuccess={() => {
            setShowCreateOrg(false);
            loadOrganizations();
          }}
        />
      )}

      {showCreateEvent && (
        <CreateEventModal
          organization={selectedOrg}
          onClose={() => {
            setShowCreateEvent(false);
            setSelectedOrg(null);
          }}
          onSuccess={() => {
            setShowCreateEvent(false);
            setSelectedOrg(null);
            loadOrganizations();
          }}
        />
      )}
    </div>
  );
};

const StatCard = ({ title, value, icon, color }) => (
  <div style={{...styles.statCard, borderTopColor: color}}>
    <div style={styles.statIcon}>{icon}</div>
    <div>
      <div style={styles.statValue}>{value}</div>
      <div style={styles.statTitle}>{title}</div>
    </div>
  </div>
);

const OrganizationCard = ({ organization, onCreateEvent, onReload }) => {
  const [expanded, setExpanded] = useState(false);

  return (
    <div style={styles.orgCard}>
      <div style={styles.orgHeader}>
        <div style={styles.orgInfo}>
          <h3 style={styles.orgName}>
            {organization.orgName['zh-CN']}
          </h3>
          <div style={styles.orgMeta}>
            <span style={styles.badge}>{organization.orgCode}</span>
            <span style={styles.metaText}>
              {organization.events.length} ä¸ªæ´»åŠ¨
            </span>
            <span style={{...styles.statusBadge, 
              background: organization.status === 'active' ? '#d1fae5' : '#fee2e2',
              color: organization.status === 'active' ? '#065f46' : '#991b1b'
            }}>
              {organization.status === 'active' ? 'è¿ä½œä¸­' : 'å·²åœç”¨'}
            </span>
          </div>
        </div>
        <div style={styles.orgActions}>
          <button
            style={styles.secondaryButton}
            onClick={() => onCreateEvent(organization)}
          >
            + åˆ›å»ºæ´»åŠ¨
          </button>
          <button
            style={styles.iconButton}
            onClick={() => setExpanded(!expanded)}
          >
            {expanded ? 'â–²' : 'â–¼'}
          </button>
        </div>
      </div>

      {expanded && (
        <div style={styles.eventsSection}>
          <h4 style={styles.eventsTitle}>æ´»åŠ¨åˆ—è¡¨</h4>
          {organization.events.length === 0 ? (
            <p style={styles.noEvents}>æ­¤ç»„ç»‡è¿˜æ²¡æœ‰æ´»åŠ¨</p>
          ) : (
            <div style={styles.eventsGrid}>
              {organization.events.map(event => (
                <EventCard key={event.id} event={event} organization={organization} />
              ))}
            </div>
          )}
        </div>
      )}
    </div>
  );
};

const EventCard = ({ event, organization }) => {
  const eventUrl = `/${organization.orgCode}-${event.eventCode}/phone`;
  
  return (
    <div style={styles.eventCard}>
      <div style={styles.eventHeader}>
        <h5 style={styles.eventName}>{event.eventName['zh-CN']}</h5>
        <span style={{...styles.statusBadge,
          background: event.status === 'active' ? '#dbeafe' : '#fee2e2',
          color: event.status === 'active' ? '#1e40af' : '#991b1b'
        }}>
          {event.status === 'active' ? 'è¿›è¡Œä¸­' : event.status}
        </span>
      </div>
      <div style={styles.eventMeta}>
        <div style={styles.metaItem}>
          ğŸª ä¹‰å–ä¼šï¼š{event.eventInfo?.fairDate || 'æœªè®¾å®š'}
        </div>
        <div style={styles.metaItem}>
          ğŸ’° æ¶ˆè´¹æœŸï¼š{event.eventInfo?.consumptionPeriod?.startDate || 'æœªè®¾å®š'} ~ {event.eventInfo?.consumptionPeriod?.endDate || 'æœªè®¾å®š'}
        </div>
        <div style={styles.metaItem}>
          ğŸ‘¥ {event.statistics?.totalUsers || 0} ä½ç”¨æˆ·
        </div>
        <div style={styles.metaItem}>
          ğŸ’µ RM {event.settings?.totalCapital?.toLocaleString() || 0}
        </div>
      </div>
      <div style={styles.eventLinks}>
        <a
          href={eventUrl}
          target="_blank"
          rel="noopener noreferrer"
          style={styles.linkButton}
        >
          ğŸ“± æ‰‹æœºç‰ˆ
        </a>
        <a
          href={eventUrl.replace('/phone', '/desktop')}
          target="_blank"
          rel="noopener noreferrer"
          style={styles.linkButton}
        >
          ğŸ–¥ï¸ æ¡Œæœºç‰ˆ
        </a>
      </div>
    </div>
  );
};

const CreateOrganizationModal = ({ onClose, onSuccess }) => {
  const [formData, setFormData] = useState({
    orgNameZh: '',
    orgNameEn: '',
    orgCode: '',
    email: '',
    phone: '',
    address: ''
  });
  const [submitting, setSubmitting] = useState(false);

  const handleSubmit = async (e) => {
    e.preventDefault();
    
    if (!formData.orgNameZh || !formData.orgCode || !formData.email) {
      alert('è¯·å¡«å†™å¿…å¡«æ ä½');
      return;
    }

    try {
      setSubmitting(true);
      
      await addDoc(collection(db, 'organizations'), {
        orgName: {
          'zh-CN': formData.orgNameZh,
          'en': formData.orgNameEn || formData.orgNameZh
        },
        orgCode: formData.orgCode.toLowerCase(),
        contactInfo: {
          email: formData.email,
          phone: formData.phone,
          address: formData.address
        },
        settings: {
          defaultLanguage: 'zh-CN',
          supportedLanguages: ['zh-CN', 'en'],
          timezone: 'Asia/Kuala_Lumpur',
          currency: 'MYR'
        },
        admins: [],
        statistics: {
          totalEvents: 0,
          activeEvents: 0,
          totalUsers: 0,
          totalTransactions: 0
        },
        status: 'active',
        createdAt: serverTimestamp(),
        createdBy: 'platform_admin',
        updatedAt: serverTimestamp()
      });

      alert('ç»„ç»‡åˆ›å»ºæˆåŠŸï¼');
      onSuccess();
    } catch (error) {
      console.error('åˆ›å»ºç»„ç»‡å¤±è´¥:', error);
      alert('åˆ›å»ºç»„ç»‡å¤±è´¥: ' + error.message);
    } finally {
      setSubmitting(false);
    }
  };

  return (
    <div style={styles.modalOverlay} onClick={onClose}>
      <div style={styles.modalContent} onClick={e => e.stopPropagation()}>
        <h2 style={styles.modalTitle}>åˆ›å»ºæ–°ç»„ç»‡</h2>
        <form onSubmit={handleSubmit}>
          <div style={styles.formGroup}>
            <label style={styles.label}>ç»„ç»‡åç§°ï¼ˆä¸­æ–‡ï¼‰*</label>
            <input
              type="text"
              style={styles.input}
              value={formData.orgNameZh}
              onChange={e => setFormData({...formData, orgNameZh: e.target.value})}
              placeholder="ä¾‹å¦‚ï¼šèŠ™è“‰ä¸­åä¸­å­¦"
              required
            />
          </div>

          <div style={styles.formGroup}>
            <label style={styles.label}>ç»„ç»‡åç§°ï¼ˆè‹±æ–‡ï¼‰</label>
            <input
              type="text"
              style={styles.input}
              value={formData.orgNameEn}
              onChange={e => setFormData({...formData, orgNameEn: e.target.value})}
              placeholder="ä¾‹å¦‚ï¼šFoon Chung Hua School"
            />
          </div>

          <div style={styles.formGroup}>
            <label style={styles.label}>ç»„ç»‡ä»£ç  *</label>
            <input
              type="text"
              style={styles.input}
              value={formData.orgCode}
              onChange={e => setFormData({...formData, orgCode: e.target.value.toLowerCase()})}
              placeholder="ä¾‹å¦‚ï¼šfchï¼ˆä»…å°å†™å­—æ¯ï¼‰"
              pattern="[a-z]+"
              required
            />
            <small style={styles.hint}>ç”¨äºç”Ÿæˆ URLï¼Œä»…é™å°å†™è‹±æ–‡å­—æ¯</small>
          </div>

          <div style={styles.formGroup}>
            <label style={styles.label}>è”ç»œé‚®ç®± *</label>
            <input
              type="email"
              style={styles.input}
              value={formData.email}
              onChange={e => setFormData({...formData, email: e.target.value})}
              placeholder="admin@example.com"
              required
            />
          </div>

          <div style={styles.formGroup}>
            <label style={styles.label}>è”ç»œç”µè¯</label>
            <input
              type="tel"
              style={styles.input}
              value={formData.phone}
              onChange={e => setFormData({...formData, phone: e.target.value})}
              placeholder="0123456789"
            />
          </div>

          <div style={styles.formGroup}>
            <label style={styles.label}>åœ°å€</label>
            <textarea
              style={{...styles.input, minHeight: '80px'}}
              value={formData.address}
              onChange={e => setFormData({...formData, address: e.target.value})}
              placeholder="ç»„ç»‡åœ°å€"
            />
          </div>

          <div style={styles.modalActions}>
            <button
              type="button"
              style={styles.cancelButton}
              onClick={onClose}
              disabled={submitting}
            >
              å–æ¶ˆ
            </button>
            <button
              type="submit"
              style={styles.submitButton}
              disabled={submitting}
            >
              {submitting ? 'åˆ›å»ºä¸­...' : 'åˆ›å»ºç»„ç»‡'}
            </button>
          </div>
        </form>
      </div>
    </div>
  );
};

const CreateEventModal = ({ organization, onClose, onSuccess }) => {
  const [formData, setFormData] = useState({
    eventNameZh: '',
    eventNameEn: '',
    eventCode: new Date().getFullYear().toString(),
    descriptionZh: '',
    voucherSalesStart: '',
    voucherSalesEnd: '',
    fairDate: '',
    fairTime: '08:00 - 16:00',
    consumptionStart: '',
    consumptionEnd: '',
    systemOpenDate: '',
    systemCloseDate: '',
    location: '',
    totalCapital: 2000000
  });
  const [submitting, setSubmitting] = useState(false);

  const handleSubmit = async (e) => {
    e.preventDefault();
    
    if (!formData.eventNameZh || !formData.eventCode || !formData.fairDate) {
      alert('è¯·å¡«å†™å¿…å¡«æ ä½');
      return;
    }

    try {
      setSubmitting(true);
      
      await addDoc(
        collection(db, 'organizations', organization.id, 'events'),
        {
          eventCode: formData.eventCode,
          eventName: {
            'zh-CN': formData.eventNameZh,
            'en': formData.eventNameEn || formData.eventNameZh
          },
          eventInfo: {
            description: {
              'zh-CN': formData.descriptionZh,
              'en': formData.descriptionZh
            },
            voucherSalesPeriod: {
              startDate: formData.voucherSalesStart,
              endDate: formData.voucherSalesEnd
            },
            fairDate: formData.fairDate,
            fairTime: formData.fairTime,
            consumptionPeriod: {
              startDate: formData.consumptionStart,
              endDate: formData.consumptionEnd
            },
            systemPeriod: {
              openDate: formData.systemOpenDate,
              closeDate: formData.systemCloseDate
            },
            location: formData.location,
            purpose: 'ç­¹å‹Ÿå­¦æ ¡å‘å±•åŸºé‡‘'
          },
          eventManager: null,
          settings: {
            totalCapital: parseInt(formData.totalCapital),
            pointToRinggitRatio: 1,
            allowCustomerRegistration: true,
            requireOTP: true,
            multiLanguage: true
          },
          statistics: {
            totalUsers: 0,
            totalCustomers: 0,
            totalSellers: 0,
            totalMerchants: 0,
            totalManagers: 0,
            totalTransactions: 0,
            totalPointsIssued: 0,
            totalPointsConsumed: 0,
            assignedCapital: 0,
            availableCapital: parseInt(formData.totalCapital)
          },
          status: 'planning',
          createdAt: serverTimestamp(),
          createdBy: 'platform_admin',
          updatedAt: serverTimestamp()
        }
      );

      alert('æ´»åŠ¨åˆ›å»ºæˆåŠŸï¼');
      onSuccess();
    } catch (error) {
      console.error('åˆ›å»ºæ´»åŠ¨å¤±è´¥:', error);
      alert('åˆ›å»ºæ´»åŠ¨å¤±è´¥: ' + error.message);
    } finally {
      setSubmitting(false);
    }
  };

  return (
    <div style={styles.modalOverlay} onClick={onClose}>
      <div style={{...styles.modalContent, maxWidth: '700px'}} onClick={e => e.stopPropagation()}>
        <h2 style={styles.modalTitle}>
          ä¸º {organization.orgName['zh-CN']} åˆ›å»ºæ´»åŠ¨
        </h2>
        <form onSubmit={handleSubmit}>
          <div style={styles.formGroup}>
            <label style={styles.label}>æ´»åŠ¨åç§°ï¼ˆä¸­æ–‡ï¼‰*</label>
            <input
              type="text"
              style={styles.input}
              value={formData.eventNameZh}
              onChange={e => setFormData({...formData, eventNameZh: e.target.value})}
              placeholder="ä¾‹å¦‚ï¼š2025æ ¡åº†ä¹‰å–ä¼š"
              required
            />
          </div>

          <div style={styles.formGroup}>
            <label style={styles.label}>æ´»åŠ¨åç§°ï¼ˆè‹±æ–‡ï¼‰</label>
            <input
              type="text"
              style={styles.input}
              value={formData.eventNameEn}
              onChange={e => setFormData({...formData, eventNameEn: e.target.value})}
              placeholder="ä¾‹å¦‚ï¼š2025 Charity Fair"
            />
          </div>

          <div style={styles.formGroup}>
            <label style={styles.label}>æ´»åŠ¨ä»£ç  *</label>
            <input
              type="text"
              style={styles.input}
              value={formData.eventCode}
              onChange={e => setFormData({...formData, eventCode: e.target.value})}
              placeholder="ä¾‹å¦‚ï¼š2025"
              required
            />
            <small style={styles.hint}>
              URL å°†ä¼šæ˜¯: /{organization.orgCode}-{formData.eventCode}/phone
            </small>
          </div>

          <div style={styles.formGroup}>
            <label style={styles.label}>æ´»åŠ¨æè¿°</label>
            <textarea
              style={{...styles.input, minHeight: '80px'}}
              value={formData.descriptionZh}
              onChange={e => setFormData({...formData, descriptionZh: e.target.value})}
              placeholder="æ´»åŠ¨è¯¦ç»†æè¿°"
            />
          </div>

          <div style={{...styles.sectionDivider, marginTop: '2rem'}}>
            <h4 style={styles.sectionTitle}>ğŸ“… å›ºæœ¬é”€å”®æœŸ</h4>
            <div style={styles.formRow}>
              <div style={styles.formGroup}>
                <label style={styles.label}>å¼€å§‹æ—¥æœŸ</label>
                <input
                  type="date"
                  style={styles.input}
                  value={formData.voucherSalesStart}
                  onChange={e => setFormData({...formData, voucherSalesStart: e.target.value})}
                />
              </div>
              <div style={styles.formGroup}>
                <label style={styles.label}>ç»“æŸæ—¥æœŸ</label>
                <input
                  type="date"
                  style={styles.input}
                  value={formData.voucherSalesEnd}
                  onChange={e => setFormData({...formData, voucherSalesEnd: e.target.value})}
                />
              </div>
            </div>
          </div>

          <div style={styles.sectionDivider}>
            <h4 style={styles.sectionTitle}>ğŸª ä¹‰å–ä¼šæ´»åŠ¨æ—¥</h4>
            <div style={styles.formRow}>
              <div style={styles.formGroup}>
                <label style={styles.label}>æ´»åŠ¨æ—¥æœŸ *</label>
                <input
                  type="date"
                  style={styles.input}
                  value={formData.fairDate}
                  onChange={e => setFormData({...formData, fairDate: e.target.value})}
                  required
                />
              </div>
              <div style={styles.formGroup}>
                <label style={styles.label}>æ´»åŠ¨æ—¶é—´</label>
                <input
                  type="text"
                  style={styles.input}
                  value={formData.fairTime}
                  onChange={e => setFormData({...formData, fairTime: e.target.value})}
                  placeholder="08:00 - 16:00"
                />
              </div>
            </div>
          </div>

          <div style={styles.sectionDivider}>
            <h4 style={styles.sectionTitle}>ğŸ’° æ¶ˆè´¹æœ‰æ•ˆæœŸ</h4>
            <div style={styles.formRow}>
              <div style={styles.formGroup}>
                <label style={styles.label}>å¼€å§‹æ—¥æœŸ</label>
                <input
                  type="date"
                  style={styles.input}
                  value={formData.consumptionStart}
                  onChange={e => setFormData({...formData, consumptionStart: e.target.value})}
                />
                <small style={styles.hint}>å¯èƒ½æœ‰é¢„å”®</small>
              </div>
              <div style={styles.formGroup}>
                <label style={styles.label}>ç»“æŸæ—¥æœŸ</label>
                <input
                  type="date"
                  style={styles.input}
                  value={formData.consumptionEnd}
                  onChange={e => setFormData({...formData, consumptionEnd: e.target.value})}
                />
                <small style={styles.hint}>å¯èƒ½å»¶ååˆ°åº—æ¶ˆè´¹</small>
              </div>
            </div>
          </div>

          <div style={styles.sectionDivider}>
            <h4 style={styles.sectionTitle}>âš™ï¸ ç³»ç»Ÿå¼€æ”¾æœŸ</h4>
            <div style={styles.formRow}>
              <div style={styles.formGroup}>
                <label style={styles.label}>ç³»ç»Ÿå¼€æ”¾æ—¥</label>
                <input
                  type="date"
                  style={styles.input}
                  value={formData.systemOpenDate}
                  onChange={e => setFormData({...formData, systemOpenDate: e.target.value})}
                />
              </div>
              <div style={styles.formGroup}>
                <label style={styles.label}>ç³»ç»Ÿå…³é—­æ—¥</label>
                <input
                  type="date"
                  style={styles.input}
                  value={formData.systemCloseDate}
                  onChange={e => setFormData({...formData, systemCloseDate: e.target.value})}
                />
                <small style={styles.hint}>å…³é—­åä»…ä¾›æŸ¥è¯¢</small>
              </div>
            </div>
          </div>

          <div style={{...styles.formGroup, marginTop: '1.5rem'}}>
            <label style={styles.label}>æ´»åŠ¨åœ°ç‚¹</label>
            <input
              type="text"
              style={styles.input}
              value={formData.location}
              onChange={e => setFormData({...formData, location: e.target.value})}
              placeholder="æ´»åŠ¨ä¸¾åŠåœ°ç‚¹"
            />
          </div>

          <div style={styles.formGroup}>
            <label style={styles.label}>æ€»èµ„æœ¬é¢åº¦ï¼ˆRMï¼‰</label>
            <input
              type="number"
              style={styles.input}
              value={formData.totalCapital}
              onChange={e => setFormData({...formData, totalCapital: e.target.value})}
              min="0"
              step="1000"
            />
          </div>

          <div style={styles.modalActions}>
            <button
              type="button"
              style={styles.cancelButton}
              onClick={onClose}
              disabled={submitting}
            >
              å–æ¶ˆ
            </button>
            <button
              type="submit"
              style={styles.submitButton}
              disabled={submitting}
            >
              {submitting ? 'åˆ›å»ºä¸­...' : 'åˆ›å»ºæ´»åŠ¨'}
            </button>
          </div>
        </form>
      </div>
    </div>
  );
};

const styles = {
  container: {
    minHeight: '100vh',
    background: 'linear-gradient(135deg, #667eea 0%, #764ba2 100%)',
    padding: '2rem'
  },
  loadingCard: {
    background: 'white',
    padding: '3rem',
    borderRadius: '16px',
    textAlign: 'center',
    maxWidth: '400px',
    margin: '0 auto'
  },
  spinner: {
    width: '48px',
    height: '48px',
    border: '4px solid #667eea',
    borderTopColor: 'transparent',
    borderRadius: '50%',
    margin: '0 auto 1rem',
    animation: 'spin 1s linear infinite'
  },
  header: {
    background: 'white',
    padding: '2rem',
    borderRadius: '16px',
    marginBottom: '2rem',
    display: 'flex',
    justifyContent: 'space-between',
    alignItems: 'center',
    boxShadow: '0 4px 6px rgba(0,0,0,0.1)'
  },
  title: {
    fontSize: '2rem',
    fontWeight: 'bold',
    color: '#1f2937',
    margin: '0 0 0.5rem 0'
  },
  subtitle: {
    color: '#6b7280',
    margin: 0
  },
  primaryButton: {
    padding: '0.75rem 1.5rem',
    background: 'linear-gradient(135deg, #667eea 0%, #764ba2 100%)',
    color: 'white',
    border: 'none',
    borderRadius: '8px',
    fontSize: '1rem',
    fontWeight: '500',
    cursor: 'pointer'
  },
  statsGrid: {
    display: 'grid',
    gridTemplateColumns: 'repeat(auto-fit, minmax(250px, 1fr))',
    gap: '1.5rem',
    marginBottom: '2rem'
  },
  statCard: {
    background: 'white',
    padding: '1.5rem',
    borderRadius: '12px',
    display: 'flex',
    alignItems: 'center',
    gap: '1rem',
    borderTop: '4px solid',
    boxShadow: '0 2px 4px rgba(0,0,0,0.1)'
  },
  statIcon: {
    fontSize: '2.5rem'
  },
  statValue: {
    fontSize: '2rem',
    fontWeight: 'bold',
    color: '#1f2937'
  },
  statTitle: {
    fontSize: '0.875rem',
    color: '#6b7280'
  },
  orgList: {
    display: 'flex',
    flexDirection: 'column',
    gap: '1.5rem'
  },
  emptyState: {
    background: 'white',
    padding: '4rem 2rem',
    borderRadius: '16px',
    textAlign: 'center'
  },
  orgCard: {
    background: 'white',
    borderRadius: '16px',
    padding: '1.5rem',
    boxShadow: '0 4px 6px rgba(0,0,0,0.1)'
  },
  orgHeader: {
    display: 'flex',
    justifyContent: 'space-between',
    alignItems: 'center',
    marginBottom: '1rem'
  },
  orgInfo: {
    flex: 1
  },
  orgName: {
    fontSize: '1.5rem',
    fontWeight: 'bold',
    color: '#1f2937',
    margin: '0 0 0.5rem 0'
  },
  orgMeta: {
    display: 'flex',
    gap: '1rem',
    alignItems: 'center'
  },
  badge: {
    background: '#dbeafe',
    color: '#1e40af',
    padding: '0.25rem 0.75rem',
    borderRadius: '12px',
    fontSize: '0.875rem',
    fontWeight: '500'
  },
  metaText: {
    color: '#6b7280',
    fontSize: '0.875rem'
  },
  statusBadge: {
    padding: '0.25rem 0.75rem',
    borderRadius: '12px',
    fontSize: '0.75rem',
    fontWeight: '500'
  },
  orgActions: {
    display: 'flex',
    gap: '0.5rem'
  },
  secondaryButton: {
    padding: '0.5rem 1rem',
    background: '#f3f4f6',
    color: '#374151',
    border: '1px solid #d1d5db',
    borderRadius: '8px',
    fontSize: '0.875rem',
    cursor: 'pointer'
  },
  iconButton: {
    padding: '0.5rem 0.75rem',
    background: '#f3f4f6',
    border: '1px solid #d1d5db',
    borderRadius: '8px',
    cursor: 'pointer'
  },
  eventsSection: {
    borderTop: '1px solid #e5e7eb',
    paddingTop: '1rem',
    marginTop: '1rem'
  },
  eventsTitle: {
    fontSize: '1.125rem',
    fontWeight: '600',
    color: '#374151',
    marginBottom: '1rem'
  },
  noEvents: {
    color: '#9ca3af',
    fontStyle: 'italic',
    textAlign: 'center',
    padding: '2rem'
  },
  eventsGrid: {
    display: 'grid',
    gridTemplateColumns: 'repeat(auto-fill, minmax(300px, 1fr))',
    gap: '1rem'
  },
  eventCard: {
    background: '#f9fafb',
    border: '1px solid #e5e7eb',
    borderRadius: '12px',
    padding: '1rem'
  },
  eventHeader: {
    display: 'flex',
    justifyContent: 'space-between',
    alignItems: 'start',
    marginBottom: '0.75rem'
  },
  eventName: {
    fontSize: '1rem',
    fontWeight: '600',
    color: '#1f2937',
    margin: 0
  },
  eventMeta: {
    display: 'flex',
    flexDirection: 'column',
    gap: '0.5rem',
    marginBottom: '1rem'
  },
  metaItem: {
    fontSize: '0.875rem',
    color: '#6b7280'
  },
  eventLinks: {
    display: 'flex',
    gap: '0.5rem'
  },
  linkButton: {
    flex: 1,
    padding: '0.5rem',
    background: 'linear-gradient(135deg, #667eea 0%, #764ba2 100%)',
    color: 'white',
    textDecoration: 'none',
    borderRadius: '6px',
    fontSize: '0.875rem',
    textAlign: 'center',
    fontWeight: '500'
  },
  modalOverlay: {
    position: 'fixed',
    top: 0,
    left: 0,
    right: 0,
    bottom: 0,
    background: 'rgba(0, 0, 0, 0.5)',
    display: 'flex',
    justifyContent: 'center',
    alignItems: 'center',
    zIndex: 1000,
    padding: '1rem'
  },
  modalContent: {
    background: 'white',
    borderRadius: '16px',
    padding: '2rem',
    maxWidth: '600px',
    width: '100%',
    maxHeight: '90vh',
    overflowY: 'auto'
  },
  modalTitle: {
    fontSize: '1.5rem',
    fontWeight: 'bold',
    color: '#1f2937',
    marginBottom: '1.5rem'
  },
  formGroup: {
    marginBottom: '1.5rem'
  },
  formRow: {
    display: 'grid',
    gridTemplateColumns: '1fr 1fr',
    gap: '1rem'
  },
  label: {
    display: 'block',
    fontSize: '0.875rem',
    fontWeight: '500',
    color: '#374151',
    marginBottom: '0.5rem'
  },
  input: {
    width: '100%',
    padding: '0.75rem',
    border: '1px solid #d1d5db',
    borderRadius: '8px',
    fontSize: '1rem',
    outline: 'none',
    boxSizing: 'border-box'
  },
  hint: {
    display: 'block',
    fontSize: '0.75rem',
    color: '#6b7280',
    marginTop: '0.25rem'
  },
  modalActions: {
    display: 'flex',
    gap: '1rem',
    justifyContent: 'flex-end',
    marginTop: '2rem'
  },
  cancelButton: {
    padding: '0.75rem 1.5rem',
    background: '#f3f4f6',
    color: '#374151',
    border: '1px solid #d1d5db',
    borderRadius: '8px',
    fontSize: '1rem',
    cursor: 'pointer'
  },
  submitButton: {
    padding: '0.75rem 1.5rem',
    background: 'linear-gradient(135deg, #667eea 0%, #764ba2 100%)',
    color: 'white',
    border: 'none',
    borderRadius: '8px',
    fontSize: '1rem',
    fontWeight: '500',
    cursor: 'pointer'
  }
};

export default PlatformDashboard;
```

# src\contexts\EventContext.jsx
```
// src/contexts/EventContext.jsx
import { createContext, useContext, useState, useEffect } from 'react';
import { db } from '../config/firebase';
import { collection, query, where, getDocs } from 'firebase/firestore';

const EventContext = createContext();

export const useEvent = () => {
  const context = useContext(EventContext);
  if (!context) {
    throw new Error('useEvent must be used within EventProvider');
  }
  return context;
};

export const EventProvider = ({ children }) => {
  const [loading, setLoading] = useState(true);
  const [error, setError] = useState(null);
  const [organizationId, setOrganizationId] = useState(null);
  const [eventId, setEventId] = useState(null);
  const [organization, setOrganization] = useState(null);
  const [event, setEvent] = useState(null);

  // å¾ URL è§£æçµ„ç¹”å’Œæ´»å‹•ä»£ç¢¼
  // URL æ ¼å¼: /fch-2025/phone æˆ– /fch-2025/desktop
  const urlPath = window.location.pathname;
  const match = urlPath.match(/\/([a-z]+)-(\d+)\/(phone|desktop)/);
  
  const orgCode = match ? match[1] : null;
  const eventCode = match ? match[2] : null;

  useEffect(() => {
    if (!orgCode || !eventCode) {
      setLoading(false);
      return;
    }

    loadEventData();
  }, [orgCode, eventCode]);

  const loadEventData = async () => {
    try {
      setLoading(true);
      setError(null);

      // 1. æ ¹æ“š orgCode æŸ¥æ‰¾çµ„ç¹”
      const orgsSnapshot = await getDocs(
        query(collection(db, 'organizations'), where('orgCode', '==', orgCode))
      );

      if (orgsSnapshot.empty) {
        throw new Error(`æ‰¾ä¸åˆ°çµ„ç¹”ä»£ç¢¼: ${orgCode}`);
      }

      const orgDoc = orgsSnapshot.docs[0];
      const orgId = orgDoc.id;
      const orgData = orgDoc.data();

      setOrganizationId(orgId);
      setOrganization({ id: orgId, ...orgData });

      // 2. æ ¹æ“š eventCode æŸ¥æ‰¾æ´»å‹•
      const eventsSnapshot = await getDocs(
        query(
          collection(db, 'organizations', orgId, 'events'),
          where('eventCode', '==', eventCode)
        )
      );

      if (eventsSnapshot.empty) {
        throw new Error(`æ‰¾ä¸åˆ°æ´»å‹•ä»£ç¢¼: ${eventCode}`);
      }

      const eventDoc = eventsSnapshot.docs[0];
      const evtId = eventDoc.id;
      const evtData = eventDoc.data();

      setEventId(evtId);
      setEvent({ id: evtId, ...evtData });

      console.log('[EventContext] Loaded:', {
        orgCode,
        eventCode,
        orgId,
        eventId: evtId
      });
    } catch (err) {
      console.error('[EventContext] Error:', err);
      setError(err.message);
    } finally {
      setLoading(false);
    }
  };

  // ç²å–é›†åˆè·¯å¾‘ï¼ˆè‡ªå‹•åŠ ä¸Š org å’Œ event å‰ç¶´ï¼‰
  const getCollectionPath = (collectionName) => {
    if (!organizationId || !eventId) {
      throw new Error('Organization or Event not loaded');
    }
    return `organizations/${organizationId}/events/${eventId}/${collectionName}`;
  };

  // ç²å– Firestore é›†åˆå¼•ç”¨
  const getCollection = (collectionName) => {
    return collection(db, getCollectionPath(collectionName));
  };

  const value = {
    loading,
    error,
    organizationId,
    eventId,
    organization,
    event,
    orgCode,
    eventCode,
    getCollectionPath,
    getCollection,
    reload: loadEventData
  };

  return (
    <EventContext.Provider value={value}>
      {children}
    </EventContext.Provider>
  );
};
```

# src\components\guards\DeviceProtection.jsx
```
import { useState, useEffect } from 'react';

// è¨­å‚™æª¢æ¸¬ Hook
export const useDeviceDetect = () => {
  const [isMobile, setIsMobile] = useState(false);

  useEffect(() => {
    const checkDevice = () => {
      const userAgent = navigator.userAgent || navigator.vendor || window.opera;
      const mobileRegex = /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i;
      const isMobileUA = mobileRegex.test(userAgent);
      const isSmallScreen = window.innerWidth <= 768;
      
      setIsMobile(isMobileUA || isSmallScreen);
    };

    checkDevice();
    window.addEventListener('resize', checkDevice);
    
    return () => window.removeEventListener('resize', checkDevice);
  }, []);

  return isMobile;
};

// è¨­å‚™è­¦å‘Šçµ„ä»¶
const DeviceWarning = ({ requiredDevice }) => {
  const isMobileRequired = requiredDevice === 'mobile';
  
  return (
    <div style={styles.container}>
      <div style={styles.card}>
        <div style={styles.icon}>âš ï¸</div>
        <h1 style={styles.title}>è¨­å‚™ä¸ç¬¦</h1>
        <p style={styles.message}>
          {isMobileRequired 
            ? 'æ­¤é é¢åƒ…ä¾›è¡Œå‹•è£ç½®ç€è¦½\nè«‹ä½¿ç”¨æ‰‹æ©Ÿæˆ–å¹³æ¿è¨ªå•'
            : 'æ­¤é é¢åƒ…ä¾›æ¡Œé¢é›»è…¦ç€è¦½\nè«‹ä½¿ç”¨é›»è…¦è¨ªå•æ­¤é é¢'
          }
        </p>
        <div style={styles.info}>
          <p style={styles.infoText}>
            {isMobileRequired 
              ? 'ğŸ“± è«‹ä½¿ç”¨æ‰‹æ©Ÿæƒæ QR Code æˆ–ç›´æ¥åœ¨æ‰‹æ©Ÿç€è¦½å™¨ä¸­æ‰“é–‹æ­¤é€£çµ'
              : 'ğŸ–¥ï¸ è«‹åœ¨æ¡Œé¢é›»è…¦ä¸Šæ‰“é–‹æ­¤é€£çµä»¥è¨ªå•ç®¡ç†ä»‹é¢'
            }
          </p>
        </div>
      </div>
    </div>
  );
};

// Mobile è·¯ç”±å®ˆè¡›
export const MobileGuard = ({ children }) => {
  const isMobile = useDeviceDetect();
  
  return isMobile ? children : <DeviceWarning requiredDevice="mobile" />;
};

// Desktop è·¯ç”±å®ˆè¡›
export const DesktopGuard = ({ children }) => {
  const isMobile = useDeviceDetect();
  
  return !isMobile ? children : <DeviceWarning requiredDevice="desktop" />;
};

const styles = {
  container: {
    display: 'flex',
    flexDirection: 'column',
    alignItems: 'center',
    justifyContent: 'center',
    minHeight: '100vh',
    padding: '20px',
    background: 'linear-gradient(135deg, #667eea 0%, #764ba2 100%)'
  },
  card: {
    backgroundColor: 'white',
    padding: '40px',
    borderRadius: '16px',
    boxShadow: '0 20px 60px rgba(0, 0, 0, 0.3)',
    maxWidth: '500px',
    width: '100%',
    textAlign: 'center'
  },
  icon: {
    fontSize: '64px',
    marginBottom: '20px'
  },
  title: {
    fontSize: '28px',
    fontWeight: 'bold',
    color: '#1f2937',
    marginBottom: '16px'
  },
  message: {
    fontSize: '16px',
    color: '#6b7280',
    lineHeight: '1.6',
    marginBottom: '24px',
    whiteSpace: 'pre-line'
  },
  info: {
    backgroundColor: '#f3f4f6',
    padding: '16px',
    borderRadius: '12px',
    borderLeft: '4px solid #667eea'
  },
  infoText: {
    fontSize: '14px',
    color: '#374151',
    margin: 0,
    lineHeight: '1.5'
  }
};

export default DeviceWarning;
```
