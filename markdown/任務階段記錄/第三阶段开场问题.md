我已经仔细阅读了所有文档。让我先总结理解，然后提出需要确认的问题。

## 📋 项目理解总结

### 当前状态
- ✅ 第一阶段：Platform Dashboard、组织/活动创建完成
- ✅ 第二阶段：双轨认证系统（EventContext + AuthContext）、手机版/桌机版登录完成
- ✅ Cloud Functions 已部署到真实 Firebase
- ✅ 测试数据和测试账号已创建

### 本次任务（第三阶段）
根据「第三阶段TODO.md」，需要实现：
**Platform Admin 指派 Org Admin 功能**

包括：
1. Cloud Function: `createOrgAdmin`
2. 前端组件: `AssignOrgAdmin.jsx`
3. 修改 `PlatformDashboard.jsx`（添加"指派管理员"按钮）

---

## ❓ 需要确认的问题

### 1. **数据存储路径问题**
在「第三阶段TODO.md」中提到两种可能的存储方式：

```javascript
// 方案 A: 根层级
users/{userId}

// 方案 B: 组织下
organizations/{orgId}/users/{userId}
```

**我的建议：**
- **Org Admin 应该存储在组织层级下**：`organizations/{orgId}/users/{userId}`
- 原因：
  - Org Admin 只管理特定组织，不跨组织
  - 与 Event 用户保持一致的路径结构
  - 更符合数据隔离原则

**请确认：Org Admin 存储在 `organizations/{orgId}/users/{userId}` 还是根层级 `users/{userId}`？**

---

### 2. **Org Admin 的角色和权限范围**
根据旧文档，角色优先级是：
```
platform_admin > org_admin > event_manager > manager > merchant > seller > customer
```

**需要确认：**
- Org Admin 可以做什么？
  - ✅ 管理组织基本信息？
  - ✅ 为活动指派 Event Manager？
  - ✅ 查看组织下所有活动？
  - ❌ 不能创建/删除活动？（这是 Platform Admin 的权限）

**请确认 Org Admin 的具体权限范围。**

---

### 3. **Org Admin 登录入口**
Org Admin 登录后应该跳转到哪里？

**我的建议：**
- 创建 `/orgCode/admin/dashboard` 路由（桌机版）
- 显示：
  - 组织信息
  - 管理员列表
  - 活动列表
  - 为活动指派 Event Manager

**请确认：**
- Org Admin 是否需要独立的 Dashboard？
- 还是直接跳转到某个活动的管理界面？

---

### 4. **与 Platform Admin 的区别**
从代码来看，目前 Platform Admin 访问 `/platform/admin`，但：

**问题：**
1. Platform Admin 目前**没有登录功能**（直接访问 Dashboard）
2. 是否需要先实现 Platform Admin 登录？（这在「第一个文档」中是优先级1）

**我的建议顺序：**
1. 先实现本次任务（Platform Admin 指派 Org Admin）
2. Platform Admin 登录功能放在下一阶段

**请确认这个顺序是否可以。**

---

### 5. **identityTag 的必要性**
在 `createOrgAdmin` 中，需要设置 `identityTag`（staff/teacher）。

**问题：**
- Org Admin 是组织管理员，为什么还需要 `identityTag`？
- 是否因为 Org Admin 可能同时是学校职员或教师？

**请确认：**
- Org Admin 的 `identityTag` 是必填还是可选？
- 如果可选，默认值是什么？

---

### 6. **初始密码设置方式**
在 `createOrgAdmin` 时：

**选项 A：** Platform Admin 设置初始密码
**选项 B：** 系统生成随机密码，发送给 Org Admin（需要邮件/短信）
**选项 C：** 首次登录时强制修改密码

**我的建议：**
- Platform Admin 手动设置初始密码
- 设置 `mustChangePassword: true`，强制首次登录修改

**请确认初始密码的设置方式。**

---

### 7. **组织的 admins 数组结构**
当前 `organizations/{orgId}` 中有 `admins` 数组：

```javascript
admins: [
  {
    uid: "phone_60123456789",
    phoneNumber: "0123456789",
    name: "John Doe",
    addedAt: "2025-01-11T10:00:00Z"
  }
]
```

**问题：**
- `uid` 是指 `authUid` 还是 Firestore 文档 ID？
- `name` 存英文名还是中文名？

**我的建议：**
```javascript
admins: [
  {
    userId: "usr_xxx",           // Firestore 文档 ID
    authUid: "phone_60123456789", // Firebase Auth UID
    phoneNumber: "0123456789",
    englishName: "John Doe",
    chineseName: "张三",
    addedAt: Timestamp,
    addedBy: "platform_admin_uid"
  }
]
```

**请确认 admins 数组的字段结构。**

---

## 🎯 如果以上问题确认后，我的实现计划

### 阶段 1：Cloud Function（20-30分钟）
1. 创建 `createOrgAdmin` function
2. 验证调用者是 Platform Admin
3. 创建 Org Admin 用户文档
4. 更新组织的 admins 数组

### 阶段 2：前端 Modal 组件（20-30分钟）
1. 创建 `AssignOrgAdmin.jsx`
2. 表单验证
3. 调用 Cloud Function

### 阶段 3：修改 PlatformDashboard（15-20分钟）
1. 添加"指派管理员"按钮
2. 显示管理员数量
3. 管理员列表展示

### 阶段 4：测试（15-20分钟）
1. 手动测试完整流程
2. 验证数据正确性

---

## ✅ 请确认以上7个问题

一旦确认，我会立即开始编写代码，分阶段提交。每个阶段完成后等待你的确认再继续下一阶段。

**准备好了吗？请逐一回答上述问题，我们就可以开始了！** 🚀