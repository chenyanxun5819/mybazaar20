function nh(e,r){for(var t=0;t<r.length;t++){const a=r[t];if(typeof a!="string"&&!Array.isArray(a)){for(const i in a)if(i!=="default"&&!(i in e)){const c=Object.getOwnPropertyDescriptor(a,i);c&&Object.defineProperty(e,i,c.get?c:{enumerable:!0,get:()=>a[i]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}var cs=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function d1(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var s0={exports:{}},o0={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hc;function ah(){return hc||(hc=1,(function(e){function r(ue,de){var We=ue.length;ue.push(de);e:for(;0<We;){var se=We-1>>>1,Le=ue[se];if(0<i(Le,de))ue[se]=de,ue[We]=Le,We=se;else break e}}function t(ue){return ue.length===0?null:ue[0]}function a(ue){if(ue.length===0)return null;var de=ue[0],We=ue.pop();if(We!==de){ue[0]=We;e:for(var se=0,Le=ue.length,Ge=Le>>>1;se<Ge;){var z=2*(se+1)-1,ne=ue[z],Z=z+1,ee=ue[Z];if(0>i(ne,We))Z<Le&&0>i(ee,ne)?(ue[se]=ee,ue[Z]=We,se=Z):(ue[se]=ne,ue[z]=We,se=z);else if(Z<Le&&0>i(ee,We))ue[se]=ee,ue[Z]=We,se=Z;else break e}}return de}function i(ue,de){var We=ue.sortIndex-de.sortIndex;return We!==0?We:ue.id-de.id}if(e.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var c=performance;e.unstable_now=function(){return c.now()}}else{var u=Date,d=u.now();e.unstable_now=function(){return u.now()-d}}var g=[],m=[],w=1,v=null,_=3,C=!1,S=!1,A=!1,y=!1,D=typeof setTimeout=="function"?setTimeout:null,P=typeof clearTimeout=="function"?clearTimeout:null,b=typeof setImmediate<"u"?setImmediate:null;function V(ue){for(var de=t(m);de!==null;){if(de.callback===null)a(m);else if(de.startTime<=ue)a(m),de.sortIndex=de.expirationTime,r(g,de);else break;de=t(m)}}function te(ue){if(A=!1,V(ue),!S)if(t(g)!==null)S=!0,W||(W=!0,X());else{var de=t(m);de!==null&&q(te,de.startTime-ue)}}var W=!1,N=-1,j=5,O=-1;function ae(){return y?!0:!(e.unstable_now()-O<j)}function Q(){if(y=!1,W){var ue=e.unstable_now();O=ue;var de=!0;try{e:{S=!1,A&&(A=!1,P(N),N=-1),C=!0;var We=_;try{t:{for(V(ue),v=t(g);v!==null&&!(v.expirationTime>ue&&ae());){var se=v.callback;if(typeof se=="function"){v.callback=null,_=v.priorityLevel;var Le=se(v.expirationTime<=ue);if(ue=e.unstable_now(),typeof Le=="function"){v.callback=Le,V(ue),de=!0;break t}v===t(g)&&a(g),V(ue)}else a(g);v=t(g)}if(v!==null)de=!0;else{var Ge=t(m);Ge!==null&&q(te,Ge.startTime-ue),de=!1}}break e}finally{v=null,_=We,C=!1}de=void 0}}finally{de?X():W=!1}}}var X;if(typeof b=="function")X=function(){b(Q)};else if(typeof MessageChannel<"u"){var ie=new MessageChannel,Ee=ie.port2;ie.port1.onmessage=Q,X=function(){Ee.postMessage(null)}}else X=function(){D(Q,0)};function q(ue,de){N=D(function(){ue(e.unstable_now())},de)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(ue){ue.callback=null},e.unstable_forceFrameRate=function(ue){0>ue||125<ue?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):j=0<ue?Math.floor(1e3/ue):5},e.unstable_getCurrentPriorityLevel=function(){return _},e.unstable_next=function(ue){switch(_){case 1:case 2:case 3:var de=3;break;default:de=_}var We=_;_=de;try{return ue()}finally{_=We}},e.unstable_requestPaint=function(){y=!0},e.unstable_runWithPriority=function(ue,de){switch(ue){case 1:case 2:case 3:case 4:case 5:break;default:ue=3}var We=_;_=ue;try{return de()}finally{_=We}},e.unstable_scheduleCallback=function(ue,de,We){var se=e.unstable_now();switch(typeof We=="object"&&We!==null?(We=We.delay,We=typeof We=="number"&&0<We?se+We:se):We=se,ue){case 1:var Le=-1;break;case 2:Le=250;break;case 5:Le=1073741823;break;case 4:Le=1e4;break;default:Le=5e3}return Le=We+Le,ue={id:w++,callback:de,priorityLevel:ue,startTime:We,expirationTime:Le,sortIndex:-1},We>se?(ue.sortIndex=We,r(m,ue),t(g)===null&&ue===t(m)&&(A?(P(N),N=-1):A=!0,q(te,We-se))):(ue.sortIndex=Le,r(g,ue),S||C||(S=!0,W||(W=!0,X()))),ue},e.unstable_shouldYield=ae,e.unstable_wrapCallback=function(ue){var de=_;return function(){var We=_;_=de;try{return ue.apply(this,arguments)}finally{_=We}}}})(o0)),o0}var dc;function f8(){return dc||(dc=1,s0.exports=ah()),s0.exports}const ih=(e,r)=>r.some(t=>e instanceof t);let xc,gc;function sh(){return xc||(xc=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function oh(){return gc||(gc=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const x1=new WeakMap,j0=new WeakMap,g1=new WeakMap,c0=new WeakMap,co=new WeakMap;function ch(e){const r=new Promise((t,a)=>{const i=()=>{e.removeEventListener("success",c),e.removeEventListener("error",u)},c=()=>{t(aa(e.result)),i()},u=()=>{a(e.error),i()};e.addEventListener("success",c),e.addEventListener("error",u)});return r.then(t=>{t instanceof IDBCursor&&x1.set(t,e)}).catch(()=>{}),co.set(r,e),r}function fh(e){if(j0.has(e))return;const r=new Promise((t,a)=>{const i=()=>{e.removeEventListener("complete",c),e.removeEventListener("error",u),e.removeEventListener("abort",u)},c=()=>{t(),i()},u=()=>{a(e.error||new DOMException("AbortError","AbortError")),i()};e.addEventListener("complete",c),e.addEventListener("error",u),e.addEventListener("abort",u)});j0.set(e,r)}let Z0={get(e,r,t){if(e instanceof IDBTransaction){if(r==="done")return j0.get(e);if(r==="objectStoreNames")return e.objectStoreNames||g1.get(e);if(r==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return aa(e[r])},set(e,r,t){return e[r]=t,!0},has(e,r){return e instanceof IDBTransaction&&(r==="done"||r==="store")?!0:r in e}};function lh(e){Z0=e(Z0)}function uh(e){return e===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(r,...t){const a=e.call(f0(this),r,...t);return g1.set(a,r.sort?r.sort():[r]),aa(a)}:oh().includes(e)?function(...r){return e.apply(f0(this),r),aa(x1.get(this))}:function(...r){return aa(e.apply(f0(this),r))}}function hh(e){return typeof e=="function"?uh(e):(e instanceof IDBTransaction&&fh(e),ih(e,sh())?new Proxy(e,Z0):e)}function aa(e){if(e instanceof IDBRequest)return ch(e);if(c0.has(e))return c0.get(e);const r=hh(e);return r!==e&&(c0.set(e,r),co.set(r,e)),r}const f0=e=>co.get(e);function l8(e,r,{blocked:t,upgrade:a,blocking:i,terminated:c}={}){const u=indexedDB.open(e,r),d=aa(u);return a&&u.addEventListener("upgradeneeded",g=>{a(aa(u.result),g.oldVersion,g.newVersion,aa(u.transaction),g)}),t&&u.addEventListener("blocked",g=>t(g.oldVersion,g.newVersion,g)),d.then(g=>{c&&g.addEventListener("close",()=>c()),i&&g.addEventListener("versionchange",m=>i(m.oldVersion,m.newVersion,m))}).catch(()=>{}),d}const dh=["get","getKey","getAll","getAllKeys","count"],xh=["put","add","delete","clear"],l0=new Map;function mc(e,r){if(!(e instanceof IDBDatabase&&!(r in e)&&typeof r=="string"))return;if(l0.get(r))return l0.get(r);const t=r.replace(/FromIndex$/,""),a=r!==t,i=xh.includes(t);if(!(t in(a?IDBIndex:IDBObjectStore).prototype)||!(i||dh.includes(t)))return;const c=async function(u,...d){const g=this.transaction(u,i?"readwrite":"readonly");let m=g.store;return a&&(m=m.index(d.shift())),(await Promise.all([m[t](...d),i&&g.done]))[0]};return l0.set(r,c),c}lh(e=>({...e,get:(r,t,a)=>mc(r,t)||e.get(r,t,a),has:(r,t)=>!!mc(r,t)||e.has(r,t)}));/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var _s={};_s.version="0.18.5";var m1=1252,gh=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],fo={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},lo=function(e){gh.indexOf(e)!=-1&&(m1=fo[0]=e)};function mh(){lo(1252)}var vn=function(e){lo(e)};function uo(){vn(1200),mh()}function pc(e){for(var r=[],t=0,a=e.length;t<a;++t)r[t]=e.charCodeAt(t);return r}function ph(e){for(var r=[],t=0;t<e.length>>1;++t)r[t]=String.fromCharCode(e.charCodeAt(2*t)+(e.charCodeAt(2*t+1)<<8));return r.join("")}function p1(e){for(var r=[],t=0;t<e.length>>1;++t)r[t]=String.fromCharCode(e.charCodeAt(2*t+1)+(e.charCodeAt(2*t)<<8));return r.join("")}var _i=function(e){var r=e.charCodeAt(0),t=e.charCodeAt(1);return r==255&&t==254?ph(e.slice(2)):r==254&&t==255?p1(e.slice(2)):r==65279?e.slice(1):e},fs=function(r){return String.fromCharCode(r)},wc=function(r){return String.fromCharCode(r)},Oi,ra="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Di(e){for(var r="",t=0,a=0,i=0,c=0,u=0,d=0,g=0,m=0;m<e.length;)t=e.charCodeAt(m++),c=t>>2,a=e.charCodeAt(m++),u=(t&3)<<4|a>>4,i=e.charCodeAt(m++),d=(a&15)<<2|i>>6,g=i&63,isNaN(a)?d=g=64:isNaN(i)&&(g=64),r+=ra.charAt(c)+ra.charAt(u)+ra.charAt(d)+ra.charAt(g);return r}function en(e){var r="",t=0,a=0,i=0,c=0,u=0,d=0,g=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var m=0;m<e.length;)c=ra.indexOf(e.charAt(m++)),u=ra.indexOf(e.charAt(m++)),t=c<<2|u>>4,r+=String.fromCharCode(t),d=ra.indexOf(e.charAt(m++)),a=(u&15)<<4|d>>2,d!==64&&(r+=String.fromCharCode(a)),g=ra.indexOf(e.charAt(m++)),i=(d&3)<<6|g,g!==64&&(r+=String.fromCharCode(i));return r}var gt=(function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node})(),Gn=(function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(r,t){return t?new Buffer(r,t):new Buffer(r)}:Buffer.from.bind(Buffer)}return function(){}})();function ia(e){return gt?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function Ec(e){return gt?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var Qr=function(r){return gt?Gn(r,"binary"):r.split("").map(function(t){return t.charCodeAt(0)&255})};function Ps(e){if(typeof ArrayBuffer>"u")return Qr(e);for(var r=new ArrayBuffer(e.length),t=new Uint8Array(r),a=0;a!=e.length;++a)t[a]=e.charCodeAt(a)&255;return r}function fa(e){if(Array.isArray(e))return e.map(function(a){return String.fromCharCode(a)}).join("");for(var r=[],t=0;t<e.length;++t)r[t]=String.fromCharCode(e[t]);return r.join("")}function wh(e){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(e)}function ho(e){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(e instanceof ArrayBuffer)return ho(new Uint8Array(e));for(var r=new Array(e.length),t=0;t<e.length;++t)r[t]=e[t];return r}var mr=gt?function(e){return Buffer.concat(e.map(function(r){return Buffer.isBuffer(r)?r:Gn(r)}))}:function(e){if(typeof Uint8Array<"u"){var r=0,t=0;for(r=0;r<e.length;++r)t+=e[r].length;var a=new Uint8Array(t),i=0;for(r=0,t=0;r<e.length;t+=i,++r)if(i=e[r].length,e[r]instanceof Uint8Array)a.set(e[r],t);else{if(typeof e[r]=="string")throw"wtf";a.set(new Uint8Array(e[r]),t)}return a}return[].concat.apply([],e.map(function(c){return Array.isArray(c)?c:[].slice.call(c)}))};function Eh(e){for(var r=[],t=0,a=e.length+250,i=ia(e.length+255),c=0;c<e.length;++c){var u=e.charCodeAt(c);if(u<128)i[t++]=u;else if(u<2048)i[t++]=192|u>>6&31,i[t++]=128|u&63;else if(u>=55296&&u<57344){u=(u&1023)+64;var d=e.charCodeAt(++c)&1023;i[t++]=240|u>>8&7,i[t++]=128|u>>2&63,i[t++]=128|d>>6&15|(u&3)<<4,i[t++]=128|d&63}else i[t++]=224|u>>12&15,i[t++]=128|u>>6&63,i[t++]=128|u&63;t>a&&(r.push(i.slice(0,t)),t=0,i=ia(65535),a=65530)}return r.push(i.slice(0,t)),mr(r)}var Pr=/\u0000/g,Ai=/[\u0001-\u0006]/g;function Ja(e){for(var r="",t=e.length-1;t>=0;)r+=e.charAt(t--);return r}function _n(e,r){var t=""+e;return t.length>=r?t:Jt("0",r-t.length)+t}function xo(e,r){var t=""+e;return t.length>=r?t:Jt(" ",r-t.length)+t}function As(e,r){var t=""+e;return t.length>=r?t:t+Jt(" ",r-t.length)}function vh(e,r){var t=""+Math.round(e);return t.length>=r?t:Jt("0",r-t.length)+t}function _h(e,r){var t=""+e;return t.length>=r?t:Jt("0",r-t.length)+t}var vc=Math.pow(2,32);function Xa(e,r){if(e>vc||e<-vc)return vh(e,r);var t=Math.round(e);return _h(t,r)}function Cs(e,r){return r=r||0,e.length>=7+r&&(e.charCodeAt(r)|32)===103&&(e.charCodeAt(r+1)|32)===101&&(e.charCodeAt(r+2)|32)===110&&(e.charCodeAt(r+3)|32)===101&&(e.charCodeAt(r+4)|32)===114&&(e.charCodeAt(r+5)|32)===97&&(e.charCodeAt(r+6)|32)===108}var _c=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],u0=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function Ah(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"上午/下午 "hh"時"mm"分"ss"秒 "',e}var qe={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"上午/下午 "hh"時"mm"分"ss"秒 "'},Ac={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},Ch={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function Ts(e,r,t){for(var a=e<0?-1:1,i=e*a,c=0,u=1,d=0,g=1,m=0,w=0,v=Math.floor(i);m<r&&(v=Math.floor(i),d=v*u+c,w=v*m+g,!(i-v<5e-8));)i=1/(i-v),c=u,u=d,g=m,m=w;if(w>r&&(m>r?(w=g,d=c):(w=m,d=u)),!t)return[0,a*d,w];var _=Math.floor(a*d/w);return[_,a*d-_*w,w]}function wa(e,r,t){if(e>2958465||e<0)return null;var a=e|0,i=Math.floor(86400*(e-a)),c=0,u=[],d={D:a,T:i,u:86400*(e-a)-i,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(d.u)<1e-6&&(d.u=0),r&&r.date1904&&(a+=1462),d.u>.9999&&(d.u=0,++i==86400&&(d.T=i=0,++a,++d.D)),a===60)u=t?[1317,10,29]:[1900,2,29],c=3;else if(a===0)u=t?[1317,8,29]:[1900,1,0],c=6;else{a>60&&--a;var g=new Date(1900,0,1);g.setDate(g.getDate()+a-1),u=[g.getFullYear(),g.getMonth()+1,g.getDate()],c=g.getDay(),a<60&&(c=(c+6)%7),t&&(c=bh(g,u))}return d.y=u[0],d.m=u[1],d.d=u[2],d.S=i%60,i=Math.floor(i/60),d.M=i%60,i=Math.floor(i/60),d.H=i,d.q=c,d}var w1=new Date(1899,11,31,0,0,0),Th=w1.getTime(),Sh=new Date(1900,2,1,0,0,0);function E1(e,r){var t=e.getTime();return r?t-=1461*24*60*60*1e3:e>=Sh&&(t+=1440*60*1e3),(t-(Th+(e.getTimezoneOffset()-w1.getTimezoneOffset())*6e4))/(1440*60*1e3)}function go(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function yh(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function Ih(e){var r=e<0?12:11,t=go(e.toFixed(12));return t.length<=r||(t=e.toPrecision(10),t.length<=r)?t:e.toExponential(5)}function kh(e){var r=go(e.toFixed(11));return r.length>(e<0?12:11)||r==="0"||r==="-0"?e.toPrecision(6):r}function Bi(e){var r=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),t;return r>=-4&&r<=-1?t=e.toPrecision(10+r):Math.abs(r)<=9?t=Ih(e):r===10?t=e.toFixed(10).substr(0,12):t=kh(e),go(yh(t.toUpperCase()))}function Ca(e,r){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):Bi(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return xn(14,E1(e,r&&r.date1904),r)}throw new Error("unsupported value in General format: "+e)}function bh(e,r){r[0]-=581;var t=e.getDay();return e<60&&(t=(t+6)%7),t}function Nh(e,r,t,a){var i="",c=0,u=0,d=t.y,g,m=0;switch(e){case 98:d=t.y+543;case 121:switch(r.length){case 1:case 2:g=d%100,m=2;break;default:g=d%1e4,m=4;break}break;case 109:switch(r.length){case 1:case 2:g=t.m,m=r.length;break;case 3:return u0[t.m-1][1];case 5:return u0[t.m-1][0];default:return u0[t.m-1][2]}break;case 100:switch(r.length){case 1:case 2:g=t.d,m=r.length;break;case 3:return _c[t.q][0];default:return _c[t.q][1]}break;case 104:switch(r.length){case 1:case 2:g=1+(t.H+11)%12,m=r.length;break;default:throw"bad hour format: "+r}break;case 72:switch(r.length){case 1:case 2:g=t.H,m=r.length;break;default:throw"bad hour format: "+r}break;case 77:switch(r.length){case 1:case 2:g=t.M,m=r.length;break;default:throw"bad minute format: "+r}break;case 115:if(r!="s"&&r!="ss"&&r!=".0"&&r!=".00"&&r!=".000")throw"bad second format: "+r;return t.u===0&&(r=="s"||r=="ss")?_n(t.S,r.length):(a>=2?u=a===3?1e3:100:u=a===1?10:1,c=Math.round(u*(t.S+t.u)),c>=60*u&&(c=0),r==="s"?c===0?"0":""+c/u:(i=_n(c,2+a),r==="ss"?i.substr(0,2):"."+i.substr(2,r.length-1)));case 90:switch(r){case"[h]":case"[hh]":g=t.D*24+t.H;break;case"[m]":case"[mm]":g=(t.D*24+t.H)*60+t.M;break;case"[s]":case"[ss]":g=((t.D*24+t.H)*60+t.M)*60+Math.round(t.S+t.u);break;default:throw"bad abstime format: "+r}m=r.length===3?1:2;break;case 101:g=d,m=1;break}var w=m>0?_n(g,m):"";return w}function na(e){var r=3;if(e.length<=r)return e;for(var t=e.length%r,a=e.substr(0,t);t!=e.length;t+=r)a+=(a.length>0?",":"")+e.substr(t,r);return a}var v1=/%/g;function Fh(e,r,t){var a=r.replace(v1,""),i=r.length-a.length;return Un(e,a,t*Math.pow(10,2*i))+Jt("%",i)}function Rh(e,r,t){for(var a=r.length-1;r.charCodeAt(a-1)===44;)--a;return Un(e,r.substr(0,a),t/Math.pow(10,3*(r.length-a)))}function _1(e,r){var t,a=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(r==0)return"0.0E+0";if(r<0)return"-"+_1(e,-r);var i=e.indexOf(".");i===-1&&(i=e.indexOf("E"));var c=Math.floor(Math.log(r)*Math.LOG10E)%i;if(c<0&&(c+=i),t=(r/Math.pow(10,c)).toPrecision(a+1+(i+c)%i),t.indexOf("e")===-1){var u=Math.floor(Math.log(r)*Math.LOG10E);for(t.indexOf(".")===-1?t=t.charAt(0)+"."+t.substr(1)+"E+"+(u-t.length+c):t+="E+"+(u-c);t.substr(0,2)==="0.";)t=t.charAt(0)+t.substr(2,i)+"."+t.substr(2+i),t=t.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");t=t.replace(/\+-/,"-")}t=t.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(d,g,m,w){return g+m+w.substr(0,(i+c)%i)+"."+w.substr(c)+"E"})}else t=r.toExponential(a);return e.match(/E\+00$/)&&t.match(/e[+-]\d$/)&&(t=t.substr(0,t.length-1)+"0"+t.charAt(t.length-1)),e.match(/E\-/)&&t.match(/e\+/)&&(t=t.replace(/e\+/,"e")),t.replace("e","E")}var A1=/# (\?+)( ?)\/( ?)(\d+)/;function Oh(e,r,t){var a=parseInt(e[4],10),i=Math.round(r*a),c=Math.floor(i/a),u=i-c*a,d=a;return t+(c===0?"":""+c)+" "+(u===0?Jt(" ",e[1].length+1+e[4].length):xo(u,e[1].length)+e[2]+"/"+e[3]+_n(d,e[4].length))}function Dh(e,r,t){return t+(r===0?"":""+r)+Jt(" ",e[1].length+2+e[4].length)}var C1=/^#*0*\.([0#]+)/,T1=/\).*[0#]/,S1=/\(###\) ###\\?-####/;function Br(e){for(var r="",t,a=0;a!=e.length;++a)switch(t=e.charCodeAt(a)){case 35:break;case 63:r+=" ";break;case 48:r+="0";break;default:r+=String.fromCharCode(t)}return r}function Cc(e,r){var t=Math.pow(10,r);return""+Math.round(e*t)/t}function Tc(e,r){var t=e-Math.floor(e),a=Math.pow(10,r);return r<(""+Math.round(t*a)).length?0:Math.round(t*a)}function Bh(e,r){return r<(""+Math.round((e-Math.floor(e))*Math.pow(10,r))).length?1:0}function Mh(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function cn(e,r,t){if(e.charCodeAt(0)===40&&!r.match(T1)){var a=r.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return t>=0?cn("n",a,t):"("+cn("n",a,-t)+")"}if(r.charCodeAt(r.length-1)===44)return Rh(e,r,t);if(r.indexOf("%")!==-1)return Fh(e,r,t);if(r.indexOf("E")!==-1)return _1(r,t);if(r.charCodeAt(0)===36)return"$"+cn(e,r.substr(r.charAt(1)==" "?2:1),t);var i,c,u,d,g=Math.abs(t),m=t<0?"-":"";if(r.match(/^00+$/))return m+Xa(g,r.length);if(r.match(/^[#?]+$/))return i=Xa(t,0),i==="0"&&(i=""),i.length>r.length?i:Br(r.substr(0,r.length-i.length))+i;if(c=r.match(A1))return Oh(c,g,m);if(r.match(/^#+0+$/))return m+Xa(g,r.length-r.indexOf("0"));if(c=r.match(C1))return i=Cc(t,c[1].length).replace(/^([^\.]+)$/,"$1."+Br(c[1])).replace(/\.$/,"."+Br(c[1])).replace(/\.(\d*)$/,function(S,A){return"."+A+Jt("0",Br(c[1]).length-A.length)}),r.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(r=r.replace(/^#+([0.])/,"$1"),c=r.match(/^(0*)\.(#*)$/))return m+Cc(g,c[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,c[1].length?"0.":".");if(c=r.match(/^#{1,3},##0(\.?)$/))return m+na(Xa(g,0));if(c=r.match(/^#,##0\.([#0]*0)$/))return t<0?"-"+cn(e,r,-t):na(""+(Math.floor(t)+Bh(t,c[1].length)))+"."+_n(Tc(t,c[1].length),c[1].length);if(c=r.match(/^#,#*,#0/))return cn(e,r.replace(/^#,#*,/,""),t);if(c=r.match(/^([0#]+)(\\?-([0#]+))+$/))return i=Ja(cn(e,r.replace(/[\\-]/g,""),t)),u=0,Ja(Ja(r.replace(/\\/g,"")).replace(/[0#]/g,function(S){return u<i.length?i.charAt(u++):S==="0"?"0":""}));if(r.match(S1))return i=cn(e,"##########",t),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var w="";if(c=r.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return u=Math.min(c[4].length,7),d=Ts(g,Math.pow(10,u)-1,!1),i=""+m,w=Un("n",c[1],d[1]),w.charAt(w.length-1)==" "&&(w=w.substr(0,w.length-1)+"0"),i+=w+c[2]+"/"+c[3],w=As(d[2],u),w.length<c[4].length&&(w=Br(c[4].substr(c[4].length-w.length))+w),i+=w,i;if(c=r.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return u=Math.min(Math.max(c[1].length,c[4].length),7),d=Ts(g,Math.pow(10,u)-1,!0),m+(d[0]||(d[1]?"":"0"))+" "+(d[1]?xo(d[1],u)+c[2]+"/"+c[3]+As(d[2],u):Jt(" ",2*u+1+c[2].length+c[3].length));if(c=r.match(/^[#0?]+$/))return i=Xa(t,0),r.length<=i.length?i:Br(r.substr(0,r.length-i.length))+i;if(c=r.match(/^([#0?]+)\.([#0]+)$/)){i=""+t.toFixed(Math.min(c[2].length,10)).replace(/([^0])0+$/,"$1"),u=i.indexOf(".");var v=r.indexOf(".")-u,_=r.length-i.length-v;return Br(r.substr(0,v)+i+r.substr(r.length-_))}if(c=r.match(/^00,000\.([#0]*0)$/))return u=Tc(t,c[1].length),t<0?"-"+cn(e,r,-t):na(Mh(t)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(S){return"00,"+(S.length<3?_n(0,3-S.length):"")+S})+"."+_n(u,c[1].length);switch(r){case"###,##0.00":return cn(e,"#,##0.00",t);case"###,###":case"##,###":case"#,###":var C=na(Xa(g,0));return C!=="0"?m+C:"";case"###,###.00":return cn(e,"###,##0.00",t).replace(/^0\./,".");case"#,###.00":return cn(e,"#,##0.00",t).replace(/^0\./,".")}throw new Error("unsupported format |"+r+"|")}function Ph(e,r,t){for(var a=r.length-1;r.charCodeAt(a-1)===44;)--a;return Un(e,r.substr(0,a),t/Math.pow(10,3*(r.length-a)))}function Lh(e,r,t){var a=r.replace(v1,""),i=r.length-a.length;return Un(e,a,t*Math.pow(10,2*i))+Jt("%",i)}function y1(e,r){var t,a=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(r==0)return"0.0E+0";if(r<0)return"-"+y1(e,-r);var i=e.indexOf(".");i===-1&&(i=e.indexOf("E"));var c=Math.floor(Math.log(r)*Math.LOG10E)%i;if(c<0&&(c+=i),t=(r/Math.pow(10,c)).toPrecision(a+1+(i+c)%i),!t.match(/[Ee]/)){var u=Math.floor(Math.log(r)*Math.LOG10E);t.indexOf(".")===-1?t=t.charAt(0)+"."+t.substr(1)+"E+"+(u-t.length+c):t+="E+"+(u-c),t=t.replace(/\+-/,"-")}t=t.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(d,g,m,w){return g+m+w.substr(0,(i+c)%i)+"."+w.substr(c)+"E"})}else t=r.toExponential(a);return e.match(/E\+00$/)&&t.match(/e[+-]\d$/)&&(t=t.substr(0,t.length-1)+"0"+t.charAt(t.length-1)),e.match(/E\-/)&&t.match(/e\+/)&&(t=t.replace(/e\+/,"e")),t.replace("e","E")}function Nn(e,r,t){if(e.charCodeAt(0)===40&&!r.match(T1)){var a=r.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return t>=0?Nn("n",a,t):"("+Nn("n",a,-t)+")"}if(r.charCodeAt(r.length-1)===44)return Ph(e,r,t);if(r.indexOf("%")!==-1)return Lh(e,r,t);if(r.indexOf("E")!==-1)return y1(r,t);if(r.charCodeAt(0)===36)return"$"+Nn(e,r.substr(r.charAt(1)==" "?2:1),t);var i,c,u,d,g=Math.abs(t),m=t<0?"-":"";if(r.match(/^00+$/))return m+_n(g,r.length);if(r.match(/^[#?]+$/))return i=""+t,t===0&&(i=""),i.length>r.length?i:Br(r.substr(0,r.length-i.length))+i;if(c=r.match(A1))return Dh(c,g,m);if(r.match(/^#+0+$/))return m+_n(g,r.length-r.indexOf("0"));if(c=r.match(C1))return i=(""+t).replace(/^([^\.]+)$/,"$1."+Br(c[1])).replace(/\.$/,"."+Br(c[1])),i=i.replace(/\.(\d*)$/,function(S,A){return"."+A+Jt("0",Br(c[1]).length-A.length)}),r.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(r=r.replace(/^#+([0.])/,"$1"),c=r.match(/^(0*)\.(#*)$/))return m+(""+g).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,c[1].length?"0.":".");if(c=r.match(/^#{1,3},##0(\.?)$/))return m+na(""+g);if(c=r.match(/^#,##0\.([#0]*0)$/))return t<0?"-"+Nn(e,r,-t):na(""+t)+"."+Jt("0",c[1].length);if(c=r.match(/^#,#*,#0/))return Nn(e,r.replace(/^#,#*,/,""),t);if(c=r.match(/^([0#]+)(\\?-([0#]+))+$/))return i=Ja(Nn(e,r.replace(/[\\-]/g,""),t)),u=0,Ja(Ja(r.replace(/\\/g,"")).replace(/[0#]/g,function(S){return u<i.length?i.charAt(u++):S==="0"?"0":""}));if(r.match(S1))return i=Nn(e,"##########",t),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var w="";if(c=r.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return u=Math.min(c[4].length,7),d=Ts(g,Math.pow(10,u)-1,!1),i=""+m,w=Un("n",c[1],d[1]),w.charAt(w.length-1)==" "&&(w=w.substr(0,w.length-1)+"0"),i+=w+c[2]+"/"+c[3],w=As(d[2],u),w.length<c[4].length&&(w=Br(c[4].substr(c[4].length-w.length))+w),i+=w,i;if(c=r.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return u=Math.min(Math.max(c[1].length,c[4].length),7),d=Ts(g,Math.pow(10,u)-1,!0),m+(d[0]||(d[1]?"":"0"))+" "+(d[1]?xo(d[1],u)+c[2]+"/"+c[3]+As(d[2],u):Jt(" ",2*u+1+c[2].length+c[3].length));if(c=r.match(/^[#0?]+$/))return i=""+t,r.length<=i.length?i:Br(r.substr(0,r.length-i.length))+i;if(c=r.match(/^([#0]+)\.([#0]+)$/)){i=""+t.toFixed(Math.min(c[2].length,10)).replace(/([^0])0+$/,"$1"),u=i.indexOf(".");var v=r.indexOf(".")-u,_=r.length-i.length-v;return Br(r.substr(0,v)+i+r.substr(r.length-_))}if(c=r.match(/^00,000\.([#0]*0)$/))return t<0?"-"+Nn(e,r,-t):na(""+t).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(S){return"00,"+(S.length<3?_n(0,3-S.length):"")+S})+"."+_n(0,c[1].length);switch(r){case"###,###":case"##,###":case"#,###":var C=na(""+g);return C!=="0"?m+C:"";default:if(r.match(/\.[0#?]*$/))return Nn(e,r.slice(0,r.lastIndexOf(".")),t)+Br(r.slice(r.lastIndexOf(".")))}throw new Error("unsupported format |"+r+"|")}function Un(e,r,t){return(t|0)===t?Nn(e,r,t):cn(e,r,t)}function Uh(e){for(var r=[],t=!1,a=0,i=0;a<e.length;++a)switch(e.charCodeAt(a)){case 34:t=!t;break;case 95:case 42:case 92:++a;break;case 59:r[r.length]=e.substr(i,a-i),i=a+1}if(r[r.length]=e.substr(i),t===!0)throw new Error("Format |"+e+"| unterminated string ");return r}var I1=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function ai(e){for(var r=0,t="",a="";r<e.length;)switch(t=e.charAt(r)){case"G":Cs(e,r)&&(r+=6),r++;break;case'"':for(;e.charCodeAt(++r)!==34&&r<e.length;);++r;break;case"\\":r+=2;break;case"_":r+=2;break;case"@":++r;break;case"B":case"b":if(e.charAt(r+1)==="1"||e.charAt(r+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"上":if(e.substr(r,3).toUpperCase()==="A/P"||e.substr(r,5).toUpperCase()==="AM/PM"||e.substr(r,5).toUpperCase()==="上午/下午")return!0;++r;break;case"[":for(a=t;e.charAt(r++)!=="]"&&r<e.length;)a+=e.charAt(r);if(a.match(I1))return!0;break;case".":case"0":case"#":for(;r<e.length&&("0#?.,E+-%".indexOf(t=e.charAt(++r))>-1||t=="\\"&&e.charAt(r+1)=="-"&&"0#".indexOf(e.charAt(r+2))>-1););break;case"?":for(;e.charAt(++r)===t;);break;case"*":++r,(e.charAt(r)==" "||e.charAt(r)=="*")&&++r;break;case"(":case")":++r;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;r<e.length&&"0123456789".indexOf(e.charAt(++r))>-1;);break;case" ":++r;break;default:++r;break}return!1}function Wh(e,r,t,a){for(var i=[],c="",u=0,d="",g="t",m,w,v,_="H";u<e.length;)switch(d=e.charAt(u)){case"G":if(!Cs(e,u))throw new Error("unrecognized character "+d+" in "+e);i[i.length]={t:"G",v:"General"},u+=7;break;case'"':for(c="";(v=e.charCodeAt(++u))!==34&&u<e.length;)c+=String.fromCharCode(v);i[i.length]={t:"t",v:c},++u;break;case"\\":var C=e.charAt(++u),S=C==="("||C===")"?C:"t";i[i.length]={t:S,v:C},++u;break;case"_":i[i.length]={t:"t",v:" "},u+=2;break;case"@":i[i.length]={t:"T",v:r},++u;break;case"B":case"b":if(e.charAt(u+1)==="1"||e.charAt(u+1)==="2"){if(m==null&&(m=wa(r,t,e.charAt(u+1)==="2"),m==null))return"";i[i.length]={t:"X",v:e.substr(u,2)},g=d,u+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":d=d.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(r<0||m==null&&(m=wa(r,t),m==null))return"";for(c=d;++u<e.length&&e.charAt(u).toLowerCase()===d;)c+=d;d==="m"&&g.toLowerCase()==="h"&&(d="M"),d==="h"&&(d=_),i[i.length]={t:d,v:c},g=d;break;case"A":case"a":case"上":var A={t:d,v:d};if(m==null&&(m=wa(r,t)),e.substr(u,3).toUpperCase()==="A/P"?(m!=null&&(A.v=m.H>=12?"P":"A"),A.t="T",_="h",u+=3):e.substr(u,5).toUpperCase()==="AM/PM"?(m!=null&&(A.v=m.H>=12?"PM":"AM"),A.t="T",u+=5,_="h"):e.substr(u,5).toUpperCase()==="上午/下午"?(m!=null&&(A.v=m.H>=12?"下午":"上午"),A.t="T",u+=5,_="h"):(A.t="t",++u),m==null&&A.t==="T")return"";i[i.length]=A,g=d;break;case"[":for(c=d;e.charAt(u++)!=="]"&&u<e.length;)c+=e.charAt(u);if(c.slice(-1)!=="]")throw'unterminated "[" block: |'+c+"|";if(c.match(I1)){if(m==null&&(m=wa(r,t),m==null))return"";i[i.length]={t:"Z",v:c.toLowerCase()},g=c.charAt(1)}else c.indexOf("$")>-1&&(c=(c.match(/\$([^-\[\]]*)/)||[])[1]||"$",ai(e)||(i[i.length]={t:"t",v:c}));break;case".":if(m!=null){for(c=d;++u<e.length&&(d=e.charAt(u))==="0";)c+=d;i[i.length]={t:"s",v:c};break}case"0":case"#":for(c=d;++u<e.length&&"0#?.,E+-%".indexOf(d=e.charAt(u))>-1;)c+=d;i[i.length]={t:"n",v:c};break;case"?":for(c=d;e.charAt(++u)===d;)c+=d;i[i.length]={t:d,v:c},g=d;break;case"*":++u,(e.charAt(u)==" "||e.charAt(u)=="*")&&++u;break;case"(":case")":i[i.length]={t:a===1?"t":d,v:d},++u;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(c=d;u<e.length&&"0123456789".indexOf(e.charAt(++u))>-1;)c+=e.charAt(u);i[i.length]={t:"D",v:c};break;case" ":i[i.length]={t:d,v:d},++u;break;case"$":i[i.length]={t:"t",v:"$"},++u;break;default:if(",$-+/():!^&'~{}<>=€acfijklopqrtuvwxzP".indexOf(d)===-1)throw new Error("unrecognized character "+d+" in "+e);i[i.length]={t:"t",v:d},++u;break}var y=0,D=0,P;for(u=i.length-1,g="t";u>=0;--u)switch(i[u].t){case"h":case"H":i[u].t=_,g="h",y<1&&(y=1);break;case"s":(P=i[u].v.match(/\.0+$/))&&(D=Math.max(D,P[0].length-1)),y<3&&(y=3);case"d":case"y":case"M":case"e":g=i[u].t;break;case"m":g==="s"&&(i[u].t="M",y<2&&(y=2));break;case"X":break;case"Z":y<1&&i[u].v.match(/[Hh]/)&&(y=1),y<2&&i[u].v.match(/[Mm]/)&&(y=2),y<3&&i[u].v.match(/[Ss]/)&&(y=3)}switch(y){case 0:break;case 1:m.u>=.5&&(m.u=0,++m.S),m.S>=60&&(m.S=0,++m.M),m.M>=60&&(m.M=0,++m.H);break;case 2:m.u>=.5&&(m.u=0,++m.S),m.S>=60&&(m.S=0,++m.M);break}var b="",V;for(u=0;u<i.length;++u)switch(i[u].t){case"t":case"T":case" ":case"D":break;case"X":i[u].v="",i[u].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":i[u].v=Nh(i[u].t.charCodeAt(0),i[u].v,m,D),i[u].t="t";break;case"n":case"?":for(V=u+1;i[V]!=null&&((d=i[V].t)==="?"||d==="D"||(d===" "||d==="t")&&i[V+1]!=null&&(i[V+1].t==="?"||i[V+1].t==="t"&&i[V+1].v==="/")||i[u].t==="("&&(d===" "||d==="n"||d===")")||d==="t"&&(i[V].v==="/"||i[V].v===" "&&i[V+1]!=null&&i[V+1].t=="?"));)i[u].v+=i[V].v,i[V]={v:"",t:";"},++V;b+=i[u].v,u=V-1;break;case"G":i[u].t="t",i[u].v=Ca(r,t);break}var te="",W,N;if(b.length>0){b.charCodeAt(0)==40?(W=r<0&&b.charCodeAt(0)===45?-r:r,N=Un("n",b,W)):(W=r<0&&a>1?-r:r,N=Un("n",b,W),W<0&&i[0]&&i[0].t=="t"&&(N=N.substr(1),i[0].v="-"+i[0].v)),V=N.length-1;var j=i.length;for(u=0;u<i.length;++u)if(i[u]!=null&&i[u].t!="t"&&i[u].v.indexOf(".")>-1){j=u;break}var O=i.length;if(j===i.length&&N.indexOf("E")===-1){for(u=i.length-1;u>=0;--u)i[u]==null||"n?".indexOf(i[u].t)===-1||(V>=i[u].v.length-1?(V-=i[u].v.length,i[u].v=N.substr(V+1,i[u].v.length)):V<0?i[u].v="":(i[u].v=N.substr(0,V+1),V=-1),i[u].t="t",O=u);V>=0&&O<i.length&&(i[O].v=N.substr(0,V+1)+i[O].v)}else if(j!==i.length&&N.indexOf("E")===-1){for(V=N.indexOf(".")-1,u=j;u>=0;--u)if(!(i[u]==null||"n?".indexOf(i[u].t)===-1)){for(w=i[u].v.indexOf(".")>-1&&u===j?i[u].v.indexOf(".")-1:i[u].v.length-1,te=i[u].v.substr(w+1);w>=0;--w)V>=0&&(i[u].v.charAt(w)==="0"||i[u].v.charAt(w)==="#")&&(te=N.charAt(V--)+te);i[u].v=te,i[u].t="t",O=u}for(V>=0&&O<i.length&&(i[O].v=N.substr(0,V+1)+i[O].v),V=N.indexOf(".")+1,u=j;u<i.length;++u)if(!(i[u]==null||"n?(".indexOf(i[u].t)===-1&&u!==j)){for(w=i[u].v.indexOf(".")>-1&&u===j?i[u].v.indexOf(".")+1:0,te=i[u].v.substr(0,w);w<i[u].v.length;++w)V<N.length&&(te+=N.charAt(V++));i[u].v=te,i[u].t="t",O=u}}}for(u=0;u<i.length;++u)i[u]!=null&&"n?".indexOf(i[u].t)>-1&&(W=a>1&&r<0&&u>0&&i[u-1].v==="-"?-r:r,i[u].v=Un(i[u].t,i[u].v,W),i[u].t="t");var ae="";for(u=0;u!==i.length;++u)i[u]!=null&&(ae+=i[u].v);return ae}var Sc=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function yc(e,r){if(r==null)return!1;var t=parseFloat(r[2]);switch(r[1]){case"=":if(e==t)return!0;break;case">":if(e>t)return!0;break;case"<":if(e<t)return!0;break;case"<>":if(e!=t)return!0;break;case">=":if(e>=t)return!0;break;case"<=":if(e<=t)return!0;break}return!1}function Vh(e,r){var t=Uh(e),a=t.length,i=t[a-1].indexOf("@");if(a<4&&i>-1&&--a,t.length>4)throw new Error("cannot find right format for |"+t.join("|")+"|");if(typeof r!="number")return[4,t.length===4||i>-1?t[t.length-1]:"@"];switch(t.length){case 1:t=i>-1?["General","General","General",t[0]]:[t[0],t[0],t[0],"@"];break;case 2:t=i>-1?[t[0],t[0],t[0],t[1]]:[t[0],t[1],t[0],"@"];break;case 3:t=i>-1?[t[0],t[1],t[0],t[2]]:[t[0],t[1],t[2],"@"];break}var c=r>0?t[0]:r<0?t[1]:t[2];if(t[0].indexOf("[")===-1&&t[1].indexOf("[")===-1)return[a,c];if(t[0].match(/\[[=<>]/)!=null||t[1].match(/\[[=<>]/)!=null){var u=t[0].match(Sc),d=t[1].match(Sc);return yc(r,u)?[a,t[0]]:yc(r,d)?[a,t[1]]:[a,t[u!=null&&d!=null?2:1]]}return[a,c]}function xn(e,r,t){t==null&&(t={});var a="";switch(typeof e){case"string":e=="m/d/yy"&&t.dateNF?a=t.dateNF:a=e;break;case"number":e==14&&t.dateNF?a=t.dateNF:a=(t.table!=null?t.table:qe)[e],a==null&&(a=t.table&&t.table[Ac[e]]||qe[Ac[e]]),a==null&&(a=Ch[e]||"General");break}if(Cs(a,0))return Ca(r,t);r instanceof Date&&(r=E1(r,t.date1904));var i=Vh(a,r);if(Cs(i[1]))return Ca(r,t);if(r===!0)r="TRUE";else if(r===!1)r="FALSE";else if(r===""||r==null)return"";return Wh(i[1],r,t,i[0])}function Wn(e,r){if(typeof r!="number"){r=+r||-1;for(var t=0;t<392;++t){if(qe[t]==null){r<0&&(r=t);continue}if(qe[t]==e){r=t;break}}r<0&&(r=391)}return qe[r]=e,r}function Ls(e){for(var r=0;r!=392;++r)e[r]!==void 0&&Wn(e[r],r)}function ii(){qe=Ah()}var Hh={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},k1=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function Gh(e){var r=typeof e=="number"?qe[e]:e;return r=r.replace(k1,"(\\d+)"),new RegExp("^"+r+"$")}function Xh(e,r,t){var a=-1,i=-1,c=-1,u=-1,d=-1,g=-1;(r.match(k1)||[]).forEach(function(v,_){var C=parseInt(t[_+1],10);switch(v.toLowerCase().charAt(0)){case"y":a=C;break;case"d":c=C;break;case"h":u=C;break;case"s":g=C;break;case"m":u>=0?d=C:i=C;break}}),g>=0&&d==-1&&i>=0&&(d=i,i=-1);var m=(""+(a>=0?a:new Date().getFullYear())).slice(-4)+"-"+("00"+(i>=1?i:1)).slice(-2)+"-"+("00"+(c>=1?c:1)).slice(-2);m.length==7&&(m="0"+m),m.length==8&&(m="20"+m);var w=("00"+(u>=0?u:0)).slice(-2)+":"+("00"+(d>=0?d:0)).slice(-2)+":"+("00"+(g>=0?g:0)).slice(-2);return u==-1&&d==-1&&g==-1?m:a==-1&&i==-1&&c==-1?w:m+"T"+w}var zh=(function(){var e={};e.version="1.2.0";function r(){for(var N=0,j=new Array(256),O=0;O!=256;++O)N=O,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,j[O]=N;return typeof Int32Array<"u"?new Int32Array(j):j}var t=r();function a(N){var j=0,O=0,ae=0,Q=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(ae=0;ae!=256;++ae)Q[ae]=N[ae];for(ae=0;ae!=256;++ae)for(O=N[ae],j=256+ae;j<4096;j+=256)O=Q[j]=O>>>8^N[O&255];var X=[];for(ae=1;ae!=16;++ae)X[ae-1]=typeof Int32Array<"u"?Q.subarray(ae*256,ae*256+256):Q.slice(ae*256,ae*256+256);return X}var i=a(t),c=i[0],u=i[1],d=i[2],g=i[3],m=i[4],w=i[5],v=i[6],_=i[7],C=i[8],S=i[9],A=i[10],y=i[11],D=i[12],P=i[13],b=i[14];function V(N,j){for(var O=j^-1,ae=0,Q=N.length;ae<Q;)O=O>>>8^t[(O^N.charCodeAt(ae++))&255];return~O}function te(N,j){for(var O=j^-1,ae=N.length-15,Q=0;Q<ae;)O=b[N[Q++]^O&255]^P[N[Q++]^O>>8&255]^D[N[Q++]^O>>16&255]^y[N[Q++]^O>>>24]^A[N[Q++]]^S[N[Q++]]^C[N[Q++]]^_[N[Q++]]^v[N[Q++]]^w[N[Q++]]^m[N[Q++]]^g[N[Q++]]^d[N[Q++]]^u[N[Q++]]^c[N[Q++]]^t[N[Q++]];for(ae+=15;Q<ae;)O=O>>>8^t[(O^N[Q++])&255];return~O}function W(N,j){for(var O=j^-1,ae=0,Q=N.length,X=0,ie=0;ae<Q;)X=N.charCodeAt(ae++),X<128?O=O>>>8^t[(O^X)&255]:X<2048?(O=O>>>8^t[(O^(192|X>>6&31))&255],O=O>>>8^t[(O^(128|X&63))&255]):X>=55296&&X<57344?(X=(X&1023)+64,ie=N.charCodeAt(ae++)&1023,O=O>>>8^t[(O^(240|X>>8&7))&255],O=O>>>8^t[(O^(128|X>>2&63))&255],O=O>>>8^t[(O^(128|ie>>6&15|(X&3)<<4))&255],O=O>>>8^t[(O^(128|ie&63))&255]):(O=O>>>8^t[(O^(224|X>>12&15))&255],O=O>>>8^t[(O^(128|X>>6&63))&255],O=O>>>8^t[(O^(128|X&63))&255]);return~O}return e.table=t,e.bstr=V,e.buf=te,e.str=W,e})(),Ke=(function(){var r={};r.version="1.2.1";function t(F,B){for(var M=F.split("/"),L=B.split("/"),H=0,Y=0,he=Math.min(M.length,L.length);H<he;++H){if(Y=M[H].length-L[H].length)return Y;if(M[H]!=L[H])return M[H]<L[H]?-1:1}return M.length-L.length}function a(F){if(F.charAt(F.length-1)=="/")return F.slice(0,-1).indexOf("/")===-1?F:a(F.slice(0,-1));var B=F.lastIndexOf("/");return B===-1?F:F.slice(0,B+1)}function i(F){if(F.charAt(F.length-1)=="/")return i(F.slice(0,-1));var B=F.lastIndexOf("/");return B===-1?F:F.slice(B+1)}function c(F,B){typeof B=="string"&&(B=new Date(B));var M=B.getHours();M=M<<6|B.getMinutes(),M=M<<5|B.getSeconds()>>>1,F.write_shift(2,M);var L=B.getFullYear()-1980;L=L<<4|B.getMonth()+1,L=L<<5|B.getDate(),F.write_shift(2,L)}function u(F){var B=F.read_shift(2)&65535,M=F.read_shift(2)&65535,L=new Date,H=M&31;M>>>=5;var Y=M&15;M>>>=4,L.setMilliseconds(0),L.setFullYear(M+1980),L.setMonth(Y-1),L.setDate(H);var he=B&31;B>>>=5;var _e=B&63;return B>>>=6,L.setHours(B),L.setMinutes(_e),L.setSeconds(he<<1),L}function d(F){Ar(F,0);for(var B={},M=0;F.l<=F.length-4;){var L=F.read_shift(2),H=F.read_shift(2),Y=F.l+H,he={};switch(L){case 21589:M=F.read_shift(1),M&1&&(he.mtime=F.read_shift(4)),H>5&&(M&2&&(he.atime=F.read_shift(4)),M&4&&(he.ctime=F.read_shift(4))),he.mtime&&(he.mt=new Date(he.mtime*1e3));break}F.l=Y,B[L]=he}return B}var g;function m(){return g||(g={})}function w(F,B){if(F[0]==80&&F[1]==75)return ci(F,B);if((F[0]|32)==109&&(F[1]|32)==105)return La(F,B);if(F.length<512)throw new Error("CFB file size "+F.length+" < 512");var M=3,L=512,H=0,Y=0,he=0,_e=0,ce=0,xe=[],ge=F.slice(0,512);Ar(ge,0);var ye=v(ge);switch(M=ye[0],M){case 3:L=512;break;case 4:L=4096;break;case 0:if(ye[1]==0)return ci(F,B);default:throw new Error("Major Version: Expected 3 or 4 saw "+M)}L!==512&&(ge=F.slice(0,L),Ar(ge,28));var be=F.slice(0,L);_(ge,M);var Fe=ge.read_shift(4,"i");if(M===3&&Fe!==0)throw new Error("# Directory Sectors: Expected 0 saw "+Fe);ge.l+=4,he=ge.read_shift(4,"i"),ge.l+=4,ge.chk("00100000","Mini Stream Cutoff Size: "),_e=ge.read_shift(4,"i"),H=ge.read_shift(4,"i"),ce=ge.read_shift(4,"i"),Y=ge.read_shift(4,"i");for(var Oe=-1,Ue=0;Ue<109&&(Oe=ge.read_shift(4,"i"),!(Oe<0));++Ue)xe[Ue]=Oe;var tt=C(F,L);y(ce,Y,tt,L,xe);var we=P(tt,he,xe,L);we[he].name="!Directory",H>0&&_e!==ie&&(we[_e].name="!MiniFAT"),we[xe[0]].name="!FAT",we.fat_addrs=xe,we.ssz=L;var Mt={},ut=[],rn=[],da=[];b(he,we,tt,ut,H,Mt,rn,_e),S(rn,da,ut),ut.shift();var wt={FileIndex:rn,FullPaths:da};return B&&B.raw&&(wt.raw={header:be,sectors:tt}),wt}function v(F){if(F[F.l]==80&&F[F.l+1]==75)return[0,0];F.chk(Ee,"Header Signature: "),F.l+=16;var B=F.read_shift(2,"u");return[F.read_shift(2,"u"),B]}function _(F,B){var M=9;switch(F.l+=2,M=F.read_shift(2)){case 9:if(B!=3)throw new Error("Sector Shift: Expected 9 saw "+M);break;case 12:if(B!=4)throw new Error("Sector Shift: Expected 12 saw "+M);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+M)}F.chk("0600","Mini Sector Shift: "),F.chk("000000000000","Reserved: ")}function C(F,B){for(var M=Math.ceil(F.length/B)-1,L=[],H=1;H<M;++H)L[H-1]=F.slice(H*B,(H+1)*B);return L[M-1]=F.slice(M*B),L}function S(F,B,M){for(var L=0,H=0,Y=0,he=0,_e=0,ce=M.length,xe=[],ge=[];L<ce;++L)xe[L]=ge[L]=L,B[L]=M[L];for(;_e<ge.length;++_e)L=ge[_e],H=F[L].L,Y=F[L].R,he=F[L].C,xe[L]===L&&(H!==-1&&xe[H]!==H&&(xe[L]=xe[H]),Y!==-1&&xe[Y]!==Y&&(xe[L]=xe[Y])),he!==-1&&(xe[he]=L),H!==-1&&L!=xe[L]&&(xe[H]=xe[L],ge.lastIndexOf(H)<_e&&ge.push(H)),Y!==-1&&L!=xe[L]&&(xe[Y]=xe[L],ge.lastIndexOf(Y)<_e&&ge.push(Y));for(L=1;L<ce;++L)xe[L]===L&&(Y!==-1&&xe[Y]!==Y?xe[L]=xe[Y]:H!==-1&&xe[H]!==H&&(xe[L]=xe[H]));for(L=1;L<ce;++L)if(F[L].type!==0){if(_e=L,_e!=xe[_e])do _e=xe[_e],B[L]=B[_e]+"/"+B[L];while(_e!==0&&xe[_e]!==-1&&_e!=xe[_e]);xe[L]=-1}for(B[0]+="/",L=1;L<ce;++L)F[L].type!==2&&(B[L]+="/")}function A(F,B,M){for(var L=F.start,H=F.size,Y=[],he=L;M&&H>0&&he>=0;)Y.push(B.slice(he*X,he*X+X)),H-=X,he=pa(M,he*4);return Y.length===0?ve(0):mr(Y).slice(0,F.size)}function y(F,B,M,L,H){var Y=ie;if(F===ie){if(B!==0)throw new Error("DIFAT chain shorter than expected")}else if(F!==-1){var he=M[F],_e=(L>>>2)-1;if(!he)return;for(var ce=0;ce<_e&&(Y=pa(he,ce*4))!==ie;++ce)H.push(Y);y(pa(he,L-4),B-1,M,L,H)}}function D(F,B,M,L,H){var Y=[],he=[];H||(H=[]);var _e=L-1,ce=0,xe=0;for(ce=B;ce>=0;){H[ce]=!0,Y[Y.length]=ce,he.push(F[ce]);var ge=M[Math.floor(ce*4/L)];if(xe=ce*4&_e,L<4+xe)throw new Error("FAT boundary crossed: "+ce+" 4 "+L);if(!F[ge])break;ce=pa(F[ge],xe)}return{nodes:Y,data:Lc([he])}}function P(F,B,M,L){var H=F.length,Y=[],he=[],_e=[],ce=[],xe=L-1,ge=0,ye=0,be=0,Fe=0;for(ge=0;ge<H;++ge)if(_e=[],be=ge+B,be>=H&&(be-=H),!he[be]){ce=[];var Oe=[];for(ye=be;ye>=0;){Oe[ye]=!0,he[ye]=!0,_e[_e.length]=ye,ce.push(F[ye]);var Ue=M[Math.floor(ye*4/L)];if(Fe=ye*4&xe,L<4+Fe)throw new Error("FAT boundary crossed: "+ye+" 4 "+L);if(!F[Ue]||(ye=pa(F[Ue],Fe),Oe[ye]))break}Y[be]={nodes:_e,data:Lc([ce])}}return Y}function b(F,B,M,L,H,Y,he,_e){for(var ce=0,xe=L.length?2:0,ge=B[F].data,ye=0,be=0,Fe;ye<ge.length;ye+=128){var Oe=ge.slice(ye,ye+128);Ar(Oe,64),be=Oe.read_shift(2),Fe=Ao(Oe,0,be-xe),L.push(Fe);var Ue={name:Fe,type:Oe.read_shift(1),color:Oe.read_shift(1),L:Oe.read_shift(4,"i"),R:Oe.read_shift(4,"i"),C:Oe.read_shift(4,"i"),clsid:Oe.read_shift(16),state:Oe.read_shift(4,"i"),start:0,size:0},tt=Oe.read_shift(2)+Oe.read_shift(2)+Oe.read_shift(2)+Oe.read_shift(2);tt!==0&&(Ue.ct=V(Oe,Oe.l-8));var we=Oe.read_shift(2)+Oe.read_shift(2)+Oe.read_shift(2)+Oe.read_shift(2);we!==0&&(Ue.mt=V(Oe,Oe.l-8)),Ue.start=Oe.read_shift(4,"i"),Ue.size=Oe.read_shift(4,"i"),Ue.size<0&&Ue.start<0&&(Ue.size=Ue.type=0,Ue.start=ie,Ue.name=""),Ue.type===5?(ce=Ue.start,H>0&&ce!==ie&&(B[ce].name="!StreamData")):Ue.size>=4096?(Ue.storage="fat",B[Ue.start]===void 0&&(B[Ue.start]=D(M,Ue.start,B.fat_addrs,B.ssz)),B[Ue.start].name=Ue.name,Ue.content=B[Ue.start].data.slice(0,Ue.size)):(Ue.storage="minifat",Ue.size<0?Ue.size=0:ce!==ie&&Ue.start!==ie&&B[ce]&&(Ue.content=A(Ue,B[ce].data,(B[_e]||{}).data))),Ue.content&&Ar(Ue.content,0),Y[Fe]=Ue,he.push(Ue)}}function V(F,B){return new Date((Jr(F,B+4)/1e7*Math.pow(2,32)+Jr(F,B)/1e7-11644473600)*1e3)}function te(F,B){return m(),w(g.readFileSync(F),B)}function W(F,B){var M=B&&B.type;switch(M||gt&&Buffer.isBuffer(F)&&(M="buffer"),M||"base64"){case"file":return te(F,B);case"base64":return w(Qr(en(F)),B);case"binary":return w(Qr(F),B)}return w(F,B)}function N(F,B){var M=B||{},L=M.root||"Root Entry";if(F.FullPaths||(F.FullPaths=[]),F.FileIndex||(F.FileIndex=[]),F.FullPaths.length!==F.FileIndex.length)throw new Error("inconsistent CFB structure");F.FullPaths.length===0&&(F.FullPaths[0]=L+"/",F.FileIndex[0]={name:L,type:5}),M.CLSID&&(F.FileIndex[0].clsid=M.CLSID),j(F)}function j(F){var B="Sh33tJ5";if(!Ke.find(F,"/"+B)){var M=ve(4);M[0]=55,M[1]=M[3]=50,M[2]=54,F.FileIndex.push({name:B,type:2,content:M,size:4,L:69,R:69,C:69}),F.FullPaths.push(F.FullPaths[0]+B),O(F)}}function O(F,B){N(F);for(var M=!1,L=!1,H=F.FullPaths.length-1;H>=0;--H){var Y=F.FileIndex[H];switch(Y.type){case 0:L?M=!0:(F.FileIndex.pop(),F.FullPaths.pop());break;case 1:case 2:case 5:L=!0,isNaN(Y.R*Y.L*Y.C)&&(M=!0),Y.R>-1&&Y.L>-1&&Y.R==Y.L&&(M=!0);break;default:M=!0;break}}if(!(!M&&!B)){var he=new Date(1987,1,19),_e=0,ce=Object.create?Object.create(null):{},xe=[];for(H=0;H<F.FullPaths.length;++H)ce[F.FullPaths[H]]=!0,F.FileIndex[H].type!==0&&xe.push([F.FullPaths[H],F.FileIndex[H]]);for(H=0;H<xe.length;++H){var ge=a(xe[H][0]);L=ce[ge],L||(xe.push([ge,{name:i(ge).replace("/",""),type:1,clsid:ue,ct:he,mt:he,content:null}]),ce[ge]=!0)}for(xe.sort(function(Fe,Oe){return t(Fe[0],Oe[0])}),F.FullPaths=[],F.FileIndex=[],H=0;H<xe.length;++H)F.FullPaths[H]=xe[H][0],F.FileIndex[H]=xe[H][1];for(H=0;H<xe.length;++H){var ye=F.FileIndex[H],be=F.FullPaths[H];if(ye.name=i(be).replace("/",""),ye.L=ye.R=ye.C=-(ye.color=1),ye.size=ye.content?ye.content.length:0,ye.start=0,ye.clsid=ye.clsid||ue,H===0)ye.C=xe.length>1?1:-1,ye.size=0,ye.type=5;else if(be.slice(-1)=="/"){for(_e=H+1;_e<xe.length&&a(F.FullPaths[_e])!=be;++_e);for(ye.C=_e>=xe.length?-1:_e,_e=H+1;_e<xe.length&&a(F.FullPaths[_e])!=a(be);++_e);ye.R=_e>=xe.length?-1:_e,ye.type=1}else a(F.FullPaths[H+1]||"")==a(be)&&(ye.R=H+1),ye.type=2}}}function ae(F,B){var M=B||{};if(M.fileType=="mad")return tn(F,M);switch(O(F),M.fileType){case"zip":return Bn(F,M)}var L=(function(Fe){for(var Oe=0,Ue=0,tt=0;tt<Fe.FileIndex.length;++tt){var we=Fe.FileIndex[tt];if(we.content){var Mt=we.content.length;Mt>0&&(Mt<4096?Oe+=Mt+63>>6:Ue+=Mt+511>>9)}}for(var ut=Fe.FullPaths.length+3>>2,rn=Oe+7>>3,da=Oe+127>>7,wt=rn+Ue+ut+da,ht=wt+127>>7,dt=ht<=109?0:Math.ceil((ht-109)/127);wt+ht+dt+127>>7>ht;)dt=++ht<=109?0:Math.ceil((ht-109)/127);var Kr=[1,dt,ht,da,ut,Ue,Oe,0];return Fe.FileIndex[0].size=Oe<<6,Kr[7]=(Fe.FileIndex[0].start=Kr[0]+Kr[1]+Kr[2]+Kr[3]+Kr[4]+Kr[5])+(Kr[6]+7>>3),Kr})(F),H=ve(L[7]<<9),Y=0,he=0;{for(Y=0;Y<8;++Y)H.write_shift(1,q[Y]);for(Y=0;Y<8;++Y)H.write_shift(2,0);for(H.write_shift(2,62),H.write_shift(2,3),H.write_shift(2,65534),H.write_shift(2,9),H.write_shift(2,6),Y=0;Y<3;++Y)H.write_shift(2,0);for(H.write_shift(4,0),H.write_shift(4,L[2]),H.write_shift(4,L[0]+L[1]+L[2]+L[3]-1),H.write_shift(4,0),H.write_shift(4,4096),H.write_shift(4,L[3]?L[0]+L[1]+L[2]-1:ie),H.write_shift(4,L[3]),H.write_shift(-4,L[1]?L[0]-1:ie),H.write_shift(4,L[1]),Y=0;Y<109;++Y)H.write_shift(-4,Y<L[2]?L[1]+Y:-1)}if(L[1])for(he=0;he<L[1];++he){for(;Y<236+he*127;++Y)H.write_shift(-4,Y<L[2]?L[1]+Y:-1);H.write_shift(-4,he===L[1]-1?ie:he+1)}var _e=function(Fe){for(he+=Fe;Y<he-1;++Y)H.write_shift(-4,Y+1);Fe&&(++Y,H.write_shift(-4,ie))};for(he=Y=0,he+=L[1];Y<he;++Y)H.write_shift(-4,de.DIFSECT);for(he+=L[2];Y<he;++Y)H.write_shift(-4,de.FATSECT);_e(L[3]),_e(L[4]);for(var ce=0,xe=0,ge=F.FileIndex[0];ce<F.FileIndex.length;++ce)ge=F.FileIndex[ce],ge.content&&(xe=ge.content.length,!(xe<4096)&&(ge.start=he,_e(xe+511>>9)));for(_e(L[6]+7>>3);H.l&511;)H.write_shift(-4,de.ENDOFCHAIN);for(he=Y=0,ce=0;ce<F.FileIndex.length;++ce)ge=F.FileIndex[ce],ge.content&&(xe=ge.content.length,!(!xe||xe>=4096)&&(ge.start=he,_e(xe+63>>6)));for(;H.l&511;)H.write_shift(-4,de.ENDOFCHAIN);for(Y=0;Y<L[4]<<2;++Y){var ye=F.FullPaths[Y];if(!ye||ye.length===0){for(ce=0;ce<17;++ce)H.write_shift(4,0);for(ce=0;ce<3;++ce)H.write_shift(4,-1);for(ce=0;ce<12;++ce)H.write_shift(4,0);continue}ge=F.FileIndex[Y],Y===0&&(ge.start=ge.size?ge.start-1:ie);var be=Y===0&&M.root||ge.name;if(xe=2*(be.length+1),H.write_shift(64,be,"utf16le"),H.write_shift(2,xe),H.write_shift(1,ge.type),H.write_shift(1,ge.color),H.write_shift(-4,ge.L),H.write_shift(-4,ge.R),H.write_shift(-4,ge.C),ge.clsid)H.write_shift(16,ge.clsid,"hex");else for(ce=0;ce<4;++ce)H.write_shift(4,0);H.write_shift(4,ge.state||0),H.write_shift(4,0),H.write_shift(4,0),H.write_shift(4,0),H.write_shift(4,0),H.write_shift(4,ge.start),H.write_shift(4,ge.size),H.write_shift(4,0)}for(Y=1;Y<F.FileIndex.length;++Y)if(ge=F.FileIndex[Y],ge.size>=4096)if(H.l=ge.start+1<<9,gt&&Buffer.isBuffer(ge.content))ge.content.copy(H,H.l,0,ge.size),H.l+=ge.size+511&-512;else{for(ce=0;ce<ge.size;++ce)H.write_shift(1,ge.content[ce]);for(;ce&511;++ce)H.write_shift(1,0)}for(Y=1;Y<F.FileIndex.length;++Y)if(ge=F.FileIndex[Y],ge.size>0&&ge.size<4096)if(gt&&Buffer.isBuffer(ge.content))ge.content.copy(H,H.l,0,ge.size),H.l+=ge.size+63&-64;else{for(ce=0;ce<ge.size;++ce)H.write_shift(1,ge.content[ce]);for(;ce&63;++ce)H.write_shift(1,0)}if(gt)H.l=H.length;else for(;H.l<H.length;)H.write_shift(1,0);return H}function Q(F,B){var M=F.FullPaths.map(function(ce){return ce.toUpperCase()}),L=M.map(function(ce){var xe=ce.split("/");return xe[xe.length-(ce.slice(-1)=="/"?2:1)]}),H=!1;B.charCodeAt(0)===47?(H=!0,B=M[0].slice(0,-1)+B):H=B.indexOf("/")!==-1;var Y=B.toUpperCase(),he=H===!0?M.indexOf(Y):L.indexOf(Y);if(he!==-1)return F.FileIndex[he];var _e=!Y.match(Ai);for(Y=Y.replace(Pr,""),_e&&(Y=Y.replace(Ai,"!")),he=0;he<M.length;++he)if((_e?M[he].replace(Ai,"!"):M[he]).replace(Pr,"")==Y||(_e?L[he].replace(Ai,"!"):L[he]).replace(Pr,"")==Y)return F.FileIndex[he];return null}var X=64,ie=-2,Ee="d0cf11e0a1b11ae1",q=[208,207,17,224,161,177,26,225],ue="00000000000000000000000000000000",de={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:ie,FREESECT:-1,HEADER_SIGNATURE:Ee,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:ue,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function We(F,B,M){m();var L=ae(F,M);g.writeFileSync(B,L)}function se(F){for(var B=new Array(F.length),M=0;M<F.length;++M)B[M]=String.fromCharCode(F[M]);return B.join("")}function Le(F,B){var M=ae(F,B);switch(B&&B.type||"buffer"){case"file":return m(),g.writeFileSync(B.filename,M),M;case"binary":return typeof M=="string"?M:se(M);case"base64":return Di(typeof M=="string"?M:se(M));case"buffer":if(gt)return Buffer.isBuffer(M)?M:Gn(M);case"array":return typeof M=="string"?Qr(M):M}return M}var Ge;function z(F){try{var B=F.InflateRaw,M=new B;if(M._processChunk(new Uint8Array([3,0]),M._finishFlushFlag),M.bytesRead)Ge=F;else throw new Error("zlib does not expose bytesRead")}catch(L){console.error("cannot use native zlib: "+(L.message||L))}}function ne(F,B){if(!Ge)return Kn(F,B);var M=Ge.InflateRaw,L=new M,H=L._processChunk(F.slice(F.l),L._finishFlushFlag);return F.l+=L.bytesRead,H}function Z(F){return Ge?Ge.deflateRawSync(F):ot(F)}var ee=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],oe=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],Ie=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function Ae(F){var B=(F<<1|F<<11)&139536|(F<<5|F<<15)&558144;return(B>>16|B>>8|B)&255}for(var Te=typeof Uint8Array<"u",Se=Te?new Uint8Array(256):[],Ye=0;Ye<256;++Ye)Se[Ye]=Ae(Ye);function K(F,B){var M=Se[F&255];return B<=8?M>>>8-B:(M=M<<8|Se[F>>8&255],B<=16?M>>>16-B:(M=M<<8|Se[F>>16&255],M>>>24-B))}function Xe(F,B){var M=B&7,L=B>>>3;return(F[L]|(M<=6?0:F[L+1]<<8))>>>M&3}function st(F,B){var M=B&7,L=B>>>3;return(F[L]|(M<=5?0:F[L+1]<<8))>>>M&7}function mt(F,B){var M=B&7,L=B>>>3;return(F[L]|(M<=4?0:F[L+1]<<8))>>>M&15}function nt(F,B){var M=B&7,L=B>>>3;return(F[L]|(M<=3?0:F[L+1]<<8))>>>M&31}function Ne(F,B){var M=B&7,L=B>>>3;return(F[L]|(M<=1?0:F[L+1]<<8))>>>M&127}function $e(F,B,M){var L=B&7,H=B>>>3,Y=(1<<M)-1,he=F[H]>>>L;return M<8-L||(he|=F[H+1]<<8-L,M<16-L)||(he|=F[H+2]<<16-L,M<24-L)||(he|=F[H+3]<<24-L),he&Y}function rt(F,B,M){var L=B&7,H=B>>>3;return L<=5?F[H]|=(M&7)<<L:(F[H]|=M<<L&255,F[H+1]=(M&7)>>8-L),B+3}function Dr(F,B,M){var L=B&7,H=B>>>3;return M=(M&1)<<L,F[H]|=M,B+1}function Ve(F,B,M){var L=B&7,H=B>>>3;return M<<=L,F[H]|=M&255,M>>>=8,F[H+1]=M,B+8}function Tn(F,B,M){var L=B&7,H=B>>>3;return M<<=L,F[H]|=M&255,M>>>=8,F[H+1]=M&255,F[H+2]=M>>>8,B+16}function mn(F,B){var M=F.length,L=2*M>B?2*M:B+5,H=0;if(M>=B)return F;if(gt){var Y=Ec(L);if(F.copy)F.copy(Y);else for(;H<F.length;++H)Y[H]=F[H];return Y}else if(Te){var he=new Uint8Array(L);if(he.set)he.set(F);else for(;H<M;++H)he[H]=F[H];return he}return F.length=L,F}function Xt(F){for(var B=new Array(F),M=0;M<F;++M)B[M]=0;return B}function zr(F,B,M){var L=1,H=0,Y=0,he=0,_e=0,ce=F.length,xe=Te?new Uint16Array(32):Xt(32);for(Y=0;Y<32;++Y)xe[Y]=0;for(Y=ce;Y<M;++Y)F[Y]=0;ce=F.length;var ge=Te?new Uint16Array(ce):Xt(ce);for(Y=0;Y<ce;++Y)xe[H=F[Y]]++,L<H&&(L=H),ge[Y]=0;for(xe[0]=0,Y=1;Y<=L;++Y)xe[Y+16]=_e=_e+xe[Y-1]<<1;for(Y=0;Y<ce;++Y)_e=F[Y],_e!=0&&(ge[Y]=xe[_e+16]++);var ye=0;for(Y=0;Y<ce;++Y)if(ye=F[Y],ye!=0)for(_e=K(ge[Y],L)>>L-ye,he=(1<<L+4-ye)-1;he>=0;--he)B[_e|he<<ye]=ye&15|Y<<4;return L}var ar=Te?new Uint16Array(512):Xt(512),Yn=Te?new Uint16Array(32):Xt(32);if(!Te){for(var Ht=0;Ht<512;++Ht)ar[Ht]=0;for(Ht=0;Ht<32;++Ht)Yn[Ht]=0}(function(){for(var F=[],B=0;B<32;B++)F.push(5);zr(F,Yn,32);var M=[];for(B=0;B<=143;B++)M.push(8);for(;B<=255;B++)M.push(9);for(;B<=279;B++)M.push(7);for(;B<=287;B++)M.push(8);zr(M,ar,288)})();var Ot=(function(){for(var B=Te?new Uint8Array(32768):[],M=0,L=0;M<Ie.length-1;++M)for(;L<Ie[M+1];++L)B[L]=M;for(;L<32768;++L)B[L]=29;var H=Te?new Uint8Array(259):[];for(M=0,L=0;M<oe.length-1;++M)for(;L<oe[M+1];++L)H[L]=M;function Y(_e,ce){for(var xe=0;xe<_e.length;){var ge=Math.min(65535,_e.length-xe),ye=xe+ge==_e.length;for(ce.write_shift(1,+ye),ce.write_shift(2,ge),ce.write_shift(2,~ge&65535);ge-- >0;)ce[ce.l++]=_e[xe++]}return ce.l}function he(_e,ce){for(var xe=0,ge=0,ye=Te?new Uint16Array(32768):[];ge<_e.length;){var be=Math.min(65535,_e.length-ge);if(be<10){for(xe=rt(ce,xe,+(ge+be==_e.length)),xe&7&&(xe+=8-(xe&7)),ce.l=xe/8|0,ce.write_shift(2,be),ce.write_shift(2,~be&65535);be-- >0;)ce[ce.l++]=_e[ge++];xe=ce.l*8;continue}xe=rt(ce,xe,+(ge+be==_e.length)+2);for(var Fe=0;be-- >0;){var Oe=_e[ge];Fe=(Fe<<5^Oe)&32767;var Ue=-1,tt=0;if((Ue=ye[Fe])&&(Ue|=ge&-32768,Ue>ge&&(Ue-=32768),Ue<ge))for(;_e[Ue+tt]==_e[ge+tt]&&tt<250;)++tt;if(tt>2){Oe=H[tt],Oe<=22?xe=Ve(ce,xe,Se[Oe+1]>>1)-1:(Ve(ce,xe,3),xe+=5,Ve(ce,xe,Se[Oe-23]>>5),xe+=3);var we=Oe<8?0:Oe-4>>2;we>0&&(Tn(ce,xe,tt-oe[Oe]),xe+=we),Oe=B[ge-Ue],xe=Ve(ce,xe,Se[Oe]>>3),xe-=3;var Mt=Oe<4?0:Oe-2>>1;Mt>0&&(Tn(ce,xe,ge-Ue-Ie[Oe]),xe+=Mt);for(var ut=0;ut<tt;++ut)ye[Fe]=ge&32767,Fe=(Fe<<5^_e[ge])&32767,++ge;be-=tt-1}else Oe<=143?Oe=Oe+48:xe=Dr(ce,xe,1),xe=Ve(ce,xe,Se[Oe]),ye[Fe]=ge&32767,++ge}xe=Ve(ce,xe,0)-1}return ce.l=(xe+7)/8|0,ce.l}return function(ce,xe){return ce.length<8?Y(ce,xe):he(ce,xe)}})();function ot(F){var B=ve(50+Math.floor(F.length*1.1)),M=Ot(F,B);return B.slice(0,M)}var Dt=Te?new Uint16Array(32768):Xt(32768),Lr=Te?new Uint16Array(32768):Xt(32768),ft=Te?new Uint16Array(128):Xt(128),Be=1,jt=1;function St(F,B){var M=nt(F,B)+257;B+=5;var L=nt(F,B)+1;B+=5;var H=mt(F,B)+4;B+=4;for(var Y=0,he=Te?new Uint8Array(19):Xt(19),_e=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],ce=1,xe=Te?new Uint8Array(8):Xt(8),ge=Te?new Uint8Array(8):Xt(8),ye=he.length,be=0;be<H;++be)he[ee[be]]=Y=st(F,B),ce<Y&&(ce=Y),xe[Y]++,B+=3;var Fe=0;for(xe[0]=0,be=1;be<=ce;++be)ge[be]=Fe=Fe+xe[be-1]<<1;for(be=0;be<ye;++be)(Fe=he[be])!=0&&(_e[be]=ge[Fe]++);var Oe=0;for(be=0;be<ye;++be)if(Oe=he[be],Oe!=0){Fe=Se[_e[be]]>>8-Oe;for(var Ue=(1<<7-Oe)-1;Ue>=0;--Ue)ft[Fe|Ue<<Oe]=Oe&7|be<<3}var tt=[];for(ce=1;tt.length<M+L;)switch(Fe=ft[Ne(F,B)],B+=Fe&7,Fe>>>=3){case 16:for(Y=3+Xe(F,B),B+=2,Fe=tt[tt.length-1];Y-- >0;)tt.push(Fe);break;case 17:for(Y=3+st(F,B),B+=3;Y-- >0;)tt.push(0);break;case 18:for(Y=11+Ne(F,B),B+=7;Y-- >0;)tt.push(0);break;default:tt.push(Fe),ce<Fe&&(ce=Fe);break}var we=tt.slice(0,M),Mt=tt.slice(M);for(be=M;be<286;++be)we[be]=0;for(be=L;be<30;++be)Mt[be]=0;return Be=zr(we,Dt,286),jt=zr(Mt,Lr,30),B}function Gt(F,B){if(F[0]==3&&!(F[1]&3))return[ia(B),2];for(var M=0,L=0,H=Ec(B||1<<18),Y=0,he=H.length>>>0,_e=0,ce=0;(L&1)==0;){if(L=st(F,M),M+=3,L>>>1)L>>1==1?(_e=9,ce=5):(M=St(F,M),_e=Be,ce=jt);else{M&7&&(M+=8-(M&7));var xe=F[M>>>3]|F[(M>>>3)+1]<<8;if(M+=32,xe>0)for(!B&&he<Y+xe&&(H=mn(H,Y+xe),he=H.length);xe-- >0;)H[Y++]=F[M>>>3],M+=8;continue}for(;;){!B&&he<Y+32767&&(H=mn(H,Y+32767),he=H.length);var ge=$e(F,M,_e),ye=L>>>1==1?ar[ge]:Dt[ge];if(M+=ye&15,ye>>>=4,(ye>>>8&255)===0)H[Y++]=ye;else{if(ye==256)break;ye-=257;var be=ye<8?0:ye-4>>2;be>5&&(be=0);var Fe=Y+oe[ye];be>0&&(Fe+=$e(F,M,be),M+=be),ge=$e(F,M,ce),ye=L>>>1==1?Yn[ge]:Lr[ge],M+=ye&15,ye>>>=4;var Oe=ye<4?0:ye-2>>1,Ue=Ie[ye];for(Oe>0&&(Ue+=$e(F,M,Oe),M+=Oe),!B&&he<Fe&&(H=mn(H,Fe+100),he=H.length);Y<Fe;)H[Y]=H[Y-Ue],++Y}}}return B?[H,M+7>>>3]:[H.slice(0,Y),M+7>>>3]}function Kn(F,B){var M=F.slice(F.l||0),L=Gt(M,B);return F.l+=L[1],L[0]}function Pa(F,B){if(F)typeof console<"u"&&console.error(B);else throw new Error(B)}function ci(F,B){var M=F;Ar(M,0);var L=[],H=[],Y={FileIndex:L,FullPaths:H};N(Y,{root:B.root});for(var he=M.length-4;(M[he]!=80||M[he+1]!=75||M[he+2]!=5||M[he+3]!=6)&&he>=0;)--he;M.l=he+4,M.l+=4;var _e=M.read_shift(2);M.l+=6;var ce=M.read_shift(4);for(M.l=ce,he=0;he<_e;++he){M.l+=20;var xe=M.read_shift(4),ge=M.read_shift(4),ye=M.read_shift(2),be=M.read_shift(2),Fe=M.read_shift(2);M.l+=8;var Oe=M.read_shift(4),Ue=d(M.slice(M.l+ye,M.l+ye+be));M.l+=ye+be+Fe;var tt=M.l;M.l=Oe+4,vt(M,xe,ge,Y,Ue),M.l=tt}return Y}function vt(F,B,M,L,H){F.l+=2;var Y=F.read_shift(2),he=F.read_shift(2),_e=u(F);if(Y&8257)throw new Error("Unsupported ZIP encryption");for(var ce=F.read_shift(4),xe=F.read_shift(4),ge=F.read_shift(4),ye=F.read_shift(2),be=F.read_shift(2),Fe="",Oe=0;Oe<ye;++Oe)Fe+=String.fromCharCode(F[F.l++]);if(be){var Ue=d(F.slice(F.l,F.l+be));(Ue[21589]||{}).mt&&(_e=Ue[21589].mt),((H||{})[21589]||{}).mt&&(_e=H[21589].mt)}F.l+=be;var tt=F.slice(F.l,F.l+xe);switch(he){case 8:tt=ne(F,ge);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+he)}var we=!1;Y&8&&(ce=F.read_shift(4),ce==134695760&&(ce=F.read_shift(4),we=!0),xe=F.read_shift(4),ge=F.read_shift(4)),xe!=B&&Pa(we,"Bad compressed size: "+B+" != "+xe),ge!=M&&Pa(we,"Bad uncompressed size: "+M+" != "+ge),pn(L,Fe,tt,{unsafe:!0,mt:_e})}function Bn(F,B){var M=B||{},L=[],H=[],Y=ve(1),he=M.compression?8:0,_e=0,ce=0,xe=0,ge=0,ye=0,be=F.FullPaths[0],Fe=be,Oe=F.FileIndex[0],Ue=[],tt=0;for(ce=1;ce<F.FullPaths.length;++ce)if(Fe=F.FullPaths[ce].slice(be.length),Oe=F.FileIndex[ce],!(!Oe.size||!Oe.content||Fe=="Sh33tJ5")){var we=ge,Mt=ve(Fe.length);for(xe=0;xe<Fe.length;++xe)Mt.write_shift(1,Fe.charCodeAt(xe)&127);Mt=Mt.slice(0,Mt.l),Ue[ye]=zh.buf(Oe.content,0);var ut=Oe.content;he==8&&(ut=Z(ut)),Y=ve(30),Y.write_shift(4,67324752),Y.write_shift(2,20),Y.write_shift(2,_e),Y.write_shift(2,he),Oe.mt?c(Y,Oe.mt):Y.write_shift(4,0),Y.write_shift(-4,Ue[ye]),Y.write_shift(4,ut.length),Y.write_shift(4,Oe.content.length),Y.write_shift(2,Mt.length),Y.write_shift(2,0),ge+=Y.length,L.push(Y),ge+=Mt.length,L.push(Mt),ge+=ut.length,L.push(ut),Y=ve(46),Y.write_shift(4,33639248),Y.write_shift(2,0),Y.write_shift(2,20),Y.write_shift(2,_e),Y.write_shift(2,he),Y.write_shift(4,0),Y.write_shift(-4,Ue[ye]),Y.write_shift(4,ut.length),Y.write_shift(4,Oe.content.length),Y.write_shift(2,Mt.length),Y.write_shift(2,0),Y.write_shift(2,0),Y.write_shift(2,0),Y.write_shift(2,0),Y.write_shift(4,0),Y.write_shift(4,we),tt+=Y.l,H.push(Y),tt+=Mt.length,H.push(Mt),++ye}return Y=ve(22),Y.write_shift(4,101010256),Y.write_shift(2,0),Y.write_shift(2,0),Y.write_shift(2,ye),Y.write_shift(2,ye),Y.write_shift(4,tt),Y.write_shift(4,ge),Y.write_shift(2,0),mr([mr(L),mr(H),Y])}var ha={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function ts(F,B){if(F.ctype)return F.ctype;var M=F.name||"",L=M.match(/\.([^\.]+)$/);return L&&ha[L[1]]||B&&(L=(M=B).match(/[\.\\]([^\.\\])+$/),L&&ha[L[1]])?ha[L[1]]:"application/octet-stream"}function Yr(F){for(var B=Di(F),M=[],L=0;L<B.length;L+=76)M.push(B.slice(L,L+76));return M.join(`\r
`)+`\r
`}function fi(F){var B=F.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(xe){var ge=xe.charCodeAt(0).toString(16).toUpperCase();return"="+(ge.length==1?"0"+ge:ge)});B=B.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),B.charAt(0)==`
`&&(B="=0D"+B.slice(1)),B=B.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var M=[],L=B.split(`\r
`),H=0;H<L.length;++H){var Y=L[H];if(Y.length==0){M.push("");continue}for(var he=0;he<Y.length;){var _e=76,ce=Y.slice(he,he+_e);ce.charAt(_e-1)=="="?_e--:ce.charAt(_e-2)=="="?_e-=2:ce.charAt(_e-3)=="="&&(_e-=3),ce=Y.slice(he,he+_e),he+=_e,he<Y.length&&(ce+="="),M.push(ce)}}return M.join(`\r
`)}function hr(F){for(var B=[],M=0;M<F.length;++M){for(var L=F[M];M<=F.length&&L.charAt(L.length-1)=="=";)L=L.slice(0,L.length-1)+F[++M];B.push(L)}for(var H=0;H<B.length;++H)B[H]=B[H].replace(/[=][0-9A-Fa-f]{2}/g,function(Y){return String.fromCharCode(parseInt(Y.slice(1),16))});return Qr(B.join(`\r
`))}function jn(F,B,M){for(var L="",H="",Y="",he,_e=0;_e<10;++_e){var ce=B[_e];if(!ce||ce.match(/^\s*$/))break;var xe=ce.match(/^(.*?):\s*([^\s].*)$/);if(xe)switch(xe[1].toLowerCase()){case"content-location":L=xe[2].trim();break;case"content-type":Y=xe[2].trim();break;case"content-transfer-encoding":H=xe[2].trim();break}}switch(++_e,H.toLowerCase()){case"base64":he=Qr(en(B.slice(_e).join("")));break;case"quoted-printable":he=hr(B.slice(_e));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+H)}var ge=pn(F,L.slice(M.length),he,{unsafe:!0});Y&&(ge.ctype=Y)}function La(F,B){if(se(F.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var M=B&&B.root||"",L=(gt&&Buffer.isBuffer(F)?F.toString("binary"):se(F)).split(`\r
`),H=0,Y="";for(H=0;H<L.length;++H)if(Y=L[H],!!/^Content-Location:/i.test(Y)&&(Y=Y.slice(Y.indexOf("file")),M||(M=Y.slice(0,Y.lastIndexOf("/")+1)),Y.slice(0,M.length)!=M))for(;M.length>0&&(M=M.slice(0,M.length-1),M=M.slice(0,M.lastIndexOf("/")+1),Y.slice(0,M.length)!=M););var he=(L[1]||"").match(/boundary="(.*?)"/);if(!he)throw new Error("MAD cannot find boundary");var _e="--"+(he[1]||""),ce=[],xe=[],ge={FileIndex:ce,FullPaths:xe};N(ge);var ye,be=0;for(H=0;H<L.length;++H){var Fe=L[H];Fe!==_e&&Fe!==_e+"--"||(be++&&jn(ge,L.slice(ye,H),M),ye=H)}return ge}function tn(F,B){var M=B||{},L=M.boundary||"SheetJS";L="------="+L;for(var H=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+L.slice(2)+'"',"","",""],Y=F.FullPaths[0],he=Y,_e=F.FileIndex[0],ce=1;ce<F.FullPaths.length;++ce)if(he=F.FullPaths[ce].slice(Y.length),_e=F.FileIndex[ce],!(!_e.size||!_e.content||he=="Sh33tJ5")){he=he.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(tt){return"_x"+tt.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(tt){return"_u"+tt.charCodeAt(0).toString(16)+"_"});for(var xe=_e.content,ge=gt&&Buffer.isBuffer(xe)?xe.toString("binary"):se(xe),ye=0,be=Math.min(1024,ge.length),Fe=0,Oe=0;Oe<=be;++Oe)(Fe=ge.charCodeAt(Oe))>=32&&Fe<128&&++ye;var Ue=ye>=be*4/5;H.push(L),H.push("Content-Location: "+(M.root||"file:///C:/SheetJS/")+he),H.push("Content-Transfer-Encoding: "+(Ue?"quoted-printable":"base64")),H.push("Content-Type: "+ts(_e,he)),H.push(""),H.push(Ue?fi(ge):Yr(ge))}return H.push(L+`--\r
`),H.join(`\r
`)}function Ys(F){var B={};return N(B,F),B}function pn(F,B,M,L){var H=L&&L.unsafe;H||N(F);var Y=!H&&Ke.find(F,B);if(!Y){var he=F.FullPaths[0];B.slice(0,he.length)==he?he=B:(he.slice(-1)!="/"&&(he+="/"),he=(he+B).replace("//","/")),Y={name:i(B),type:2},F.FileIndex.push(Y),F.FullPaths.push(he),H||Ke.utils.cfb_gc(F)}return Y.content=M,Y.size=M?M.length:0,L&&(L.CLSID&&(Y.clsid=L.CLSID),L.mt&&(Y.mt=L.mt),L.ct&&(Y.ct=L.ct)),Y}function li(F,B){N(F);var M=Ke.find(F,B);if(M){for(var L=0;L<F.FileIndex.length;++L)if(F.FileIndex[L]==M)return F.FileIndex.splice(L,1),F.FullPaths.splice(L,1),!0}return!1}function Tr(F,B,M){N(F);var L=Ke.find(F,B);if(L){for(var H=0;H<F.FileIndex.length;++H)if(F.FileIndex[H]==L)return F.FileIndex[H].name=i(M),F.FullPaths[H]=M,!0}return!1}function Mn(F){O(F,!0)}return r.find=Q,r.read=W,r.parse=w,r.write=Le,r.writeFile=We,r.utils={cfb_new:Ys,cfb_add:pn,cfb_del:li,cfb_mov:Tr,cfb_gc:Mn,ReadShift:Si,CheckField:q1,prep_blob:Ar,bconcat:mr,use_zlib:z,_deflateRaw:ot,_inflateRaw:Kn,consts:de},r})();function Yh(e){return typeof e=="string"?Ps(e):Array.isArray(e)?wh(e):e}function Ki(e,r,t){if(typeof Deno<"u"){if(t&&typeof r=="string")switch(t){case"utf8":r=new TextEncoder(t).encode(r);break;case"binary":r=Ps(r);break;default:throw new Error("Unsupported encoding "+t)}return Deno.writeFileSync(e,r)}var a=t=="utf8"?Rn(r):r;if(typeof IE_SaveFile<"u")return IE_SaveFile(a,e);if(typeof Blob<"u"){var i=new Blob([Yh(a)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(i,e);if(typeof saveAs<"u")return saveAs(i,e);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var c=URL.createObjectURL(i);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(c)},6e4),chrome.downloads.download({url:c,filename:e,saveAs:!0});var u=document.createElement("a");if(u.download!=null)return u.download=e,u.href=c,document.body.appendChild(u),u.click(),document.body.removeChild(u),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(c)},6e4),c}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var d=File(e);return d.open("w"),d.encoding="binary",Array.isArray(r)&&(r=fa(r)),d.write(r),d.close(),r}catch(g){if(!g.message||!g.message.match(/onstruct/))throw g}throw new Error("cannot save file "+e)}function Kh(e){if(typeof Deno<"u")return Deno.readFileSync(e);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var r=File(e);r.open("r"),r.encoding="binary";var t=r.read();return r.close(),t}catch(a){if(!a.message||!a.message.match(/onstruct/))throw a}throw new Error("Cannot access file "+e)}function $t(e){for(var r=Object.keys(e),t=[],a=0;a<r.length;++a)Object.prototype.hasOwnProperty.call(e,r[a])&&t.push(r[a]);return t}function Ic(e,r){for(var t=[],a=$t(e),i=0;i!==a.length;++i)t[e[a[i]][r]]==null&&(t[e[a[i]][r]]=a[i]);return t}function Us(e){for(var r=[],t=$t(e),a=0;a!==t.length;++a)r[e[t[a]]]=t[a];return r}function Ws(e){for(var r=[],t=$t(e),a=0;a!==t.length;++a)r[e[t[a]]]=parseInt(t[a],10);return r}function jh(e){for(var r=[],t=$t(e),a=0;a!==t.length;++a)r[e[t[a]]]==null&&(r[e[t[a]]]=[]),r[e[t[a]]].push(t[a]);return r}var Ss=new Date(1899,11,30,0,0,0);function ur(e,r){var t=e.getTime(),a=Ss.getTime()+(e.getTimezoneOffset()-Ss.getTimezoneOffset())*6e4;return(t-a)/(1440*60*1e3)}var b1=new Date,Zh=Ss.getTime()+(b1.getTimezoneOffset()-Ss.getTimezoneOffset())*6e4,kc=b1.getTimezoneOffset();function Vs(e){var r=new Date;return r.setTime(e*24*60*60*1e3+Zh),r.getTimezoneOffset()!==kc&&r.setTime(r.getTime()+(r.getTimezoneOffset()-kc)*6e4),r}function qh(e){var r=0,t=0,a=!1,i=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!i)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var c=1;c!=i.length;++c)if(i[c]){switch(t=1,c>3&&(a=!0),i[c].slice(i[c].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+i[c].slice(i[c].length-1));case"D":t*=24;case"H":t*=60;case"M":if(a)t*=60;else throw new Error("Unsupported ISO Duration Field: M")}r+=t*parseInt(i[c],10)}return r}var bc=new Date("2017-02-19T19:06:09.000Z"),N1=isNaN(bc.getFullYear())?new Date("2/19/17"):bc,Jh=N1.getFullYear()==2017;function Wt(e,r){var t=new Date(e);if(Jh)return r>0?t.setTime(t.getTime()+t.getTimezoneOffset()*60*1e3):r<0&&t.setTime(t.getTime()-t.getTimezoneOffset()*60*1e3),t;if(e instanceof Date)return e;if(N1.getFullYear()==1917&&!isNaN(t.getFullYear())){var a=t.getFullYear();return e.indexOf(""+a)>-1||t.setFullYear(t.getFullYear()+100),t}var i=e.match(/\d+/g)||["2017","2","19","0","0","0"],c=new Date(+i[0],+i[1]-1,+i[2],+i[3]||0,+i[4]||0,+i[5]||0);return e.indexOf("Z")>-1&&(c=new Date(c.getTime()-c.getTimezoneOffset()*60*1e3)),c}function Ta(e,r){if(gt&&Buffer.isBuffer(e)){if(r){if(e[0]==255&&e[1]==254)return Rn(e.slice(2).toString("utf16le"));if(e[1]==254&&e[2]==255)return Rn(p1(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder<"u")try{if(r){if(e[0]==255&&e[1]==254)return Rn(new TextDecoder("utf-16le").decode(e.slice(2)));if(e[0]==254&&e[1]==255)return Rn(new TextDecoder("utf-16be").decode(e.slice(2)))}var t={"€":"","‚":"",ƒ:"","„":"","…":"","†":"","‡":"","ˆ":"","‰":"",Š:"","‹":"",Œ:"",Ž:"","‘":"","’":"","“":"","”":"","•":"","–":"","—":"","˜":"","™":"",š:"","›":"",œ:"",ž:"",Ÿ:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[€‚ƒ„…†‡ˆ‰Š‹ŒŽ‘’“”•–—˜™š›œžŸ]/g,function(c){return t[c]||c})}catch{}for(var a=[],i=0;i!=e.length;++i)a.push(String.fromCharCode(e[i]));return a.join("")}function Vt(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var r={};for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&(r[t]=Vt(e[t]));return r}function Jt(e,r){for(var t="";t.length<r;)t+=e;return t}function An(e){var r=Number(e);if(!isNaN(r))return isFinite(r)?r:NaN;if(!/\d/.test(e))return r;var t=1,a=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return t*=100,""});return!isNaN(r=Number(a))||(a=a.replace(/[(](.*)[)]/,function(i,c){return t=-t,c}),!isNaN(r=Number(a)))?r/t:r}var Qh=["january","february","march","april","may","june","july","august","september","october","november","december"];function ti(e){var r=new Date(e),t=new Date(NaN),a=r.getYear(),i=r.getMonth(),c=r.getDate();if(isNaN(c))return t;var u=e.toLowerCase();if(u.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(u=u.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),u.length>3&&Qh.indexOf(u)==-1)return t}else if(u.match(/[a-z]/))return t;return a<0||a>8099?t:(i>0||c>1)&&a!=101?r:e.match(/[^-0-9:,\/\\]/)?t:r}var $h=(function(){var e="abacaba".split(/(:?b)/i).length==5;return function(t,a,i){if(e||typeof a=="string")return t.split(a);for(var c=t.split(a),u=[c[0]],d=1;d<c.length;++d)u.push(i),u.push(c[d]);return u}})();function F1(e){return e?e.content&&e.type?Ta(e.content,!0):e.data?_i(e.data):e.asNodeBuffer&&gt?_i(e.asNodeBuffer().toString("binary")):e.asBinary?_i(e.asBinary()):e._data&&e._data.getContent?_i(Ta(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function R1(e){if(!e)return null;if(e.data)return pc(e.data);if(e.asNodeBuffer&&gt)return e.asNodeBuffer();if(e._data&&e._data.getContent){var r=e._data.getContent();return typeof r=="string"?pc(r):Array.prototype.slice.call(r)}return e.content&&e.type?e.content:null}function ed(e){return e&&e.name.slice(-4)===".bin"?R1(e):F1(e)}function un(e,r){for(var t=e.FullPaths||$t(e.files),a=r.toLowerCase().replace(/[\/]/g,"\\"),i=a.replace(/\\/g,"/"),c=0;c<t.length;++c){var u=t[c].replace(/^Root Entry[\/]/,"").toLowerCase();if(a==u||i==u)return e.files?e.files[t[c]]:e.FileIndex[c]}return null}function mo(e,r){var t=un(e,r);if(t==null)throw new Error("Cannot find file "+r+" in zip");return t}function sr(e,r,t){if(!t)return ed(mo(e,r));if(!r)return null;try{return sr(e,r)}catch{return null}}function $r(e,r,t){if(!t)return F1(mo(e,r));if(!r)return null;try{return $r(e,r)}catch{return null}}function td(e,r,t){return R1(mo(e,r))}function Nc(e){for(var r=e.FullPaths||$t(e.files),t=[],a=0;a<r.length;++a)r[a].slice(-1)!="/"&&t.push(r[a].replace(/^Root Entry[\/]/,""));return t.sort()}function ct(e,r,t){if(e.FullPaths){if(typeof t=="string"){var a;return gt?a=Gn(t):a=Eh(t),Ke.utils.cfb_add(e,r,a)}Ke.utils.cfb_add(e,r,t)}else e.file(r,t)}function po(){return Ke.utils.cfb_new()}function O1(e,r){switch(r.type){case"base64":return Ke.read(e,{type:"base64"});case"binary":return Ke.read(e,{type:"binary"});case"buffer":case"array":return Ke.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+r.type)}function Ci(e,r){if(e.charAt(0)=="/")return e.slice(1);var t=r.split("/");r.slice(-1)!="/"&&t.pop();for(var a=e.split("/");a.length!==0;){var i=a.shift();i===".."?t.pop():i!=="."&&t.push(i)}return t.join("/")}var nr=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,rd=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,Fc=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,nd=/<[^>]*>/g,Or=nr.match(Fc)?Fc:nd,ad=/<\w*:/,id=/<(\/?)\w+:/;function et(e,r,t){for(var a={},i=0,c=0;i!==e.length&&!((c=e.charCodeAt(i))===32||c===10||c===13);++i);if(r||(a[0]=e.slice(0,i)),i===e.length)return a;var u=e.match(rd),d=0,g="",m=0,w="",v="",_=1;if(u)for(m=0;m!=u.length;++m){for(v=u[m],c=0;c!=v.length&&v.charCodeAt(c)!==61;++c);for(w=v.slice(0,c).trim();v.charCodeAt(c+1)==32;)++c;for(_=(i=v.charCodeAt(c+1))==34||i==39?1:0,g=v.slice(c+1+_,v.length-_),d=0;d!=w.length&&w.charCodeAt(d)!==58;++d);if(d===w.length)w.indexOf("_")>0&&(w=w.slice(0,w.indexOf("_"))),a[w]=g,a[w.toLowerCase()]=g;else{var C=(d===5&&w.slice(0,5)==="xmlns"?"xmlns":"")+w.slice(d+1);if(a[C]&&w.slice(d-3,d)=="ext")continue;a[C]=g,a[C.toLowerCase()]=g}}return a}function On(e){return e.replace(id,"<$1")}var D1={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},wo=Us(D1),At=(function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,r=/_x([\da-fA-F]{4})_/ig;return function t(a){var i=a+"",c=i.indexOf("<![CDATA[");if(c==-1)return i.replace(e,function(d,g){return D1[d]||String.fromCharCode(parseInt(g,d.indexOf("x")>-1?16:10))||d}).replace(r,function(d,g){return String.fromCharCode(parseInt(g,16))});var u=i.indexOf("]]>");return t(i.slice(0,c))+i.slice(c+9,u)+t(i.slice(u+3))}})(),Eo=/[&<>'"]/g,sd=/[\u0000-\u0008\u000b-\u001f]/g;function kt(e){var r=e+"";return r.replace(Eo,function(t){return wo[t]}).replace(sd,function(t){return"_x"+("000"+t.charCodeAt(0).toString(16)).slice(-4)+"_"})}function Rc(e){return kt(e).replace(/ /g,"_x0020_")}var B1=/[\u0000-\u001f]/g;function vo(e){var r=e+"";return r.replace(Eo,function(t){return wo[t]}).replace(/\n/g,"<br/>").replace(B1,function(t){return"&#x"+("000"+t.charCodeAt(0).toString(16)).slice(-4)+";"})}function od(e){var r=e+"";return r.replace(Eo,function(t){return wo[t]}).replace(B1,function(t){return"&#x"+t.charCodeAt(0).toString(16).toUpperCase()+";"})}var Oc=(function(){var e=/&#(\d+);/g;function r(t,a){return String.fromCharCode(parseInt(a,10))}return function(a){return a.replace(e,r)}})();function cd(e){return e.replace(/(\r\n|[\r\n])/g,"&#10;")}function Ut(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function h0(e){for(var r="",t=0,a=0,i=0,c=0,u=0,d=0;t<e.length;){if(a=e.charCodeAt(t++),a<128){r+=String.fromCharCode(a);continue}if(i=e.charCodeAt(t++),a>191&&a<224){u=(a&31)<<6,u|=i&63,r+=String.fromCharCode(u);continue}if(c=e.charCodeAt(t++),a<240){r+=String.fromCharCode((a&15)<<12|(i&63)<<6|c&63);continue}u=e.charCodeAt(t++),d=((a&7)<<18|(i&63)<<12|(c&63)<<6|u&63)-65536,r+=String.fromCharCode(55296+(d>>>10&1023)),r+=String.fromCharCode(56320+(d&1023))}return r}function Dc(e){var r=ia(2*e.length),t,a,i=1,c=0,u=0,d;for(a=0;a<e.length;a+=i)i=1,(d=e.charCodeAt(a))<128?t=d:d<224?(t=(d&31)*64+(e.charCodeAt(a+1)&63),i=2):d<240?(t=(d&15)*4096+(e.charCodeAt(a+1)&63)*64+(e.charCodeAt(a+2)&63),i=3):(i=4,t=(d&7)*262144+(e.charCodeAt(a+1)&63)*4096+(e.charCodeAt(a+2)&63)*64+(e.charCodeAt(a+3)&63),t-=65536,u=55296+(t>>>10&1023),t=56320+(t&1023)),u!==0&&(r[c++]=u&255,r[c++]=u>>>8,u=0),r[c++]=t%256,r[c++]=t>>>8;return r.slice(0,c).toString("ucs2")}function Bc(e){return Gn(e,"binary").toString("utf8")}var ls="foo bar bazâð£",Nt=gt&&(Bc(ls)==h0(ls)&&Bc||Dc(ls)==h0(ls)&&Dc)||h0,Rn=gt?function(e){return Gn(e,"utf8").toString("binary")}:function(e){for(var r=[],t=0,a=0,i=0;t<e.length;)switch(a=e.charCodeAt(t++),!0){case a<128:r.push(String.fromCharCode(a));break;case a<2048:r.push(String.fromCharCode(192+(a>>6))),r.push(String.fromCharCode(128+(a&63)));break;case(a>=55296&&a<57344):a-=55296,i=e.charCodeAt(t++)-56320+(a<<10),r.push(String.fromCharCode(240+(i>>18&7))),r.push(String.fromCharCode(144+(i>>12&63))),r.push(String.fromCharCode(128+(i>>6&63))),r.push(String.fromCharCode(128+(i&63)));break;default:r.push(String.fromCharCode(224+(a>>12))),r.push(String.fromCharCode(128+(a>>6&63))),r.push(String.fromCharCode(128+(a&63)))}return r.join("")},Mi=(function(){var e={};return function(t,a){var i=t+"|"+(a||"");return e[i]?e[i]:e[i]=new RegExp("<(?:\\w+:)?"+t+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+t+">",a||"")}})(),M1=(function(){var e=[["nbsp"," "],["middot","·"],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(r){return[new RegExp("&"+r[0]+";","ig"),r[1]]});return function(t){for(var a=t.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),i=0;i<e.length;++i)a=a.replace(e[i][0],e[i][1]);return a}})(),fd=(function(){var e={};return function(t){return e[t]!==void 0?e[t]:e[t]=new RegExp("<(?:vt:)?"+t+">([\\s\\S]*?)</(?:vt:)?"+t+">","g")}})(),ld=/<\/?(?:vt:)?variant>/g,ud=/<(?:vt:)([^>]*)>([\s\S]*)</;function Mc(e,r){var t=et(e),a=e.match(fd(t.baseType))||[],i=[];if(a.length!=t.size){if(r.WTF)throw new Error("unexpected vector length "+a.length+" != "+t.size);return i}return a.forEach(function(c){var u=c.replace(ld,"").match(ud);u&&i.push({v:Nt(u[2]),t:u[1]})}),i}var P1=/(^\s|\s$|\n)/;function Cr(e,r){return"<"+e+(r.match(P1)?' xml:space="preserve"':"")+">"+r+"</"+e+">"}function Pi(e){return $t(e).map(function(r){return" "+r+'="'+e[r]+'"'}).join("")}function Me(e,r,t){return"<"+e+(t!=null?Pi(t):"")+(r!=null?(r.match(P1)?' xml:space="preserve"':"")+">"+r+"</"+e:"/")+">"}function q0(e,r){try{return e.toISOString().replace(/\.\d*/,"")}catch(t){if(r)throw t}return""}function hd(e,r){switch(typeof e){case"string":var t=Me("vt:lpwstr",kt(e));return t=t.replace(/&quot;/g,"_x0022_"),t;case"number":return Me((e|0)==e?"vt:i4":"vt:r8",kt(String(e)));case"boolean":return Me("vt:bool",e?"true":"false")}if(e instanceof Date)return Me("vt:filetime",q0(e));throw new Error("Unable to serialize "+e)}function _o(e){if(gt&&Buffer.isBuffer(e))return e.toString("utf8");if(typeof e=="string")return e;if(typeof Uint8Array<"u"&&e instanceof Uint8Array)return Nt(fa(ho(e)));throw new Error("Bad input format: expected Buffer or string")}var Li=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,lr={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},ba=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],qr={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function dd(e,r){for(var t=1-2*(e[r+7]>>>7),a=((e[r+7]&127)<<4)+(e[r+6]>>>4&15),i=e[r+6]&15,c=5;c>=0;--c)i=i*256+e[r+c];return a==2047?i==0?t*(1/0):NaN:(a==0?a=-1022:(a-=1023,i+=Math.pow(2,52)),t*Math.pow(2,a-52)*i)}function xd(e,r,t){var a=(r<0||1/r==-1/0?1:0)<<7,i=0,c=0,u=a?-r:r;isFinite(u)?u==0?i=c=0:(i=Math.floor(Math.log(u)/Math.LN2),c=u*Math.pow(2,52-i),i<=-1023&&(!isFinite(c)||c<Math.pow(2,52))?i=-1022:(c-=Math.pow(2,52),i+=1023)):(i=2047,c=isNaN(r)?26985:0);for(var d=0;d<=5;++d,c/=256)e[t+d]=c&255;e[t+6]=(i&15)<<4|c&15,e[t+7]=i>>4|a}var Pc=function(e){for(var r=[],t=10240,a=0;a<e[0].length;++a)if(e[0][a])for(var i=0,c=e[0][a].length;i<c;i+=t)r.push.apply(r,e[0][a].slice(i,i+t));return r},Lc=gt?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(r){return Buffer.isBuffer(r)?r:Gn(r)})):Pc(e)}:Pc,Uc=function(e,r,t){for(var a=[],i=r;i<t;i+=2)a.push(String.fromCharCode(Ln(e,i)));return a.join("").replace(Pr,"")},Ao=gt?function(e,r,t){return Buffer.isBuffer(e)?e.toString("utf16le",r,t).replace(Pr,""):Uc(e,r,t)}:Uc,Wc=function(e,r,t){for(var a=[],i=r;i<r+t;++i)a.push(("0"+e[i].toString(16)).slice(-2));return a.join("")},L1=gt?function(e,r,t){return Buffer.isBuffer(e)?e.toString("hex",r,r+t):Wc(e,r,t)}:Wc,Vc=function(e,r,t){for(var a=[],i=r;i<t;i++)a.push(String.fromCharCode(ja(e,i)));return a.join("")},ji=gt?function(r,t,a){return Buffer.isBuffer(r)?r.toString("utf8",t,a):Vc(r,t,a)}:Vc,U1=function(e,r){var t=Jr(e,r);return t>0?ji(e,r+4,r+4+t-1):""},W1=U1,V1=function(e,r){var t=Jr(e,r);return t>0?ji(e,r+4,r+4+t-1):""},H1=V1,G1=function(e,r){var t=2*Jr(e,r);return t>0?ji(e,r+4,r+4+t-1):""},X1=G1,z1=function(r,t){var a=Jr(r,t);return a>0?Ao(r,t+4,t+4+a):""},Y1=z1,K1=function(e,r){var t=Jr(e,r);return t>0?ji(e,r+4,r+4+t):""},j1=K1,Z1=function(e,r){return dd(e,r)},ys=Z1,Co=function(r){return Array.isArray(r)||typeof Uint8Array<"u"&&r instanceof Uint8Array};gt&&(W1=function(r,t){if(!Buffer.isBuffer(r))return U1(r,t);var a=r.readUInt32LE(t);return a>0?r.toString("utf8",t+4,t+4+a-1):""},H1=function(r,t){if(!Buffer.isBuffer(r))return V1(r,t);var a=r.readUInt32LE(t);return a>0?r.toString("utf8",t+4,t+4+a-1):""},X1=function(r,t){if(!Buffer.isBuffer(r))return G1(r,t);var a=2*r.readUInt32LE(t);return r.toString("utf16le",t+4,t+4+a-1)},Y1=function(r,t){if(!Buffer.isBuffer(r))return z1(r,t);var a=r.readUInt32LE(t);return r.toString("utf16le",t+4,t+4+a)},j1=function(r,t){if(!Buffer.isBuffer(r))return K1(r,t);var a=r.readUInt32LE(t);return r.toString("utf8",t+4,t+4+a)},ys=function(r,t){return Buffer.isBuffer(r)?r.readDoubleLE(t):Z1(r,t)},Co=function(r){return Buffer.isBuffer(r)||Array.isArray(r)||typeof Uint8Array<"u"&&r instanceof Uint8Array});var ja=function(e,r){return e[r]},Ln=function(e,r){return e[r+1]*256+e[r]},gd=function(e,r){var t=e[r+1]*256+e[r];return t<32768?t:(65535-t+1)*-1},Jr=function(e,r){return e[r+3]*(1<<24)+(e[r+2]<<16)+(e[r+1]<<8)+e[r]},pa=function(e,r){return e[r+3]<<24|e[r+2]<<16|e[r+1]<<8|e[r]},md=function(e,r){return e[r]<<24|e[r+1]<<16|e[r+2]<<8|e[r+3]};function Si(e,r){var t="",a,i,c=[],u,d,g,m;switch(r){case"dbcs":if(m=this.l,gt&&Buffer.isBuffer(this))t=this.slice(this.l,this.l+2*e).toString("utf16le");else for(g=0;g<e;++g)t+=String.fromCharCode(Ln(this,m)),m+=2;e*=2;break;case"utf8":t=ji(this,this.l,this.l+e);break;case"utf16le":e*=2,t=Ao(this,this.l,this.l+e);break;case"wstr":return Si.call(this,e,"dbcs");case"lpstr-ansi":t=W1(this,this.l),e=4+Jr(this,this.l);break;case"lpstr-cp":t=H1(this,this.l),e=4+Jr(this,this.l);break;case"lpwstr":t=X1(this,this.l),e=4+2*Jr(this,this.l);break;case"lpp4":e=4+Jr(this,this.l),t=Y1(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+Jr(this,this.l),t=j1(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,t="";(u=ja(this,this.l+e++))!==0;)c.push(fs(u));t=c.join("");break;case"_wstr":for(e=0,t="";(u=Ln(this,this.l+e))!==0;)c.push(fs(u)),e+=2;e+=2,t=c.join("");break;case"dbcs-cont":for(t="",m=this.l,g=0;g<e;++g){if(this.lens&&this.lens.indexOf(m)!==-1)return u=ja(this,m),this.l=m+1,d=Si.call(this,e-g,u?"dbcs-cont":"sbcs-cont"),c.join("")+d;c.push(fs(Ln(this,m))),m+=2}t=c.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(t="",m=this.l,g=0;g!=e;++g){if(this.lens&&this.lens.indexOf(m)!==-1)return u=ja(this,m),this.l=m+1,d=Si.call(this,e-g,u?"dbcs-cont":"sbcs-cont"),c.join("")+d;c.push(fs(ja(this,m))),m+=1}t=c.join("");break;default:switch(e){case 1:return a=ja(this,this.l),this.l++,a;case 2:return a=(r==="i"?gd:Ln)(this,this.l),this.l+=2,a;case 4:case-4:return r==="i"||(this[this.l+3]&128)===0?(a=(e>0?pa:md)(this,this.l),this.l+=4,a):(i=Jr(this,this.l),this.l+=4,i);case 8:case-8:if(r==="f")return e==8?i=ys(this,this.l):i=ys([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,i;e=8;case 16:t=L1(this,this.l,e);break}}return this.l+=e,t}var pd=function(e,r,t){e[t]=r&255,e[t+1]=r>>>8&255,e[t+2]=r>>>16&255,e[t+3]=r>>>24&255},wd=function(e,r,t){e[t]=r&255,e[t+1]=r>>8&255,e[t+2]=r>>16&255,e[t+3]=r>>24&255},Ed=function(e,r,t){e[t]=r&255,e[t+1]=r>>>8&255};function vd(e,r,t){var a=0,i=0;if(t==="dbcs"){for(i=0;i!=r.length;++i)Ed(this,r.charCodeAt(i),this.l+2*i);a=2*r.length}else if(t==="sbcs"){for(r=r.replace(/[^\x00-\x7F]/g,"_"),i=0;i!=r.length;++i)this[this.l+i]=r.charCodeAt(i)&255;a=r.length}else if(t==="hex"){for(;i<e;++i)this[this.l++]=parseInt(r.slice(2*i,2*i+2),16)||0;return this}else if(t==="utf16le"){var c=Math.min(this.l+e,this.length);for(i=0;i<Math.min(r.length,e);++i){var u=r.charCodeAt(i);this[this.l++]=u&255,this[this.l++]=u>>8}for(;this.l<c;)this[this.l++]=0;return this}else switch(e){case 1:a=1,this[this.l]=r&255;break;case 2:a=2,this[this.l]=r&255,r>>>=8,this[this.l+1]=r&255;break;case 3:a=3,this[this.l]=r&255,r>>>=8,this[this.l+1]=r&255,r>>>=8,this[this.l+2]=r&255;break;case 4:a=4,pd(this,r,this.l);break;case 8:if(a=8,t==="f"){xd(this,r,this.l);break}case 16:break;case-4:a=4,wd(this,r,this.l);break}return this.l+=a,this}function q1(e,r){var t=L1(this,this.l,e.length>>1);if(t!==e)throw new Error(r+"Expected "+e+" saw "+t);this.l+=e.length>>1}function Ar(e,r){e.l=r,e.read_shift=Si,e.chk=q1,e.write_shift=vd}function Rr(e,r){e.l+=r}function ve(e){var r=ia(e);return Ar(r,0),r}function Xn(e,r,t){if(e){var a,i,c;Ar(e,e.l||0);for(var u=e.length,d=0,g=0;e.l<u;){d=e.read_shift(1),d&128&&(d=(d&127)+((e.read_shift(1)&127)<<7));var m=Xi[d]||Xi[65535];for(a=e.read_shift(1),c=a&127,i=1;i<4&&a&128;++i)c+=((a=e.read_shift(1))&127)<<7*i;g=e.l+c;var w=m.f&&m.f(e,c,t);if(e.l=g,r(w,m,d))return}}}function Gr(){var e=[],r=gt?256:2048,t=function(m){var w=ve(m);return Ar(w,0),w},a=t(r),i=function(){a&&(a.length>a.l&&(a=a.slice(0,a.l),a.l=a.length),a.length>0&&e.push(a),a=null)},c=function(m){return a&&m<a.length-a.l?a:(i(),a=t(Math.max(m+1,r)))},u=function(){return i(),mr(e)},d=function(m){i(),a=m,a.l==null&&(a.l=a.length),c(r)};return{next:c,push:d,end:u,_bufs:e}}function Ce(e,r,t,a){var i=+r,c;if(!isNaN(i)){a||(a=Xi[i].p||(t||[]).length||0),c=1+(i>=128?1:0)+1,a>=128&&++c,a>=16384&&++c,a>=2097152&&++c;var u=e.next(c);i<=127?u.write_shift(1,i):(u.write_shift(1,(i&127)+128),u.write_shift(1,i>>7));for(var d=0;d!=4;++d)if(a>=128)u.write_shift(1,(a&127)+128),a>>=7;else{u.write_shift(1,a);break}a>0&&Co(t)&&e.push(t)}}function yi(e,r,t){var a=Vt(e);if(r.s?(a.cRel&&(a.c+=r.s.c),a.rRel&&(a.r+=r.s.r)):(a.cRel&&(a.c+=r.c),a.rRel&&(a.r+=r.r)),!t||t.biff<12){for(;a.c>=256;)a.c-=256;for(;a.r>=65536;)a.r-=65536}return a}function Hc(e,r,t){var a=Vt(e);return a.s=yi(a.s,r.s,t),a.e=yi(a.e,r.s,t),a}function Ii(e,r){if(e.cRel&&e.c<0)for(e=Vt(e);e.c<0;)e.c+=r>8?16384:256;if(e.rRel&&e.r<0)for(e=Vt(e);e.r<0;)e.r+=r>8?1048576:r>5?65536:16384;var t=Qe(e);return!e.cRel&&e.cRel!=null&&(t=Cd(t)),!e.rRel&&e.rRel!=null&&(t=_d(t)),t}function d0(e,r){return e.s.r==0&&!e.s.rRel&&e.e.r==(r.biff>=12?1048575:r.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+Yt(e.s.c)+":"+(e.e.cRel?"":"$")+Yt(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(r.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+rr(e.s.r)+":"+(e.e.rRel?"":"$")+rr(e.e.r):Ii(e.s,r.biff)+":"+Ii(e.e,r.biff)}function To(e){return parseInt(Ad(e),10)-1}function rr(e){return""+(e+1)}function _d(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function Ad(e){return e.replace(/\$(\d+)$/,"$1")}function So(e){for(var r=Td(e),t=0,a=0;a!==r.length;++a)t=26*t+r.charCodeAt(a)-64;return t-1}function Yt(e){if(e<0)throw new Error("invalid column "+e);var r="";for(++e;e;e=Math.floor((e-1)/26))r=String.fromCharCode((e-1)%26+65)+r;return r}function Cd(e){return e.replace(/^([A-Z])/,"$$$1")}function Td(e){return e.replace(/^\$([A-Z])/,"$1")}function Sd(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function Kt(e){for(var r=0,t=0,a=0;a<e.length;++a){var i=e.charCodeAt(a);i>=48&&i<=57?r=10*r+(i-48):i>=65&&i<=90&&(t=26*t+(i-64))}return{c:t-1,r:r-1}}function Qe(e){for(var r=e.c+1,t="";r;r=(r-1)/26|0)t=String.fromCharCode((r-1)%26+65)+t;return t+(e.r+1)}function Xr(e){var r=e.indexOf(":");return r==-1?{s:Kt(e),e:Kt(e)}:{s:Kt(e.slice(0,r)),e:Kt(e.slice(r+1))}}function it(e,r){return typeof r>"u"||typeof r=="number"?it(e.s,e.e):(typeof e!="string"&&(e=Qe(e)),typeof r!="string"&&(r=Qe(r)),e==r?e:e+":"+r)}function Ct(e){var r={s:{c:0,r:0},e:{c:0,r:0}},t=0,a=0,i=0,c=e.length;for(t=0;a<c&&!((i=e.charCodeAt(a)-64)<1||i>26);++a)t=26*t+i;for(r.s.c=--t,t=0;a<c&&!((i=e.charCodeAt(a)-48)<0||i>9);++a)t=10*t+i;if(r.s.r=--t,a===c||i!=10)return r.e.c=r.s.c,r.e.r=r.s.r,r;for(++a,t=0;a!=c&&!((i=e.charCodeAt(a)-64)<1||i>26);++a)t=26*t+i;for(r.e.c=--t,t=0;a!=c&&!((i=e.charCodeAt(a)-48)<0||i>9);++a)t=10*t+i;return r.e.r=--t,r}function Gc(e,r){var t=e.t=="d"&&r instanceof Date;if(e.z!=null)try{return e.w=xn(e.z,t?ur(r):r)}catch{}try{return e.w=xn((e.XF||{}).numFmtId||(t?14:0),t?ur(r):r)}catch{return""+r}}function Hn(e,r,t){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&t&&t.dateNF&&(e.z=t.dateNF),e.t=="e"?zn[e.v]||e.v:r==null?Gc(e,e.v):Gc(e,r))}function la(e,r){var t=r&&r.sheet?r.sheet:"Sheet1",a={};return a[t]=e,{SheetNames:[t],Sheets:a}}function J1(e,r,t){var a=t||{},i=e?Array.isArray(e):a.dense,c=e||(i?[]:{}),u=0,d=0;if(c&&a.origin!=null){if(typeof a.origin=="number")u=a.origin;else{var g=typeof a.origin=="string"?Kt(a.origin):a.origin;u=g.r,d=g.c}c["!ref"]||(c["!ref"]="A1:A1")}var m={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(c["!ref"]){var w=Ct(c["!ref"]);m.s.c=w.s.c,m.s.r=w.s.r,m.e.c=Math.max(m.e.c,w.e.c),m.e.r=Math.max(m.e.r,w.e.r),u==-1&&(m.e.r=u=w.e.r+1)}for(var v=0;v!=r.length;++v)if(r[v]){if(!Array.isArray(r[v]))throw new Error("aoa_to_sheet expects an array of arrays");for(var _=0;_!=r[v].length;++_)if(!(typeof r[v][_]>"u")){var C={v:r[v][_]},S=u+v,A=d+_;if(m.s.r>S&&(m.s.r=S),m.s.c>A&&(m.s.c=A),m.e.r<S&&(m.e.r=S),m.e.c<A&&(m.e.c=A),r[v][_]&&typeof r[v][_]=="object"&&!Array.isArray(r[v][_])&&!(r[v][_]instanceof Date))C=r[v][_];else if(Array.isArray(C.v)&&(C.f=r[v][_][1],C.v=C.v[0]),C.v===null)if(C.f)C.t="n";else if(a.nullError)C.t="e",C.v=0;else if(a.sheetStubs)C.t="z";else continue;else typeof C.v=="number"?C.t="n":typeof C.v=="boolean"?C.t="b":C.v instanceof Date?(C.z=a.dateNF||qe[14],a.cellDates?(C.t="d",C.w=xn(C.z,ur(C.v))):(C.t="n",C.v=ur(C.v),C.w=xn(C.z,C.v))):C.t="s";if(i)c[S]||(c[S]=[]),c[S][A]&&c[S][A].z&&(C.z=c[S][A].z),c[S][A]=C;else{var y=Qe({c:A,r:S});c[y]&&c[y].z&&(C.z=c[y].z),c[y]=C}}}return m.s.c<1e7&&(c["!ref"]=it(m)),c}function si(e,r){return J1(null,e,r)}function yd(e){return e.read_shift(4,"i")}function Cn(e,r){return r||(r=ve(4)),r.write_shift(4,e),r}function Fr(e){var r=e.read_shift(4);return r===0?"":e.read_shift(r,"dbcs")}function pr(e,r){var t=!1;return r==null&&(t=!0,r=ve(4+2*e.length)),r.write_shift(4,e.length),e.length>0&&r.write_shift(0,e,"dbcs"),t?r.slice(0,r.l):r}function Id(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function kd(e,r){return r||(r=ve(4)),r.write_shift(2,0),r.write_shift(2,0),r}function yo(e,r){var t=e.l,a=e.read_shift(1),i=Fr(e),c=[],u={t:i,h:i};if((a&1)!==0){for(var d=e.read_shift(4),g=0;g!=d;++g)c.push(Id(e));u.r=c}else u.r=[{ich:0,ifnt:0}];return e.l=t+r,u}function bd(e,r){var t=!1;return r==null&&(t=!0,r=ve(15+4*e.t.length)),r.write_shift(1,0),pr(e.t,r),t?r.slice(0,r.l):r}var Nd=yo;function Fd(e,r){var t=!1;return r==null&&(t=!0,r=ve(23+4*e.t.length)),r.write_shift(1,1),pr(e.t,r),r.write_shift(4,1),kd({},r),t?r.slice(0,r.l):r}function gn(e){var r=e.read_shift(4),t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:r,iStyleRef:t}}function Na(e,r){return r==null&&(r=ve(8)),r.write_shift(-4,e.c),r.write_shift(3,e.iStyleRef||e.s),r.write_shift(1,0),r}function Fa(e){var r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:r}}function Ra(e,r){return r==null&&(r=ve(4)),r.write_shift(3,e.iStyleRef||e.s),r.write_shift(1,0),r}var Rd=Fr,Q1=pr;function Io(e){var r=e.read_shift(4);return r===0||r===4294967295?"":e.read_shift(r,"dbcs")}function Is(e,r){var t=!1;return r==null&&(t=!0,r=ve(127)),r.write_shift(4,e.length>0?e.length:4294967295),e.length>0&&r.write_shift(0,e,"dbcs"),t?r.slice(0,r.l):r}var Od=Fr,J0=Io,ko=Is;function bo(e){var r=e.slice(e.l,e.l+4),t=r[0]&1,a=r[0]&2;e.l+=4;var i=a===0?ys([0,0,0,0,r[0]&252,r[1],r[2],r[3]],0):pa(r,0)>>2;return t?i/100:i}function $1(e,r){r==null&&(r=ve(4));var t=0,a=0,i=e*100;if(e==(e|0)&&e>=-536870912&&e<1<<29?a=1:i==(i|0)&&i>=-536870912&&i<1<<29&&(a=1,t=1),a)r.write_shift(-4,((t?i:e)<<2)+(t+2));else throw new Error("unsupported RkNumber "+e)}function el(e){var r={s:{},e:{}};return r.s.r=e.read_shift(4),r.e.r=e.read_shift(4),r.s.c=e.read_shift(4),r.e.c=e.read_shift(4),r}function Dd(e,r){return r||(r=ve(16)),r.write_shift(4,e.s.r),r.write_shift(4,e.e.r),r.write_shift(4,e.s.c),r.write_shift(4,e.e.c),r}var Oa=el,oi=Dd;function Nr(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function Sa(e,r){return(r||ve(8)).write_shift(8,e,"f")}function Bd(e){var r={},t=e.read_shift(1),a=t>>>1,i=e.read_shift(1),c=e.read_shift(2,"i"),u=e.read_shift(1),d=e.read_shift(1),g=e.read_shift(1);switch(e.l++,a){case 0:r.auto=1;break;case 1:r.index=i;var m=Ea[i];m&&(r.rgb=Wi(m));break;case 2:r.rgb=Wi([u,d,g]);break;case 3:r.theme=i;break}return c!=0&&(r.tint=c>0?c/32767:c/32768),r}function ks(e,r){if(r||(r=ve(8)),!e||e.auto)return r.write_shift(4,0),r.write_shift(4,0),r;e.index!=null?(r.write_shift(1,2),r.write_shift(1,e.index)):e.theme!=null?(r.write_shift(1,6),r.write_shift(1,e.theme)):(r.write_shift(1,5),r.write_shift(1,0));var t=e.tint||0;if(t>0?t*=32767:t<0&&(t*=32768),r.write_shift(2,t),!e.rgb||e.theme!=null)r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);else{var a=e.rgb||"FFFFFF";typeof a=="number"&&(a=("000000"+a.toString(16)).slice(-6)),r.write_shift(1,parseInt(a.slice(0,2),16)),r.write_shift(1,parseInt(a.slice(2,4),16)),r.write_shift(1,parseInt(a.slice(4,6),16)),r.write_shift(1,255)}return r}function Md(e){var r=e.read_shift(1);e.l++;var t={fBold:r&1,fItalic:r&2,fUnderline:r&4,fStrikeout:r&8,fOutline:r&16,fShadow:r&32,fCondense:r&64,fExtend:r&128};return t}function Pd(e,r){r||(r=ve(2));var t=(e.italic?2:0)|(e.strike?8:0)|(e.outline?16:0)|(e.shadow?32:0)|(e.condense?64:0)|(e.extend?128:0);return r.write_shift(1,t),r.write_shift(1,0),r}function tl(e,r){var t={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},a=e.read_shift(4);switch(a){case 0:return"";case 4294967295:case 4294967294:return t[e.read_shift(4)]||""}if(a>400)throw new Error("Unsupported Clipboard: "+a.toString(16));return e.l-=4,e.read_shift(0,r==1?"lpstr":"lpwstr")}function Ld(e){return tl(e,1)}function Ud(e){return tl(e,2)}var No=2,Hr=3,us=11,Xc=12,bs=19,hs=64,Wd=65,Vd=71,Hd=4108,Gd=4126,gr=80,rl=81,Xd=[gr,rl],Q0={1:{n:"CodePage",t:No},2:{n:"Category",t:gr},3:{n:"PresentationFormat",t:gr},4:{n:"ByteCount",t:Hr},5:{n:"LineCount",t:Hr},6:{n:"ParagraphCount",t:Hr},7:{n:"SlideCount",t:Hr},8:{n:"NoteCount",t:Hr},9:{n:"HiddenCount",t:Hr},10:{n:"MultimediaClipCount",t:Hr},11:{n:"ScaleCrop",t:us},12:{n:"HeadingPairs",t:Hd},13:{n:"TitlesOfParts",t:Gd},14:{n:"Manager",t:gr},15:{n:"Company",t:gr},16:{n:"LinksUpToDate",t:us},17:{n:"CharacterCount",t:Hr},19:{n:"SharedDoc",t:us},22:{n:"HyperlinksChanged",t:us},23:{n:"AppVersion",t:Hr,p:"version"},24:{n:"DigSig",t:Wd},26:{n:"ContentType",t:gr},27:{n:"ContentStatus",t:gr},28:{n:"Language",t:gr},29:{n:"Version",t:gr},255:{},2147483648:{n:"Locale",t:bs},2147483651:{n:"Behavior",t:bs},1919054434:{}},$0={1:{n:"CodePage",t:No},2:{n:"Title",t:gr},3:{n:"Subject",t:gr},4:{n:"Author",t:gr},5:{n:"Keywords",t:gr},6:{n:"Comments",t:gr},7:{n:"Template",t:gr},8:{n:"LastAuthor",t:gr},9:{n:"RevNumber",t:gr},10:{n:"EditTime",t:hs},11:{n:"LastPrinted",t:hs},12:{n:"CreatedDate",t:hs},13:{n:"ModifiedDate",t:hs},14:{n:"PageCount",t:Hr},15:{n:"WordCount",t:Hr},16:{n:"CharCount",t:Hr},17:{n:"Thumbnail",t:Vd},18:{n:"Application",t:gr},19:{n:"DocSecurity",t:Hr},255:{},2147483648:{n:"Locale",t:bs},2147483651:{n:"Behavior",t:bs},1919054434:{}},zc={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},zd=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function Yd(e){return e.map(function(r){return[r>>16&255,r>>8&255,r&255]})}var Kd=Yd([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Ea=Vt(Kd),zn={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},nl={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},eo={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},ds={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function Fo(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function jd(e){var r=Fo();if(!e||!e.match)return r;var t={};if((e.match(Or)||[]).forEach(function(a){var i=et(a);switch(i[0].replace(ad,"<")){case"<?xml":break;case"<Types":r.xmlns=i["xmlns"+(i[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":t[i.Extension]=i.ContentType;break;case"<Override":r[eo[i.ContentType]]!==void 0&&r[eo[i.ContentType]].push(i.PartName);break}}),r.xmlns!==lr.CT)throw new Error("Unknown Namespace: "+r.xmlns);return r.calcchain=r.calcchains.length>0?r.calcchains[0]:"",r.sst=r.strs.length>0?r.strs[0]:"",r.style=r.styles.length>0?r.styles[0]:"",r.defaults=t,delete r.calcchains,r}function al(e,r){var t=jh(eo),a=[],i;a[a.length]=nr,a[a.length]=Me("Types",null,{xmlns:lr.CT,"xmlns:xsd":lr.xsd,"xmlns:xsi":lr.xsi}),a=a.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(g){return Me("Default",null,{Extension:g[0],ContentType:g[1]})}));var c=function(g){e[g]&&e[g].length>0&&(i=e[g][0],a[a.length]=Me("Override",null,{PartName:(i[0]=="/"?"":"/")+i,ContentType:ds[g][r.bookType]||ds[g].xlsx}))},u=function(g){(e[g]||[]).forEach(function(m){a[a.length]=Me("Override",null,{PartName:(m[0]=="/"?"":"/")+m,ContentType:ds[g][r.bookType]||ds[g].xlsx})})},d=function(g){(e[g]||[]).forEach(function(m){a[a.length]=Me("Override",null,{PartName:(m[0]=="/"?"":"/")+m,ContentType:t[g][0]})})};return c("workbooks"),u("sheets"),u("charts"),d("themes"),["strs","styles"].forEach(c),["coreprops","extprops","custprops"].forEach(d),d("vba"),d("comments"),d("threadedcomments"),d("drawings"),u("metadata"),d("people"),a.length>2&&(a[a.length]="</Types>",a[1]=a[1].replace("/>",">")),a.join("")}var pt={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function Ui(e){var r=e.lastIndexOf("/");return e.slice(0,r+1)+"_rels/"+e.slice(r+1)+".rels"}function ki(e,r){var t={"!id":{}};if(!e)return t;r.charAt(0)!=="/"&&(r="/"+r);var a={};return(e.match(Or)||[]).forEach(function(i){var c=et(i);if(c[0]==="<Relationship"){var u={};u.Type=c.Type,u.Target=c.Target,u.Id=c.Id,c.TargetMode&&(u.TargetMode=c.TargetMode);var d=c.TargetMode==="External"?c.Target:Ci(c.Target,r);t[d]=u,a[c.Id]=u}}),t["!id"]=a,t}function Qa(e){var r=[nr,Me("Relationships",null,{xmlns:lr.RELS})];return $t(e["!id"]).forEach(function(t){r[r.length]=Me("Relationship",null,e["!id"][t])}),r.length>2&&(r[r.length]="</Relationships>",r[1]=r[1].replace("/>",">")),r.join("")}function It(e,r,t,a,i,c){if(i||(i={}),e["!id"]||(e["!id"]={}),e["!idx"]||(e["!idx"]=1),r<0)for(r=e["!idx"];e["!id"]["rId"+r];++r);if(e["!idx"]=r+1,i.Id="rId"+r,i.Type=a,i.Target=t,[pt.HLINK,pt.XPATH,pt.XMISS].indexOf(i.Type)>-1&&(i.TargetMode="External"),e["!id"][i.Id])throw new Error("Cannot rewrite rId "+r);return e["!id"][i.Id]=i,e[("/"+i.Target).replace("//","/")]=i,r}var Zd="application/vnd.oasis.opendocument.spreadsheet";function qd(e,r){for(var t=_o(e),a,i;a=Li.exec(t);)switch(a[3]){case"manifest":break;case"file-entry":if(i=et(a[0],!1),i.path=="/"&&i.type!==Zd)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(r&&r.WTF)throw a}}function Jd(e){var r=[nr];r.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),r.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var t=0;t<e.length;++t)r.push('  <manifest:file-entry manifest:full-path="'+e[t][0]+'" manifest:media-type="'+e[t][1]+`"/>
`);return r.push("</manifest:manifest>"),r.join("")}function Yc(e,r,t){return['  <rdf:Description rdf:about="'+e+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(t||"odf")+"#"+r+`"/>
`,`  </rdf:Description>
`].join("")}function Qd(e,r){return['  <rdf:Description rdf:about="'+e+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+r+`"/>
`,`  </rdf:Description>
`].join("")}function $d(e){var r=[nr];r.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var t=0;t!=e.length;++t)r.push(Yc(e[t][0],e[t][1])),r.push(Qd("",e[t][0]));return r.push(Yc("","Document","pkg")),r.push("</rdf:RDF>"),r.join("")}function il(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+_s.version+"</meta:generator></office:meta></office:document-meta>"}var dn=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],ex=(function(){for(var e=new Array(dn.length),r=0;r<dn.length;++r){var t=dn[r],a="(?:"+t[0].slice(0,t[0].indexOf(":"))+":)"+t[0].slice(t[0].indexOf(":")+1);e[r]=new RegExp("<"+a+"[^>]*>([\\s\\S]*?)</"+a+">")}return e})();function sl(e){var r={};e=Nt(e);for(var t=0;t<dn.length;++t){var a=dn[t],i=e.match(ex[t]);i!=null&&i.length>0&&(r[a[1]]=At(i[1])),a[2]==="date"&&r[a[1]]&&(r[a[1]]=Wt(r[a[1]]))}return r}function x0(e,r,t,a,i){i[e]!=null||r==null||r===""||(i[e]=r,r=kt(r),a[a.length]=t?Me(e,r,t):Cr(e,r))}function ol(e,r){var t=r||{},a=[nr,Me("cp:coreProperties",null,{"xmlns:cp":lr.CORE_PROPS,"xmlns:dc":lr.dc,"xmlns:dcterms":lr.dcterms,"xmlns:dcmitype":lr.dcmitype,"xmlns:xsi":lr.xsi})],i={};if(!e&&!t.Props)return a.join("");e&&(e.CreatedDate!=null&&x0("dcterms:created",typeof e.CreatedDate=="string"?e.CreatedDate:q0(e.CreatedDate,t.WTF),{"xsi:type":"dcterms:W3CDTF"},a,i),e.ModifiedDate!=null&&x0("dcterms:modified",typeof e.ModifiedDate=="string"?e.ModifiedDate:q0(e.ModifiedDate,t.WTF),{"xsi:type":"dcterms:W3CDTF"},a,i));for(var c=0;c!=dn.length;++c){var u=dn[c],d=t.Props&&t.Props[u[1]]!=null?t.Props[u[1]]:e?e[u[1]]:null;d===!0?d="1":d===!1?d="0":typeof d=="number"&&(d=String(d)),d!=null&&x0(u[0],d,null,a,i)}return a.length>2&&(a[a.length]="</cp:coreProperties>",a[1]=a[1].replace("/>",">")),a.join("")}var va=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],cl=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function fl(e,r,t,a){var i=[];if(typeof e=="string")i=Mc(e,a);else for(var c=0;c<e.length;++c)i=i.concat(e[c].map(function(w){return{v:w}}));var u=typeof r=="string"?Mc(r,a).map(function(w){return w.v}):r,d=0,g=0;if(u.length>0)for(var m=0;m!==i.length;m+=2){switch(g=+i[m+1].v,i[m].v){case"Worksheets":case"工作表":case"Листы":case"أوراق العمل":case"ワークシート":case"גליונות עבודה":case"Arbeitsblätter":case"Çalışma Sayfaları":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de cálculo":case"Planilhas":case"Regneark":case"Hojas de cálculo":case"Werkbladen":t.Worksheets=g,t.SheetNames=u.slice(d,d+g);break;case"Named Ranges":case"Rangos con nombre":case"名前付き一覧":case"Benannte Bereiche":case"Navngivne områder":t.NamedRanges=g,t.DefinedNames=u.slice(d,d+g);break;case"Charts":case"Diagramme":t.Chartsheets=g,t.ChartNames=u.slice(d,d+g);break}d+=g}}function tx(e,r,t){var a={};return r||(r={}),e=Nt(e),va.forEach(function(i){var c=(e.match(Mi(i[0]))||[])[1];switch(i[2]){case"string":c&&(r[i[1]]=At(c));break;case"bool":r[i[1]]=c==="true";break;case"raw":var u=e.match(new RegExp("<"+i[0]+"[^>]*>([\\s\\S]*?)</"+i[0]+">"));u&&u.length>0&&(a[i[1]]=u[1]);break}}),a.HeadingPairs&&a.TitlesOfParts&&fl(a.HeadingPairs,a.TitlesOfParts,r,t),r}function ll(e){var r=[],t=Me;return e||(e={}),e.Application="SheetJS",r[r.length]=nr,r[r.length]=Me("Properties",null,{xmlns:lr.EXT_PROPS,"xmlns:vt":lr.vt}),va.forEach(function(a){if(e[a[1]]!==void 0){var i;switch(a[2]){case"string":i=kt(String(e[a[1]]));break;case"bool":i=e[a[1]]?"true":"false";break}i!==void 0&&(r[r.length]=t(a[0],i))}}),r[r.length]=t("HeadingPairs",t("vt:vector",t("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+t("vt:variant",t("vt:i4",String(e.Worksheets))),{size:2,baseType:"variant"})),r[r.length]=t("TitlesOfParts",t("vt:vector",e.SheetNames.map(function(a){return"<vt:lpstr>"+kt(a)+"</vt:lpstr>"}).join(""),{size:e.Worksheets,baseType:"lpstr"})),r.length>2&&(r[r.length]="</Properties>",r[1]=r[1].replace("/>",">")),r.join("")}var rx=/<[^>]+>[^<]*/g;function nx(e,r){var t={},a="",i=e.match(rx);if(i)for(var c=0;c!=i.length;++c){var u=i[c],d=et(u);switch(d[0]){case"<?xml":break;case"<Properties":break;case"<property":a=At(d.name);break;case"</property>":a=null;break;default:if(u.indexOf("<vt:")===0){var g=u.split(">"),m=g[0].slice(4),w=g[1];switch(m){case"lpstr":case"bstr":case"lpwstr":t[a]=At(w);break;case"bool":t[a]=Ut(w);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":t[a]=parseInt(w,10);break;case"r4":case"r8":case"decimal":t[a]=parseFloat(w);break;case"filetime":case"date":t[a]=Wt(w);break;case"cy":case"error":t[a]=At(w);break;default:if(m.slice(-1)=="/")break;r.WTF&&typeof console<"u"&&console.warn("Unexpected",u,m,g)}}else if(u.slice(0,2)!=="</"){if(r.WTF)throw new Error(u)}}}return t}function ul(e){var r=[nr,Me("Properties",null,{xmlns:lr.CUST_PROPS,"xmlns:vt":lr.vt})];if(!e)return r.join("");var t=1;return $t(e).forEach(function(i){++t,r[r.length]=Me("property",hd(e[i]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:t,name:kt(i)})}),r.length>2&&(r[r.length]="</Properties>",r[1]=r[1].replace("/>",">")),r.join("")}var to={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},g0;function ax(e,r,t){g0||(g0=Us(to)),r=g0[r]||r,e[r]=t}function ix(e,r){var t=[];return $t(to).map(function(a){for(var i=0;i<dn.length;++i)if(dn[i][1]==a)return dn[i];for(i=0;i<va.length;++i)if(va[i][1]==a)return va[i];throw a}).forEach(function(a){if(e[a[1]]!=null){var i=r&&r.Props&&r.Props[a[1]]!=null?r.Props[a[1]]:e[a[1]];switch(a[2]){case"date":i=new Date(i).toISOString().replace(/\.\d*Z/,"Z");break}typeof i=="number"?i=String(i):i===!0||i===!1?i=i?"1":"0":i instanceof Date&&(i=new Date(i).toISOString().replace(/\.\d*Z/,"")),t.push(Cr(to[a[1]]||a[1],i))}}),Me("DocumentProperties",t.join(""),{xmlns:qr.o})}function sx(e,r){var t=["Worksheets","SheetNames"],a="CustomDocumentProperties",i=[];return e&&$t(e).forEach(function(c){if(Object.prototype.hasOwnProperty.call(e,c)){for(var u=0;u<dn.length;++u)if(c==dn[u][1])return;for(u=0;u<va.length;++u)if(c==va[u][1])return;for(u=0;u<t.length;++u)if(c==t[u])return;var d=e[c],g="string";typeof d=="number"?(g="float",d=String(d)):d===!0||d===!1?(g="boolean",d=d?"1":"0"):d=String(d),i.push(Me(Rc(c),d,{"dt:dt":g}))}}),r&&$t(r).forEach(function(c){if(Object.prototype.hasOwnProperty.call(r,c)&&!(e&&Object.prototype.hasOwnProperty.call(e,c))){var u=r[c],d="string";typeof u=="number"?(d="float",u=String(u)):u===!0||u===!1?(d="boolean",u=u?"1":"0"):u instanceof Date?(d="dateTime.tz",u=u.toISOString()):u=String(u),i.push(Me(Rc(c),u,{"dt:dt":d}))}}),"<"+a+' xmlns="'+qr.o+'">'+i.join("")+"</"+a+">"}function Ro(e){var r=e.read_shift(4),t=e.read_shift(4);return new Date((t/1e7*Math.pow(2,32)+r/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function ox(e){var r=typeof e=="string"?new Date(Date.parse(e)):e,t=r.getTime()/1e3+11644473600,a=t%Math.pow(2,32),i=(t-a)/Math.pow(2,32);a*=1e7,i*=1e7;var c=a/Math.pow(2,32)|0;c>0&&(a=a%Math.pow(2,32),i+=c);var u=ve(8);return u.write_shift(4,a),u.write_shift(4,i),u}function hl(e,r,t){var a=e.l,i=e.read_shift(0,"lpstr-cp");if(t)for(;e.l-a&3;)++e.l;return i}function dl(e,r,t){var a=e.read_shift(0,"lpwstr");return a}function xl(e,r,t){return r===31?dl(e):hl(e,r,t)}function ro(e,r,t){return xl(e,r,t===!1?0:4)}function cx(e,r){if(!r)throw new Error("VtUnalignedString must have positive length");return xl(e,r,0)}function fx(e){for(var r=e.read_shift(4),t=[],a=0;a!=r;++a){var i=e.l;t[a]=e.read_shift(0,"lpwstr").replace(Pr,""),e.l-i&2&&(e.l+=2)}return t}function lx(e){for(var r=e.read_shift(4),t=[],a=0;a!=r;++a)t[a]=e.read_shift(0,"lpstr-cp").replace(Pr,"");return t}function ux(e){var r=e.l,t=Ns(e,rl);e[e.l]==0&&e[e.l+1]==0&&e.l-r&2&&(e.l+=2);var a=Ns(e,Hr);return[t,a]}function hx(e){for(var r=e.read_shift(4),t=[],a=0;a<r/2;++a)t.push(ux(e));return t}function Kc(e,r){for(var t=e.read_shift(4),a={},i=0;i!=t;++i){var c=e.read_shift(4),u=e.read_shift(4);a[c]=e.read_shift(u,r===1200?"utf16le":"utf8").replace(Pr,"").replace(Ai,"!"),r===1200&&u%2&&(e.l+=2)}return e.l&3&&(e.l=e.l>>3<<2),a}function gl(e){var r=e.read_shift(4),t=e.slice(e.l,e.l+r);return e.l+=r,(r&3)>0&&(e.l+=4-(r&3)&3),t}function dx(e){var r={};return r.Size=e.read_shift(4),e.l+=r.Size+3-(r.Size-1)%4,r}function Ns(e,r,t){var a=e.read_shift(2),i,c=t||{};if(e.l+=2,r!==Xc&&a!==r&&Xd.indexOf(r)===-1&&!((r&65534)==4126&&(a&65534)==4126))throw new Error("Expected type "+r+" saw "+a);switch(r===Xc?a:r){case 2:return i=e.read_shift(2,"i"),c.raw||(e.l+=2),i;case 3:return i=e.read_shift(4,"i"),i;case 11:return e.read_shift(4)!==0;case 19:return i=e.read_shift(4),i;case 30:return hl(e,a,4).replace(Pr,"");case 31:return dl(e);case 64:return Ro(e);case 65:return gl(e);case 71:return dx(e);case 80:return ro(e,a,!c.raw).replace(Pr,"");case 81:return cx(e,a).replace(Pr,"");case 4108:return hx(e);case 4126:case 4127:return a==4127?fx(e):lx(e);default:throw new Error("TypedPropertyValue unrecognized type "+r+" "+a)}}function jc(e,r){var t=ve(4),a=ve(4);switch(t.write_shift(4,e==80?31:e),e){case 3:a.write_shift(-4,r);break;case 5:a=ve(8),a.write_shift(8,r,"f");break;case 11:a.write_shift(4,r?1:0);break;case 64:a=ox(r);break;case 31:case 80:for(a=ve(4+2*(r.length+1)+(r.length%2?0:2)),a.write_shift(4,r.length+1),a.write_shift(0,r,"dbcs");a.l!=a.length;)a.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+r)}return mr([t,a])}function Zc(e,r){var t=e.l,a=e.read_shift(4),i=e.read_shift(4),c=[],u=0,d=0,g=-1,m={};for(u=0;u!=i;++u){var w=e.read_shift(4),v=e.read_shift(4);c[u]=[w,v+t]}c.sort(function(P,b){return P[1]-b[1]});var _={};for(u=0;u!=i;++u){if(e.l!==c[u][1]){var C=!0;if(u>0&&r)switch(r[c[u-1][0]].t){case 2:e.l+2===c[u][1]&&(e.l+=2,C=!1);break;case 80:e.l<=c[u][1]&&(e.l=c[u][1],C=!1);break;case 4108:e.l<=c[u][1]&&(e.l=c[u][1],C=!1);break}if((!r||u==0)&&e.l<=c[u][1]&&(C=!1,e.l=c[u][1]),C)throw new Error("Read Error: Expected address "+c[u][1]+" at "+e.l+" :"+u)}if(r){var S=r[c[u][0]];if(_[S.n]=Ns(e,S.t,{raw:!0}),S.p==="version"&&(_[S.n]=String(_[S.n]>>16)+"."+("0000"+String(_[S.n]&65535)).slice(-4)),S.n=="CodePage")switch(_[S.n]){case 0:_[S.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:vn(d=_[S.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+_[S.n])}}else if(c[u][0]===1){if(d=_.CodePage=Ns(e,No),vn(d),g!==-1){var A=e.l;e.l=c[g][1],m=Kc(e,d),e.l=A}}else if(c[u][0]===0){if(d===0){g=u,e.l=c[u+1][1];continue}m=Kc(e,d)}else{var y=m[c[u][0]],D;switch(e[e.l]){case 65:e.l+=4,D=gl(e);break;case 30:e.l+=4,D=ro(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 31:e.l+=4,D=ro(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,D=e.read_shift(4,"i");break;case 19:e.l+=4,D=e.read_shift(4);break;case 5:e.l+=4,D=e.read_shift(8,"f");break;case 11:e.l+=4,D=tr(e,4);break;case 64:e.l+=4,D=Wt(Ro(e));break;default:throw new Error("unparsed value: "+e[e.l])}_[y]=D}}return e.l=t+a,_}var ml=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function xx(e){switch(typeof e){case"boolean":return 11;case"number":return(e|0)==e?3:5;case"string":return 31;case"object":if(e instanceof Date)return 64;break}return-1}function qc(e,r,t){var a=ve(8),i=[],c=[],u=8,d=0,g=ve(8),m=ve(8);if(g.write_shift(4,2),g.write_shift(4,1200),m.write_shift(4,1),c.push(g),i.push(m),u+=8+g.length,!r){m=ve(8),m.write_shift(4,0),i.unshift(m);var w=[ve(4)];for(w[0].write_shift(4,e.length),d=0;d<e.length;++d){var v=e[d][0];for(g=ve(8+2*(v.length+1)+(v.length%2?0:2)),g.write_shift(4,d+2),g.write_shift(4,v.length+1),g.write_shift(0,v,"dbcs");g.l!=g.length;)g.write_shift(1,0);w.push(g)}g=mr(w),c.unshift(g),u+=8+g.length}for(d=0;d<e.length;++d)if(!(r&&!r[e[d][0]])&&!(ml.indexOf(e[d][0])>-1||cl.indexOf(e[d][0])>-1)&&e[d][1]!=null){var _=e[d][1],C=0;if(r){C=+r[e[d][0]];var S=t[C];if(S.p=="version"&&typeof _=="string"){var A=_.split(".");_=(+A[0]<<16)+(+A[1]||0)}g=jc(S.t,_)}else{var y=xx(_);y==-1&&(y=31,_=String(_)),g=jc(y,_)}c.push(g),m=ve(8),m.write_shift(4,r?C:2+d),i.push(m),u+=8+g.length}var D=8*(c.length+1);for(d=0;d<c.length;++d)i[d].write_shift(4,D),D+=c[d].length;return a.write_shift(4,u),a.write_shift(4,c.length),mr([a].concat(i).concat(c))}function Jc(e,r,t){var a=e.content;if(!a)return{};Ar(a,0);var i,c,u,d,g=0;a.chk("feff","Byte Order: "),a.read_shift(2);var m=a.read_shift(4),w=a.read_shift(16);if(w!==Ke.utils.consts.HEADER_CLSID&&w!==t)throw new Error("Bad PropertySet CLSID "+w);if(i=a.read_shift(4),i!==1&&i!==2)throw new Error("Unrecognized #Sets: "+i);if(c=a.read_shift(16),d=a.read_shift(4),i===1&&d!==a.l)throw new Error("Length mismatch: "+d+" !== "+a.l);i===2&&(u=a.read_shift(16),g=a.read_shift(4));var v=Zc(a,r),_={SystemIdentifier:m};for(var C in v)_[C]=v[C];if(_.FMTID=c,i===1)return _;if(g-a.l==2&&(a.l+=2),a.l!==g)throw new Error("Length mismatch 2: "+a.l+" !== "+g);var S;try{S=Zc(a,null)}catch{}for(C in S)_[C]=S[C];return _.FMTID=[c,u],_}function Qc(e,r,t,a,i,c){var u=ve(i?68:48),d=[u];u.write_shift(2,65534),u.write_shift(2,0),u.write_shift(4,842412599),u.write_shift(16,Ke.utils.consts.HEADER_CLSID,"hex"),u.write_shift(4,i?2:1),u.write_shift(16,r,"hex"),u.write_shift(4,i?68:48);var g=qc(e,t,a);if(d.push(g),i){var m=qc(i,null,null);u.write_shift(16,c,"hex"),u.write_shift(4,68+g.length),d.push(m)}return mr(d)}function ea(e,r){return e.read_shift(r),null}function gx(e,r){r||(r=ve(e));for(var t=0;t<e;++t)r.write_shift(1,0);return r}function mx(e,r,t){for(var a=[],i=e.l+r;e.l<i;)a.push(t(e,i-e.l));if(i!==e.l)throw new Error("Slurp error");return a}function tr(e,r){return e.read_shift(r)===1}function Mr(e,r){return r||(r=ve(2)),r.write_shift(2,+!!e),r}function or(e){return e.read_shift(2,"u")}function hn(e,r){return r||(r=ve(2)),r.write_shift(2,e),r}function pl(e,r){return mx(e,r,or)}function px(e){var r=e.read_shift(1),t=e.read_shift(1);return t===1?r:r===1}function wl(e,r,t){return t||(t=ve(2)),t.write_shift(1,r=="e"?+e:+!!e),t.write_shift(1,r=="e"?1:0),t}function Zi(e,r,t){var a=e.read_shift(t&&t.biff>=12?2:1),i="sbcs-cont";if(t&&t.biff>=8,!t||t.biff==8){var c=e.read_shift(1);c&&(i="dbcs-cont")}else t.biff==12&&(i="wstr");t.biff>=2&&t.biff<=5&&(i="cpstr");var u=a?e.read_shift(a,i):"";return u}function wx(e){var r=e.read_shift(2),t=e.read_shift(1),a=t&4,i=t&8,c=1+(t&1),u=0,d,g={};i&&(u=e.read_shift(2)),a&&(d=e.read_shift(4));var m=c==2?"dbcs-cont":"sbcs-cont",w=r===0?"":e.read_shift(r,m);return i&&(e.l+=4*u),a&&(e.l+=d),g.t=w,i||(g.raw="<t>"+g.t+"</t>",g.r=g.t),g}function Ex(e){var r=e.t||"",t=ve(3);t.write_shift(2,r.length),t.write_shift(1,1);var a=ve(2*r.length);a.write_shift(2*r.length,r,"utf16le");var i=[t,a];return mr(i)}function ya(e,r,t){var a;if(t){if(t.biff>=2&&t.biff<=5)return e.read_shift(r,"cpstr");if(t.biff>=12)return e.read_shift(r,"dbcs-cont")}var i=e.read_shift(1);return i===0?a=e.read_shift(r,"sbcs-cont"):a=e.read_shift(r,"dbcs-cont"),a}function qi(e,r,t){var a=e.read_shift(t&&t.biff==2?1:2);return a===0?(e.l++,""):ya(e,a,t)}function Da(e,r,t){if(t.biff>5)return qi(e,r,t);var a=e.read_shift(1);return a===0?(e.l++,""):e.read_shift(a,t.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function El(e,r,t){return t||(t=ve(3+2*e.length)),t.write_shift(2,e.length),t.write_shift(1,1),t.write_shift(31,e,"utf16le"),t}function vx(e){var r=e.read_shift(1);e.l++;var t=e.read_shift(2);return e.l+=2,[r,t]}function _x(e){var r=e.read_shift(4),t=e.l,a=!1;r>24&&(e.l+=r-24,e.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(a=!0),e.l=t);var i=e.read_shift((a?r-24:r)>>1,"utf16le").replace(Pr,"");return a&&(e.l+=24),i}function Ax(e){for(var r=e.read_shift(2),t="";r-- >0;)t+="../";var a=e.read_shift(0,"lpstr-ansi");if(e.l+=2,e.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var i=e.read_shift(4);if(i===0)return t+a.replace(/\\/g,"/");var c=e.read_shift(4);if(e.read_shift(2)!=3)throw new Error("Bad FileMoniker");var u=e.read_shift(c>>1,"utf16le").replace(Pr,"");return t+u}function Cx(e,r){var t=e.read_shift(16);switch(t){case"e0c9ea79f9bace118c8200aa004ba90b":return _x(e);case"0303000000000000c000000000000046":return Ax(e);default:throw new Error("Unsupported Moniker "+t)}}function xs(e){var r=e.read_shift(4),t=r>0?e.read_shift(r,"utf16le").replace(Pr,""):"";return t}function $c(e,r){r||(r=ve(6+e.length*2)),r.write_shift(4,1+e.length);for(var t=0;t<e.length;++t)r.write_shift(2,e.charCodeAt(t));return r.write_shift(2,0),r}function Tx(e,r){var t=e.l+r,a=e.read_shift(4);if(a!==2)throw new Error("Unrecognized streamVersion: "+a);var i=e.read_shift(2);e.l+=2;var c,u,d,g,m="",w,v;i&16&&(c=xs(e,t-e.l)),i&128&&(u=xs(e,t-e.l)),(i&257)===257&&(d=xs(e,t-e.l)),(i&257)===1&&(g=Cx(e,t-e.l)),i&8&&(m=xs(e,t-e.l)),i&32&&(w=e.read_shift(16)),i&64&&(v=Ro(e)),e.l=t;var _=u||d||g||"";_&&m&&(_+="#"+m),_||(_="#"+m),i&2&&_.charAt(0)=="/"&&_.charAt(1)!="/"&&(_="file://"+_);var C={Target:_};return w&&(C.guid=w),v&&(C.time=v),c&&(C.Tooltip=c),C}function Sx(e){var r=ve(512),t=0,a=e.Target;a.slice(0,7)=="file://"&&(a=a.slice(7));var i=a.indexOf("#"),c=i>-1?31:23;switch(a.charAt(0)){case"#":c=28;break;case".":c&=-3;break}r.write_shift(4,2),r.write_shift(4,c);var u=[8,6815827,6619237,4849780,83];for(t=0;t<u.length;++t)r.write_shift(4,u[t]);if(c==28)a=a.slice(1),$c(a,r);else if(c&2){for(u="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),t=0;t<u.length;++t)r.write_shift(1,parseInt(u[t],16));var d=i>-1?a.slice(0,i):a;for(r.write_shift(4,2*(d.length+1)),t=0;t<d.length;++t)r.write_shift(2,d.charCodeAt(t));r.write_shift(2,0),c&8&&$c(i>-1?a.slice(i+1):"",r)}else{for(u="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),t=0;t<u.length;++t)r.write_shift(1,parseInt(u[t],16));for(var g=0;a.slice(g*3,g*3+3)=="../"||a.slice(g*3,g*3+3)=="..\\";)++g;for(r.write_shift(2,g),r.write_shift(4,a.length-3*g+1),t=0;t<a.length-3*g;++t)r.write_shift(1,a.charCodeAt(t+3*g)&255);for(r.write_shift(1,0),r.write_shift(2,65535),r.write_shift(2,57005),t=0;t<6;++t)r.write_shift(4,0)}return r.slice(0,r.l)}function vl(e){var r=e.read_shift(1),t=e.read_shift(1),a=e.read_shift(1),i=e.read_shift(1);return[r,t,a,i]}function _l(e,r){var t=vl(e);return t[3]=0,t}function Dn(e){var r=e.read_shift(2),t=e.read_shift(2),a=e.read_shift(2);return{r,c:t,ixfe:a}}function Ia(e,r,t,a){return a||(a=ve(6)),a.write_shift(2,e),a.write_shift(2,r),a.write_shift(2,t||0),a}function yx(e){var r=e.read_shift(2),t=e.read_shift(2);return e.l+=8,{type:r,flags:t}}function Ix(e,r,t){return r===0?"":Da(e,r,t)}function kx(e,r,t){var a=t.biff>8?4:2,i=e.read_shift(a),c=e.read_shift(a,"i"),u=e.read_shift(a,"i");return[i,c,u]}function Al(e){var r=e.read_shift(2),t=bo(e);return[r,t]}function bx(e,r,t){e.l+=4,r-=4;var a=e.l+r,i=Zi(e,r,t),c=e.read_shift(2);if(a-=e.l,c!==a)throw new Error("Malformed AddinUdf: padding = "+a+" != "+c);return e.l+=c,i}function Hs(e){var r=e.read_shift(2),t=e.read_shift(2),a=e.read_shift(2),i=e.read_shift(2);return{s:{c:a,r},e:{c:i,r:t}}}function Cl(e,r){return r||(r=ve(8)),r.write_shift(2,e.s.r),r.write_shift(2,e.e.r),r.write_shift(2,e.s.c),r.write_shift(2,e.e.c),r}function Tl(e){var r=e.read_shift(2),t=e.read_shift(2),a=e.read_shift(1),i=e.read_shift(1);return{s:{c:a,r},e:{c:i,r:t}}}var Nx=Tl;function Sl(e){e.l+=4;var r=e.read_shift(2),t=e.read_shift(2),a=e.read_shift(2);return e.l+=12,[t,r,a]}function Fx(e){var r={};return e.l+=4,e.l+=16,r.fSharedNote=e.read_shift(2),e.l+=4,r}function Rx(e){var r={};return e.l+=4,e.cf=e.read_shift(2),r}function yr(e){e.l+=2,e.l+=e.read_shift(2)}var Ox={0:yr,4:yr,5:yr,6:yr,7:Rx,8:yr,9:yr,10:yr,11:yr,12:yr,13:Fx,14:yr,15:yr,16:yr,17:yr,18:yr,19:yr,20:yr,21:Sl};function Dx(e,r){for(var t=e.l+r,a=[];e.l<t;){var i=e.read_shift(2);e.l-=2;try{a.push(Ox[i](e,t-e.l))}catch{return e.l=t,a}}return e.l!=t&&(e.l=t),a}function gs(e,r){var t={BIFFVer:0,dt:0};switch(t.BIFFVer=e.read_shift(2),r-=2,r>=2&&(t.dt=e.read_shift(2),e.l-=2),t.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(r>6)throw new Error("Unexpected BIFF Ver "+t.BIFFVer)}return e.read_shift(r),t}function Oo(e,r,t){var a=1536,i=16;switch(t.bookType){case"biff8":break;case"biff5":a=1280,i=8;break;case"biff4":a=4,i=6;break;case"biff3":a=3,i=6;break;case"biff2":a=2,i=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var c=ve(i);return c.write_shift(2,a),c.write_shift(2,r),i>4&&c.write_shift(2,29282),i>6&&c.write_shift(2,1997),i>8&&(c.write_shift(2,49161),c.write_shift(2,1),c.write_shift(2,1798),c.write_shift(2,0)),c}function Bx(e,r){return r===0||e.read_shift(2),1200}function Mx(e,r,t){if(t.enc)return e.l+=r,"";var a=e.l,i=Da(e,0,t);return e.read_shift(r+a-e.l),i}function Px(e,r){var t=!r||r.biff==8,a=ve(t?112:54);for(a.write_shift(r.biff==8?2:1,7),t&&a.write_shift(1,0),a.write_shift(4,859007059),a.write_shift(4,5458548|(t?0:536870912));a.l<a.length;)a.write_shift(1,t?0:32);return a}function Lx(e,r,t){var a=t&&t.biff==8||r==2?e.read_shift(2):(e.l+=r,0);return{fDialog:a&16,fBelow:a&64,fRight:a&128}}function Ux(e,r,t){var a=e.read_shift(4),i=e.read_shift(1)&3,c=e.read_shift(1);switch(c){case 0:c="Worksheet";break;case 1:c="Macrosheet";break;case 2:c="Chartsheet";break;case 6:c="VBAModule";break}var u=Zi(e,0,t);return u.length===0&&(u="Sheet1"),{pos:a,hs:i,dt:c,name:u}}function Wx(e,r){var t=!r||r.biff>=8?2:1,a=ve(8+t*e.name.length);a.write_shift(4,e.pos),a.write_shift(1,e.hs||0),a.write_shift(1,e.dt),a.write_shift(1,e.name.length),r.biff>=8&&a.write_shift(1,1),a.write_shift(t*e.name.length,e.name,r.biff<8?"sbcs":"utf16le");var i=a.slice(0,a.l);return i.l=a.l,i}function Vx(e,r){for(var t=e.l+r,a=e.read_shift(4),i=e.read_shift(4),c=[],u=0;u!=i&&e.l<t;++u)c.push(wx(e));return c.Count=a,c.Unique=i,c}function Hx(e,r){var t=ve(8);t.write_shift(4,e.Count),t.write_shift(4,e.Unique);for(var a=[],i=0;i<e.length;++i)a[i]=Ex(e[i]);var c=mr([t].concat(a));return c.parts=[t.length].concat(a.map(function(u){return u.length})),c}function Gx(e,r){var t={};return t.dsst=e.read_shift(2),e.l+=r-2,t}function Xx(e){var r={};r.r=e.read_shift(2),r.c=e.read_shift(2),r.cnt=e.read_shift(2)-r.c;var t=e.read_shift(2);e.l+=4;var a=e.read_shift(1);return e.l+=3,a&7&&(r.level=a&7),a&32&&(r.hidden=!0),a&64&&(r.hpt=t/20),r}function zx(e){var r=yx(e);if(r.type!=2211)throw new Error("Invalid Future Record "+r.type);var t=e.read_shift(4);return t!==0}function Yx(e){return e.read_shift(2),e.read_shift(4)}function ef(e,r,t){var a=0;t&&t.biff==2||(a=e.read_shift(2));var i=e.read_shift(2);t&&t.biff==2&&(a=1-(i>>15),i&=32767);var c={Unsynced:a&1,DyZero:(a&2)>>1,ExAsc:(a&4)>>2,ExDsc:(a&8)>>3};return[c,i]}function Kx(e){var r=e.read_shift(2),t=e.read_shift(2),a=e.read_shift(2),i=e.read_shift(2),c=e.read_shift(2),u=e.read_shift(2),d=e.read_shift(2),g=e.read_shift(2),m=e.read_shift(2);return{Pos:[r,t],Dim:[a,i],Flags:c,CurTab:u,FirstTab:d,Selected:g,TabRatio:m}}function jx(){var e=ve(18);return e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,29280),e.write_shift(2,17600),e.write_shift(2,56),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,1),e.write_shift(2,500),e}function Zx(e,r,t){if(t&&t.biff>=2&&t.biff<5)return{};var a=e.read_shift(2);return{RTL:a&64}}function qx(e){var r=ve(18),t=1718;return e&&e.RTL&&(t|=64),r.write_shift(2,t),r.write_shift(4,0),r.write_shift(4,64),r.write_shift(4,0),r.write_shift(4,0),r}function Jx(){}function Qx(e,r,t){var a={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(t&&t.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10;break}return a.name=Zi(e,0,t),a}function $x(e,r){var t=e.name||"Arial",a=r&&r.biff==5,i=a?15+t.length:16+2*t.length,c=ve(i);return c.write_shift(2,e.sz*20),c.write_shift(4,0),c.write_shift(2,400),c.write_shift(4,0),c.write_shift(2,0),c.write_shift(1,t.length),a||c.write_shift(1,1),c.write_shift((a?1:2)*t.length,t,a?"sbcs":"utf16le"),c}function e2(e){var r=Dn(e);return r.isst=e.read_shift(4),r}function t2(e,r,t,a){var i=ve(10);return Ia(e,r,a,i),i.write_shift(4,t),i}function r2(e,r,t){t.biffguess&&t.biff==2&&(t.biff=5);var a=e.l+r,i=Dn(e);t.biff==2&&e.l++;var c=qi(e,a-e.l,t);return i.val=c,i}function n2(e,r,t,a,i){var c=!i||i.biff==8,u=ve(8+ +c+(1+c)*t.length);return Ia(e,r,a,u),u.write_shift(2,t.length),c&&u.write_shift(1,1),u.write_shift((1+c)*t.length,t,c?"utf16le":"sbcs"),u}function a2(e,r,t){var a=e.read_shift(2),i=Da(e,0,t);return[a,i]}function i2(e,r,t,a){var i=t&&t.biff==5;a||(a=ve(i?3+r.length:5+2*r.length)),a.write_shift(2,e),a.write_shift(i?1:2,r.length),i||a.write_shift(1,1),a.write_shift((i?1:2)*r.length,r,i?"sbcs":"utf16le");var c=a.length>a.l?a.slice(0,a.l):a;return c.l==null&&(c.l=c.length),c}var s2=Da;function tf(e,r,t){var a=e.l+r,i=t.biff==8||!t.biff?4:2,c=e.read_shift(i),u=e.read_shift(i),d=e.read_shift(2),g=e.read_shift(2);return e.l=a,{s:{r:c,c:d},e:{r:u,c:g}}}function o2(e,r){var t=r.biff==8||!r.biff?4:2,a=ve(2*t+6);return a.write_shift(t,e.s.r),a.write_shift(t,e.e.r+1),a.write_shift(2,e.s.c),a.write_shift(2,e.e.c+1),a.write_shift(2,0),a}function c2(e){var r=e.read_shift(2),t=e.read_shift(2),a=Al(e);return{r,c:t,ixfe:a[0],rknum:a[1]}}function f2(e,r){for(var t=e.l+r-2,a=e.read_shift(2),i=e.read_shift(2),c=[];e.l<t;)c.push(Al(e));if(e.l!==t)throw new Error("MulRK read error");var u=e.read_shift(2);if(c.length!=u-i+1)throw new Error("MulRK length mismatch");return{r:a,c:i,C:u,rkrec:c}}function l2(e,r){for(var t=e.l+r-2,a=e.read_shift(2),i=e.read_shift(2),c=[];e.l<t;)c.push(e.read_shift(2));if(e.l!==t)throw new Error("MulBlank read error");var u=e.read_shift(2);if(c.length!=u-i+1)throw new Error("MulBlank length mismatch");return{r:a,c:i,C:u,ixfe:c}}function u2(e,r,t,a){var i={},c=e.read_shift(4),u=e.read_shift(4),d=e.read_shift(4),g=e.read_shift(2);return i.patternType=zd[d>>26],a.cellStyles&&(i.alc=c&7,i.fWrap=c>>3&1,i.alcV=c>>4&7,i.fJustLast=c>>7&1,i.trot=c>>8&255,i.cIndent=c>>16&15,i.fShrinkToFit=c>>20&1,i.iReadOrder=c>>22&2,i.fAtrNum=c>>26&1,i.fAtrFnt=c>>27&1,i.fAtrAlc=c>>28&1,i.fAtrBdr=c>>29&1,i.fAtrPat=c>>30&1,i.fAtrProt=c>>31&1,i.dgLeft=u&15,i.dgRight=u>>4&15,i.dgTop=u>>8&15,i.dgBottom=u>>12&15,i.icvLeft=u>>16&127,i.icvRight=u>>23&127,i.grbitDiag=u>>30&3,i.icvTop=d&127,i.icvBottom=d>>7&127,i.icvDiag=d>>14&127,i.dgDiag=d>>21&15,i.icvFore=g&127,i.icvBack=g>>7&127,i.fsxButton=g>>14&1),i}function h2(e,r,t){var a={};return a.ifnt=e.read_shift(2),a.numFmtId=e.read_shift(2),a.flags=e.read_shift(2),a.fStyle=a.flags>>2&1,r-=6,a.data=u2(e,r,a.fStyle,t),a}function rf(e,r,t,a){var i=t&&t.biff==5;a||(a=ve(i?16:20)),a.write_shift(2,0),e.style?(a.write_shift(2,e.numFmtId||0),a.write_shift(2,65524)):(a.write_shift(2,e.numFmtId||0),a.write_shift(2,r<<4));var c=0;return e.numFmtId>0&&i&&(c|=1024),a.write_shift(4,c),a.write_shift(4,0),i||a.write_shift(4,0),a.write_shift(2,0),a}function d2(e){e.l+=4;var r=[e.read_shift(2),e.read_shift(2)];if(r[0]!==0&&r[0]--,r[1]!==0&&r[1]--,r[0]>7||r[1]>7)throw new Error("Bad Gutters: "+r.join("|"));return r}function x2(e){var r=ve(8);return r.write_shift(4,0),r.write_shift(2,0),r.write_shift(2,0),r}function nf(e,r,t){var a=Dn(e);(t.biff==2||r==9)&&++e.l;var i=px(e);return a.val=i,a.t=i===!0||i===!1?"b":"e",a}function g2(e,r,t,a,i,c){var u=ve(8);return Ia(e,r,a,u),wl(t,c,u),u}function m2(e,r,t){t.biffguess&&t.biff==2&&(t.biff=5);var a=Dn(e),i=Nr(e);return a.val=i,a}function p2(e,r,t,a){var i=ve(14);return Ia(e,r,a,i),Sa(t,i),i}var af=Ix;function w2(e,r,t){var a=e.l+r,i=e.read_shift(2),c=e.read_shift(2);if(t.sbcch=c,c==1025||c==14849)return[c,i];if(c<1||c>255)throw new Error("Unexpected SupBook type: "+c);for(var u=ya(e,c),d=[];a>e.l;)d.push(qi(e));return[c,i,u,d]}function sf(e,r,t){var a=e.read_shift(2),i,c={fBuiltIn:a&1,fWantAdvise:a>>>1&1,fWantPict:a>>>2&1,fOle:a>>>3&1,fOleLink:a>>>4&1,cf:a>>>5&1023,fIcon:a>>>15&1};return t.sbcch===14849&&(i=bx(e,r-2,t)),c.body=i||e.read_shift(r-2),typeof i=="string"&&(c.Name=i),c}var E2=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function of(e,r,t){var a=e.l+r,i=e.read_shift(2),c=e.read_shift(1),u=e.read_shift(1),d=e.read_shift(t&&t.biff==2?1:2),g=0;(!t||t.biff>=5)&&(t.biff!=5&&(e.l+=2),g=e.read_shift(2),t.biff==5&&(e.l+=2),e.l+=4);var m=ya(e,u,t);i&32&&(m=E2[m.charCodeAt(0)]);var w=a-e.l;t&&t.biff==2&&--w;var v=a==e.l||d===0||!(w>0)?[]:Dw(e,w,t,d);return{chKey:c,Name:m,itab:g,rgce:v}}function yl(e,r,t){if(t.biff<8)return v2(e,r,t);for(var a=[],i=e.l+r,c=e.read_shift(t.biff>8?4:2);c--!==0;)a.push(kx(e,t.biff>8?12:6,t));if(e.l!=i)throw new Error("Bad ExternSheet: "+e.l+" != "+i);return a}function v2(e,r,t){e[e.l+1]==3&&e[e.l]++;var a=Zi(e,r,t);return a.charCodeAt(0)==3?a.slice(1):a}function _2(e,r,t){if(t.biff<8){e.l+=r;return}var a=e.read_shift(2),i=e.read_shift(2),c=ya(e,a,t),u=ya(e,i,t);return[c,u]}function A2(e,r,t){var a=Tl(e);e.l++;var i=e.read_shift(1);return r-=8,[Bw(e,r,t),i,a]}function cf(e,r,t){var a=Nx(e);switch(t.biff){case 2:e.l++,r-=7;break;case 3:case 4:e.l+=2,r-=8;break;default:e.l+=6,r-=12}return[a,Rw(e,r,t)]}function C2(e){var r=e.read_shift(4)!==0,t=e.read_shift(4)!==0,a=e.read_shift(4);return[r,t,a]}function T2(e,r,t){if(!(t.biff<8)){var a=e.read_shift(2),i=e.read_shift(2),c=e.read_shift(2),u=e.read_shift(2),d=Da(e,0,t);return t.biff<8&&e.read_shift(1),[{r:a,c:i},d,u,c]}}function S2(e,r,t){return T2(e,r,t)}function y2(e,r){for(var t=[],a=e.read_shift(2);a--;)t.push(Hs(e));return t}function I2(e){var r=ve(2+e.length*8);r.write_shift(2,e.length);for(var t=0;t<e.length;++t)Cl(e[t],r);return r}function k2(e,r,t){if(t&&t.biff<8)return N2(e,r,t);var a=Sl(e),i=Dx(e,r-22,a[1]);return{cmo:a,ft:i}}var b2={8:function(e,r){var t=e.l+r;e.l+=10;var a=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var i=e.read_shift(1);return e.l+=i,e.l=t,{fmt:a}}};function N2(e,r,t){e.l+=4;var a=e.read_shift(2),i=e.read_shift(2),c=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,r-=36;var u=[];return u.push((b2[a]||Rr)(e,r,t)),{cmo:[i,a,c],ft:u}}function F2(e,r,t){var a=e.l,i="";try{e.l+=4;var c=(t.lastobj||{cmo:[0,0]}).cmo[1],u;[0,5,7,11,12,14].indexOf(c)==-1?e.l+=6:u=vx(e,6,t);var d=e.read_shift(2);e.read_shift(2),or(e,2);var g=e.read_shift(2);e.l+=g;for(var m=1;m<e.lens.length-1;++m){if(e.l-a!=e.lens[m])throw new Error("TxO: bad continue record");var w=e[e.l],v=ya(e,e.lens[m+1]-e.lens[m]-1);if(i+=v,i.length>=(w?d:2*d))break}if(i.length!==d&&i.length!==d*2)throw new Error("cchText: "+d+" != "+i.length);return e.l=a+r,{t:i}}catch{return e.l=a+r,{t:i}}}function R2(e,r){var t=Hs(e);e.l+=16;var a=Tx(e,r-24);return[t,a]}function O2(e){var r=ve(24),t=Kt(e[0]);r.write_shift(2,t.r),r.write_shift(2,t.r),r.write_shift(2,t.c),r.write_shift(2,t.c);for(var a="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),i=0;i<16;++i)r.write_shift(1,parseInt(a[i],16));return mr([r,Sx(e[1])])}function D2(e,r){e.read_shift(2);var t=Hs(e),a=e.read_shift((r-10)/2,"dbcs-cont");return a=a.replace(Pr,""),[t,a]}function B2(e){var r=e[1].Tooltip,t=ve(10+2*(r.length+1));t.write_shift(2,2048);var a=Kt(e[0]);t.write_shift(2,a.r),t.write_shift(2,a.r),t.write_shift(2,a.c),t.write_shift(2,a.c);for(var i=0;i<r.length;++i)t.write_shift(2,r.charCodeAt(i));return t.write_shift(2,0),t}function M2(e){var r=[0,0],t;return t=e.read_shift(2),r[0]=zc[t]||t,t=e.read_shift(2),r[1]=zc[t]||t,r}function P2(e){return e||(e=ve(4)),e.write_shift(2,1),e.write_shift(2,1),e}function L2(e){for(var r=e.read_shift(2),t=[];r-- >0;)t.push(_l(e));return t}function U2(e){for(var r=e.read_shift(2),t=[];r-- >0;)t.push(_l(e));return t}function W2(e){e.l+=2;var r={cxfs:0,crc:0};return r.cxfs=e.read_shift(2),r.crc=e.read_shift(4),r}function Il(e,r,t){if(!t.cellStyles)return Rr(e,r);var a=t&&t.biff>=12?4:2,i=e.read_shift(a),c=e.read_shift(a),u=e.read_shift(a),d=e.read_shift(a),g=e.read_shift(2);a==2&&(e.l+=2);var m={s:i,e:c,w:u,ixfe:d,flags:g};return(t.biff>=5||!t.biff)&&(m.level=g>>8&7),m}function V2(e,r){var t=ve(12);t.write_shift(2,r),t.write_shift(2,r),t.write_shift(2,e.width*256),t.write_shift(2,0);var a=0;return e.hidden&&(a|=1),t.write_shift(1,a),a=e.level||0,t.write_shift(1,a),t.write_shift(2,0),t}function H2(e,r){var t={};return r<32||(e.l+=16,t.header=Nr(e),t.footer=Nr(e),e.l+=2),t}function G2(e,r,t){var a={area:!1};if(t.biff!=5)return e.l+=r,a;var i=e.read_shift(1);return e.l+=3,i&16&&(a.area=!0),a}function X2(e){for(var r=ve(2*e),t=0;t<e;++t)r.write_shift(2,t+1);return r}var z2=Dn,Y2=pl,K2=qi;function j2(e){var r=e.read_shift(2),t=e.read_shift(2),a=e.read_shift(4),i={fmt:r,env:t,len:a,data:e.slice(e.l,e.l+a)};return e.l+=a,i}function Z2(e,r,t){t.biffguess&&t.biff==5&&(t.biff=2);var a=Dn(e);++e.l;var i=Da(e,r-7,t);return a.t="str",a.val=i,a}function q2(e){var r=Dn(e);++e.l;var t=Nr(e);return r.t="n",r.val=t,r}function J2(e,r,t){var a=ve(15);return es(a,e,r),a.write_shift(8,t,"f"),a}function Q2(e){var r=Dn(e);++e.l;var t=e.read_shift(2);return r.t="n",r.val=t,r}function $2(e,r,t){var a=ve(9);return es(a,e,r),a.write_shift(2,t),a}function eg(e){var r=e.read_shift(1);return r===0?(e.l++,""):e.read_shift(r,"sbcs-cont")}function tg(e,r){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=r-13}function rg(e,r,t){var a=e.l+r,i=Dn(e),c=e.read_shift(2),u=ya(e,c,t);return e.l=a,i.t="str",i.val=u,i}var ng=[2,3,48,49,131,139,140,245],no=(function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},r=Us({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function t(d,g){var m=[],w=ia(1);switch(g.type){case"base64":w=Qr(en(d));break;case"binary":w=Qr(d);break;case"buffer":case"array":w=d;break}Ar(w,0);var v=w.read_shift(1),_=!!(v&136),C=!1,S=!1;switch(v){case 2:break;case 3:break;case 48:C=!0,_=!0;break;case 49:C=!0,_=!0;break;case 131:break;case 139:break;case 140:S=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+v.toString(16))}var A=0,y=521;v==2&&(A=w.read_shift(2)),w.l+=3,v!=2&&(A=w.read_shift(4)),A>1048576&&(A=1e6),v!=2&&(y=w.read_shift(2));var D=w.read_shift(2),P=g.codepage||1252;v!=2&&(w.l+=16,w.read_shift(1),w[w.l]!==0&&(P=e[w[w.l]]),w.l+=1,w.l+=2),S&&(w.l+=36);for(var b=[],V={},te=Math.min(w.length,v==2?521:y-10-(C?264:0)),W=S?32:11;w.l<te&&w[w.l]!=13;)switch(V={},V.name=Oi.utils.decode(P,w.slice(w.l,w.l+W)).replace(/[\u0000\r\n].*$/g,""),w.l+=W,V.type=String.fromCharCode(w.read_shift(1)),v!=2&&!S&&(V.offset=w.read_shift(4)),V.len=w.read_shift(1),v==2&&(V.offset=w.read_shift(2)),V.dec=w.read_shift(1),V.name.length&&b.push(V),v!=2&&(w.l+=S?13:14),V.type){case"B":(!C||V.len!=8)&&g.WTF&&console.log("Skipping "+V.name+":"+V.type);break;case"G":case"P":g.WTF&&console.log("Skipping "+V.name+":"+V.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+V.type)}if(w[w.l]!==13&&(w.l=y-1),w.read_shift(1)!==13)throw new Error("DBF Terminator not found "+w.l+" "+w[w.l]);w.l=y;var N=0,j=0;for(m[0]=[],j=0;j!=b.length;++j)m[0][j]=b[j].name;for(;A-- >0;){if(w[w.l]===42){w.l+=D;continue}for(++w.l,m[++N]=[],j=0,j=0;j!=b.length;++j){var O=w.slice(w.l,w.l+b[j].len);w.l+=b[j].len,Ar(O,0);var ae=Oi.utils.decode(P,O);switch(b[j].type){case"C":ae.trim().length&&(m[N][j]=ae.replace(/\s+$/,""));break;case"D":ae.length===8?m[N][j]=new Date(+ae.slice(0,4),+ae.slice(4,6)-1,+ae.slice(6,8)):m[N][j]=ae;break;case"F":m[N][j]=parseFloat(ae.trim());break;case"+":case"I":m[N][j]=S?O.read_shift(-4,"i")^2147483648:O.read_shift(4,"i");break;case"L":switch(ae.trim().toUpperCase()){case"Y":case"T":m[N][j]=!0;break;case"N":case"F":m[N][j]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+ae+"|")}break;case"M":if(!_)throw new Error("DBF Unexpected MEMO for type "+v.toString(16));m[N][j]="##MEMO##"+(S?parseInt(ae.trim(),10):O.read_shift(4));break;case"N":ae=ae.replace(/\u0000/g,"").trim(),ae&&ae!="."&&(m[N][j]=+ae||0);break;case"@":m[N][j]=new Date(O.read_shift(-8,"f")-621356832e5);break;case"T":m[N][j]=new Date((O.read_shift(4)-2440588)*864e5+O.read_shift(4));break;case"Y":m[N][j]=O.read_shift(4,"i")/1e4+O.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":m[N][j]=-O.read_shift(-8,"f");break;case"B":if(C&&b[j].len==8){m[N][j]=O.read_shift(8,"f");break}case"G":case"P":O.l+=b[j].len;break;case"0":if(b[j].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+b[j].type)}}}if(v!=2&&w.l<w.length&&w[w.l++]!=26)throw new Error("DBF EOF Marker missing "+(w.l-1)+" of "+w.length+" "+w[w.l-1].toString(16));return g&&g.sheetRows&&(m=m.slice(0,g.sheetRows)),g.DBF=b,m}function a(d,g){var m=g||{};m.dateNF||(m.dateNF="yyyymmdd");var w=si(t(d,m),m);return w["!cols"]=m.DBF.map(function(v){return{wch:v.len,DBF:v}}),delete m.DBF,w}function i(d,g){try{return la(a(d,g),g)}catch(m){if(g&&g.WTF)throw m}return{SheetNames:[],Sheets:{}}}var c={B:8,C:250,L:1,D:8,"?":0,"":0};function u(d,g){var m=g||{};if(+m.codepage>=0&&vn(+m.codepage),m.type=="string")throw new Error("Cannot write DBF to JS string");var w=Gr(),v=Os(d,{header:1,raw:!0,cellDates:!0}),_=v[0],C=v.slice(1),S=d["!cols"]||[],A=0,y=0,D=0,P=1;for(A=0;A<_.length;++A){if(((S[A]||{}).DBF||{}).name){_[A]=S[A].DBF.name,++D;continue}if(_[A]!=null){if(++D,typeof _[A]=="number"&&(_[A]=_[A].toString(10)),typeof _[A]!="string")throw new Error("DBF Invalid column name "+_[A]+" |"+typeof _[A]+"|");if(_.indexOf(_[A])!==A){for(y=0;y<1024;++y)if(_.indexOf(_[A]+"_"+y)==-1){_[A]+="_"+y;break}}}}var b=Ct(d["!ref"]),V=[],te=[],W=[];for(A=0;A<=b.e.c-b.s.c;++A){var N="",j="",O=0,ae=[];for(y=0;y<C.length;++y)C[y][A]!=null&&ae.push(C[y][A]);if(ae.length==0||_[A]==null){V[A]="?";continue}for(y=0;y<ae.length;++y){switch(typeof ae[y]){case"number":j="B";break;case"string":j="C";break;case"boolean":j="L";break;case"object":j=ae[y]instanceof Date?"D":"C";break;default:j="C"}O=Math.max(O,String(ae[y]).length),N=N&&N!=j?"C":j}O>250&&(O=250),j=((S[A]||{}).DBF||{}).type,j=="C"&&S[A].DBF.len>O&&(O=S[A].DBF.len),N=="B"&&j=="N"&&(N="N",W[A]=S[A].DBF.dec,O=S[A].DBF.len),te[A]=N=="C"||j=="N"?O:c[N]||0,P+=te[A],V[A]=N}var Q=w.next(32);for(Q.write_shift(4,318902576),Q.write_shift(4,C.length),Q.write_shift(2,296+32*D),Q.write_shift(2,P),A=0;A<4;++A)Q.write_shift(4,0);for(Q.write_shift(4,0|(+r[m1]||3)<<8),A=0,y=0;A<_.length;++A)if(_[A]!=null){var X=w.next(32),ie=(_[A].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);X.write_shift(1,ie,"sbcs"),X.write_shift(1,V[A]=="?"?"C":V[A],"sbcs"),X.write_shift(4,y),X.write_shift(1,te[A]||c[V[A]]||0),X.write_shift(1,W[A]||0),X.write_shift(1,2),X.write_shift(4,0),X.write_shift(1,0),X.write_shift(4,0),X.write_shift(4,0),y+=te[A]||c[V[A]]||0}var Ee=w.next(264);for(Ee.write_shift(4,13),A=0;A<65;++A)Ee.write_shift(4,0);for(A=0;A<C.length;++A){var q=w.next(P);for(q.write_shift(1,0),y=0;y<_.length;++y)if(_[y]!=null)switch(V[y]){case"L":q.write_shift(1,C[A][y]==null?63:C[A][y]?84:70);break;case"B":q.write_shift(8,C[A][y]||0,"f");break;case"N":var ue="0";for(typeof C[A][y]=="number"&&(ue=C[A][y].toFixed(W[y]||0)),D=0;D<te[y]-ue.length;++D)q.write_shift(1,32);q.write_shift(1,ue,"sbcs");break;case"D":C[A][y]?(q.write_shift(4,("0000"+C[A][y].getFullYear()).slice(-4),"sbcs"),q.write_shift(2,("00"+(C[A][y].getMonth()+1)).slice(-2),"sbcs"),q.write_shift(2,("00"+C[A][y].getDate()).slice(-2),"sbcs")):q.write_shift(8,"00000000","sbcs");break;case"C":var de=String(C[A][y]!=null?C[A][y]:"").slice(0,te[y]);for(q.write_shift(1,de,"sbcs"),D=0;D<te[y]-de.length;++D)q.write_shift(1,32);break}}return w.next(1).write_shift(1,26),w.end()}return{to_workbook:i,to_sheet:a,from_sheet:u}})(),kl=(function(){var e={AA:"À",BA:"Á",CA:"Â",DA:195,HA:"Ä",JA:197,AE:"È",BE:"É",CE:"Ê",HE:"Ë",AI:"Ì",BI:"Í",CI:"Î",HI:"Ï",AO:"Ò",BO:"Ó",CO:"Ô",DO:213,HO:"Ö",AU:"Ù",BU:"Ú",CU:"Û",HU:"Ü",Aa:"à",Ba:"á",Ca:"â",Da:227,Ha:"ä",Ja:229,Ae:"è",Be:"é",Ce:"ê",He:"ë",Ai:"ì",Bi:"í",Ci:"î",Hi:"ï",Ao:"ò",Bo:"ó",Co:"ô",Do:245,Ho:"ö",Au:"ù",Bu:"ú",Cu:"û",Hu:"ü",KC:"Ç",Kc:"ç",q:"æ",z:"œ",a:"Æ",j:"Œ",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},r=new RegExp("\x1BN("+$t(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),t=function(_,C){var S=e[C];return typeof S=="number"?wc(S):S},a=function(_,C,S){var A=C.charCodeAt(0)-32<<4|S.charCodeAt(0)-48;return A==59?_:wc(A)};e["|"]=254;function i(_,C){switch(C.type){case"base64":return c(en(_),C);case"binary":return c(_,C);case"buffer":return c(gt&&Buffer.isBuffer(_)?_.toString("binary"):fa(_),C);case"array":return c(Ta(_),C)}throw new Error("Unrecognized type "+C.type)}function c(_,C){var S=_.split(/[\n\r]+/),A=-1,y=-1,D=0,P=0,b=[],V=[],te=null,W={},N=[],j=[],O=[],ae=0,Q;for(+C.codepage>=0&&vn(+C.codepage);D!==S.length;++D){ae=0;var X=S[D].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,a).replace(r,t),ie=X.replace(/;;/g,"\0").split(";").map(function(ee){return ee.replace(/\u0000/g,";")}),Ee=ie[0],q;if(X.length>0)switch(Ee){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":ie[1].charAt(0)=="P"&&V.push(X.slice(3).replace(/;;/g,";"));break;case"C":var ue=!1,de=!1,We=!1,se=!1,Le=-1,Ge=-1;for(P=1;P<ie.length;++P)switch(ie[P].charAt(0)){case"A":break;case"X":y=parseInt(ie[P].slice(1))-1,de=!0;break;case"Y":for(A=parseInt(ie[P].slice(1))-1,de||(y=0),Q=b.length;Q<=A;++Q)b[Q]=[];break;case"K":q=ie[P].slice(1),q.charAt(0)==='"'?q=q.slice(1,q.length-1):q==="TRUE"?q=!0:q==="FALSE"?q=!1:isNaN(An(q))?isNaN(ti(q).getDate())||(q=Wt(q)):(q=An(q),te!==null&&ai(te)&&(q=Vs(q))),ue=!0;break;case"E":se=!0;var z=$a(ie[P].slice(1),{r:A,c:y});b[A][y]=[b[A][y],z];break;case"S":We=!0,b[A][y]=[b[A][y],"S5S"];break;case"G":break;case"R":Le=parseInt(ie[P].slice(1))-1;break;case"C":Ge=parseInt(ie[P].slice(1))-1;break;default:if(C&&C.WTF)throw new Error("SYLK bad record "+X)}if(ue&&(b[A][y]&&b[A][y].length==2?b[A][y][0]=q:b[A][y]=q,te=null),We){if(se)throw new Error("SYLK shared formula cannot have own formula");var ne=Le>-1&&b[Le][Ge];if(!ne||!ne[1])throw new Error("SYLK shared formula cannot find base");b[A][y][1]=Yl(ne[1],{r:A-Le,c:y-Ge})}break;case"F":var Z=0;for(P=1;P<ie.length;++P)switch(ie[P].charAt(0)){case"X":y=parseInt(ie[P].slice(1))-1,++Z;break;case"Y":for(A=parseInt(ie[P].slice(1))-1,Q=b.length;Q<=A;++Q)b[Q]=[];break;case"M":ae=parseInt(ie[P].slice(1))/20;break;case"F":break;case"G":break;case"P":te=V[parseInt(ie[P].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(O=ie[P].slice(1).split(" "),Q=parseInt(O[0],10);Q<=parseInt(O[1],10);++Q)ae=parseInt(O[2],10),j[Q-1]=ae===0?{hidden:!0}:{wch:ae},sa(j[Q-1]);break;case"C":y=parseInt(ie[P].slice(1))-1,j[y]||(j[y]={});break;case"R":A=parseInt(ie[P].slice(1))-1,N[A]||(N[A]={}),ae>0?(N[A].hpt=ae,N[A].hpx=ni(ae)):ae===0&&(N[A].hidden=!0);break;default:if(C&&C.WTF)throw new Error("SYLK bad record "+X)}Z<1&&(te=null);break;default:if(C&&C.WTF)throw new Error("SYLK bad record "+X)}}return N.length>0&&(W["!rows"]=N),j.length>0&&(W["!cols"]=j),C&&C.sheetRows&&(b=b.slice(0,C.sheetRows)),[b,W]}function u(_,C){var S=i(_,C),A=S[0],y=S[1],D=si(A,C);return $t(y).forEach(function(P){D[P]=y[P]}),D}function d(_,C){return la(u(_,C),C)}function g(_,C,S,A){var y="C;Y"+(S+1)+";X"+(A+1)+";K";switch(_.t){case"n":y+=_.v||0,_.f&&!_.F&&(y+=";E"+Uo(_.f,{r:S,c:A}));break;case"b":y+=_.v?"TRUE":"FALSE";break;case"e":y+=_.w||_.v;break;case"d":y+='"'+(_.w||_.v)+'"';break;case"s":y+='"'+_.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return y}function m(_,C){C.forEach(function(S,A){var y="F;W"+(A+1)+" "+(A+1)+" ";S.hidden?y+="0":(typeof S.width=="number"&&!S.wpx&&(S.wpx=Vi(S.width)),typeof S.wpx=="number"&&!S.wch&&(S.wch=Hi(S.wpx)),typeof S.wch=="number"&&(y+=Math.round(S.wch))),y.charAt(y.length-1)!=" "&&_.push(y)})}function w(_,C){C.forEach(function(S,A){var y="F;";S.hidden?y+="M0;":S.hpt?y+="M"+20*S.hpt+";":S.hpx&&(y+="M"+20*Gi(S.hpx)+";"),y.length>2&&_.push(y+"R"+(A+1))})}function v(_,C){var S=["ID;PWXL;N;E"],A=[],y=Ct(_["!ref"]),D,P=Array.isArray(_),b=`\r
`;S.push("P;PGeneral"),S.push("F;P0;DG0G8;M255"),_["!cols"]&&m(S,_["!cols"]),_["!rows"]&&w(S,_["!rows"]),S.push("B;Y"+(y.e.r-y.s.r+1)+";X"+(y.e.c-y.s.c+1)+";D"+[y.s.c,y.s.r,y.e.c,y.e.r].join(" "));for(var V=y.s.r;V<=y.e.r;++V)for(var te=y.s.c;te<=y.e.c;++te){var W=Qe({r:V,c:te});D=P?(_[V]||[])[te]:_[W],!(!D||D.v==null&&(!D.f||D.F))&&A.push(g(D,_,V,te))}return S.join(b)+b+A.join(b)+b+"E"+b}return{to_workbook:d,to_sheet:u,from_sheet:v}})(),bl=(function(){function e(c,u){switch(u.type){case"base64":return r(en(c),u);case"binary":return r(c,u);case"buffer":return r(gt&&Buffer.isBuffer(c)?c.toString("binary"):fa(c),u);case"array":return r(Ta(c),u)}throw new Error("Unrecognized type "+u.type)}function r(c,u){for(var d=c.split(`
`),g=-1,m=-1,w=0,v=[];w!==d.length;++w){if(d[w].trim()==="BOT"){v[++g]=[],m=0;continue}if(!(g<0)){var _=d[w].trim().split(","),C=_[0],S=_[1];++w;for(var A=d[w]||"";(A.match(/["]/g)||[]).length&1&&w<d.length-1;)A+=`
`+d[++w];switch(A=A.trim(),+C){case-1:if(A==="BOT"){v[++g]=[],m=0;continue}else if(A!=="EOD")throw new Error("Unrecognized DIF special command "+A);break;case 0:A==="TRUE"?v[g][m]=!0:A==="FALSE"?v[g][m]=!1:isNaN(An(S))?isNaN(ti(S).getDate())?v[g][m]=S:v[g][m]=Wt(S):v[g][m]=An(S),++m;break;case 1:A=A.slice(1,A.length-1),A=A.replace(/""/g,'"'),A&&A.match(/^=".*"$/)&&(A=A.slice(2,-1)),v[g][m++]=A!==""?A:null;break}if(A==="EOD")break}}return u&&u.sheetRows&&(v=v.slice(0,u.sheetRows)),v}function t(c,u){return si(e(c,u),u)}function a(c,u){return la(t(c,u),u)}var i=(function(){var c=function(g,m,w,v,_){g.push(m),g.push(w+","+v),g.push('"'+_.replace(/"/g,'""')+'"')},u=function(g,m,w,v){g.push(m+","+w),g.push(m==1?'"'+v.replace(/"/g,'""')+'"':v)};return function(g){var m=[],w=Ct(g["!ref"]),v,_=Array.isArray(g);c(m,"TABLE",0,1,"sheetjs"),c(m,"VECTORS",0,w.e.r-w.s.r+1,""),c(m,"TUPLES",0,w.e.c-w.s.c+1,""),c(m,"DATA",0,0,"");for(var C=w.s.r;C<=w.e.r;++C){u(m,-1,0,"BOT");for(var S=w.s.c;S<=w.e.c;++S){var A=Qe({r:C,c:S});if(v=_?(g[C]||[])[S]:g[A],!v){u(m,1,0,"");continue}switch(v.t){case"n":var y=v.w;!y&&v.v!=null&&(y=v.v),y==null?v.f&&!v.F?u(m,1,0,"="+v.f):u(m,1,0,""):u(m,0,y,"V");break;case"b":u(m,0,v.v?1:0,v.v?"TRUE":"FALSE");break;case"s":u(m,1,0,isNaN(v.v)?v.v:'="'+v.v+'"');break;case"d":v.w||(v.w=xn(v.z||qe[14],ur(Wt(v.v)))),u(m,0,v.w,"V");break;default:u(m,1,0,"")}}}u(m,-1,0,"EOD");var D=`\r
`,P=m.join(D);return P}})();return{to_workbook:a,to_sheet:t,from_sheet:i}})(),Nl=(function(){function e(v){return v.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function r(v){return v.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function t(v,_){for(var C=v.split(`
`),S=-1,A=-1,y=0,D=[];y!==C.length;++y){var P=C[y].trim().split(":");if(P[0]==="cell"){var b=Kt(P[1]);if(D.length<=b.r)for(S=D.length;S<=b.r;++S)D[S]||(D[S]=[]);switch(S=b.r,A=b.c,P[2]){case"t":D[S][A]=e(P[3]);break;case"v":D[S][A]=+P[3];break;case"vtf":var V=P[P.length-1];case"vtc":switch(P[3]){case"nl":D[S][A]=!!+P[4];break;default:D[S][A]=+P[4];break}P[2]=="vtf"&&(D[S][A]=[D[S][A],V])}}}return _&&_.sheetRows&&(D=D.slice(0,_.sheetRows)),D}function a(v,_){return si(t(v,_),_)}function i(v,_){return la(a(v,_),_)}var c=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),u=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,d=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),g="--SocialCalcSpreadsheetControlSave--";function m(v){if(!v||!v["!ref"])return"";for(var _=[],C=[],S,A="",y=Xr(v["!ref"]),D=Array.isArray(v),P=y.s.r;P<=y.e.r;++P)for(var b=y.s.c;b<=y.e.c;++b)if(A=Qe({r:P,c:b}),S=D?(v[P]||[])[b]:v[A],!(!S||S.v==null||S.t==="z")){switch(C=["cell",A,"t"],S.t){case"s":case"str":C.push(r(S.v));break;case"n":S.f?(C[2]="vtf",C[3]="n",C[4]=S.v,C[5]=r(S.f)):(C[2]="v",C[3]=S.v);break;case"b":C[2]="vt"+(S.f?"f":"c"),C[3]="nl",C[4]=S.v?"1":"0",C[5]=r(S.f||(S.v?"TRUE":"FALSE"));break;case"d":var V=ur(Wt(S.v));C[2]="vtc",C[3]="nd",C[4]=""+V,C[5]=S.w||xn(S.z||qe[14],V);break;case"e":continue}_.push(C.join(":"))}return _.push("sheet:c:"+(y.e.c-y.s.c+1)+":r:"+(y.e.r-y.s.r+1)+":tvf:1"),_.push("valueformat:1:text-wiki"),_.join(`
`)}function w(v){return[c,u,d,u,m(v),g].join(`
`)}return{to_workbook:i,to_sheet:a,from_sheet:w}})(),ri=(function(){function e(w,v,_,C,S){S.raw?v[_][C]=w:w===""||(w==="TRUE"?v[_][C]=!0:w==="FALSE"?v[_][C]=!1:isNaN(An(w))?isNaN(ti(w).getDate())?v[_][C]=w:v[_][C]=Wt(w):v[_][C]=An(w))}function r(w,v){var _=v||{},C=[];if(!w||w.length===0)return C;for(var S=w.split(/[\r\n]/),A=S.length-1;A>=0&&S[A].length===0;)--A;for(var y=10,D=0,P=0;P<=A;++P)D=S[P].indexOf(" "),D==-1?D=S[P].length:D++,y=Math.max(y,D);for(P=0;P<=A;++P){C[P]=[];var b=0;for(e(S[P].slice(0,y).trim(),C,P,b,_),b=1;b<=(S[P].length-y)/10+1;++b)e(S[P].slice(y+(b-1)*10,y+b*10).trim(),C,P,b,_)}return _.sheetRows&&(C=C.slice(0,_.sheetRows)),C}var t={44:",",9:"	",59:";",124:"|"},a={44:3,9:2,59:1,124:0};function i(w){for(var v={},_=!1,C=0,S=0;C<w.length;++C)(S=w.charCodeAt(C))==34?_=!_:!_&&S in t&&(v[S]=(v[S]||0)+1);S=[];for(C in v)Object.prototype.hasOwnProperty.call(v,C)&&S.push([v[C],C]);if(!S.length){v=a;for(C in v)Object.prototype.hasOwnProperty.call(v,C)&&S.push([v[C],C])}return S.sort(function(A,y){return A[0]-y[0]||a[A[1]]-a[y[1]]}),t[S.pop()[1]]||44}function c(w,v){var _=v||{},C="",S=_.dense?[]:{},A={s:{c:0,r:0},e:{c:0,r:0}};w.slice(0,4)=="sep="?w.charCodeAt(5)==13&&w.charCodeAt(6)==10?(C=w.charAt(4),w=w.slice(7)):w.charCodeAt(5)==13||w.charCodeAt(5)==10?(C=w.charAt(4),w=w.slice(6)):C=i(w.slice(0,1024)):_&&_.FS?C=_.FS:C=i(w.slice(0,1024));var y=0,D=0,P=0,b=0,V=0,te=C.charCodeAt(0),W=!1,N=0,j=w.charCodeAt(0);w=w.replace(/\r\n/mg,`
`);var O=_.dateNF!=null?Gh(_.dateNF):null;function ae(){var Q=w.slice(b,V),X={};if(Q.charAt(0)=='"'&&Q.charAt(Q.length-1)=='"'&&(Q=Q.slice(1,-1).replace(/""/g,'"')),Q.length===0)X.t="z";else if(_.raw)X.t="s",X.v=Q;else if(Q.trim().length===0)X.t="s",X.v=Q;else if(Q.charCodeAt(0)==61)Q.charCodeAt(1)==34&&Q.charCodeAt(Q.length-1)==34?(X.t="s",X.v=Q.slice(2,-1).replace(/""/g,'"')):wp(Q)?(X.t="n",X.f=Q.slice(1)):(X.t="s",X.v=Q);else if(Q=="TRUE")X.t="b",X.v=!0;else if(Q=="FALSE")X.t="b",X.v=!1;else if(!isNaN(P=An(Q)))X.t="n",_.cellText!==!1&&(X.w=Q),X.v=P;else if(!isNaN(ti(Q).getDate())||O&&Q.match(O)){X.z=_.dateNF||qe[14];var ie=0;O&&Q.match(O)&&(Q=Xh(Q,_.dateNF,Q.match(O)||[]),ie=1),_.cellDates?(X.t="d",X.v=Wt(Q,ie)):(X.t="n",X.v=ur(Wt(Q,ie))),_.cellText!==!1&&(X.w=xn(X.z,X.v instanceof Date?ur(X.v):X.v)),_.cellNF||delete X.z}else X.t="s",X.v=Q;if(X.t=="z"||(_.dense?(S[y]||(S[y]=[]),S[y][D]=X):S[Qe({c:D,r:y})]=X),b=V+1,j=w.charCodeAt(b),A.e.c<D&&(A.e.c=D),A.e.r<y&&(A.e.r=y),N==te)++D;else if(D=0,++y,_.sheetRows&&_.sheetRows<=y)return!0}e:for(;V<w.length;++V)switch(N=w.charCodeAt(V)){case 34:j===34&&(W=!W);break;case te:case 10:case 13:if(!W&&ae())break e;break}return V-b>0&&ae(),S["!ref"]=it(A),S}function u(w,v){return!(v&&v.PRN)||v.FS||w.slice(0,4)=="sep="||w.indexOf("	")>=0||w.indexOf(",")>=0||w.indexOf(";")>=0?c(w,v):si(r(w,v),v)}function d(w,v){var _="",C=v.type=="string"?[0,0,0,0]:Ko(w,v);switch(v.type){case"base64":_=en(w);break;case"binary":_=w;break;case"buffer":v.codepage==65001?_=w.toString("utf8"):v.codepage&&typeof Oi<"u"||(_=gt&&Buffer.isBuffer(w)?w.toString("binary"):fa(w));break;case"array":_=Ta(w);break;case"string":_=w;break;default:throw new Error("Unrecognized type "+v.type)}return C[0]==239&&C[1]==187&&C[2]==191?_=Nt(_.slice(3)):v.type!="string"&&v.type!="buffer"&&v.codepage==65001?_=Nt(_):v.type=="binary"&&typeof Oi<"u",_.slice(0,19)=="socialcalc:version:"?Nl.to_sheet(v.type=="string"?_:Nt(_),v):u(_,v)}function g(w,v){return la(d(w,v),v)}function m(w){for(var v=[],_=Ct(w["!ref"]),C,S=Array.isArray(w),A=_.s.r;A<=_.e.r;++A){for(var y=[],D=_.s.c;D<=_.e.c;++D){var P=Qe({r:A,c:D});if(C=S?(w[A]||[])[D]:w[P],!C||C.v==null){y.push("          ");continue}for(var b=(C.w||(Hn(C),C.w)||"").slice(0,10);b.length<10;)b+=" ";y.push(b+(D===0?" ":""))}v.push(y.join(""))}return v.join(`
`)}return{to_workbook:g,to_sheet:d,from_sheet:m}})();function ag(e,r){var t=r||{},a=!!t.WTF;t.WTF=!0;try{var i=kl.to_workbook(e,t);return t.WTF=a,i}catch(c){if(t.WTF=a,!c.message.match(/SYLK bad record ID/)&&a)throw c;return ri.to_workbook(e,r)}}var _a=(function(){function e(z,ne,Z){if(z){Ar(z,z.l||0);for(var ee=Z.Enum||Le;z.l<z.length;){var oe=z.read_shift(2),Ie=ee[oe]||ee[65535],Ae=z.read_shift(2),Te=z.l+Ae,Se=Ie.f&&Ie.f(z,Ae,Z);if(z.l=Te,ne(Se,Ie,oe))return}}}function r(z,ne){switch(ne.type){case"base64":return t(Qr(en(z)),ne);case"binary":return t(Qr(z),ne);case"buffer":case"array":return t(z,ne)}throw"Unsupported type "+ne.type}function t(z,ne){if(!z)return z;var Z=ne||{},ee=Z.dense?[]:{},oe="Sheet1",Ie="",Ae=0,Te={},Se=[],Ye=[],K={s:{r:0,c:0},e:{r:0,c:0}},Xe=Z.sheetRows||0;if(z[2]==0&&(z[3]==8||z[3]==9)&&z.length>=16&&z[14]==5&&z[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(z[2]==2)Z.Enum=Le,e(z,function(Ne,$e,rt){switch(rt){case 0:Z.vers=Ne,Ne>=4096&&(Z.qpro=!0);break;case 6:K=Ne;break;case 204:Ne&&(Ie=Ne);break;case 222:Ie=Ne;break;case 15:case 51:Z.qpro||(Ne[1].v=Ne[1].v.slice(1));case 13:case 14:case 16:rt==14&&(Ne[2]&112)==112&&(Ne[2]&15)>1&&(Ne[2]&15)<15&&(Ne[1].z=Z.dateNF||qe[14],Z.cellDates&&(Ne[1].t="d",Ne[1].v=Vs(Ne[1].v))),Z.qpro&&Ne[3]>Ae&&(ee["!ref"]=it(K),Te[oe]=ee,Se.push(oe),ee=Z.dense?[]:{},K={s:{r:0,c:0},e:{r:0,c:0}},Ae=Ne[3],oe=Ie||"Sheet"+(Ae+1),Ie="");var Dr=Z.dense?(ee[Ne[0].r]||[])[Ne[0].c]:ee[Qe(Ne[0])];if(Dr){Dr.t=Ne[1].t,Dr.v=Ne[1].v,Ne[1].z!=null&&(Dr.z=Ne[1].z),Ne[1].f!=null&&(Dr.f=Ne[1].f);break}Z.dense?(ee[Ne[0].r]||(ee[Ne[0].r]=[]),ee[Ne[0].r][Ne[0].c]=Ne[1]):ee[Qe(Ne[0])]=Ne[1];break}},Z);else if(z[2]==26||z[2]==14)Z.Enum=Ge,z[2]==14&&(Z.qpro=!0,z.l=0),e(z,function(Ne,$e,rt){switch(rt){case 204:oe=Ne;break;case 22:Ne[1].v=Ne[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(Ne[3]>Ae&&(ee["!ref"]=it(K),Te[oe]=ee,Se.push(oe),ee=Z.dense?[]:{},K={s:{r:0,c:0},e:{r:0,c:0}},Ae=Ne[3],oe="Sheet"+(Ae+1)),Xe>0&&Ne[0].r>=Xe)break;Z.dense?(ee[Ne[0].r]||(ee[Ne[0].r]=[]),ee[Ne[0].r][Ne[0].c]=Ne[1]):ee[Qe(Ne[0])]=Ne[1],K.e.c<Ne[0].c&&(K.e.c=Ne[0].c),K.e.r<Ne[0].r&&(K.e.r=Ne[0].r);break;case 27:Ne[14e3]&&(Ye[Ne[14e3][0]]=Ne[14e3][1]);break;case 1537:Ye[Ne[0]]=Ne[1],Ne[0]==Ae&&(oe=Ne[1]);break}},Z);else throw new Error("Unrecognized LOTUS BOF "+z[2]);if(ee["!ref"]=it(K),Te[Ie||oe]=ee,Se.push(Ie||oe),!Ye.length)return{SheetNames:Se,Sheets:Te};for(var st={},mt=[],nt=0;nt<Ye.length;++nt)Te[Se[nt]]?(mt.push(Ye[nt]||Se[nt]),st[Ye[nt]]=Te[Ye[nt]]||Te[Se[nt]]):(mt.push(Ye[nt]),st[Ye[nt]]={"!ref":"A1"});return{SheetNames:mt,Sheets:st}}function a(z,ne){var Z=ne||{};if(+Z.codepage>=0&&vn(+Z.codepage),Z.type=="string")throw new Error("Cannot write WK1 to JS string");var ee=Gr(),oe=Ct(z["!ref"]),Ie=Array.isArray(z),Ae=[];Pe(ee,0,c(1030)),Pe(ee,6,g(oe));for(var Te=Math.min(oe.e.r,8191),Se=oe.s.r;Se<=Te;++Se)for(var Ye=rr(Se),K=oe.s.c;K<=oe.e.c;++K){Se===oe.s.r&&(Ae[K]=Yt(K));var Xe=Ae[K]+Ye,st=Ie?(z[Se]||[])[K]:z[Xe];if(!(!st||st.t=="z"))if(st.t=="n")(st.v|0)==st.v&&st.v>=-32768&&st.v<=32767?Pe(ee,13,C(Se,K,st.v)):Pe(ee,14,A(Se,K,st.v));else{var mt=Hn(st);Pe(ee,15,v(Se,K,mt.slice(0,239)))}}return Pe(ee,1),ee.end()}function i(z,ne){var Z=ne||{};if(+Z.codepage>=0&&vn(+Z.codepage),Z.type=="string")throw new Error("Cannot write WK3 to JS string");var ee=Gr();Pe(ee,0,u(z));for(var oe=0,Ie=0;oe<z.SheetNames.length;++oe)(z.Sheets[z.SheetNames[oe]]||{})["!ref"]&&Pe(ee,27,se(z.SheetNames[oe],Ie++));var Ae=0;for(oe=0;oe<z.SheetNames.length;++oe){var Te=z.Sheets[z.SheetNames[oe]];if(!(!Te||!Te["!ref"])){for(var Se=Ct(Te["!ref"]),Ye=Array.isArray(Te),K=[],Xe=Math.min(Se.e.r,8191),st=Se.s.r;st<=Xe;++st)for(var mt=rr(st),nt=Se.s.c;nt<=Se.e.c;++nt){st===Se.s.r&&(K[nt]=Yt(nt));var Ne=K[nt]+mt,$e=Ye?(Te[st]||[])[nt]:Te[Ne];if(!(!$e||$e.t=="z"))if($e.t=="n")Pe(ee,23,ae(st,nt,Ae,$e.v));else{var rt=Hn($e);Pe(ee,22,N(st,nt,Ae,rt.slice(0,239)))}}++Ae}}return Pe(ee,1),ee.end()}function c(z){var ne=ve(2);return ne.write_shift(2,z),ne}function u(z){var ne=ve(26);ne.write_shift(2,4096),ne.write_shift(2,4),ne.write_shift(4,0);for(var Z=0,ee=0,oe=0,Ie=0;Ie<z.SheetNames.length;++Ie){var Ae=z.SheetNames[Ie],Te=z.Sheets[Ae];if(!(!Te||!Te["!ref"])){++oe;var Se=Xr(Te["!ref"]);Z<Se.e.r&&(Z=Se.e.r),ee<Se.e.c&&(ee=Se.e.c)}}return Z>8191&&(Z=8191),ne.write_shift(2,Z),ne.write_shift(1,oe),ne.write_shift(1,ee),ne.write_shift(2,0),ne.write_shift(2,0),ne.write_shift(1,1),ne.write_shift(1,2),ne.write_shift(4,0),ne.write_shift(4,0),ne}function d(z,ne,Z){var ee={s:{c:0,r:0},e:{c:0,r:0}};return ne==8&&Z.qpro?(ee.s.c=z.read_shift(1),z.l++,ee.s.r=z.read_shift(2),ee.e.c=z.read_shift(1),z.l++,ee.e.r=z.read_shift(2),ee):(ee.s.c=z.read_shift(2),ee.s.r=z.read_shift(2),ne==12&&Z.qpro&&(z.l+=2),ee.e.c=z.read_shift(2),ee.e.r=z.read_shift(2),ne==12&&Z.qpro&&(z.l+=2),ee.s.c==65535&&(ee.s.c=ee.e.c=ee.s.r=ee.e.r=0),ee)}function g(z){var ne=ve(8);return ne.write_shift(2,z.s.c),ne.write_shift(2,z.s.r),ne.write_shift(2,z.e.c),ne.write_shift(2,z.e.r),ne}function m(z,ne,Z){var ee=[{c:0,r:0},{t:"n",v:0},0,0];return Z.qpro&&Z.vers!=20768?(ee[0].c=z.read_shift(1),ee[3]=z.read_shift(1),ee[0].r=z.read_shift(2),z.l+=2):(ee[2]=z.read_shift(1),ee[0].c=z.read_shift(2),ee[0].r=z.read_shift(2)),ee}function w(z,ne,Z){var ee=z.l+ne,oe=m(z,ne,Z);if(oe[1].t="s",Z.vers==20768){z.l++;var Ie=z.read_shift(1);return oe[1].v=z.read_shift(Ie,"utf8"),oe}return Z.qpro&&z.l++,oe[1].v=z.read_shift(ee-z.l,"cstr"),oe}function v(z,ne,Z){var ee=ve(7+Z.length);ee.write_shift(1,255),ee.write_shift(2,ne),ee.write_shift(2,z),ee.write_shift(1,39);for(var oe=0;oe<ee.length;++oe){var Ie=Z.charCodeAt(oe);ee.write_shift(1,Ie>=128?95:Ie)}return ee.write_shift(1,0),ee}function _(z,ne,Z){var ee=m(z,ne,Z);return ee[1].v=z.read_shift(2,"i"),ee}function C(z,ne,Z){var ee=ve(7);return ee.write_shift(1,255),ee.write_shift(2,ne),ee.write_shift(2,z),ee.write_shift(2,Z,"i"),ee}function S(z,ne,Z){var ee=m(z,ne,Z);return ee[1].v=z.read_shift(8,"f"),ee}function A(z,ne,Z){var ee=ve(13);return ee.write_shift(1,255),ee.write_shift(2,ne),ee.write_shift(2,z),ee.write_shift(8,Z,"f"),ee}function y(z,ne,Z){var ee=z.l+ne,oe=m(z,ne,Z);if(oe[1].v=z.read_shift(8,"f"),Z.qpro)z.l=ee;else{var Ie=z.read_shift(2);V(z.slice(z.l,z.l+Ie),oe),z.l+=Ie}return oe}function D(z,ne,Z){var ee=ne&32768;return ne&=-32769,ne=(ee?z:0)+(ne>=8192?ne-16384:ne),(ee?"":"$")+(Z?Yt(ne):rr(ne))}var P={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},b=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function V(z,ne){Ar(z,0);for(var Z=[],ee=0,oe="",Ie="",Ae="",Te="";z.l<z.length;){var Se=z[z.l++];switch(Se){case 0:Z.push(z.read_shift(8,"f"));break;case 1:Ie=D(ne[0].c,z.read_shift(2),!0),oe=D(ne[0].r,z.read_shift(2),!1),Z.push(Ie+oe);break;case 2:{var Ye=D(ne[0].c,z.read_shift(2),!0),K=D(ne[0].r,z.read_shift(2),!1);Ie=D(ne[0].c,z.read_shift(2),!0),oe=D(ne[0].r,z.read_shift(2),!1),Z.push(Ye+K+":"+Ie+oe)}break;case 3:if(z.l<z.length){console.error("WK1 premature formula end");return}break;case 4:Z.push("("+Z.pop()+")");break;case 5:Z.push(z.read_shift(2));break;case 6:{for(var Xe="";Se=z[z.l++];)Xe+=String.fromCharCode(Se);Z.push('"'+Xe.replace(/"/g,'""')+'"')}break;case 8:Z.push("-"+Z.pop());break;case 23:Z.push("+"+Z.pop());break;case 22:Z.push("NOT("+Z.pop()+")");break;case 20:case 21:Te=Z.pop(),Ae=Z.pop(),Z.push(["AND","OR"][Se-20]+"("+Ae+","+Te+")");break;default:if(Se<32&&b[Se])Te=Z.pop(),Ae=Z.pop(),Z.push(Ae+b[Se]+Te);else if(P[Se]){if(ee=P[Se][1],ee==69&&(ee=z[z.l++]),ee>Z.length){console.error("WK1 bad formula parse 0x"+Se.toString(16)+":|"+Z.join("|")+"|");return}var st=Z.slice(-ee);Z.length-=ee,Z.push(P[Se][0]+"("+st.join(",")+")")}else return Se<=7?console.error("WK1 invalid opcode "+Se.toString(16)):Se<=24?console.error("WK1 unsupported op "+Se.toString(16)):Se<=30?console.error("WK1 invalid opcode "+Se.toString(16)):Se<=115?console.error("WK1 unsupported function opcode "+Se.toString(16)):console.error("WK1 unrecognized opcode "+Se.toString(16))}}Z.length==1?ne[1].f=""+Z[0]:console.error("WK1 bad formula parse |"+Z.join("|")+"|")}function te(z){var ne=[{c:0,r:0},{t:"n",v:0},0];return ne[0].r=z.read_shift(2),ne[3]=z[z.l++],ne[0].c=z[z.l++],ne}function W(z,ne){var Z=te(z);return Z[1].t="s",Z[1].v=z.read_shift(ne-4,"cstr"),Z}function N(z,ne,Z,ee){var oe=ve(6+ee.length);oe.write_shift(2,z),oe.write_shift(1,Z),oe.write_shift(1,ne),oe.write_shift(1,39);for(var Ie=0;Ie<ee.length;++Ie){var Ae=ee.charCodeAt(Ie);oe.write_shift(1,Ae>=128?95:Ae)}return oe.write_shift(1,0),oe}function j(z,ne){var Z=te(z);Z[1].v=z.read_shift(2);var ee=Z[1].v>>1;if(Z[1].v&1)switch(ee&7){case 0:ee=(ee>>3)*5e3;break;case 1:ee=(ee>>3)*500;break;case 2:ee=(ee>>3)/20;break;case 3:ee=(ee>>3)/200;break;case 4:ee=(ee>>3)/2e3;break;case 5:ee=(ee>>3)/2e4;break;case 6:ee=(ee>>3)/16;break;case 7:ee=(ee>>3)/64;break}return Z[1].v=ee,Z}function O(z,ne){var Z=te(z),ee=z.read_shift(4),oe=z.read_shift(4),Ie=z.read_shift(2);if(Ie==65535)return ee===0&&oe===3221225472?(Z[1].t="e",Z[1].v=15):ee===0&&oe===3489660928?(Z[1].t="e",Z[1].v=42):Z[1].v=0,Z;var Ae=Ie&32768;return Ie=(Ie&32767)-16446,Z[1].v=(1-Ae*2)*(oe*Math.pow(2,Ie+32)+ee*Math.pow(2,Ie)),Z}function ae(z,ne,Z,ee){var oe=ve(14);if(oe.write_shift(2,z),oe.write_shift(1,Z),oe.write_shift(1,ne),ee==0)return oe.write_shift(4,0),oe.write_shift(4,0),oe.write_shift(2,65535),oe;var Ie=0,Ae=0,Te=0,Se=0;return ee<0&&(Ie=1,ee=-ee),Ae=Math.log2(ee)|0,ee/=Math.pow(2,Ae-31),Se=ee>>>0,(Se&2147483648)==0&&(ee/=2,++Ae,Se=ee>>>0),ee-=Se,Se|=2147483648,Se>>>=0,ee*=Math.pow(2,32),Te=ee>>>0,oe.write_shift(4,Te),oe.write_shift(4,Se),Ae+=16383+(Ie?32768:0),oe.write_shift(2,Ae),oe}function Q(z,ne){var Z=O(z);return z.l+=ne-14,Z}function X(z,ne){var Z=te(z),ee=z.read_shift(4);return Z[1].v=ee>>6,Z}function ie(z,ne){var Z=te(z),ee=z.read_shift(8,"f");return Z[1].v=ee,Z}function Ee(z,ne){var Z=ie(z);return z.l+=ne-10,Z}function q(z,ne){return z[z.l+ne-1]==0?z.read_shift(ne,"cstr"):""}function ue(z,ne){var Z=z[z.l++];Z>ne-1&&(Z=ne-1);for(var ee="";ee.length<Z;)ee+=String.fromCharCode(z[z.l++]);return ee}function de(z,ne,Z){if(!(!Z.qpro||ne<21)){var ee=z.read_shift(1);z.l+=17,z.l+=1,z.l+=2;var oe=z.read_shift(ne-21,"cstr");return[ee,oe]}}function We(z,ne){for(var Z={},ee=z.l+ne;z.l<ee;){var oe=z.read_shift(2);if(oe==14e3){for(Z[oe]=[0,""],Z[oe][0]=z.read_shift(2);z[z.l];)Z[oe][1]+=String.fromCharCode(z[z.l]),z.l++;z.l++}}return Z}function se(z,ne){var Z=ve(5+z.length);Z.write_shift(2,14e3),Z.write_shift(2,ne);for(var ee=0;ee<z.length;++ee){var oe=z.charCodeAt(ee);Z[Z.l++]=oe>127?95:oe}return Z[Z.l++]=0,Z}var Le={0:{n:"BOF",f:or},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:d},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:_},14:{n:"NUMBER",f:S},15:{n:"LABEL",f:w},16:{n:"FORMULA",f:y},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:w},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:q},222:{n:"SHEETNAMELP",f:ue},65535:{n:""}},Ge={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:W},23:{n:"NUMBER17",f:O},24:{n:"NUMBER18",f:j},25:{n:"FORMULA19",f:Q},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:We},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:X},38:{n:"??"},39:{n:"NUMBER27",f:ie},40:{n:"FORMULA28",f:Ee},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:q},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:de},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:a,book_to_wk3:i,to_workbook:r}})();function ig(e){var r={},t=e.match(Or),a=0,i=!1;if(t)for(;a!=t.length;++a){var c=et(t[a]);switch(c[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!c.val)break;case"<shadow>":case"<shadow/>":r.shadow=1;break;case"</shadow>":break;case"<charset":if(c.val=="1")break;r.cp=fo[parseInt(c.val,10)];break;case"<outline":if(!c.val)break;case"<outline>":case"<outline/>":r.outline=1;break;case"</outline>":break;case"<rFont":r.name=c.val;break;case"<sz":r.sz=c.val;break;case"<strike":if(!c.val)break;case"<strike>":case"<strike/>":r.strike=1;break;case"</strike>":break;case"<u":if(!c.val)break;switch(c.val){case"double":r.uval="double";break;case"singleAccounting":r.uval="single-accounting";break;case"doubleAccounting":r.uval="double-accounting";break}case"<u>":case"<u/>":r.u=1;break;case"</u>":break;case"<b":if(c.val=="0")break;case"<b>":case"<b/>":r.b=1;break;case"</b>":break;case"<i":if(c.val=="0")break;case"<i>":case"<i/>":r.i=1;break;case"</i>":break;case"<color":c.rgb&&(r.color=c.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":r.family=c.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":r.valign=c.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(c[0].charCodeAt(1)!==47&&!i)throw new Error("Unrecognized rich format "+c[0])}}return r}var sg=(function(){var e=Mi("t"),r=Mi("rPr");function t(c){var u=c.match(e);if(!u)return{t:"s",v:""};var d={t:"s",v:At(u[1])},g=c.match(r);return g&&(d.s=ig(g[1])),d}var a=/<(?:\w+:)?r>/g,i=/<\/(?:\w+:)?r>/;return function(u){return u.replace(a,"").split(i).map(t).filter(function(d){return d.v})}})(),og=(function(){var r=/(\r\n|\n)/g;function t(i,c,u){var d=[];i.u&&d.push("text-decoration: underline;"),i.uval&&d.push("text-underline-style:"+i.uval+";"),i.sz&&d.push("font-size:"+i.sz+"pt;"),i.outline&&d.push("text-effect: outline;"),i.shadow&&d.push("text-shadow: auto;"),c.push('<span style="'+d.join("")+'">'),i.b&&(c.push("<b>"),u.push("</b>")),i.i&&(c.push("<i>"),u.push("</i>")),i.strike&&(c.push("<s>"),u.push("</s>"));var g=i.valign||"";return g=="superscript"||g=="super"?g="sup":g=="subscript"&&(g="sub"),g!=""&&(c.push("<"+g+">"),u.push("</"+g+">")),u.push("</span>"),i}function a(i){var c=[[],i.v,[]];return i.v?(i.s&&t(i.s,c[0],c[2]),c[0].join("")+c[1].replace(r,"<br/>")+c[2].join("")):""}return function(c){return c.map(a).join("")}})(),cg=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,fg=/<(?:\w+:)?r>/,lg=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function Do(e,r){var t=r?r.cellHTML:!0,a={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(a.t=At(Nt(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),a.r=Nt(e),t&&(a.h=vo(a.t))):e.match(fg)&&(a.r=Nt(e),a.t=At(Nt((e.replace(lg,"").match(cg)||[]).join("").replace(Or,""))),t&&(a.h=og(sg(a.r)))),a):{t:""}}var ug=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,hg=/<(?:\w+:)?(?:si|sstItem)>/g,dg=/<\/(?:\w+:)?(?:si|sstItem)>/;function xg(e,r){var t=[],a="";if(!e)return t;var i=e.match(ug);if(i){a=i[2].replace(hg,"").split(dg);for(var c=0;c!=a.length;++c){var u=Do(a[c].trim(),r);u!=null&&(t[t.length]=u)}i=et(i[1]),t.Count=i.count,t.Unique=i.uniqueCount}return t}var gg=/^\s|\s$|[\t\n\r]/;function Fl(e,r){if(!r.bookSST)return"";var t=[nr];t[t.length]=Me("sst",null,{xmlns:ba[0],count:e.Count,uniqueCount:e.Unique});for(var a=0;a!=e.length;++a)if(e[a]!=null){var i=e[a],c="<si>";i.r?c+=i.r:(c+="<t",i.t||(i.t=""),i.t.match(gg)&&(c+=' xml:space="preserve"'),c+=">"+kt(i.t)+"</t>"),c+="</si>",t[t.length]=c}return t.length>2&&(t[t.length]="</sst>",t[1]=t[1].replace("/>",">")),t.join("")}function mg(e){return[e.read_shift(4),e.read_shift(4)]}function pg(e,r){var t=[],a=!1;return Xn(e,function(c,u,d){switch(d){case 159:t.Count=c[0],t.Unique=c[1];break;case 19:t.push(c);break;case 160:return!0;case 35:a=!0;break;case 36:a=!1;break;default:if(u.T,!a||r.WTF)throw new Error("Unexpected record 0x"+d.toString(16))}}),t}function wg(e,r){return r||(r=ve(8)),r.write_shift(4,e.Count),r.write_shift(4,e.Unique),r}var Eg=bd;function vg(e){var r=Gr();Ce(r,159,wg(e));for(var t=0;t<e.length;++t)Ce(r,19,Eg(e[t]));return Ce(r,160),r.end()}function Rl(e){for(var r=[],t=e.split(""),a=0;a<t.length;++a)r[a]=t[a].charCodeAt(0);return r}function Vn(e,r){var t={};return t.Major=e.read_shift(2),t.Minor=e.read_shift(2),r>=4&&(e.l+=r-4),t}function _g(e){var r={};return r.id=e.read_shift(0,"lpp4"),r.R=Vn(e,4),r.U=Vn(e,4),r.W=Vn(e,4),r}function Ag(e){for(var r=e.read_shift(4),t=e.l+r-4,a={},i=e.read_shift(4),c=[];i-- >0;)c.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(a.name=e.read_shift(0,"lpp4"),a.comps=c,e.l!=t)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+t);return a}function Cg(e){var r=[];e.l+=4;for(var t=e.read_shift(4);t-- >0;)r.push(Ag(e));return r}function Tg(e){var r=[];e.l+=4;for(var t=e.read_shift(4);t-- >0;)r.push(e.read_shift(0,"lpp4"));return r}function Sg(e){var r={};return e.read_shift(4),e.l+=4,r.id=e.read_shift(0,"lpp4"),r.name=e.read_shift(0,"lpp4"),r.R=Vn(e,4),r.U=Vn(e,4),r.W=Vn(e,4),r}function yg(e){var r=Sg(e);if(r.ename=e.read_shift(0,"8lpp4"),r.blksz=e.read_shift(4),r.cmode=e.read_shift(4),e.read_shift(4)!=4)throw new Error("Bad !Primary record");return r}function Ol(e,r){var t=e.l+r,a={};a.Flags=e.read_shift(4)&63,e.l+=4,a.AlgID=e.read_shift(4);var i=!1;switch(a.AlgID){case 26126:case 26127:case 26128:i=a.Flags==36;break;case 26625:i=a.Flags==4;break;case 0:i=a.Flags==16||a.Flags==4||a.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+a.AlgID}if(!i)throw new Error("Encryption Flags/AlgID mismatch");return a.AlgIDHash=e.read_shift(4),a.KeySize=e.read_shift(4),a.ProviderType=e.read_shift(4),e.l+=8,a.CSPName=e.read_shift(t-e.l>>1,"utf16le"),e.l=t,a}function Dl(e,r){var t={},a=e.l+r;return e.l+=4,t.Salt=e.slice(e.l,e.l+16),e.l+=16,t.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),t.VerifierHash=e.slice(e.l,a),e.l=a,t}function Ig(e){var r=Vn(e);switch(r.Minor){case 2:return[r.Minor,kg(e)];case 3:return[r.Minor,bg()];case 4:return[r.Minor,Ng(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+r.Minor)}function kg(e){var r=e.read_shift(4);if((r&63)!=36)throw new Error("EncryptionInfo mismatch");var t=e.read_shift(4),a=Ol(e,t),i=Dl(e,e.length-e.l);return{t:"Std",h:a,v:i}}function bg(){throw new Error("File is password-protected: ECMA-376 Extensible")}function Ng(e){var r=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var t=e.read_shift(e.length-e.l,"utf8"),a={};return t.replace(Or,function(c){var u=et(c);switch(On(u[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":r.forEach(function(d){a[d]=u[d]});break;case"<dataIntegrity":a.encryptedHmacKey=u.encryptedHmacKey,a.encryptedHmacValue=u.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":a.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":a.uri=u.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":a.encs.push(u);break;default:throw u[0]}}),a}function Fg(e,r){var t={},a=t.EncryptionVersionInfo=Vn(e,4);if(r-=4,a.Minor!=2)throw new Error("unrecognized minor version code: "+a.Minor);if(a.Major>4||a.Major<2)throw new Error("unrecognized major version code: "+a.Major);t.Flags=e.read_shift(4),r-=4;var i=e.read_shift(4);return r-=4,t.EncryptionHeader=Ol(e,i),r-=i,t.EncryptionVerifier=Dl(e,r),t}function Rg(e){var r={},t=r.EncryptionVersionInfo=Vn(e,4);if(t.Major!=1||t.Minor!=1)throw"unrecognized version code "+t.Major+" : "+t.Minor;return r.Salt=e.read_shift(16),r.EncryptedVerifier=e.read_shift(16),r.EncryptedVerifierHash=e.read_shift(16),r}function Bo(e){var r=0,t,a=Rl(e),i=a.length+1,c,u,d,g,m;for(t=ia(i),t[0]=a.length,c=1;c!=i;++c)t[c]=a[c-1];for(c=i-1;c>=0;--c)u=t[c],d=(r&16384)===0?0:1,g=r<<1&32767,m=d|g,r=m^u;return r^52811}var Bl=(function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],r=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],t=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],a=function(u){return(u/2|u*128)&255},i=function(u,d){return a(u^d)},c=function(u){for(var d=r[u.length-1],g=104,m=u.length-1;m>=0;--m)for(var w=u[m],v=0;v!=7;++v)w&64&&(d^=t[g]),w*=2,--g;return d};return function(u){for(var d=Rl(u),g=c(d),m=d.length,w=ia(16),v=0;v!=16;++v)w[v]=0;var _,C,S;for((m&1)===1&&(_=g>>8,w[m]=i(e[0],_),--m,_=g&255,C=d[d.length-1],w[m]=i(C,_));m>0;)--m,_=g>>8,w[m]=i(d[m],_),--m,_=g&255,w[m]=i(d[m],_);for(m=15,S=15-d.length;S>0;)_=g>>8,w[m]=i(e[S],_),--m,--S,_=g&255,w[m]=i(d[m],_),--m,--S;return w}})(),Og=function(e,r,t,a,i){i||(i=r),a||(a=Bl(e));var c,u;for(c=0;c!=r.length;++c)u=r[c],u^=a[t],u=(u>>5|u<<3)&255,i[c]=u,++t;return[i,t,a]},Dg=function(e){var r=0,t=Bl(e);return function(a){var i=Og("",a,r,t);return r=i[1],i[0]}};function Bg(e,r,t,a){var i={key:or(e),verificationBytes:or(e)};return t.password&&(i.verifier=Bo(t.password)),a.valid=i.verificationBytes===i.verifier,a.valid&&(a.insitu=Dg(t.password)),i}function Mg(e,r,t){var a=t||{};return a.Info=e.read_shift(2),e.l-=2,a.Info===1?a.Data=Rg(e):a.Data=Fg(e,r),a}function Pg(e,r,t){var a={Type:t.biff>=8?e.read_shift(2):0};return a.Type?Mg(e,r-2,a):Bg(e,t.biff>=8?r:r-2,t,a),a}var Ml=(function(){function e(i,c){switch(c.type){case"base64":return r(en(i),c);case"binary":return r(i,c);case"buffer":return r(gt&&Buffer.isBuffer(i)?i.toString("binary"):fa(i),c);case"array":return r(Ta(i),c)}throw new Error("Unrecognized type "+c.type)}function r(i,c){var u=c||{},d=u.dense?[]:{},g=i.match(/\\trowd.*?\\row\b/g);if(!g.length)throw new Error("RTF missing table");var m={s:{c:0,r:0},e:{c:0,r:g.length-1}};return g.forEach(function(w,v){Array.isArray(d)&&(d[v]=[]);for(var _=/\\\w+\b/g,C=0,S,A=-1;S=_.exec(w);){switch(S[0]){case"\\cell":var y=w.slice(C,_.lastIndex-S[0].length);if(y[0]==" "&&(y=y.slice(1)),++A,y.length){var D={v:y,t:"s"};Array.isArray(d)?d[v][A]=D:d[Qe({r:v,c:A})]=D}break}C=_.lastIndex}A>m.e.c&&(m.e.c=A)}),d["!ref"]=it(m),d}function t(i,c){return la(e(i,c),c)}function a(i){for(var c=["{\\rtf1\\ansi"],u=Ct(i["!ref"]),d,g=Array.isArray(i),m=u.s.r;m<=u.e.r;++m){c.push("\\trowd\\trautofit1");for(var w=u.s.c;w<=u.e.c;++w)c.push("\\cellx"+(w+1));for(c.push("\\pard\\intbl"),w=u.s.c;w<=u.e.c;++w){var v=Qe({r:m,c:w});d=g?(i[m]||[])[w]:i[v],!(!d||d.v==null&&(!d.f||d.F))&&(c.push(" "+(d.w||(Hn(d),d.w))),c.push("\\cell"))}c.push("\\pard\\intbl\\row")}return c.join("")+"}"}return{to_workbook:t,to_sheet:e,from_sheet:a}})();function Lg(e){var r=e.slice(e[0]==="#"?1:0).slice(0,6);return[parseInt(r.slice(0,2),16),parseInt(r.slice(2,4),16),parseInt(r.slice(4,6),16)]}function Wi(e){for(var r=0,t=1;r!=3;++r)t=t*256+(e[r]>255?255:e[r]<0?0:e[r]);return t.toString(16).toUpperCase().slice(1)}function Ug(e){var r=e[0]/255,t=e[1]/255,a=e[2]/255,i=Math.max(r,t,a),c=Math.min(r,t,a),u=i-c;if(u===0)return[0,0,r];var d=0,g=0,m=i+c;switch(g=u/(m>1?2-m:m),i){case r:d=((t-a)/u+6)%6;break;case t:d=(a-r)/u+2;break;case a:d=(r-t)/u+4;break}return[d/6,g,m/2]}function Wg(e){var r=e[0],t=e[1],a=e[2],i=t*2*(a<.5?a:1-a),c=a-i/2,u=[c,c,c],d=6*r,g;if(t!==0)switch(d|0){case 0:case 6:g=i*d,u[0]+=i,u[1]+=g;break;case 1:g=i*(2-d),u[0]+=g,u[1]+=i;break;case 2:g=i*(d-2),u[1]+=i,u[2]+=g;break;case 3:g=i*(4-d),u[1]+=g,u[2]+=i;break;case 4:g=i*(d-4),u[2]+=i,u[0]+=g;break;case 5:g=i*(6-d),u[2]+=g,u[0]+=i;break}for(var m=0;m!=3;++m)u[m]=Math.round(u[m]*255);return u}function Fs(e,r){if(r===0)return e;var t=Ug(Lg(e));return r<0?t[2]=t[2]*(1+r):t[2]=1-(1-t[2])*(1-r),Wi(Wg(t))}var Pl=6,Vg=15,Hg=1,br=Pl;function Vi(e){return Math.floor((e+Math.round(128/br)/256)*br)}function Hi(e){return Math.floor((e-5)/br*100+.5)/100}function Rs(e){return Math.round((e*br+5)/br*256)/256}function m0(e){return Rs(Hi(Vi(e)))}function Mo(e){var r=Math.abs(e-m0(e)),t=br;if(r>.005)for(br=Hg;br<Vg;++br)Math.abs(e-m0(e))<=r&&(r=Math.abs(e-m0(e)),t=br);br=t}function sa(e){e.width?(e.wpx=Vi(e.width),e.wch=Hi(e.wpx),e.MDW=br):e.wpx?(e.wch=Hi(e.wpx),e.width=Rs(e.wch),e.MDW=br):typeof e.wch=="number"&&(e.width=Rs(e.wch),e.wpx=Vi(e.width),e.MDW=br),e.customWidth&&delete e.customWidth}var Gg=96,Ll=Gg;function Gi(e){return e*96/Ll}function ni(e){return e*Ll/96}var Xg={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function zg(e,r,t,a){r.Borders=[];var i={},c=!1;(e[0].match(Or)||[]).forEach(function(u){var d=et(u);switch(On(d[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":i={},d.diagonalUp&&(i.diagonalUp=Ut(d.diagonalUp)),d.diagonalDown&&(i.diagonalDown=Ut(d.diagonalDown)),r.Borders.push(i);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":c=!0;break;case"</ext>":c=!1;break;default:if(a&&a.WTF&&!c)throw new Error("unrecognized "+d[0]+" in borders")}})}function Yg(e,r,t,a){r.Fills=[];var i={},c=!1;(e[0].match(Or)||[]).forEach(function(u){var d=et(u);switch(On(d[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":i={},r.Fills.push(i);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":r.Fills.push(i),i={};break;case"<patternFill":case"<patternFill>":d.patternType&&(i.patternType=d.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":i.bgColor||(i.bgColor={}),d.indexed&&(i.bgColor.indexed=parseInt(d.indexed,10)),d.theme&&(i.bgColor.theme=parseInt(d.theme,10)),d.tint&&(i.bgColor.tint=parseFloat(d.tint)),d.rgb&&(i.bgColor.rgb=d.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":i.fgColor||(i.fgColor={}),d.theme&&(i.fgColor.theme=parseInt(d.theme,10)),d.tint&&(i.fgColor.tint=parseFloat(d.tint)),d.rgb!=null&&(i.fgColor.rgb=d.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":c=!0;break;case"</ext>":c=!1;break;default:if(a&&a.WTF&&!c)throw new Error("unrecognized "+d[0]+" in fills")}})}function Kg(e,r,t,a){r.Fonts=[];var i={},c=!1;(e[0].match(Or)||[]).forEach(function(u){var d=et(u);switch(On(d[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":r.Fonts.push(i),i={};break;case"<name":d.val&&(i.name=Nt(d.val));break;case"<name/>":case"</name>":break;case"<b":i.bold=d.val?Ut(d.val):1;break;case"<b/>":i.bold=1;break;case"<i":i.italic=d.val?Ut(d.val):1;break;case"<i/>":i.italic=1;break;case"<u":switch(d.val){case"none":i.underline=0;break;case"single":i.underline=1;break;case"double":i.underline=2;break;case"singleAccounting":i.underline=33;break;case"doubleAccounting":i.underline=34;break}break;case"<u/>":i.underline=1;break;case"<strike":i.strike=d.val?Ut(d.val):1;break;case"<strike/>":i.strike=1;break;case"<outline":i.outline=d.val?Ut(d.val):1;break;case"<outline/>":i.outline=1;break;case"<shadow":i.shadow=d.val?Ut(d.val):1;break;case"<shadow/>":i.shadow=1;break;case"<condense":i.condense=d.val?Ut(d.val):1;break;case"<condense/>":i.condense=1;break;case"<extend":i.extend=d.val?Ut(d.val):1;break;case"<extend/>":i.extend=1;break;case"<sz":d.val&&(i.sz=+d.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":d.val&&(i.vertAlign=d.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":d.val&&(i.family=parseInt(d.val,10));break;case"<family/>":case"</family>":break;case"<scheme":d.val&&(i.scheme=d.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(d.val=="1")break;d.codepage=fo[parseInt(d.val,10)];break;case"<color":if(i.color||(i.color={}),d.auto&&(i.color.auto=Ut(d.auto)),d.rgb)i.color.rgb=d.rgb.slice(-6);else if(d.indexed){i.color.index=parseInt(d.indexed,10);var g=Ea[i.color.index];i.color.index==81&&(g=Ea[1]),g||(g=Ea[1]),i.color.rgb=g[0].toString(16)+g[1].toString(16)+g[2].toString(16)}else d.theme&&(i.color.theme=parseInt(d.theme,10),d.tint&&(i.color.tint=parseFloat(d.tint)),d.theme&&t.themeElements&&t.themeElements.clrScheme&&(i.color.rgb=Fs(t.themeElements.clrScheme[i.color.theme].rgb,i.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":c=!0;break;case"</AlternateContent>":c=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":c=!0;break;case"</ext>":c=!1;break;default:if(a&&a.WTF&&!c)throw new Error("unrecognized "+d[0]+" in fonts")}})}function jg(e,r,t){r.NumberFmt=[];for(var a=$t(qe),i=0;i<a.length;++i)r.NumberFmt[a[i]]=qe[a[i]];var c=e[0].match(Or);if(c)for(i=0;i<c.length;++i){var u=et(c[i]);switch(On(u[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var d=At(Nt(u.formatCode)),g=parseInt(u.numFmtId,10);if(r.NumberFmt[g]=d,g>0){if(g>392){for(g=392;g>60&&r.NumberFmt[g]!=null;--g);r.NumberFmt[g]=d}Wn(d,g)}}break;case"</numFmt>":break;default:if(t.WTF)throw new Error("unrecognized "+u[0]+" in numFmts")}}}function Zg(e){var r=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(t){for(var a=t[0];a<=t[1];++a)e[a]!=null&&(r[r.length]=Me("numFmt",null,{numFmtId:a,formatCode:kt(e[a])}))}),r.length===1?"":(r[r.length]="</numFmts>",r[0]=Me("numFmts",null,{count:r.length-2}).replace("/>",">"),r.join(""))}var ms=["numFmtId","fillId","fontId","borderId","xfId"],ps=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function qg(e,r,t){r.CellXf=[];var a,i=!1;(e[0].match(Or)||[]).forEach(function(c){var u=et(c),d=0;switch(On(u[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(a=u,delete a[0],d=0;d<ms.length;++d)a[ms[d]]&&(a[ms[d]]=parseInt(a[ms[d]],10));for(d=0;d<ps.length;++d)a[ps[d]]&&(a[ps[d]]=Ut(a[ps[d]]));if(r.NumberFmt&&a.numFmtId>392){for(d=392;d>60;--d)if(r.NumberFmt[a.numFmtId]==r.NumberFmt[d]){a.numFmtId=d;break}}r.CellXf.push(a);break;case"</xf>":break;case"<alignment":case"<alignment/>":var g={};u.vertical&&(g.vertical=u.vertical),u.horizontal&&(g.horizontal=u.horizontal),u.textRotation!=null&&(g.textRotation=u.textRotation),u.indent&&(g.indent=u.indent),u.wrapText&&(g.wrapText=Ut(u.wrapText)),a.alignment=g;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":i=!0;break;case"</AlternateContent>":i=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(t&&t.WTF&&!i)throw new Error("unrecognized "+u[0]+" in cellXfs")}})}function Jg(e){var r=[];return r[r.length]=Me("cellXfs",null),e.forEach(function(t){r[r.length]=Me("xf",null,t)}),r[r.length]="</cellXfs>",r.length===2?"":(r[0]=Me("cellXfs",null,{count:r.length-2}).replace("/>",">"),r.join(""))}var Qg=(function(){var r=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,t=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,a=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,i=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,c=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(d,g,m){var w={};if(!d)return w;d=d.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var v;return(v=d.match(r))&&jg(v,w,m),(v=d.match(i))&&Kg(v,w,g,m),(v=d.match(a))&&Yg(v,w,g,m),(v=d.match(c))&&zg(v,w,g,m),(v=d.match(t))&&qg(v,w,m),w}})();function Ul(e,r){var t=[nr,Me("styleSheet",null,{xmlns:ba[0],"xmlns:vt":lr.vt})],a;return e.SSF&&(a=Zg(e.SSF))!=null&&(t[t.length]=a),t[t.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',t[t.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',t[t.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',t[t.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(a=Jg(r.cellXfs))&&(t[t.length]=a),t[t.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',t[t.length]='<dxfs count="0"/>',t[t.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',t.length>2&&(t[t.length]="</styleSheet>",t[1]=t[1].replace("/>",">")),t.join("")}function $g(e,r){var t=e.read_shift(2),a=Fr(e);return[t,a]}function em(e,r,t){t||(t=ve(6+4*r.length)),t.write_shift(2,e),pr(r,t);var a=t.length>t.l?t.slice(0,t.l):t;return t.l==null&&(t.l=t.length),a}function tm(e,r,t){var a={};a.sz=e.read_shift(2)/20;var i=Md(e);i.fItalic&&(a.italic=1),i.fCondense&&(a.condense=1),i.fExtend&&(a.extend=1),i.fShadow&&(a.shadow=1),i.fOutline&&(a.outline=1),i.fStrikeout&&(a.strike=1);var c=e.read_shift(2);switch(c===700&&(a.bold=1),e.read_shift(2)){case 1:a.vertAlign="superscript";break;case 2:a.vertAlign="subscript";break}var u=e.read_shift(1);u!=0&&(a.underline=u);var d=e.read_shift(1);d>0&&(a.family=d);var g=e.read_shift(1);switch(g>0&&(a.charset=g),e.l++,a.color=Bd(e),e.read_shift(1)){case 1:a.scheme="major";break;case 2:a.scheme="minor";break}return a.name=Fr(e),a}function rm(e,r){r||(r=ve(153)),r.write_shift(2,e.sz*20),Pd(e,r),r.write_shift(2,e.bold?700:400);var t=0;e.vertAlign=="superscript"?t=1:e.vertAlign=="subscript"&&(t=2),r.write_shift(2,t),r.write_shift(1,e.underline||0),r.write_shift(1,e.family||0),r.write_shift(1,e.charset||0),r.write_shift(1,0),ks(e.color,r);var a=0;return a=2,r.write_shift(1,a),pr(e.name,r),r.length>r.l?r.slice(0,r.l):r}var nm=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],p0,am=Rr;function ff(e,r){r||(r=ve(84)),p0||(p0=Us(nm));var t=p0[e.patternType];t==null&&(t=40),r.write_shift(4,t);var a=0;if(t!=40)for(ks({auto:1},r),ks({auto:1},r);a<12;++a)r.write_shift(4,0);else{for(;a<4;++a)r.write_shift(4,0);for(;a<12;++a)r.write_shift(4,0)}return r.length>r.l?r.slice(0,r.l):r}function im(e,r){var t=e.l+r,a=e.read_shift(2),i=e.read_shift(2);return e.l=t,{ixfe:a,numFmtId:i}}function Wl(e,r,t){t||(t=ve(16)),t.write_shift(2,r||0),t.write_shift(2,e.numFmtId||0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);var a=0;return t.write_shift(1,a),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(1,0),t}function Ei(e,r){return r||(r=ve(10)),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(4,0),r}var sm=Rr;function om(e,r){return r||(r=ve(51)),r.write_shift(1,0),Ei(null,r),Ei(null,r),Ei(null,r),Ei(null,r),Ei(null,r),r.length>r.l?r.slice(0,r.l):r}function cm(e,r){return r||(r=ve(52)),r.write_shift(4,e.xfId),r.write_shift(2,1),r.write_shift(1,0),r.write_shift(1,0),Is(e.name||"",r),r.length>r.l?r.slice(0,r.l):r}function fm(e,r,t){var a=ve(2052);return a.write_shift(4,e),Is(r,a),Is(t,a),a.length>a.l?a.slice(0,a.l):a}function lm(e,r,t){var a={};a.NumberFmt=[];for(var i in qe)a.NumberFmt[i]=qe[i];a.CellXf=[],a.Fonts=[];var c=[],u=!1;return Xn(e,function(g,m,w){switch(w){case 44:a.NumberFmt[g[0]]=g[1],Wn(g[1],g[0]);break;case 43:a.Fonts.push(g),g.color.theme!=null&&r&&r.themeElements&&r.themeElements.clrScheme&&(g.color.rgb=Fs(r.themeElements.clrScheme[g.color.theme].rgb,g.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:c[c.length-1]==617&&a.CellXf.push(g);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:u=!0;break;case 36:u=!1;break;case 37:c.push(w),u=!0;break;case 38:c.pop(),u=!1;break;default:if(m.T>0)c.push(w);else if(m.T<0)c.pop();else if(!u||t.WTF&&c[c.length-1]!=37)throw new Error("Unexpected record 0x"+w.toString(16))}}),a}function um(e,r){if(r){var t=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(a){for(var i=a[0];i<=a[1];++i)r[i]!=null&&++t}),t!=0&&(Ce(e,615,Cn(t)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(a){for(var i=a[0];i<=a[1];++i)r[i]!=null&&Ce(e,44,em(i,r[i]))}),Ce(e,616))}}function hm(e){var r=1;Ce(e,611,Cn(r)),Ce(e,43,rm({sz:12,color:{theme:1},name:"Calibri",family:2})),Ce(e,612)}function dm(e){var r=2;Ce(e,603,Cn(r)),Ce(e,45,ff({patternType:"none"})),Ce(e,45,ff({patternType:"gray125"})),Ce(e,604)}function xm(e){var r=1;Ce(e,613,Cn(r)),Ce(e,46,om()),Ce(e,614)}function gm(e){var r=1;Ce(e,626,Cn(r)),Ce(e,47,Wl({numFmtId:0},65535)),Ce(e,627)}function mm(e,r){Ce(e,617,Cn(r.length)),r.forEach(function(t){Ce(e,47,Wl(t,0))}),Ce(e,618)}function pm(e){var r=1;Ce(e,619,Cn(r)),Ce(e,48,cm({xfId:0,name:"Normal"})),Ce(e,620)}function wm(e){var r=0;Ce(e,505,Cn(r)),Ce(e,506)}function Em(e){var r=0;Ce(e,508,fm(r,"TableStyleMedium9","PivotStyleMedium4")),Ce(e,509)}function vm(e,r){var t=Gr();return Ce(t,278),um(t,e.SSF),hm(t),dm(t),xm(t),gm(t),mm(t,r.cellXfs),pm(t),wm(t),Em(t),Ce(t,279),t.end()}var _m=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function Am(e,r,t){r.themeElements.clrScheme=[];var a={};(e[0].match(Or)||[]).forEach(function(i){var c=et(i);switch(c[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":a.rgb=c.val;break;case"<a:sysClr":a.rgb=c.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":c[0].charAt(1)==="/"?(r.themeElements.clrScheme[_m.indexOf(c[0])]=a,a={}):a.name=c[0].slice(3,c[0].length-1);break;default:if(t&&t.WTF)throw new Error("Unrecognized "+c[0]+" in clrScheme")}})}function Cm(){}function Tm(){}var Sm=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,ym=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,Im=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function km(e,r,t){r.themeElements={};var a;[["clrScheme",Sm,Am],["fontScheme",ym,Cm],["fmtScheme",Im,Tm]].forEach(function(i){if(!(a=e.match(i[1])))throw new Error(i[0]+" not found in themeElements");i[2](a,r,t)})}var bm=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function Vl(e,r){(!e||e.length===0)&&(e=Po());var t,a={};if(!(t=e.match(bm)))throw new Error("themeElements not found in theme");return km(t[0],a,r),a.raw=e,a}function Po(e,r){if(r&&r.themeXLSX)return r.themeXLSX;if(e&&typeof e.raw=="string")return e.raw;var t=[nr];return t[t.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',t[t.length]="<a:themeElements>",t[t.length]='<a:clrScheme name="Office">',t[t.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',t[t.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',t[t.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',t[t.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',t[t.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',t[t.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',t[t.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',t[t.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',t[t.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',t[t.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',t[t.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',t[t.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',t[t.length]="</a:clrScheme>",t[t.length]='<a:fontScheme name="Office">',t[t.length]="<a:majorFont>",t[t.length]='<a:latin typeface="Cambria"/>',t[t.length]='<a:ea typeface=""/>',t[t.length]='<a:cs typeface=""/>',t[t.length]='<a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/>',t[t.length]='<a:font script="Hang" typeface="맑은 고딕"/>',t[t.length]='<a:font script="Hans" typeface="宋体"/>',t[t.length]='<a:font script="Hant" typeface="新細明體"/>',t[t.length]='<a:font script="Arab" typeface="Times New Roman"/>',t[t.length]='<a:font script="Hebr" typeface="Times New Roman"/>',t[t.length]='<a:font script="Thai" typeface="Tahoma"/>',t[t.length]='<a:font script="Ethi" typeface="Nyala"/>',t[t.length]='<a:font script="Beng" typeface="Vrinda"/>',t[t.length]='<a:font script="Gujr" typeface="Shruti"/>',t[t.length]='<a:font script="Khmr" typeface="MoolBoran"/>',t[t.length]='<a:font script="Knda" typeface="Tunga"/>',t[t.length]='<a:font script="Guru" typeface="Raavi"/>',t[t.length]='<a:font script="Cans" typeface="Euphemia"/>',t[t.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',t[t.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',t[t.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',t[t.length]='<a:font script="Thaa" typeface="MV Boli"/>',t[t.length]='<a:font script="Deva" typeface="Mangal"/>',t[t.length]='<a:font script="Telu" typeface="Gautami"/>',t[t.length]='<a:font script="Taml" typeface="Latha"/>',t[t.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',t[t.length]='<a:font script="Orya" typeface="Kalinga"/>',t[t.length]='<a:font script="Mlym" typeface="Kartika"/>',t[t.length]='<a:font script="Laoo" typeface="DokChampa"/>',t[t.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',t[t.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',t[t.length]='<a:font script="Viet" typeface="Times New Roman"/>',t[t.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',t[t.length]='<a:font script="Geor" typeface="Sylfaen"/>',t[t.length]="</a:majorFont>",t[t.length]="<a:minorFont>",t[t.length]='<a:latin typeface="Calibri"/>',t[t.length]='<a:ea typeface=""/>',t[t.length]='<a:cs typeface=""/>',t[t.length]='<a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/>',t[t.length]='<a:font script="Hang" typeface="맑은 고딕"/>',t[t.length]='<a:font script="Hans" typeface="宋体"/>',t[t.length]='<a:font script="Hant" typeface="新細明體"/>',t[t.length]='<a:font script="Arab" typeface="Arial"/>',t[t.length]='<a:font script="Hebr" typeface="Arial"/>',t[t.length]='<a:font script="Thai" typeface="Tahoma"/>',t[t.length]='<a:font script="Ethi" typeface="Nyala"/>',t[t.length]='<a:font script="Beng" typeface="Vrinda"/>',t[t.length]='<a:font script="Gujr" typeface="Shruti"/>',t[t.length]='<a:font script="Khmr" typeface="DaunPenh"/>',t[t.length]='<a:font script="Knda" typeface="Tunga"/>',t[t.length]='<a:font script="Guru" typeface="Raavi"/>',t[t.length]='<a:font script="Cans" typeface="Euphemia"/>',t[t.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',t[t.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',t[t.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',t[t.length]='<a:font script="Thaa" typeface="MV Boli"/>',t[t.length]='<a:font script="Deva" typeface="Mangal"/>',t[t.length]='<a:font script="Telu" typeface="Gautami"/>',t[t.length]='<a:font script="Taml" typeface="Latha"/>',t[t.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',t[t.length]='<a:font script="Orya" typeface="Kalinga"/>',t[t.length]='<a:font script="Mlym" typeface="Kartika"/>',t[t.length]='<a:font script="Laoo" typeface="DokChampa"/>',t[t.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',t[t.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',t[t.length]='<a:font script="Viet" typeface="Arial"/>',t[t.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',t[t.length]='<a:font script="Geor" typeface="Sylfaen"/>',t[t.length]="</a:minorFont>",t[t.length]="</a:fontScheme>",t[t.length]='<a:fmtScheme name="Office">',t[t.length]="<a:fillStyleLst>",t[t.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:lin ang="16200000" scaled="1"/>',t[t.length]="</a:gradFill>",t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:lin ang="16200000" scaled="0"/>',t[t.length]="</a:gradFill>",t[t.length]="</a:fillStyleLst>",t[t.length]="<a:lnStyleLst>",t[t.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]="</a:lnStyleLst>",t[t.length]="<a:effectStyleLst>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]="</a:effectStyle>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]="</a:effectStyle>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',t[t.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',t[t.length]="</a:effectStyle>",t[t.length]="</a:effectStyleLst>",t[t.length]="<a:bgFillStyleLst>",t[t.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',t[t.length]="</a:gradFill>",t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',t[t.length]="</a:gradFill>",t[t.length]="</a:bgFillStyleLst>",t[t.length]="</a:fmtScheme>",t[t.length]="</a:themeElements>",t[t.length]="<a:objectDefaults>",t[t.length]="<a:spDef>",t[t.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',t[t.length]="</a:spDef>",t[t.length]="<a:lnDef>",t[t.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',t[t.length]="</a:lnDef>",t[t.length]="</a:objectDefaults>",t[t.length]="<a:extraClrSchemeLst/>",t[t.length]="</a:theme>",t.join("")}function Nm(e,r,t){var a=e.l+r,i=e.read_shift(4);if(i!==124226){if(!t.cellStyles){e.l=a;return}var c=e.slice(e.l);e.l=a;var u;try{u=O1(c,{type:"array"})}catch{return}var d=$r(u,"theme/theme/theme1.xml",!0);if(d)return Vl(d,t)}}function Fm(e){return e.read_shift(4)}function Rm(e){var r={};switch(r.xclrType=e.read_shift(2),r.nTintShade=e.read_shift(2),r.xclrType){case 0:e.l+=4;break;case 1:r.xclrValue=Om(e,4);break;case 2:r.xclrValue=vl(e);break;case 3:r.xclrValue=Fm(e);break;case 4:e.l+=4;break}return e.l+=8,r}function Om(e,r){return Rr(e,r)}function Dm(e,r){return Rr(e,r)}function Bm(e){var r=e.read_shift(2),t=e.read_shift(2)-4,a=[r];switch(r){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:a[1]=Rm(e);break;case 6:a[1]=Dm(e,t);break;case 14:case 15:a[1]=e.read_shift(t===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+r+" "+t)}return a}function Mm(e,r){var t=e.l+r;e.l+=2;var a=e.read_shift(2);e.l+=2;for(var i=e.read_shift(2),c=[];i-- >0;)c.push(Bm(e,t-e.l));return{ixfe:a,ext:c}}function Pm(e,r){r.forEach(function(t){t[0]})}function Lm(e,r){return{flags:e.read_shift(4),version:e.read_shift(4),name:Fr(e)}}function Um(e){var r=ve(12+2*e.name.length);return r.write_shift(4,e.flags),r.write_shift(4,e.version),pr(e.name,r),r.slice(0,r.l)}function Wm(e){for(var r=[],t=e.read_shift(4);t-- >0;)r.push([e.read_shift(4),e.read_shift(4)]);return r}function Vm(e){var r=ve(4+8*e.length);r.write_shift(4,e.length);for(var t=0;t<e.length;++t)r.write_shift(4,e[t][0]),r.write_shift(4,e[t][1]);return r}function Hm(e,r){var t=ve(8+2*r.length);return t.write_shift(4,e),pr(r,t),t.slice(0,t.l)}function Gm(e){return e.l+=4,e.read_shift(4)!=0}function Xm(e,r){var t=ve(8);return t.write_shift(4,e),t.write_shift(4,1),t}function zm(e,r,t){var a={Types:[],Cell:[],Value:[]},i=t||{},c=[],u=!1,d=2;return Xn(e,function(g,m,w){switch(w){case 335:a.Types.push({name:g.name});break;case 51:g.forEach(function(v){d==1?a.Cell.push({type:a.Types[v[0]-1].name,index:v[1]}):d==0&&a.Value.push({type:a.Types[v[0]-1].name,index:v[1]})});break;case 337:d=g?1:0;break;case 338:d=2;break;case 35:c.push(w),u=!0;break;case 36:c.pop(),u=!1;break;default:if(!m.T){if(!u||i.WTF&&c[c.length-1]!=35)throw new Error("Unexpected record 0x"+w.toString(16))}}}),a}function Ym(){var e=Gr();return Ce(e,332),Ce(e,334,Cn(1)),Ce(e,335,Um({name:"XLDAPR",version:12e4,flags:3496657072})),Ce(e,336),Ce(e,339,Hm(1,"XLDAPR")),Ce(e,52),Ce(e,35,Cn(514)),Ce(e,4096,Cn(0)),Ce(e,4097,hn(1)),Ce(e,36),Ce(e,53),Ce(e,340),Ce(e,337,Xm(1)),Ce(e,51,Vm([[1,0]])),Ce(e,338),Ce(e,333),e.end()}function Km(e,r,t){var a={Types:[],Cell:[],Value:[]};if(!e)return a;var i=!1,c=2,u;return e.replace(Or,function(d){var g=et(d);switch(On(g[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":a.Types.push({name:g.name});break;case"</metadataType>":break;case"<futureMetadata":for(var m=0;m<a.Types.length;++m)a.Types[m].name==g.name&&(u=a.Types[m]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":c==1?a.Cell.push({type:a.Types[g.t-1].name,index:+g.v}):c==0&&a.Value.push({type:a.Types[g.t-1].name,index:+g.v});break;case"</rc>":break;case"<cellMetadata":c=1;break;case"</cellMetadata>":c=2;break;case"<valueMetadata":c=0;break;case"</valueMetadata>":c=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;case"<rvb":if(!u)break;u.offsets||(u.offsets=[]),u.offsets.push(+g.i);break;default:if(!i&&t.WTF)throw new Error("unrecognized "+g[0]+" in metadata")}return d}),a}function Hl(){var e=[nr];return e.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),e.join("")}function jm(e){var r=[];if(!e)return r;var t=1;return(e.match(Or)||[]).forEach(function(a){var i=et(a);switch(i[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete i[0],i.i?t=i.i:i.i=t,r.push(i);break}}),r}function Zm(e){var r={};r.i=e.read_shift(4);var t={};t.r=e.read_shift(4),t.c=e.read_shift(4),r.r=Qe(t);var a=e.read_shift(1);return a&2&&(r.l="1"),a&8&&(r.a="1"),r}function qm(e,r,t){var a=[];return Xn(e,function(c,u,d){switch(d){case 63:a.push(c);break;default:if(!u.T)throw new Error("Unexpected record 0x"+d.toString(16))}}),a}function Jm(e,r,t,a){if(!e)return e;var i=a||{},c=!1;Xn(e,function(d,g,m){switch(m){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:c=!0;break;case 36:c=!1;break;default:if(!g.T){if(!c||i.WTF)throw new Error("Unexpected record 0x"+m.toString(16))}}},i)}function Qm(e,r){if(!e)return"??";var t=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return r["!id"][t].Target}var Za=1024;function Gl(e,r){for(var t=[21600,21600],a=["m0,0l0",t[1],t[0],t[1],t[0],"0xe"].join(","),i=[Me("xml",null,{"xmlns:v":qr.v,"xmlns:o":qr.o,"xmlns:x":qr.x,"xmlns:mv":qr.mv}).replace(/\/>/,">"),Me("o:shapelayout",Me("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"}),Me("v:shapetype",[Me("v:stroke",null,{joinstyle:"miter"}),Me("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:t.join(","),path:a})];Za<e*1e3;)Za+=1e3;return r.forEach(function(c){var u=Kt(c[0]),d={color2:"#BEFF82",type:"gradient"};d.type=="gradient"&&(d.angle="-180");var g=d.type=="gradient"?Me("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,m=Me("v:fill",g,d),w={on:"t",obscured:"t"};++Za,i=i.concat(["<v:shape"+Pi({id:"_x0000_s"+Za,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(c[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",m,Me("v:shadow",null,w),Me("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",Cr("x:Anchor",[u.c+1,0,u.r+1,0,u.c+3,20,u.r+5,20].join(",")),Cr("x:AutoFill","False"),Cr("x:Row",String(u.r)),Cr("x:Column",String(u.c)),c[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),i.push("</xml>"),i.join("")}function lf(e,r,t,a){var i=Array.isArray(e),c;r.forEach(function(u){var d=Kt(u.ref);if(i?(e[d.r]||(e[d.r]=[]),c=e[d.r][d.c]):c=e[u.ref],!c){c={t:"z"},i?e[d.r][d.c]=c:e[u.ref]=c;var g=Ct(e["!ref"]||"BDWGO1000001:A1");g.s.r>d.r&&(g.s.r=d.r),g.e.r<d.r&&(g.e.r=d.r),g.s.c>d.c&&(g.s.c=d.c),g.e.c<d.c&&(g.e.c=d.c);var m=it(g);m!==e["!ref"]&&(e["!ref"]=m)}c.c||(c.c=[]);var w={a:u.author,t:u.t,r:u.r,T:t};u.h&&(w.h=u.h);for(var v=c.c.length-1;v>=0;--v){if(!t&&c.c[v].T)return;t&&!c.c[v].T&&c.c.splice(v,1)}if(t&&a){for(v=0;v<a.length;++v)if(w.a==a[v].id){w.a=a[v].name||w.a;break}}c.c.push(w)})}function $m(e,r){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var t=[],a=[],i=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);i&&i[1]&&i[1].split(/<\/\w*:?author>/).forEach(function(u){if(!(u===""||u.trim()==="")){var d=u.match(/<(?:\w+:)?author[^>]*>(.*)/);d&&t.push(d[1])}});var c=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return c&&c[1]&&c[1].split(/<\/\w*:?comment>/).forEach(function(u){if(!(u===""||u.trim()==="")){var d=u.match(/<(?:\w+:)?comment[^>]*>/);if(d){var g=et(d[0]),m={author:g.authorId&&t[g.authorId]||"sheetjsghost",ref:g.ref,guid:g.guid},w=Kt(g.ref);if(!(r.sheetRows&&r.sheetRows<=w.r)){var v=u.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),_=!!v&&!!v[1]&&Do(v[1])||{r:"",t:"",h:""};m.r=_.r,_.r=="<t></t>"&&(_.t=_.h=""),m.t=(_.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),r.cellHTML&&(m.h=_.h),a.push(m)}}}}),a}function Xl(e){var r=[nr,Me("comments",null,{xmlns:ba[0]})],t=[];return r.push("<authors>"),e.forEach(function(a){a[1].forEach(function(i){var c=kt(i.a);t.indexOf(c)==-1&&(t.push(c),r.push("<author>"+c+"</author>")),i.T&&i.ID&&t.indexOf("tc="+i.ID)==-1&&(t.push("tc="+i.ID),r.push("<author>tc="+i.ID+"</author>"))})}),t.length==0&&(t.push("SheetJ5"),r.push("<author>SheetJ5</author>")),r.push("</authors>"),r.push("<commentList>"),e.forEach(function(a){var i=0,c=[];if(a[1][0]&&a[1][0].T&&a[1][0].ID?i=t.indexOf("tc="+a[1][0].ID):a[1].forEach(function(g){g.a&&(i=t.indexOf(kt(g.a))),c.push(g.t||"")}),r.push('<comment ref="'+a[0]+'" authorId="'+i+'"><text>'),c.length<=1)r.push(Cr("t",kt(c[0]||"")));else{for(var u=`Comment:
    `+c[0]+`
`,d=1;d<c.length;++d)u+=`Reply:
    `+c[d]+`
`;r.push(Cr("t",kt(u)))}r.push("</text></comment>")}),r.push("</commentList>"),r.length>2&&(r[r.length]="</comments>",r[1]=r[1].replace("/>",">")),r.join("")}function ep(e,r){var t=[],a=!1,i={},c=0;return e.replace(Or,function(d,g){var m=et(d);switch(On(m[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":i={author:m.personId,guid:m.id,ref:m.ref,T:1};break;case"</threadedComment>":i.t!=null&&t.push(i);break;case"<text>":case"<text":c=g+d.length;break;case"</text>":i.t=e.slice(c,g).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":a=!0;break;case"</mentions>":a=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(!a&&r.WTF)throw new Error("unrecognized "+m[0]+" in threaded comments")}return d}),t}function tp(e,r,t){var a=[nr,Me("ThreadedComments",null,{xmlns:lr.TCMNT}).replace(/[\/]>/,">")];return e.forEach(function(i){var c="";(i[1]||[]).forEach(function(u,d){if(!u.T){delete u.ID;return}u.a&&r.indexOf(u.a)==-1&&r.push(u.a);var g={ref:i[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+t.tcid++).slice(-12)+"}"};d==0?c=g.id:g.parentId=c,u.ID=g.id,u.a&&(g.personId="{54EE7950-7262-4200-6969-"+("000000000000"+r.indexOf(u.a)).slice(-12)+"}"),a.push(Me("threadedComment",Cr("text",u.t||""),g))})}),a.push("</ThreadedComments>"),a.join("")}function rp(e,r){var t=[],a=!1;return e.replace(Or,function(c){var u=et(c);switch(On(u[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":t.push({name:u.displayname,id:u.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(!a&&r.WTF)throw new Error("unrecognized "+u[0]+" in threaded comments")}return c}),t}function np(e){var r=[nr,Me("personList",null,{xmlns:lr.TCMNT,"xmlns:x":ba[0]}).replace(/[\/]>/,">")];return e.forEach(function(t,a){r.push(Me("person",null,{displayName:t,id:"{54EE7950-7262-4200-6969-"+("000000000000"+a).slice(-12)+"}",userId:t,providerId:"None"}))}),r.push("</personList>"),r.join("")}function ap(e){var r={};r.iauthor=e.read_shift(4);var t=Oa(e);return r.rfx=t.s,r.ref=Qe(t.s),e.l+=16,r}function ip(e,r){return r==null&&(r=ve(36)),r.write_shift(4,e[1].iauthor),oi(e[0],r),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r}var sp=Fr;function op(e){return pr(e.slice(0,54))}function cp(e,r){var t=[],a=[],i={},c=!1;return Xn(e,function(d,g,m){switch(m){case 632:a.push(d);break;case 635:i=d;break;case 637:i.t=d.t,i.h=d.h,i.r=d.r;break;case 636:if(i.author=a[i.iauthor],delete i.iauthor,r.sheetRows&&i.rfx&&r.sheetRows<=i.rfx.r)break;i.t||(i.t=""),delete i.rfx,t.push(i);break;case 3072:break;case 35:c=!0;break;case 36:c=!1;break;case 37:break;case 38:break;default:if(!g.T){if(!c||r.WTF)throw new Error("Unexpected record 0x"+m.toString(16))}}}),t}function fp(e){var r=Gr(),t=[];return Ce(r,628),Ce(r,630),e.forEach(function(a){a[1].forEach(function(i){t.indexOf(i.a)>-1||(t.push(i.a.slice(0,54)),Ce(r,632,op(i.a)))})}),Ce(r,631),Ce(r,633),e.forEach(function(a){a[1].forEach(function(i){i.iauthor=t.indexOf(i.a);var c={s:Kt(a[0]),e:Kt(a[0])};Ce(r,635,ip([c,i])),i.t&&i.t.length>0&&Ce(r,637,Fd(i)),Ce(r,636),delete i.iauthor})}),Ce(r,634),Ce(r,629),r.end()}var lp="application/vnd.ms-office.vbaProject";function up(e){var r=Ke.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(t,a){if(!(t.slice(-1)==="/"||!t.match(/_VBA_PROJECT_CUR/))){var i=t.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");Ke.utils.cfb_add(r,i,e.FileIndex[a].content)}}),Ke.write(r)}function hp(e,r){r.FullPaths.forEach(function(t,a){if(a!=0){var i=t.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");i.slice(-1)!=="/"&&Ke.utils.cfb_add(e,i,r.FileIndex[a].content)}})}var zl=["xlsb","xlsm","xlam","biff8","xla"];function dp(){return{"!type":"dialog"}}function xp(){return{"!type":"dialog"}}function gp(){return{"!type":"macro"}}function mp(){return{"!type":"macro"}}var $a=(function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,r={r:0,c:0};function t(a,i,c,u){var d=!1,g=!1;c.length==0?g=!0:c.charAt(0)=="["&&(g=!0,c=c.slice(1,-1)),u.length==0?d=!0:u.charAt(0)=="["&&(d=!0,u=u.slice(1,-1));var m=c.length>0?parseInt(c,10)|0:0,w=u.length>0?parseInt(u,10)|0:0;return d?w+=r.c:--w,g?m+=r.r:--m,i+(d?"":"$")+Yt(w)+(g?"":"$")+rr(m)}return function(i,c){return r=c,i.replace(e,t)}})(),Lo=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,Uo=(function(){return function(r,t){return r.replace(Lo,function(a,i,c,u,d,g){var m=So(u)-(c?0:t.c),w=To(g)-(d?0:t.r),v=w==0?"":d?w+1:"["+w+"]",_=m==0?"":c?m+1:"["+m+"]";return i+"R"+v+"C"+_})}})();function Yl(e,r){return e.replace(Lo,function(t,a,i,c,u,d){return a+(i=="$"?i+c:Yt(So(c)+r.c))+(u=="$"?u+d:rr(To(d)+r.r))})}function pp(e,r,t){var a=Xr(r),i=a.s,c=Kt(t),u={r:c.r-i.r,c:c.c-i.c};return Yl(e,u)}function wp(e){return e.length!=1}function uf(e){return e.replace(/_xlfn\./g,"")}function ir(e){e.l+=1}function oa(e,r){var t=e.read_shift(2);return[t&16383,t>>14&1,t>>15&1]}function Kl(e,r,t){var a=2;if(t){if(t.biff>=2&&t.biff<=5)return jl(e);t.biff==12&&(a=4)}var i=e.read_shift(a),c=e.read_shift(a),u=oa(e),d=oa(e);return{s:{r:i,c:u[0],cRel:u[1],rRel:u[2]},e:{r:c,c:d[0],cRel:d[1],rRel:d[2]}}}function jl(e){var r=oa(e),t=oa(e),a=e.read_shift(1),i=e.read_shift(1);return{s:{r:r[0],c:a,cRel:r[1],rRel:r[2]},e:{r:t[0],c:i,cRel:t[1],rRel:t[2]}}}function Ep(e,r,t){if(t.biff<8)return jl(e);var a=e.read_shift(t.biff==12?4:2),i=e.read_shift(t.biff==12?4:2),c=oa(e),u=oa(e);return{s:{r:a,c:c[0],cRel:c[1],rRel:c[2]},e:{r:i,c:u[0],cRel:u[1],rRel:u[2]}}}function Zl(e,r,t){if(t&&t.biff>=2&&t.biff<=5)return vp(e);var a=e.read_shift(t&&t.biff==12?4:2),i=oa(e);return{r:a,c:i[0],cRel:i[1],rRel:i[2]}}function vp(e){var r=oa(e),t=e.read_shift(1);return{r:r[0],c:t,cRel:r[1],rRel:r[2]}}function _p(e){var r=e.read_shift(2),t=e.read_shift(2);return{r,c:t&255,fQuoted:!!(t&16384),cRel:t>>15,rRel:t>>15}}function Ap(e,r,t){var a=t&&t.biff?t.biff:8;if(a>=2&&a<=5)return Cp(e);var i=e.read_shift(a>=12?4:2),c=e.read_shift(2),u=(c&16384)>>14,d=(c&32768)>>15;if(c&=16383,d==1)for(;i>524287;)i-=1048576;if(u==1)for(;c>8191;)c=c-16384;return{r:i,c,cRel:u,rRel:d}}function Cp(e){var r=e.read_shift(2),t=e.read_shift(1),a=(r&32768)>>15,i=(r&16384)>>14;return r&=16383,a==1&&r>=8192&&(r=r-16384),i==1&&t>=128&&(t=t-256),{r,c:t,cRel:i,rRel:a}}function Tp(e,r,t){var a=(e[e.l++]&96)>>5,i=Kl(e,t.biff>=2&&t.biff<=5?6:8,t);return[a,i]}function Sp(e,r,t){var a=(e[e.l++]&96)>>5,i=e.read_shift(2,"i"),c=8;if(t)switch(t.biff){case 5:e.l+=12,c=6;break;case 12:c=12;break}var u=Kl(e,c,t);return[a,i,u]}function yp(e,r,t){var a=(e[e.l++]&96)>>5;return e.l+=t&&t.biff>8?12:t.biff<8?6:8,[a]}function Ip(e,r,t){var a=(e[e.l++]&96)>>5,i=e.read_shift(2),c=8;if(t)switch(t.biff){case 5:e.l+=12,c=6;break;case 12:c=12;break}return e.l+=c,[a,i]}function kp(e,r,t){var a=(e[e.l++]&96)>>5,i=Ep(e,r-1,t);return[a,i]}function bp(e,r,t){var a=(e[e.l++]&96)>>5;return e.l+=t.biff==2?6:t.biff==12?14:7,[a]}function hf(e){var r=e[e.l+1]&1,t=1;return e.l+=4,[r,t]}function Np(e,r,t){e.l+=2;for(var a=e.read_shift(t&&t.biff==2?1:2),i=[],c=0;c<=a;++c)i.push(e.read_shift(t&&t.biff==2?1:2));return i}function Fp(e,r,t){var a=e[e.l+1]&255?1:0;return e.l+=2,[a,e.read_shift(t&&t.biff==2?1:2)]}function Rp(e,r,t){var a=e[e.l+1]&255?1:0;return e.l+=2,[a,e.read_shift(t&&t.biff==2?1:2)]}function Op(e){var r=e[e.l+1]&255?1:0;return e.l+=2,[r,e.read_shift(2)]}function Dp(e,r,t){var a=e[e.l+1]&255?1:0;return e.l+=t&&t.biff==2?3:4,[a]}function ql(e){var r=e.read_shift(1),t=e.read_shift(1);return[r,t]}function Bp(e){return e.read_shift(2),ql(e)}function Mp(e){return e.read_shift(2),ql(e)}function Pp(e,r,t){var a=(e[e.l]&96)>>5;e.l+=1;var i=Zl(e,0,t);return[a,i]}function Lp(e,r,t){var a=(e[e.l]&96)>>5;e.l+=1;var i=Ap(e,0,t);return[a,i]}function Up(e,r,t){var a=(e[e.l]&96)>>5;e.l+=1;var i=e.read_shift(2);t&&t.biff==5&&(e.l+=12);var c=Zl(e,0,t);return[a,i,c]}function Wp(e,r,t){var a=(e[e.l]&96)>>5;e.l+=1;var i=e.read_shift(t&&t.biff<=3?1:2);return[Gw[i],$l[i],a]}function Vp(e,r,t){var a=e[e.l++],i=e.read_shift(1),c=t&&t.biff<=3?[a==88?-1:0,e.read_shift(1)]:Hp(e);return[i,(c[0]===0?$l:Hw)[c[1]]]}function Hp(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function Gp(e,r,t){e.l+=t&&t.biff==2?3:4}function Xp(e,r,t){if(e.l++,t&&t.biff==12)return[e.read_shift(4,"i"),0];var a=e.read_shift(2),i=e.read_shift(t&&t.biff==2?1:2);return[a,i]}function zp(e){return e.l++,zn[e.read_shift(1)]}function Yp(e){return e.l++,e.read_shift(2)}function Kp(e){return e.l++,e.read_shift(1)!==0}function jp(e){return e.l++,Nr(e)}function Zp(e,r,t){return e.l++,Zi(e,r-1,t)}function qp(e,r){var t=[e.read_shift(1)];if(r==12)switch(t[0]){case 2:t[0]=4;break;case 4:t[0]=16;break;case 0:t[0]=1;break;case 1:t[0]=2;break}switch(t[0]){case 4:t[1]=tr(e,1)?"TRUE":"FALSE",r!=12&&(e.l+=7);break;case 37:case 16:t[1]=zn[e[e.l]],e.l+=r==12?4:8;break;case 0:e.l+=8;break;case 1:t[1]=Nr(e);break;case 2:t[1]=Da(e,0,{biff:r>0&&r<8?2:r});break;default:throw new Error("Bad SerAr: "+t[0])}return t}function Jp(e,r,t){for(var a=e.read_shift(t.biff==12?4:2),i=[],c=0;c!=a;++c)i.push((t.biff==12?Oa:Hs)(e));return i}function Qp(e,r,t){var a=0,i=0;t.biff==12?(a=e.read_shift(4),i=e.read_shift(4)):(i=1+e.read_shift(1),a=1+e.read_shift(2)),t.biff>=2&&t.biff<8&&(--a,--i==0&&(i=256));for(var c=0,u=[];c!=a&&(u[c]=[]);++c)for(var d=0;d!=i;++d)u[c][d]=qp(e,t.biff);return u}function $p(e,r,t){var a=e.read_shift(1)>>>5&3,i=!t||t.biff>=8?4:2,c=e.read_shift(i);switch(t.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[a,0,c]}function ew(e,r,t){if(t.biff==5)return tw(e);var a=e.read_shift(1)>>>5&3,i=e.read_shift(2),c=e.read_shift(4);return[a,i,c]}function tw(e){var r=e.read_shift(1)>>>5&3,t=e.read_shift(2,"i");e.l+=8;var a=e.read_shift(2);return e.l+=12,[r,t,a]}function rw(e,r,t){var a=e.read_shift(1)>>>5&3;e.l+=t&&t.biff==2?3:4;var i=e.read_shift(t&&t.biff==2?1:2);return[a,i]}function nw(e,r,t){var a=e.read_shift(1)>>>5&3,i=e.read_shift(t&&t.biff==2?1:2);return[a,i]}function aw(e,r,t){var a=e.read_shift(1)>>>5&3;return e.l+=4,t.biff<8&&e.l--,t.biff==12&&(e.l+=2),[a]}function iw(e,r,t){var a=(e[e.l++]&96)>>5,i=e.read_shift(2),c=4;if(t)switch(t.biff){case 5:c=15;break;case 12:c=6;break}return e.l+=c,[a,i]}var sw=Rr,ow=Rr,cw=Rr;function Ji(e,r,t){return e.l+=2,[_p(e)]}function Wo(e){return e.l+=6,[]}var fw=Ji,lw=Wo,uw=Wo,hw=Ji;function Jl(e){return e.l+=2,[or(e),e.read_shift(2)&1]}var dw=Ji,xw=Jl,gw=Wo,mw=Ji,pw=Ji,ww=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function Ew(e){e.l+=2;var r=e.read_shift(2),t=e.read_shift(2),a=e.read_shift(4),i=e.read_shift(2),c=e.read_shift(2),u=ww[t>>2&31];return{ixti:r,coltype:t&3,rt:u,idx:a,c:i,C:c}}function vw(e){return e.l+=2,[e.read_shift(4)]}function _w(e,r,t){return e.l+=5,e.l+=2,e.l+=t.biff==2?1:4,["PTGSHEET"]}function Aw(e,r,t){return e.l+=t.biff==2?4:5,["PTGENDSHEET"]}function Cw(e){var r=e.read_shift(1)>>>5&3,t=e.read_shift(2);return[r,t]}function Tw(e){var r=e.read_shift(1)>>>5&3,t=e.read_shift(2);return[r,t]}function Sw(e){return e.l+=4,[0,0]}var df={1:{n:"PtgExp",f:Xp},2:{n:"PtgTbl",f:cw},3:{n:"PtgAdd",f:ir},4:{n:"PtgSub",f:ir},5:{n:"PtgMul",f:ir},6:{n:"PtgDiv",f:ir},7:{n:"PtgPower",f:ir},8:{n:"PtgConcat",f:ir},9:{n:"PtgLt",f:ir},10:{n:"PtgLe",f:ir},11:{n:"PtgEq",f:ir},12:{n:"PtgGe",f:ir},13:{n:"PtgGt",f:ir},14:{n:"PtgNe",f:ir},15:{n:"PtgIsect",f:ir},16:{n:"PtgUnion",f:ir},17:{n:"PtgRange",f:ir},18:{n:"PtgUplus",f:ir},19:{n:"PtgUminus",f:ir},20:{n:"PtgPercent",f:ir},21:{n:"PtgParen",f:ir},22:{n:"PtgMissArg",f:ir},23:{n:"PtgStr",f:Zp},26:{n:"PtgSheet",f:_w},27:{n:"PtgEndSheet",f:Aw},28:{n:"PtgErr",f:zp},29:{n:"PtgBool",f:Kp},30:{n:"PtgInt",f:Yp},31:{n:"PtgNum",f:jp},32:{n:"PtgArray",f:bp},33:{n:"PtgFunc",f:Wp},34:{n:"PtgFuncVar",f:Vp},35:{n:"PtgName",f:$p},36:{n:"PtgRef",f:Pp},37:{n:"PtgArea",f:Tp},38:{n:"PtgMemArea",f:rw},39:{n:"PtgMemErr",f:sw},40:{n:"PtgMemNoMem",f:ow},41:{n:"PtgMemFunc",f:nw},42:{n:"PtgRefErr",f:aw},43:{n:"PtgAreaErr",f:yp},44:{n:"PtgRefN",f:Lp},45:{n:"PtgAreaN",f:kp},46:{n:"PtgMemAreaN",f:Cw},47:{n:"PtgMemNoMemN",f:Tw},57:{n:"PtgNameX",f:ew},58:{n:"PtgRef3d",f:Up},59:{n:"PtgArea3d",f:Sp},60:{n:"PtgRefErr3d",f:iw},61:{n:"PtgAreaErr3d",f:Ip},255:{}},yw={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},Iw={1:{n:"PtgElfLel",f:Jl},2:{n:"PtgElfRw",f:mw},3:{n:"PtgElfCol",f:fw},6:{n:"PtgElfRwV",f:pw},7:{n:"PtgElfColV",f:hw},10:{n:"PtgElfRadical",f:dw},11:{n:"PtgElfRadicalS",f:gw},13:{n:"PtgElfColS",f:lw},15:{n:"PtgElfColSV",f:uw},16:{n:"PtgElfRadicalLel",f:xw},25:{n:"PtgList",f:Ew},29:{n:"PtgSxName",f:vw},255:{}},kw={0:{n:"PtgAttrNoop",f:Sw},1:{n:"PtgAttrSemi",f:Dp},2:{n:"PtgAttrIf",f:Rp},4:{n:"PtgAttrChoose",f:Np},8:{n:"PtgAttrGoto",f:Fp},16:{n:"PtgAttrSum",f:Gp},32:{n:"PtgAttrBaxcel",f:hf},33:{n:"PtgAttrBaxcel",f:hf},64:{n:"PtgAttrSpace",f:Bp},65:{n:"PtgAttrSpaceSemi",f:Mp},128:{n:"PtgAttrIfError",f:Op},255:{}};function Qi(e,r,t,a){if(a.biff<8)return Rr(e,r);for(var i=e.l+r,c=[],u=0;u!==t.length;++u)switch(t[u][0]){case"PtgArray":t[u][1]=Qp(e,0,a),c.push(t[u][1]);break;case"PtgMemArea":t[u][2]=Jp(e,t[u][1],a),c.push(t[u][2]);break;case"PtgExp":a&&a.biff==12&&(t[u][1][1]=e.read_shift(4),c.push(t[u][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+t[u][0]}return r=i-e.l,r!==0&&c.push(Rr(e,r)),c}function $i(e,r,t){for(var a=e.l+r,i,c,u=[];a!=e.l;)r=a-e.l,c=e[e.l],i=df[c]||df[yw[c]],(c===24||c===25)&&(i=(c===24?Iw:kw)[e[e.l+1]]),!i||!i.f?Rr(e,r):u.push([i.n,i.f(e,r,t)]);return u}function bw(e){for(var r=[],t=0;t<e.length;++t){for(var a=e[t],i=[],c=0;c<a.length;++c){var u=a[c];if(u)switch(u[0]){case 2:i.push('"'+u[1].replace(/"/g,'""')+'"');break;default:i.push(u[1])}else i.push("")}r.push(i.join(","))}return r.join(";")}var Nw={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function Fw(e,r){if(!e&&!(r&&r.biff<=5&&r.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function Ql(e,r,t){if(!e)return"SH33TJSERR0";if(t.biff>8&&(!e.XTI||!e.XTI[r]))return e.SheetNames[r];if(!e.XTI)return"SH33TJSERR6";var a=e.XTI[r];if(t.biff<8)return r>1e4&&(r-=65536),r<0&&(r=-r),r==0?"":e.XTI[r-1];if(!a)return"SH33TJSERR1";var i="";if(t.biff>8)switch(e[a[0]][0]){case 357:return i=a[1]==-1?"#REF":e.SheetNames[a[1]],a[1]==a[2]?i:i+":"+e.SheetNames[a[2]];case 358:return t.SID!=null?e.SheetNames[t.SID]:"SH33TJSSAME"+e[a[0]][0];case 355:default:return"SH33TJSSRC"+e[a[0]][0]}switch(e[a[0]][0][0]){case 1025:return i=a[1]==-1?"#REF":e.SheetNames[a[1]]||"SH33TJSERR3",a[1]==a[2]?i:i+":"+e.SheetNames[a[2]];case 14849:return e[a[0]].slice(1).map(function(c){return c.Name}).join(";;");default:return e[a[0]][0][3]?(i=a[1]==-1?"#REF":e[a[0]][0][3][a[1]]||"SH33TJSERR4",a[1]==a[2]?i:i+":"+e[a[0]][0][3][a[2]]):"SH33TJSERR2"}}function xf(e,r,t){var a=Ql(e,r,t);return a=="#REF"?a:Fw(a,t)}function kr(e,r,t,a,i){var c=i&&i.biff||8,u={s:{c:0,r:0}},d=[],g,m,w,v=0,_=0,C,S="";if(!e[0]||!e[0][0])return"";for(var A=-1,y="",D=0,P=e[0].length;D<P;++D){var b=e[0][D];switch(b[0]){case"PtgUminus":d.push("-"+d.pop());break;case"PtgUplus":d.push("+"+d.pop());break;case"PtgPercent":d.push(d.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(g=d.pop(),m=d.pop(),A>=0){switch(e[0][A][1][0]){case 0:y=Jt(" ",e[0][A][1][1]);break;case 1:y=Jt("\r",e[0][A][1][1]);break;default:if(y="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][A][1][0])}m=m+y,A=-1}d.push(m+Nw[b[0]]+g);break;case"PtgIsect":g=d.pop(),m=d.pop(),d.push(m+" "+g);break;case"PtgUnion":g=d.pop(),m=d.pop(),d.push(m+","+g);break;case"PtgRange":g=d.pop(),m=d.pop(),d.push(m+":"+g);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":w=yi(b[1][1],u,i),d.push(Ii(w,c));break;case"PtgRefN":w=t?yi(b[1][1],t,i):b[1][1],d.push(Ii(w,c));break;case"PtgRef3d":v=b[1][1],w=yi(b[1][2],u,i),S=xf(a,v,i),d.push(S+"!"+Ii(w,c));break;case"PtgFunc":case"PtgFuncVar":var V=b[1][0],te=b[1][1];V||(V=0),V&=127;var W=V==0?[]:d.slice(-V);d.length-=V,te==="User"&&(te=W.shift()),d.push(te+"("+W.join(",")+")");break;case"PtgBool":d.push(b[1]?"TRUE":"FALSE");break;case"PtgInt":d.push(b[1]);break;case"PtgNum":d.push(String(b[1]));break;case"PtgStr":d.push('"'+b[1].replace(/"/g,'""')+'"');break;case"PtgErr":d.push(b[1]);break;case"PtgAreaN":C=Hc(b[1][1],t?{s:t}:u,i),d.push(d0(C,i));break;case"PtgArea":C=Hc(b[1][1],u,i),d.push(d0(C,i));break;case"PtgArea3d":v=b[1][1],C=b[1][2],S=xf(a,v,i),d.push(S+"!"+d0(C,i));break;case"PtgAttrSum":d.push("SUM("+d.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":_=b[1][2];var N=(a.names||[])[_-1]||(a[0]||[])[_],j=N?N.Name:"SH33TJSNAME"+String(_);j&&j.slice(0,6)=="_xlfn."&&!i.xlfn&&(j=j.slice(6)),d.push(j);break;case"PtgNameX":var O=b[1][1];_=b[1][2];var ae;if(i.biff<=5)O<0&&(O=-O),a[O]&&(ae=a[O][_]);else{var Q="";if(((a[O]||[])[0]||[])[0]==14849||(((a[O]||[])[0]||[])[0]==1025?a[O][_]&&a[O][_].itab>0&&(Q=a.SheetNames[a[O][_].itab-1]+"!"):Q=a.SheetNames[_-1]+"!"),a[O]&&a[O][_])Q+=a[O][_].Name;else if(a[0]&&a[0][_])Q+=a[0][_].Name;else{var X=(Ql(a,O,i)||"").split(";;");X[_-1]?Q=X[_-1]:Q+="SH33TJSERRX"}d.push(Q);break}ae||(ae={Name:"SH33TJSERRY"}),d.push(ae.Name);break;case"PtgParen":var ie="(",Ee=")";if(A>=0){switch(y="",e[0][A][1][0]){case 2:ie=Jt(" ",e[0][A][1][1])+ie;break;case 3:ie=Jt("\r",e[0][A][1][1])+ie;break;case 4:Ee=Jt(" ",e[0][A][1][1])+Ee;break;case 5:Ee=Jt("\r",e[0][A][1][1])+Ee;break;default:if(i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][A][1][0])}A=-1}d.push(ie+d.pop()+Ee);break;case"PtgRefErr":d.push("#REF!");break;case"PtgRefErr3d":d.push("#REF!");break;case"PtgExp":w={c:b[1][1],r:b[1][0]};var q={c:t.c,r:t.r};if(a.sharedf[Qe(w)]){var ue=a.sharedf[Qe(w)];d.push(kr(ue,u,q,a,i))}else{var de=!1;for(g=0;g!=a.arrayf.length;++g)if(m=a.arrayf[g],!(w.c<m[0].s.c||w.c>m[0].e.c)&&!(w.r<m[0].s.r||w.r>m[0].e.r)){d.push(kr(m[1],u,q,a,i)),de=!0;break}de||d.push(b[1])}break;case"PtgArray":d.push("{"+bw(b[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":A=D;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":d.push("");break;case"PtgAreaErr":d.push("#REF!");break;case"PtgAreaErr3d":d.push("#REF!");break;case"PtgList":d.push("Table"+b[1].idx+"[#"+b[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(b));default:throw new Error("Unrecognized Formula Token: "+String(b))}var We=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(i.biff!=3&&A>=0&&We.indexOf(e[0][D][0])==-1){b=e[0][A];var se=!0;switch(b[1][0]){case 4:se=!1;case 0:y=Jt(" ",b[1][1]);break;case 5:se=!1;case 1:y=Jt("\r",b[1][1]);break;default:if(y="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+b[1][0])}d.push((se?y:"")+d.pop()+(se?"":y)),A=-1}}if(d.length>1&&i.WTF)throw new Error("bad formula stack");return d[0]}function Rw(e,r,t){var a=e.l+r,i=t.biff==2?1:2,c,u=e.read_shift(i);if(u==65535)return[[],Rr(e,r-2)];var d=$i(e,u,t);return r!==u+i&&(c=Qi(e,r-u-i,d,t)),e.l=a,[d,c]}function Ow(e,r,t){var a=e.l+r,i=t.biff==2?1:2,c,u=e.read_shift(i);if(u==65535)return[[],Rr(e,r-2)];var d=$i(e,u,t);return r!==u+i&&(c=Qi(e,r-u-i,d,t)),e.l=a,[d,c]}function Dw(e,r,t,a){var i=e.l+r,c=$i(e,a,t),u;return i!==e.l&&(u=Qi(e,i-e.l,c,t)),[c,u]}function Bw(e,r,t){var a=e.l+r,i,c=e.read_shift(2),u=$i(e,c,t);return c==65535?[[],Rr(e,r-2)]:(r!==c+2&&(i=Qi(e,a-c-2,u,t)),[u,i])}function Mw(e){var r;if(Ln(e,e.l+6)!==65535)return[Nr(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return r=e[e.l+2]===1,e.l+=8,[r,"b"];case 2:return r=e[e.l+2],e.l+=8,[r,"e"];case 3:return e.l+=8,["","s"]}return[]}function Pw(e){if(e==null){var r=ve(8);return r.write_shift(1,3),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,65535),r}else if(typeof e=="number")return Sa(e);return Sa(0)}function w0(e,r,t){var a=e.l+r,i=Dn(e);t.biff==2&&++e.l;var c=Mw(e),u=e.read_shift(1);t.biff!=2&&(e.read_shift(1),t.biff>=5&&e.read_shift(4));var d=Ow(e,a-e.l,t);return{cell:i,val:c[0],formula:d,shared:u>>3&1,tt:c[1]}}function Lw(e,r,t,a,i){var c=Ia(r,t,i),u=Pw(e.v),d=ve(6),g=33;d.write_shift(2,g),d.write_shift(4,0);for(var m=ve(e.bf.length),w=0;w<e.bf.length;++w)m[w]=e.bf[w];var v=mr([c,u,d,m]);return v}function Gs(e,r,t){var a=e.read_shift(4),i=$i(e,a,t),c=e.read_shift(4),u=c>0?Qi(e,c,i,t):null;return[i,u]}var Uw=Gs,Xs=Gs,Ww=Gs,Vw=Gs,Hw={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},$l={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},Gw={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function gf(e){return e.slice(0,3)=="of:"&&(e=e.slice(3)),e.charCodeAt(0)==61&&(e=e.slice(1),e.charCodeAt(0)==61&&(e=e.slice(1))),e=e.replace(/COM\.MICROSOFT\./g,""),e=e.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(r,t){return t.replace(/\./g,"")}),e=e.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),e.replace(/[;~]/g,",").replace(/\|/g,";")}function Xw(e){var r="of:="+e.replace(Lo,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return r.replace(/;/g,"|").replace(/,/g,";")}function E0(e){var r=e.split(":"),t=r[0].split(".")[0];return[t,r[0].split(".")[1]+(r.length>1?":"+(r[1].split(".")[1]||r[1].split(".")[0]):"")]}function zw(e){return e.replace(/\./,"!")}var bi={},ei={},Ni=typeof Map<"u";function Vo(e,r,t){var a=0,i=e.length;if(t){if(Ni?t.has(r):Object.prototype.hasOwnProperty.call(t,r)){for(var c=Ni?t.get(r):t[r];a<c.length;++a)if(e[c[a]].t===r)return e.Count++,c[a]}}else for(;a<i;++a)if(e[a].t===r)return e.Count++,a;return e[i]={t:r},e.Count++,e.Unique++,t&&(Ni?(t.has(r)||t.set(r,[]),t.get(r).push(i)):(Object.prototype.hasOwnProperty.call(t,r)||(t[r]=[]),t[r].push(i))),i}function zs(e,r){var t={min:e+1,max:e+1},a=-1;return r.MDW&&(br=r.MDW),r.width!=null?t.customWidth=1:r.wpx!=null?a=Hi(r.wpx):r.wch!=null&&(a=r.wch),a>-1?(t.width=Rs(a),t.customWidth=1):r.width!=null&&(t.width=r.width),r.hidden&&(t.hidden=!0),r.level!=null&&(t.outlineLevel=t.level=r.level),t}function Aa(e,r){if(e){var t=[.7,.7,.75,.75,.3,.3];r=="xlml"&&(t=[1,1,1,1,.5,.5]),e.left==null&&(e.left=t[0]),e.right==null&&(e.right=t[1]),e.top==null&&(e.top=t[2]),e.bottom==null&&(e.bottom=t[3]),e.header==null&&(e.header=t[4]),e.footer==null&&(e.footer=t[5])}}function ua(e,r,t){var a=t.revssf[r.z!=null?r.z:"General"],i=60,c=e.length;if(a==null&&t.ssf){for(;i<392;++i)if(t.ssf[i]==null){Wn(r.z,i),t.ssf[i]=r.z,t.revssf[r.z]=a=i;break}}for(i=0;i!=c;++i)if(e[i].numFmtId===a)return i;return e[c]={numFmtId:a,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},c}function eu(e,r,t,a,i,c){try{a.cellNF&&(e.z=qe[r])}catch(d){if(a.WTF)throw d}if(!(e.t==="z"&&!a.cellStyles)){if(e.t==="d"&&typeof e.v=="string"&&(e.v=Wt(e.v)),(!a||a.cellText!==!1)&&e.t!=="z")try{if(qe[r]==null&&Wn(Hh[r]||"General",r),e.t==="e")e.w=e.w||zn[e.v];else if(r===0)if(e.t==="n")(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Bi(e.v);else if(e.t==="d"){var u=ur(e.v);(u|0)===u?e.w=u.toString(10):e.w=Bi(u)}else{if(e.v===void 0)return"";e.w=Ca(e.v,ei)}else e.t==="d"?e.w=xn(r,ur(e.v),ei):e.w=xn(r,e.v,ei)}catch(d){if(a.WTF)throw d}if(a.cellStyles&&t!=null)try{e.s=c.Fills[t],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=Fs(i.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),a.WTF&&(e.s.fgColor.raw_rgb=i.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=Fs(i.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),a.WTF&&(e.s.bgColor.raw_rgb=i.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(d){if(a.WTF&&c.Fills)throw d}}}function Yw(e,r,t){if(e&&e["!ref"]){var a=Ct(e["!ref"]);if(a.e.c<a.s.c||a.e.r<a.s.r)throw new Error("Bad range ("+t+"): "+e["!ref"])}}function Kw(e,r){var t=Ct(r);t.s.r<=t.e.r&&t.s.c<=t.e.c&&t.s.r>=0&&t.s.c>=0&&(e["!ref"]=it(t))}var jw=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,Zw=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,qw=/<(?:\w:)?hyperlink [^>]*>/mg,Jw=/"(\w*:\w*)"/,Qw=/<(?:\w:)?col\b[^>]*[\/]?>/g,$w=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,e3=/<(?:\w:)?pageMargins[^>]*\/>/g,tu=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,t3=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,r3=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function n3(e,r,t,a,i,c,u){if(!e)return e;a||(a={"!id":{}});var d=r.dense?[]:{},g={s:{r:2e6,c:2e6},e:{r:0,c:0}},m="",w="",v=e.match(Zw);v?(m=e.slice(0,v.index),w=e.slice(v.index+v[0].length)):m=w=e;var _=m.match(tu);_?Ho(_[0],d,i,t):(_=m.match(t3))&&i3(_[0],_[1]||"",d,i,t);var C=(m.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(C>0){var S=m.slice(C,C+50).match(Jw);S&&Kw(d,S[1])}var A=m.match(r3);A&&A[1]&&w3(A[1],i);var y=[];if(r.cellStyles){var D=m.match(Qw);D&&d3(y,D)}v&&_3(v[1],d,r,g,c,u);var P=w.match($w);P&&(d["!autofilter"]=g3(P[0]));var b=[],V=w.match(jw);if(V)for(C=0;C!=V.length;++C)b[C]=Ct(V[C].slice(V[C].indexOf('"')+1));var te=w.match(qw);te&&l3(d,te,a);var W=w.match(e3);if(W&&(d["!margins"]=u3(et(W[0]))),!d["!ref"]&&g.e.c>=g.s.c&&g.e.r>=g.s.r&&(d["!ref"]=it(g)),r.sheetRows>0&&d["!ref"]){var N=Ct(d["!ref"]);r.sheetRows<=+N.e.r&&(N.e.r=r.sheetRows-1,N.e.r>g.e.r&&(N.e.r=g.e.r),N.e.r<N.s.r&&(N.s.r=N.e.r),N.e.c>g.e.c&&(N.e.c=g.e.c),N.e.c<N.s.c&&(N.s.c=N.e.c),d["!fullref"]=d["!ref"],d["!ref"]=it(N))}return y.length>0&&(d["!cols"]=y),b.length>0&&(d["!merges"]=b),d}function a3(e){if(e.length===0)return"";for(var r='<mergeCells count="'+e.length+'">',t=0;t!=e.length;++t)r+='<mergeCell ref="'+it(e[t])+'"/>';return r+"</mergeCells>"}function Ho(e,r,t,a){var i=et(e);t.Sheets[a]||(t.Sheets[a]={}),i.codeName&&(t.Sheets[a].CodeName=At(Nt(i.codeName)))}function i3(e,r,t,a,i){Ho(e.slice(0,e.indexOf(">")),t,a,i)}function s3(e,r,t,a,i){var c=!1,u={},d=null;if(a.bookType!=="xlsx"&&r.vbaraw){var g=r.SheetNames[t];try{r.Workbook&&(g=r.Workbook.Sheets[t].CodeName||g)}catch{}c=!0,u.codeName=Rn(kt(g))}if(e&&e["!outline"]){var m={summaryBelow:1,summaryRight:1};e["!outline"].above&&(m.summaryBelow=0),e["!outline"].left&&(m.summaryRight=0),d=(d||"")+Me("outlinePr",null,m)}!c&&!d||(i[i.length]=Me("sheetPr",d,u))}var o3=["objects","scenarios","selectLockedCells","selectUnlockedCells"],c3=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function f3(e){var r={sheet:1};return o3.forEach(function(t){e[t]!=null&&e[t]&&(r[t]="1")}),c3.forEach(function(t){e[t]!=null&&!e[t]&&(r[t]="0")}),e.password&&(r.password=Bo(e.password).toString(16).toUpperCase()),Me("sheetProtection",null,r)}function l3(e,r,t){for(var a=Array.isArray(e),i=0;i!=r.length;++i){var c=et(Nt(r[i]),!0);if(!c.ref)return;var u=((t||{})["!id"]||[])[c.id];u?(c.Target=u.Target,c.location&&(c.Target+="#"+At(c.location))):(c.Target="#"+At(c.location),u={Target:c.Target,TargetMode:"Internal"}),c.Rel=u,c.tooltip&&(c.Tooltip=c.tooltip,delete c.tooltip);for(var d=Ct(c.ref),g=d.s.r;g<=d.e.r;++g)for(var m=d.s.c;m<=d.e.c;++m){var w=Qe({c:m,r:g});a?(e[g]||(e[g]=[]),e[g][m]||(e[g][m]={t:"z",v:void 0}),e[g][m].l=c):(e[w]||(e[w]={t:"z",v:void 0}),e[w].l=c)}}}function u3(e){var r={};return["left","right","top","bottom","header","footer"].forEach(function(t){e[t]&&(r[t]=parseFloat(e[t]))}),r}function h3(e){return Aa(e),Me("pageMargins",null,e)}function d3(e,r){for(var t=!1,a=0;a!=r.length;++a){var i=et(r[a],!0);i.hidden&&(i.hidden=Ut(i.hidden));var c=parseInt(i.min,10)-1,u=parseInt(i.max,10)-1;for(i.outlineLevel&&(i.level=+i.outlineLevel||0),delete i.min,delete i.max,i.width=+i.width,!t&&i.width&&(t=!0,Mo(i.width)),sa(i);c<=u;)e[c++]=Vt(i)}}function x3(e,r){for(var t=["<cols>"],a,i=0;i!=r.length;++i)(a=r[i])&&(t[t.length]=Me("col",null,zs(i,a)));return t[t.length]="</cols>",t.join("")}function g3(e){var r={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return r}function m3(e,r,t,a){var i=typeof e.ref=="string"?e.ref:it(e.ref);t.Workbook||(t.Workbook={Sheets:[]}),t.Workbook.Names||(t.Workbook.Names=[]);var c=t.Workbook.Names,u=Xr(i);u.s.r==u.e.r&&(u.e.r=Xr(r["!ref"]).e.r,i=it(u));for(var d=0;d<c.length;++d){var g=c[d];if(g.Name=="_xlnm._FilterDatabase"&&g.Sheet==a){g.Ref="'"+t.SheetNames[a]+"'!"+i;break}}return d==c.length&&c.push({Name:"_xlnm._FilterDatabase",Sheet:a,Ref:"'"+t.SheetNames[a]+"'!"+i}),Me("autoFilter",null,{ref:i})}var p3=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function w3(e,r){r.Views||(r.Views=[{}]),(e.match(p3)||[]).forEach(function(t,a){var i=et(t);r.Views[a]||(r.Views[a]={}),+i.zoomScale&&(r.Views[a].zoom=+i.zoomScale),Ut(i.rightToLeft)&&(r.Views[a].RTL=!0)})}function E3(e,r,t,a){var i={workbookViewId:"0"};return(((a||{}).Workbook||{}).Views||[])[0]&&(i.rightToLeft=a.Workbook.Views[0].RTL?"1":"0"),Me("sheetViews",Me("sheetView",null,i),{})}function v3(e,r,t,a){if(e.c&&t["!comments"].push([r,e.c]),e.v===void 0&&typeof e.f!="string"||e.t==="z"&&!e.f)return"";var i="",c=e.t,u=e.v;if(e.t!=="z")switch(e.t){case"b":i=e.v?"1":"0";break;case"n":i=""+e.v;break;case"e":i=zn[e.v];break;case"d":a&&a.cellDates?i=Wt(e.v,-1).toISOString():(e=Vt(e),e.t="n",i=""+(e.v=ur(Wt(e.v)))),typeof e.z>"u"&&(e.z=qe[14]);break;default:i=e.v;break}var d=Cr("v",kt(i)),g={r},m=ua(a.cellXfs,e,a);switch(m!==0&&(g.s=m),e.t){case"n":break;case"d":g.t="d";break;case"b":g.t="b";break;case"e":g.t="e";break;case"z":break;default:if(e.v==null){delete e.t;break}if(e.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(a&&a.bookSST){d=Cr("v",""+Vo(a.Strings,e.v,a.revStrings)),g.t="s";break}g.t="str";break}if(e.t!=c&&(e.t=c,e.v=u),typeof e.f=="string"&&e.f){var w=e.F&&e.F.slice(0,r.length)==r?{t:"array",ref:e.F}:null;d=Me("f",kt(e.f),w)+(e.v!=null?d:"")}return e.l&&t["!links"].push([r,e.l]),e.D&&(g.cm=1),Me("c",d,g)}var _3=(function(){var e=/<(?:\w+:)?c[ \/>]/,r=/<\/(?:\w+:)?row>/,t=/r=["']([^"']*)["']/,a=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,i=/ref=["']([^"']*)["']/,c=Mi("v"),u=Mi("f");return function(g,m,w,v,_,C){for(var S=0,A="",y=[],D=[],P=0,b=0,V=0,te="",W,N,j=0,O=0,ae,Q,X=0,ie=0,Ee=Array.isArray(C.CellXf),q,ue=[],de=[],We=Array.isArray(m),se=[],Le={},Ge=!1,z=!!w.sheetStubs,ne=g.split(r),Z=0,ee=ne.length;Z!=ee;++Z){A=ne[Z].trim();var oe=A.length;if(oe!==0){var Ie=0;e:for(S=0;S<oe;++S)switch(A[S]){case">":if(A[S-1]!="/"){++S;break e}if(w&&w.cellStyles){if(N=et(A.slice(Ie,S),!0),j=N.r!=null?parseInt(N.r,10):j+1,O=-1,w.sheetRows&&w.sheetRows<j)continue;Le={},Ge=!1,N.ht&&(Ge=!0,Le.hpt=parseFloat(N.ht),Le.hpx=ni(Le.hpt)),N.hidden=="1"&&(Ge=!0,Le.hidden=!0),N.outlineLevel!=null&&(Ge=!0,Le.level=+N.outlineLevel),Ge&&(se[j-1]=Le)}break;case"<":Ie=S;break}if(Ie>=S)break;if(N=et(A.slice(Ie,S),!0),j=N.r!=null?parseInt(N.r,10):j+1,O=-1,!(w.sheetRows&&w.sheetRows<j)){v.s.r>j-1&&(v.s.r=j-1),v.e.r<j-1&&(v.e.r=j-1),w&&w.cellStyles&&(Le={},Ge=!1,N.ht&&(Ge=!0,Le.hpt=parseFloat(N.ht),Le.hpx=ni(Le.hpt)),N.hidden=="1"&&(Ge=!0,Le.hidden=!0),N.outlineLevel!=null&&(Ge=!0,Le.level=+N.outlineLevel),Ge&&(se[j-1]=Le)),y=A.slice(S).split(e);for(var Ae=0;Ae!=y.length&&y[Ae].trim().charAt(0)=="<";++Ae);for(y=y.slice(Ae),S=0;S!=y.length;++S)if(A=y[S].trim(),A.length!==0){if(D=A.match(t),P=S,b=0,V=0,A="<c "+(A.slice(0,1)=="<"?">":"")+A,D!=null&&D.length===2){for(P=0,te=D[1],b=0;b!=te.length&&!((V=te.charCodeAt(b)-64)<1||V>26);++b)P=26*P+V;--P,O=P}else++O;for(b=0;b!=A.length&&A.charCodeAt(b)!==62;++b);if(++b,N=et(A.slice(0,b),!0),N.r||(N.r=Qe({r:j-1,c:O})),te=A.slice(b),W={t:""},(D=te.match(c))!=null&&D[1]!==""&&(W.v=At(D[1])),w.cellFormula){if((D=te.match(u))!=null&&D[1]!==""){if(W.f=At(Nt(D[1])).replace(/\r\n/g,`
`),w.xlfn||(W.f=uf(W.f)),D[0].indexOf('t="array"')>-1)W.F=(te.match(i)||[])[1],W.F.indexOf(":")>-1&&ue.push([Ct(W.F),W.F]);else if(D[0].indexOf('t="shared"')>-1){Q=et(D[0]);var Te=At(Nt(D[1]));w.xlfn||(Te=uf(Te)),de[parseInt(Q.si,10)]=[Q,Te,N.r]}}else(D=te.match(/<f[^>]*\/>/))&&(Q=et(D[0]),de[Q.si]&&(W.f=pp(de[Q.si][1],de[Q.si][2],N.r)));var Se=Kt(N.r);for(b=0;b<ue.length;++b)Se.r>=ue[b][0].s.r&&Se.r<=ue[b][0].e.r&&Se.c>=ue[b][0].s.c&&Se.c<=ue[b][0].e.c&&(W.F=ue[b][1])}if(N.t==null&&W.v===void 0)if(W.f||W.F)W.v=0,W.t="n";else if(z)W.t="z";else continue;else W.t=N.t||"n";switch(v.s.c>O&&(v.s.c=O),v.e.c<O&&(v.e.c=O),W.t){case"n":if(W.v==""||W.v==null){if(!z)continue;W.t="z"}else W.v=parseFloat(W.v);break;case"s":if(typeof W.v>"u"){if(!z)continue;W.t="z"}else ae=bi[parseInt(W.v,10)],W.v=ae.t,W.r=ae.r,w.cellHTML&&(W.h=ae.h);break;case"str":W.t="s",W.v=W.v!=null?Nt(W.v):"",w.cellHTML&&(W.h=vo(W.v));break;case"inlineStr":D=te.match(a),W.t="s",D!=null&&(ae=Do(D[1]))?(W.v=ae.t,w.cellHTML&&(W.h=ae.h)):W.v="";break;case"b":W.v=Ut(W.v);break;case"d":w.cellDates?W.v=Wt(W.v,1):(W.v=ur(Wt(W.v,1)),W.t="n");break;case"e":(!w||w.cellText!==!1)&&(W.w=W.v),W.v=nl[W.v];break}if(X=ie=0,q=null,Ee&&N.s!==void 0&&(q=C.CellXf[N.s],q!=null&&(q.numFmtId!=null&&(X=q.numFmtId),w.cellStyles&&q.fillId!=null&&(ie=q.fillId))),eu(W,X,ie,w,_,C),w.cellDates&&Ee&&W.t=="n"&&ai(qe[X])&&(W.t="d",W.v=Vs(W.v)),N.cm&&w.xlmeta){var Ye=(w.xlmeta.Cell||[])[+N.cm-1];Ye&&Ye.type=="XLDAPR"&&(W.D=!0)}if(We){var K=Kt(N.r);m[K.r]||(m[K.r]=[]),m[K.r][K.c]=W}else m[N.r]=W}}}}se.length>0&&(m["!rows"]=se)}})();function A3(e,r,t,a){var i=[],c=[],u=Ct(e["!ref"]),d="",g,m="",w=[],v=0,_=0,C=e["!rows"],S=Array.isArray(e),A={r:m},y,D=-1;for(_=u.s.c;_<=u.e.c;++_)w[_]=Yt(_);for(v=u.s.r;v<=u.e.r;++v){for(c=[],m=rr(v),_=u.s.c;_<=u.e.c;++_){g=w[_]+m;var P=S?(e[v]||[])[_]:e[g];P!==void 0&&(d=v3(P,g,e,r))!=null&&c.push(d)}(c.length>0||C&&C[v])&&(A={r:m},C&&C[v]&&(y=C[v],y.hidden&&(A.hidden=1),D=-1,y.hpx?D=Gi(y.hpx):y.hpt&&(D=y.hpt),D>-1&&(A.ht=D,A.customHeight=1),y.level&&(A.outlineLevel=y.level)),i[i.length]=Me("row",c.join(""),A))}if(C)for(;v<C.length;++v)C&&C[v]&&(A={r:v+1},y=C[v],y.hidden&&(A.hidden=1),D=-1,y.hpx?D=Gi(y.hpx):y.hpt&&(D=y.hpt),D>-1&&(A.ht=D,A.customHeight=1),y.level&&(A.outlineLevel=y.level),i[i.length]=Me("row","",A));return i.join("")}function ru(e,r,t,a){var i=[nr,Me("worksheet",null,{xmlns:ba[0],"xmlns:r":lr.r})],c=t.SheetNames[e],u=0,d="",g=t.Sheets[c];g==null&&(g={});var m=g["!ref"]||"A1",w=Ct(m);if(w.e.c>16383||w.e.r>1048575){if(r.WTF)throw new Error("Range "+m+" exceeds format limit A1:XFD1048576");w.e.c=Math.min(w.e.c,16383),w.e.r=Math.min(w.e.c,1048575),m=it(w)}a||(a={}),g["!comments"]=[];var v=[];s3(g,t,e,r,i),i[i.length]=Me("dimension",null,{ref:m}),i[i.length]=E3(g,r,e,t),r.sheetFormat&&(i[i.length]=Me("sheetFormatPr",null,{defaultRowHeight:r.sheetFormat.defaultRowHeight||"16",baseColWidth:r.sheetFormat.baseColWidth||"10",outlineLevelRow:r.sheetFormat.outlineLevelRow||"7"})),g["!cols"]!=null&&g["!cols"].length>0&&(i[i.length]=x3(g,g["!cols"])),i[u=i.length]="<sheetData/>",g["!links"]=[],g["!ref"]!=null&&(d=A3(g,r),d.length>0&&(i[i.length]=d)),i.length>u+1&&(i[i.length]="</sheetData>",i[u]=i[u].replace("/>",">")),g["!protect"]&&(i[i.length]=f3(g["!protect"])),g["!autofilter"]!=null&&(i[i.length]=m3(g["!autofilter"],g,t,e)),g["!merges"]!=null&&g["!merges"].length>0&&(i[i.length]=a3(g["!merges"]));var _=-1,C,S=-1;return g["!links"].length>0&&(i[i.length]="<hyperlinks>",g["!links"].forEach(function(A){A[1].Target&&(C={ref:A[0]},A[1].Target.charAt(0)!="#"&&(S=It(a,-1,kt(A[1].Target).replace(/#.*$/,""),pt.HLINK),C["r:id"]="rId"+S),(_=A[1].Target.indexOf("#"))>-1&&(C.location=kt(A[1].Target.slice(_+1))),A[1].Tooltip&&(C.tooltip=kt(A[1].Tooltip)),i[i.length]=Me("hyperlink",null,C))}),i[i.length]="</hyperlinks>"),delete g["!links"],g["!margins"]!=null&&(i[i.length]=h3(g["!margins"])),(!r||r.ignoreEC||r.ignoreEC==null)&&(i[i.length]=Cr("ignoredErrors",Me("ignoredError",null,{numberStoredAsText:1,sqref:m}))),v.length>0&&(S=It(a,-1,"../drawings/drawing"+(e+1)+".xml",pt.DRAW),i[i.length]=Me("drawing",null,{"r:id":"rId"+S}),g["!drawing"]=v),g["!comments"].length>0&&(S=It(a,-1,"../drawings/vmlDrawing"+(e+1)+".vml",pt.VML),i[i.length]=Me("legacyDrawing",null,{"r:id":"rId"+S}),g["!legacy"]=S),i.length>1&&(i[i.length]="</worksheet>",i[1]=i[1].replace("/>",">")),i.join("")}function C3(e,r){var t={},a=e.l+r;t.r=e.read_shift(4),e.l+=4;var i=e.read_shift(2);e.l+=1;var c=e.read_shift(1);return e.l=a,c&7&&(t.level=c&7),c&16&&(t.hidden=!0),c&32&&(t.hpt=i/20),t}function T3(e,r,t){var a=ve(145),i=(t["!rows"]||[])[e]||{};a.write_shift(4,e),a.write_shift(4,0);var c=320;i.hpx?c=Gi(i.hpx)*20:i.hpt&&(c=i.hpt*20),a.write_shift(2,c),a.write_shift(1,0);var u=0;i.level&&(u|=i.level),i.hidden&&(u|=16),(i.hpx||i.hpt)&&(u|=32),a.write_shift(1,u),a.write_shift(1,0);var d=0,g=a.l;a.l+=4;for(var m={r:e,c:0},w=0;w<16;++w)if(!(r.s.c>w+1<<10||r.e.c<w<<10)){for(var v=-1,_=-1,C=w<<10;C<w+1<<10;++C){m.c=C;var S=Array.isArray(t)?(t[m.r]||[])[m.c]:t[Qe(m)];S&&(v<0&&(v=C),_=C)}v<0||(++d,a.write_shift(4,v),a.write_shift(4,_))}var A=a.l;return a.l=g,a.write_shift(4,d),a.l=A,a.length>a.l?a.slice(0,a.l):a}function S3(e,r,t,a){var i=T3(a,t,r);(i.length>17||(r["!rows"]||[])[a])&&Ce(e,0,i)}var y3=Oa,I3=oi;function k3(){}function b3(e,r){var t={},a=e[e.l];return++e.l,t.above=!(a&64),t.left=!(a&128),e.l+=18,t.name=Rd(e),t}function N3(e,r,t){t==null&&(t=ve(84+4*e.length));var a=192;r&&(r.above&&(a&=-65),r.left&&(a&=-129)),t.write_shift(1,a);for(var i=1;i<3;++i)t.write_shift(1,0);return ks({auto:1},t),t.write_shift(-4,-1),t.write_shift(-4,-1),Q1(e,t),t.slice(0,t.l)}function F3(e){var r=gn(e);return[r]}function R3(e,r,t){return t==null&&(t=ve(8)),Na(r,t)}function O3(e){var r=Fa(e);return[r]}function D3(e,r,t){return t==null&&(t=ve(4)),Ra(r,t)}function B3(e){var r=gn(e),t=e.read_shift(1);return[r,t,"b"]}function M3(e,r,t){return t==null&&(t=ve(9)),Na(r,t),t.write_shift(1,e.v?1:0),t}function P3(e){var r=Fa(e),t=e.read_shift(1);return[r,t,"b"]}function L3(e,r,t){return t==null&&(t=ve(5)),Ra(r,t),t.write_shift(1,e.v?1:0),t}function U3(e){var r=gn(e),t=e.read_shift(1);return[r,t,"e"]}function W3(e,r,t){return t==null&&(t=ve(9)),Na(r,t),t.write_shift(1,e.v),t}function V3(e){var r=Fa(e),t=e.read_shift(1);return[r,t,"e"]}function H3(e,r,t){return t==null&&(t=ve(8)),Ra(r,t),t.write_shift(1,e.v),t.write_shift(2,0),t.write_shift(1,0),t}function G3(e){var r=gn(e),t=e.read_shift(4);return[r,t,"s"]}function X3(e,r,t){return t==null&&(t=ve(12)),Na(r,t),t.write_shift(4,r.v),t}function z3(e){var r=Fa(e),t=e.read_shift(4);return[r,t,"s"]}function Y3(e,r,t){return t==null&&(t=ve(8)),Ra(r,t),t.write_shift(4,r.v),t}function K3(e){var r=gn(e),t=Nr(e);return[r,t,"n"]}function j3(e,r,t){return t==null&&(t=ve(16)),Na(r,t),Sa(e.v,t),t}function nu(e){var r=Fa(e),t=Nr(e);return[r,t,"n"]}function Z3(e,r,t){return t==null&&(t=ve(12)),Ra(r,t),Sa(e.v,t),t}function q3(e){var r=gn(e),t=bo(e);return[r,t,"n"]}function J3(e,r,t){return t==null&&(t=ve(12)),Na(r,t),$1(e.v,t),t}function Q3(e){var r=Fa(e),t=bo(e);return[r,t,"n"]}function $3(e,r,t){return t==null&&(t=ve(8)),Ra(r,t),$1(e.v,t),t}function e4(e){var r=gn(e),t=yo(e);return[r,t,"is"]}function t4(e){var r=gn(e),t=Fr(e);return[r,t,"str"]}function r4(e,r,t){return t==null&&(t=ve(12+4*e.v.length)),Na(r,t),pr(e.v,t),t.length>t.l?t.slice(0,t.l):t}function n4(e){var r=Fa(e),t=Fr(e);return[r,t,"str"]}function a4(e,r,t){return t==null&&(t=ve(8+4*e.v.length)),Ra(r,t),pr(e.v,t),t.length>t.l?t.slice(0,t.l):t}function i4(e,r,t){var a=e.l+r,i=gn(e);i.r=t["!row"];var c=e.read_shift(1),u=[i,c,"b"];if(t.cellFormula){e.l+=2;var d=Xs(e,a-e.l,t);u[3]=kr(d,null,i,t.supbooks,t)}else e.l=a;return u}function s4(e,r,t){var a=e.l+r,i=gn(e);i.r=t["!row"];var c=e.read_shift(1),u=[i,c,"e"];if(t.cellFormula){e.l+=2;var d=Xs(e,a-e.l,t);u[3]=kr(d,null,i,t.supbooks,t)}else e.l=a;return u}function o4(e,r,t){var a=e.l+r,i=gn(e);i.r=t["!row"];var c=Nr(e),u=[i,c,"n"];if(t.cellFormula){e.l+=2;var d=Xs(e,a-e.l,t);u[3]=kr(d,null,i,t.supbooks,t)}else e.l=a;return u}function c4(e,r,t){var a=e.l+r,i=gn(e);i.r=t["!row"];var c=Fr(e),u=[i,c,"str"];if(t.cellFormula){e.l+=2;var d=Xs(e,a-e.l,t);u[3]=kr(d,null,i,t.supbooks,t)}else e.l=a;return u}var f4=Oa,l4=oi;function u4(e,r){return r==null&&(r=ve(4)),r.write_shift(4,e),r}function h4(e,r){var t=e.l+r,a=Oa(e),i=Io(e),c=Fr(e),u=Fr(e),d=Fr(e);e.l=t;var g={rfx:a,relId:i,loc:c,display:d};return u&&(g.Tooltip=u),g}function d4(e,r){var t=ve(50+4*(e[1].Target.length+(e[1].Tooltip||"").length));oi({s:Kt(e[0]),e:Kt(e[0])},t),ko("rId"+r,t);var a=e[1].Target.indexOf("#"),i=a==-1?"":e[1].Target.slice(a+1);return pr(i||"",t),pr(e[1].Tooltip||"",t),pr("",t),t.slice(0,t.l)}function x4(){}function g4(e,r,t){var a=e.l+r,i=el(e),c=e.read_shift(1),u=[i];if(u[2]=c,t.cellFormula){var d=Uw(e,a-e.l,t);u[1]=d}else e.l=a;return u}function m4(e,r,t){var a=e.l+r,i=Oa(e),c=[i];if(t.cellFormula){var u=Vw(e,a-e.l,t);c[1]=u,e.l=a}else e.l=a;return c}function p4(e,r,t){t==null&&(t=ve(18));var a=zs(e,r);t.write_shift(-4,e),t.write_shift(-4,e),t.write_shift(4,(a.width||10)*256),t.write_shift(4,0);var i=0;return r.hidden&&(i|=1),typeof a.width=="number"&&(i|=2),r.level&&(i|=r.level<<8),t.write_shift(2,i),t}var au=["left","right","top","bottom","header","footer"];function w4(e){var r={};return au.forEach(function(t){r[t]=Nr(e)}),r}function E4(e,r){return r==null&&(r=ve(48)),Aa(e),au.forEach(function(t){Sa(e[t],r)}),r}function v4(e){var r=e.read_shift(2);return e.l+=28,{RTL:r&32}}function _4(e,r,t){t==null&&(t=ve(30));var a=924;return(((r||{}).Views||[])[0]||{}).RTL&&(a|=32),t.write_shift(2,a),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,100),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(4,0),t}function A4(e){var r=ve(24);return r.write_shift(4,4),r.write_shift(4,1),oi(e,r),r}function C4(e,r){return r==null&&(r=ve(66)),r.write_shift(2,e.password?Bo(e.password):0),r.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(t){t[1]?r.write_shift(4,e[t[0]]!=null&&!e[t[0]]?1:0):r.write_shift(4,e[t[0]]!=null&&e[t[0]]?0:1)}),r}function T4(){}function S4(){}function y4(e,r,t,a,i,c,u){if(!e)return e;var d=r||{};a||(a={"!id":{}});var g=d.dense?[]:{},m,w={s:{r:2e6,c:2e6},e:{r:0,c:0}},v=!1,_=!1,C,S,A,y,D,P,b,V,te,W=[];d.biff=12,d["!row"]=0;var N=0,j=!1,O=[],ae={},Q=d.supbooks||i.supbooks||[[]];if(Q.sharedf=ae,Q.arrayf=O,Q.SheetNames=i.SheetNames||i.Sheets.map(function(We){return We.name}),!d.supbooks&&(d.supbooks=Q,i.Names))for(var X=0;X<i.Names.length;++X)Q[0][X+1]=i.Names[X];var ie=[],Ee=[],q=!1;Xi[16]={n:"BrtShortReal",f:nu};var ue;if(Xn(e,function(se,Le,Ge){if(!_)switch(Ge){case 148:m=se;break;case 0:C=se,d.sheetRows&&d.sheetRows<=C.r&&(_=!0),V=rr(y=C.r),d["!row"]=C.r,(se.hidden||se.hpt||se.level!=null)&&(se.hpt&&(se.hpx=ni(se.hpt)),Ee[se.r]=se);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(S={t:se[2]},se[2]){case"n":S.v=se[1];break;case"s":b=bi[se[1]],S.v=b.t,S.r=b.r;break;case"b":S.v=!!se[1];break;case"e":S.v=se[1],d.cellText!==!1&&(S.w=zn[S.v]);break;case"str":S.t="s",S.v=se[1];break;case"is":S.t="s",S.v=se[1].t;break}if((A=u.CellXf[se[0].iStyleRef])&&eu(S,A.numFmtId,null,d,c,u),D=se[0].c==-1?D+1:se[0].c,d.dense?(g[y]||(g[y]=[]),g[y][D]=S):g[Yt(D)+V]=S,d.cellFormula){for(j=!1,N=0;N<O.length;++N){var z=O[N];C.r>=z[0].s.r&&C.r<=z[0].e.r&&D>=z[0].s.c&&D<=z[0].e.c&&(S.F=it(z[0]),j=!0)}!j&&se.length>3&&(S.f=se[3])}if(w.s.r>C.r&&(w.s.r=C.r),w.s.c>D&&(w.s.c=D),w.e.r<C.r&&(w.e.r=C.r),w.e.c<D&&(w.e.c=D),d.cellDates&&A&&S.t=="n"&&ai(qe[A.numFmtId])){var ne=wa(S.v);ne&&(S.t="d",S.v=new Date(ne.y,ne.m-1,ne.d,ne.H,ne.M,ne.S,ne.u))}ue&&(ue.type=="XLDAPR"&&(S.D=!0),ue=void 0);break;case 1:case 12:if(!d.sheetStubs||v)break;S={t:"z",v:void 0},D=se[0].c==-1?D+1:se[0].c,d.dense?(g[y]||(g[y]=[]),g[y][D]=S):g[Yt(D)+V]=S,w.s.r>C.r&&(w.s.r=C.r),w.s.c>D&&(w.s.c=D),w.e.r<C.r&&(w.e.r=C.r),w.e.c<D&&(w.e.c=D),ue&&(ue.type=="XLDAPR"&&(S.D=!0),ue=void 0);break;case 176:W.push(se);break;case 49:ue=((d.xlmeta||{}).Cell||[])[se-1];break;case 494:var Z=a["!id"][se.relId];for(Z?(se.Target=Z.Target,se.loc&&(se.Target+="#"+se.loc),se.Rel=Z):se.relId==""&&(se.Target="#"+se.loc),y=se.rfx.s.r;y<=se.rfx.e.r;++y)for(D=se.rfx.s.c;D<=se.rfx.e.c;++D)d.dense?(g[y]||(g[y]=[]),g[y][D]||(g[y][D]={t:"z",v:void 0}),g[y][D].l=se):(P=Qe({c:D,r:y}),g[P]||(g[P]={t:"z",v:void 0}),g[P].l=se);break;case 426:if(!d.cellFormula)break;O.push(se),te=d.dense?g[y][D]:g[Yt(D)+V],te.f=kr(se[1],w,{r:C.r,c:D},Q,d),te.F=it(se[0]);break;case 427:if(!d.cellFormula)break;ae[Qe(se[0].s)]=se[1],te=d.dense?g[y][D]:g[Yt(D)+V],te.f=kr(se[1],w,{r:C.r,c:D},Q,d);break;case 60:if(!d.cellStyles)break;for(;se.e>=se.s;)ie[se.e--]={width:se.w/256,hidden:!!(se.flags&1),level:se.level},q||(q=!0,Mo(se.w/256)),sa(ie[se.e+1]);break;case 161:g["!autofilter"]={ref:it(se)};break;case 476:g["!margins"]=se;break;case 147:i.Sheets[t]||(i.Sheets[t]={}),se.name&&(i.Sheets[t].CodeName=se.name),(se.above||se.left)&&(g["!outline"]={above:se.above,left:se.left});break;case 137:i.Views||(i.Views=[{}]),i.Views[0]||(i.Views[0]={}),se.RTL&&(i.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:v=!0;break;case 36:v=!1;break;case 37:v=!0;break;case 38:v=!1;break;default:if(!Le.T){if(!v||d.WTF)throw new Error("Unexpected record 0x"+Ge.toString(16))}}},d),delete d.supbooks,delete d["!row"],!g["!ref"]&&(w.s.r<2e6||m&&(m.e.r>0||m.e.c>0||m.s.r>0||m.s.c>0))&&(g["!ref"]=it(m||w)),d.sheetRows&&g["!ref"]){var de=Ct(g["!ref"]);d.sheetRows<=+de.e.r&&(de.e.r=d.sheetRows-1,de.e.r>w.e.r&&(de.e.r=w.e.r),de.e.r<de.s.r&&(de.s.r=de.e.r),de.e.c>w.e.c&&(de.e.c=w.e.c),de.e.c<de.s.c&&(de.s.c=de.e.c),g["!fullref"]=g["!ref"],g["!ref"]=it(de))}return W.length>0&&(g["!merges"]=W),ie.length>0&&(g["!cols"]=ie),Ee.length>0&&(g["!rows"]=Ee),g}function I4(e,r,t,a,i,c,u){if(r.v===void 0)return!1;var d="";switch(r.t){case"b":d=r.v?"1":"0";break;case"d":r=Vt(r),r.z=r.z||qe[14],r.v=ur(Wt(r.v)),r.t="n";break;case"n":case"e":d=""+r.v;break;default:d=r.v;break}var g={r:t,c:a};switch(g.s=ua(i.cellXfs,r,i),r.l&&c["!links"].push([Qe(g),r.l]),r.c&&c["!comments"].push([Qe(g),r.c]),r.t){case"s":case"str":return i.bookSST?(d=Vo(i.Strings,r.v,i.revStrings),g.t="s",g.v=d,u?Ce(e,18,Y3(r,g)):Ce(e,7,X3(r,g))):(g.t="str",u?Ce(e,17,a4(r,g)):Ce(e,6,r4(r,g))),!0;case"n":return r.v==(r.v|0)&&r.v>-1e3&&r.v<1e3?u?Ce(e,13,$3(r,g)):Ce(e,2,J3(r,g)):u?Ce(e,16,Z3(r,g)):Ce(e,5,j3(r,g)),!0;case"b":return g.t="b",u?Ce(e,15,L3(r,g)):Ce(e,4,M3(r,g)),!0;case"e":return g.t="e",u?Ce(e,14,H3(r,g)):Ce(e,3,W3(r,g)),!0}return u?Ce(e,12,D3(r,g)):Ce(e,1,R3(r,g)),!0}function k4(e,r,t,a){var i=Ct(r["!ref"]||"A1"),c,u="",d=[];Ce(e,145);var g=Array.isArray(r),m=i.e.r;r["!rows"]&&(m=Math.max(i.e.r,r["!rows"].length-1));for(var w=i.s.r;w<=m;++w){u=rr(w),S3(e,r,i,w);var v=!1;if(w<=i.e.r)for(var _=i.s.c;_<=i.e.c;++_){w===i.s.r&&(d[_]=Yt(_)),c=d[_]+u;var C=g?(r[w]||[])[_]:r[c];if(!C){v=!1;continue}v=I4(e,C,w,_,a,r,v)}}Ce(e,146)}function b4(e,r){!r||!r["!merges"]||(Ce(e,177,u4(r["!merges"].length)),r["!merges"].forEach(function(t){Ce(e,176,l4(t))}),Ce(e,178))}function N4(e,r){!r||!r["!cols"]||(Ce(e,390),r["!cols"].forEach(function(t,a){t&&Ce(e,60,p4(a,t))}),Ce(e,391))}function F4(e,r){!r||!r["!ref"]||(Ce(e,648),Ce(e,649,A4(Ct(r["!ref"]))),Ce(e,650))}function R4(e,r,t){r["!links"].forEach(function(a){if(a[1].Target){var i=It(t,-1,a[1].Target.replace(/#.*$/,""),pt.HLINK);Ce(e,494,d4(a,i))}}),delete r["!links"]}function O4(e,r,t,a){if(r["!comments"].length>0){var i=It(a,-1,"../drawings/vmlDrawing"+(t+1)+".vml",pt.VML);Ce(e,551,ko("rId"+i)),r["!legacy"]=i}}function D4(e,r,t,a){if(r["!autofilter"]){var i=r["!autofilter"],c=typeof i.ref=="string"?i.ref:it(i.ref);t.Workbook||(t.Workbook={Sheets:[]}),t.Workbook.Names||(t.Workbook.Names=[]);var u=t.Workbook.Names,d=Xr(c);d.s.r==d.e.r&&(d.e.r=Xr(r["!ref"]).e.r,c=it(d));for(var g=0;g<u.length;++g){var m=u[g];if(m.Name=="_xlnm._FilterDatabase"&&m.Sheet==a){m.Ref="'"+t.SheetNames[a]+"'!"+c;break}}g==u.length&&u.push({Name:"_xlnm._FilterDatabase",Sheet:a,Ref:"'"+t.SheetNames[a]+"'!"+c}),Ce(e,161,oi(Ct(c))),Ce(e,162)}}function B4(e,r,t){Ce(e,133),Ce(e,137,_4(r,t)),Ce(e,138),Ce(e,134)}function M4(e,r){r["!protect"]&&Ce(e,535,C4(r["!protect"]))}function P4(e,r,t,a){var i=Gr(),c=t.SheetNames[e],u=t.Sheets[c]||{},d=c;try{t&&t.Workbook&&(d=t.Workbook.Sheets[e].CodeName||d)}catch{}var g=Ct(u["!ref"]||"A1");if(g.e.c>16383||g.e.r>1048575){if(r.WTF)throw new Error("Range "+(u["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");g.e.c=Math.min(g.e.c,16383),g.e.r=Math.min(g.e.c,1048575)}return u["!links"]=[],u["!comments"]=[],Ce(i,129),(t.vbaraw||u["!outline"])&&Ce(i,147,N3(d,u["!outline"])),Ce(i,148,I3(g)),B4(i,u,t.Workbook),N4(i,u),k4(i,u,e,r),M4(i,u),D4(i,u,t,e),b4(i,u),R4(i,u,a),u["!margins"]&&Ce(i,476,E4(u["!margins"])),(!r||r.ignoreEC||r.ignoreEC==null)&&F4(i,u),O4(i,u,e,a),Ce(i,130),i.end()}function L4(e){var r=[],t=e.match(/^<c:numCache>/),a;(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(c){var u=c.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);u&&(r[+u[1]]=t?+u[2]:u[2])});var i=At((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(c){a=c.replace(/<.*?>/g,"")}),[r,i,a]}function U4(e,r,t,a,i,c){var u=c||{"!type":"chart"};if(!e)return c;var d=0,g=0,m="A",w={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(v){var _=L4(v);w.s.r=w.s.c=0,w.e.c=d,m=Yt(d),_[0].forEach(function(C,S){u[m+rr(S)]={t:"n",v:C,z:_[1]},g=S}),w.e.r<g&&(w.e.r=g),++d}),d>0&&(u["!ref"]=it(w)),u}function W4(e,r,t,a,i){if(!e)return e;a||(a={"!id":{}});var c={"!type":"chart","!drawel":null,"!rel":""},u,d=e.match(tu);return d&&Ho(d[0],c,i,t),(u=e.match(/drawing r:id="(.*?)"/))&&(c["!rel"]=u[1]),a["!id"][c["!rel"]]&&(c["!drawel"]=a["!id"][c["!rel"]]),c}function V4(e,r){e.l+=10;var t=Fr(e);return{name:t}}function H4(e,r,t,a,i){if(!e)return e;a||(a={"!id":{}});var c={"!type":"chart","!drawel":null,"!rel":""},u=!1;return Xn(e,function(g,m,w){switch(w){case 550:c["!rel"]=g;break;case 651:i.Sheets[t]||(i.Sheets[t]={}),g.name&&(i.Sheets[t].CodeName=g.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:u=!0;break;case 36:u=!1;break;case 37:break;case 38:break;default:if(!(m.T>0)){if(!(m.T<0)){if(!u||r.WTF)throw new Error("Unexpected record 0x"+w.toString(16))}}}},r),a["!id"][c["!rel"]]&&(c["!drawel"]=a["!id"][c["!rel"]]),c}var Go=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],G4=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],X4=[],z4=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function mf(e,r){for(var t=0;t!=e.length;++t)for(var a=e[t],i=0;i!=r.length;++i){var c=r[i];if(a[c[0]]==null)a[c[0]]=c[1];else switch(c[2]){case"bool":typeof a[c[0]]=="string"&&(a[c[0]]=Ut(a[c[0]]));break;case"int":typeof a[c[0]]=="string"&&(a[c[0]]=parseInt(a[c[0]],10));break}}}function pf(e,r){for(var t=0;t!=r.length;++t){var a=r[t];if(e[a[0]]==null)e[a[0]]=a[1];else switch(a[2]){case"bool":typeof e[a[0]]=="string"&&(e[a[0]]=Ut(e[a[0]]));break;case"int":typeof e[a[0]]=="string"&&(e[a[0]]=parseInt(e[a[0]],10));break}}}function iu(e){pf(e.WBProps,Go),pf(e.CalcPr,z4),mf(e.WBView,G4),mf(e.Sheets,X4),ei.date1904=Ut(e.WBProps.date1904)}function Y4(e){return!e.Workbook||!e.Workbook.WBProps?"false":Ut(e.Workbook.WBProps.date1904)?"true":"false"}var K4="][*?/\\".split("");function su(e,r){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var t=!0;return K4.forEach(function(a){if(e.indexOf(a)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),t}function j4(e,r,t){e.forEach(function(a,i){su(a);for(var c=0;c<i;++c)if(a==e[c])throw new Error("Duplicate Sheet Name: "+a);if(t){var u=r&&r[i]&&r[i].CodeName||a;if(u.charCodeAt(0)==95&&u.length>22)throw new Error("Bad Code Name: Worksheet"+u)}})}function Z4(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error("Invalid Workbook");if(!e.SheetNames.length)throw new Error("Workbook is empty");var r=e.Workbook&&e.Workbook.Sheets||[];j4(e.SheetNames,r,!!e.vbaraw);for(var t=0;t<e.SheetNames.length;++t)Yw(e.Sheets[e.SheetNames[t]],e.SheetNames[t],t)}var q4=/<\w+:workbook/;function J4(e,r){if(!e)throw new Error("Could not find file");var t={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},a=!1,i="xmlns",c={},u=0;if(e.replace(Or,function(g,m){var w=et(g);switch(On(w[0])){case"<?xml":break;case"<workbook":g.match(q4)&&(i="xmlns"+g.match(/<(\w+):/)[1]),t.xmlns=w[i];break;case"</workbook>":break;case"<fileVersion":delete w[0],t.AppVersion=w;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":Go.forEach(function(v){if(w[v[0]]!=null)switch(v[2]){case"bool":t.WBProps[v[0]]=Ut(w[v[0]]);break;case"int":t.WBProps[v[0]]=parseInt(w[v[0]],10);break;default:t.WBProps[v[0]]=w[v[0]]}}),w.codeName&&(t.WBProps.CodeName=Nt(w.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete w[0],t.WBView.push(w);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(w.state){case"hidden":w.Hidden=1;break;case"veryHidden":w.Hidden=2;break;default:w.Hidden=0}delete w.state,w.name=At(Nt(w.name)),delete w[0],t.Sheets.push(w);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":a=!0;break;case"</definedNames>":a=!1;break;case"<definedName":c={},c.Name=Nt(w.name),w.comment&&(c.Comment=w.comment),w.localSheetId&&(c.Sheet=+w.localSheetId),Ut(w.hidden||"0")&&(c.Hidden=!0),u=m+g.length;break;case"</definedName>":c.Ref=At(Nt(e.slice(u,m))),t.Names.push(c);break;case"<definedName/>":break;case"<calcPr":delete w[0],t.CalcPr=w;break;case"<calcPr/>":delete w[0],t.CalcPr=w;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":a=!0;break;case"</AlternateContent>":a=!1;break;case"<revisionPtr":break;default:if(!a&&r.WTF)throw new Error("unrecognized "+w[0]+" in workbook")}return g}),ba.indexOf(t.xmlns)===-1)throw new Error("Unknown Namespace: "+t.xmlns);return iu(t),t}function ou(e){var r=[nr];r[r.length]=Me("workbook",null,{xmlns:ba[0],"xmlns:r":lr.r});var t=e.Workbook&&(e.Workbook.Names||[]).length>0,a={codeName:"ThisWorkbook"};e.Workbook&&e.Workbook.WBProps&&(Go.forEach(function(d){e.Workbook.WBProps[d[0]]!=null&&e.Workbook.WBProps[d[0]]!=d[1]&&(a[d[0]]=e.Workbook.WBProps[d[0]])}),e.Workbook.WBProps.CodeName&&(a.codeName=e.Workbook.WBProps.CodeName,delete a.CodeName)),r[r.length]=Me("workbookPr",null,a);var i=e.Workbook&&e.Workbook.Sheets||[],c=0;if(i&&i[0]&&i[0].Hidden){for(r[r.length]="<bookViews>",c=0;c!=e.SheetNames.length&&!(!i[c]||!i[c].Hidden);++c);c==e.SheetNames.length&&(c=0),r[r.length]='<workbookView firstSheet="'+c+'" activeTab="'+c+'"/>',r[r.length]="</bookViews>"}for(r[r.length]="<sheets>",c=0;c!=e.SheetNames.length;++c){var u={name:kt(e.SheetNames[c].slice(0,31))};if(u.sheetId=""+(c+1),u["r:id"]="rId"+(c+1),i[c])switch(i[c].Hidden){case 1:u.state="hidden";break;case 2:u.state="veryHidden";break}r[r.length]=Me("sheet",null,u)}return r[r.length]="</sheets>",t&&(r[r.length]="<definedNames>",e.Workbook&&e.Workbook.Names&&e.Workbook.Names.forEach(function(d){var g={name:d.Name};d.Comment&&(g.comment=d.Comment),d.Sheet!=null&&(g.localSheetId=""+d.Sheet),d.Hidden&&(g.hidden="1"),d.Ref&&(r[r.length]=Me("definedName",kt(d.Ref),g))}),r[r.length]="</definedNames>"),r.length>2&&(r[r.length]="</workbook>",r[1]=r[1].replace("/>",">")),r.join("")}function Q4(e,r){var t={};return t.Hidden=e.read_shift(4),t.iTabID=e.read_shift(4),t.strRelID=J0(e),t.name=Fr(e),t}function $4(e,r){return r||(r=ve(127)),r.write_shift(4,e.Hidden),r.write_shift(4,e.iTabID),ko(e.strRelID,r),pr(e.name.slice(0,31),r),r.length>r.l?r.slice(0,r.l):r}function eE(e,r){var t={},a=e.read_shift(4);t.defaultThemeVersion=e.read_shift(4);var i=r>8?Fr(e):"";return i.length>0&&(t.CodeName=i),t.autoCompressPictures=!!(a&65536),t.backupFile=!!(a&64),t.checkCompatibility=!!(a&4096),t.date1904=!!(a&1),t.filterPrivacy=!!(a&8),t.hidePivotFieldList=!!(a&1024),t.promptedSolutions=!!(a&16),t.publishItems=!!(a&2048),t.refreshAllConnections=!!(a&262144),t.saveExternalLinkValues=!!(a&128),t.showBorderUnselectedTables=!!(a&4),t.showInkAnnotation=!!(a&32),t.showObjects=["all","placeholders","none"][a>>13&3],t.showPivotChartFilter=!!(a&32768),t.updateLinks=["userSet","never","always"][a>>8&3],t}function tE(e,r){r||(r=ve(72));var t=0;return e&&e.filterPrivacy&&(t|=8),r.write_shift(4,t),r.write_shift(4,0),Q1(e&&e.CodeName||"ThisWorkbook",r),r.slice(0,r.l)}function rE(e,r){var t={};return e.read_shift(4),t.ArchID=e.read_shift(4),e.l+=r-8,t}function nE(e,r,t){var a=e.l+r;e.l+=4,e.l+=1;var i=e.read_shift(4),c=Od(e),u=Ww(e,0,t),d=Io(e);e.l=a;var g={Name:c,Ptg:u};return i<268435455&&(g.Sheet=i),d&&(g.Comment=d),g}function aE(e,r){var t={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},a=[],i=!1;r||(r={}),r.biff=12;var c=[],u=[[]];return u.SheetNames=[],u.XTI=[],Xi[16]={n:"BrtFRTArchID$",f:rE},Xn(e,function(g,m,w){switch(w){case 156:u.SheetNames.push(g.name),t.Sheets.push(g);break;case 153:t.WBProps=g;break;case 39:g.Sheet!=null&&(r.SID=g.Sheet),g.Ref=kr(g.Ptg,null,null,u,r),delete r.SID,delete g.Ptg,c.push(g);break;case 1036:break;case 357:case 358:case 355:case 667:u[0].length?u.push([w,g]):u[0]=[w,g],u[u.length-1].XTI=[];break;case 362:u.length===0&&(u[0]=[],u[0].XTI=[]),u[u.length-1].XTI=u[u.length-1].XTI.concat(g),u.XTI=u.XTI.concat(g);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:a.push(w),i=!0;break;case 36:a.pop(),i=!1;break;case 37:a.push(w),i=!0;break;case 38:a.pop(),i=!1;break;case 16:break;default:if(!m.T){if(!i||r.WTF&&a[a.length-1]!=37&&a[a.length-1]!=35)throw new Error("Unexpected record 0x"+w.toString(16))}}},r),iu(t),t.Names=c,t.supbooks=u,t}function iE(e,r){Ce(e,143);for(var t=0;t!=r.SheetNames.length;++t){var a=r.Workbook&&r.Workbook.Sheets&&r.Workbook.Sheets[t]&&r.Workbook.Sheets[t].Hidden||0,i={Hidden:a,iTabID:t+1,strRelID:"rId"+(t+1),name:r.SheetNames[t]};Ce(e,156,$4(i))}Ce(e,144)}function sE(e,r){r||(r=ve(127));for(var t=0;t!=4;++t)r.write_shift(4,0);return pr("SheetJS",r),pr(_s.version,r),pr(_s.version,r),pr("7262",r),r.length>r.l?r.slice(0,r.l):r}function oE(e,r){r||(r=ve(29)),r.write_shift(-4,0),r.write_shift(-4,460),r.write_shift(4,28800),r.write_shift(4,17600),r.write_shift(4,500),r.write_shift(4,e),r.write_shift(4,e);var t=120;return r.write_shift(1,t),r.length>r.l?r.slice(0,r.l):r}function cE(e,r){if(!(!r.Workbook||!r.Workbook.Sheets)){for(var t=r.Workbook.Sheets,a=0,i=-1,c=-1;a<t.length;++a)!t[a]||!t[a].Hidden&&i==-1?i=a:t[a].Hidden==1&&c==-1&&(c=a);c>i||(Ce(e,135),Ce(e,158,oE(i)),Ce(e,136))}}function fE(e,r){var t=Gr();return Ce(t,131),Ce(t,128,sE()),Ce(t,153,tE(e.Workbook&&e.Workbook.WBProps||null)),cE(t,e),iE(t,e),Ce(t,132),t.end()}function lE(e,r,t){return r.slice(-4)===".bin"?aE(e,t):J4(e,t)}function uE(e,r,t,a,i,c,u,d){return r.slice(-4)===".bin"?y4(e,a,t,i,c,u,d):n3(e,a,t,i,c,u,d)}function hE(e,r,t,a,i,c,u,d){return r.slice(-4)===".bin"?H4(e,a,t,i,c):W4(e,a,t,i,c)}function dE(e,r,t,a,i,c,u,d){return r.slice(-4)===".bin"?gp():mp()}function xE(e,r,t,a,i,c,u,d){return r.slice(-4)===".bin"?dp():xp()}function gE(e,r,t,a){return r.slice(-4)===".bin"?lm(e,t,a):Qg(e,t,a)}function mE(e,r,t){return Vl(e,t)}function pE(e,r,t){return r.slice(-4)===".bin"?pg(e,t):xg(e,t)}function wE(e,r,t){return r.slice(-4)===".bin"?cp(e,t):$m(e,t)}function EE(e,r,t){return r.slice(-4)===".bin"?qm(e):jm(e)}function vE(e,r,t,a){return t.slice(-4)===".bin"?Jm(e,r,t,a):void 0}function _E(e,r,t){return r.slice(-4)===".bin"?zm(e,r,t):Km(e,r,t)}function AE(e,r,t){return(r.slice(-4)===".bin"?fE:ou)(e)}function CE(e,r,t,a,i){return(r.slice(-4)===".bin"?P4:ru)(e,t,a,i)}function TE(e,r,t){return(r.slice(-4)===".bin"?vm:Ul)(e,t)}function SE(e,r,t){return(r.slice(-4)===".bin"?vg:Fl)(e,t)}function yE(e,r,t){return(r.slice(-4)===".bin"?fp:Xl)(e)}function IE(e){return(e.slice(-4)===".bin"?Ym:Hl)()}var cu=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,fu=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function En(e,r){var t=e.split(/\s+/),a=[];if(a[0]=t[0],t.length===1)return a;var i=e.match(cu),c,u,d,g;if(i)for(g=0;g!=i.length;++g)c=i[g].match(fu),(u=c[1].indexOf(":"))===-1?a[c[1]]=c[2].slice(1,c[2].length-1):(c[1].slice(0,6)==="xmlns:"?d="xmlns"+c[1].slice(6):d=c[1].slice(u+1),a[d]=c[2].slice(1,c[2].length-1));return a}function kE(e){var r=e.split(/\s+/),t={};if(r.length===1)return t;var a=e.match(cu),i,c,u,d;if(a)for(d=0;d!=a.length;++d)i=a[d].match(fu),(c=i[1].indexOf(":"))===-1?t[i[1]]=i[2].slice(1,i[2].length-1):(i[1].slice(0,6)==="xmlns:"?u="xmlns"+i[1].slice(6):u=i[1].slice(c+1),t[u]=i[2].slice(1,i[2].length-1));return t}var Fi;function bE(e,r){var t=Fi[e]||At(e);return t==="General"?Ca(r):xn(t,r)}function NE(e,r,t,a){var i=a;switch((t[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":i=Ut(a);break;case"i2":case"int":i=parseInt(a,10);break;case"r4":case"float":i=parseFloat(a);break;case"date":case"dateTime.tz":i=Wt(a);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+t[0])}e[At(r)]=i}function FE(e,r,t){if(e.t!=="z"){if(!t||t.cellText!==!1)try{e.t==="e"?e.w=e.w||zn[e.v]:r==="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Bi(e.v):e.w=Ca(e.v):e.w=bE(r||"General",e.v)}catch(c){if(t.WTF)throw c}try{var a=Fi[r]||r||"General";if(t.cellNF&&(e.z=a),t.cellDates&&e.t=="n"&&ai(a)){var i=wa(e.v);i&&(e.t="d",e.v=new Date(i.y,i.m-1,i.d,i.H,i.M,i.S,i.u))}}catch(c){if(t.WTF)throw c}}}function RE(e,r,t){if(t.cellStyles&&r.Interior){var a=r.Interior;a.Pattern&&(a.patternType=Xg[a.Pattern]||a.Pattern)}e[r.ID]=r}function OE(e,r,t,a,i,c,u,d,g,m){var w="General",v=a.StyleID,_={};m=m||{};var C=[],S=0;for(v===void 0&&d&&(v=d.StyleID),v===void 0&&u&&(v=u.StyleID);c[v]!==void 0&&(c[v].nf&&(w=c[v].nf),c[v].Interior&&C.push(c[v].Interior),!!c[v].Parent);)v=c[v].Parent;switch(t.Type){case"Boolean":a.t="b",a.v=Ut(e);break;case"String":a.t="s",a.r=Oc(At(e)),a.v=e.indexOf("<")>-1?At(r||e).replace(/<.*?>/g,""):a.r;break;case"DateTime":e.slice(-1)!="Z"&&(e+="Z"),a.v=(Wt(e)-new Date(Date.UTC(1899,11,30)))/(1440*60*1e3),a.v!==a.v?a.v=At(e):a.v<60&&(a.v=a.v-1),(!w||w=="General")&&(w="yyyy-mm-dd");case"Number":a.v===void 0&&(a.v=+e),a.t||(a.t="n");break;case"Error":a.t="e",a.v=nl[e],m.cellText!==!1&&(a.w=e);break;default:e==""&&r==""?a.t="z":(a.t="s",a.v=Oc(r||e));break}if(FE(a,w,m),m.cellFormula!==!1)if(a.Formula){var A=At(a.Formula);A.charCodeAt(0)==61&&(A=A.slice(1)),a.f=$a(A,i),delete a.Formula,a.ArrayRange=="RC"?a.F=$a("RC:RC",i):a.ArrayRange&&(a.F=$a(a.ArrayRange,i),g.push([Ct(a.F),a.F]))}else for(S=0;S<g.length;++S)i.r>=g[S][0].s.r&&i.r<=g[S][0].e.r&&i.c>=g[S][0].s.c&&i.c<=g[S][0].e.c&&(a.F=g[S][1]);m.cellStyles&&(C.forEach(function(y){!_.patternType&&y.patternType&&(_.patternType=y.patternType)}),a.s=_),a.StyleID!==void 0&&(a.ixfe=a.StyleID)}function DE(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.v=e.w=e.ixfe=void 0}function v0(e,r){var t=r||{};ii();var a=_i(_o(e));(t.type=="binary"||t.type=="array"||t.type=="base64")&&(a=Nt(a));var i=a.slice(0,1024).toLowerCase(),c=!1;if(i=i.replace(/".*?"/g,""),(i.indexOf(">")&1023)>Math.min(i.indexOf(",")&1023,i.indexOf(";")&1023)){var u=Vt(t);return u.type="string",ri.to_workbook(a,u)}if(i.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function($e){i.indexOf("<"+$e)>=0&&(c=!0)}),c)return Ev(a,t);Fi={"General Number":"General","General Date":qe[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":qe[15],"Short Date":qe[14],"Long Time":qe[19],"Medium Time":qe[18],"Short Time":qe[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:qe[2],Standard:qe[4],Percent:qe[10],Scientific:qe[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var d,g=[],m,w={},v=[],_=t.dense?[]:{},C="",S={},A={},y=En('<Data ss:Type="String">'),D=0,P=0,b=0,V={s:{r:2e6,c:2e6},e:{r:0,c:0}},te={},W={},N="",j=0,O=[],ae={},Q={},X=0,ie=[],Ee=[],q={},ue=[],de,We=!1,se=[],Le=[],Ge={},z=0,ne=0,Z={Sheets:[],WBProps:{date1904:!1}},ee={};Li.lastIndex=0,a=a.replace(/<!--([\s\S]*?)-->/mg,"");for(var oe="";d=Li.exec(a);)switch(d[3]=(oe=d[3]).toLowerCase()){case"data":if(oe=="data"){if(d[1]==="/"){if((m=g.pop())[0]!==d[3])throw new Error("Bad state: "+m.join("|"))}else d[0].charAt(d[0].length-2)!=="/"&&g.push([d[3],!0]);break}if(g[g.length-1][1])break;d[1]==="/"?OE(a.slice(D,d.index),N,y,g[g.length-1][0]=="comment"?q:S,{c:P,r:b},te,ue[P],A,se,t):(N="",y=En(d[0]),D=d.index+d[0].length);break;case"cell":if(d[1]==="/")if(Ee.length>0&&(S.c=Ee),(!t.sheetRows||t.sheetRows>b)&&S.v!==void 0&&(t.dense?(_[b]||(_[b]=[]),_[b][P]=S):_[Yt(P)+rr(b)]=S),S.HRef&&(S.l={Target:At(S.HRef)},S.HRefScreenTip&&(S.l.Tooltip=S.HRefScreenTip),delete S.HRef,delete S.HRefScreenTip),(S.MergeAcross||S.MergeDown)&&(z=P+(parseInt(S.MergeAcross,10)|0),ne=b+(parseInt(S.MergeDown,10)|0),O.push({s:{c:P,r:b},e:{c:z,r:ne}})),!t.sheetStubs)S.MergeAcross?P=z+1:++P;else if(S.MergeAcross||S.MergeDown){for(var Ie=P;Ie<=z;++Ie)for(var Ae=b;Ae<=ne;++Ae)(Ie>P||Ae>b)&&(t.dense?(_[Ae]||(_[Ae]=[]),_[Ae][Ie]={t:"z"}):_[Yt(Ie)+rr(Ae)]={t:"z"});P=z+1}else++P;else S=kE(d[0]),S.Index&&(P=+S.Index-1),P<V.s.c&&(V.s.c=P),P>V.e.c&&(V.e.c=P),d[0].slice(-2)==="/>"&&++P,Ee=[];break;case"row":d[1]==="/"||d[0].slice(-2)==="/>"?(b<V.s.r&&(V.s.r=b),b>V.e.r&&(V.e.r=b),d[0].slice(-2)==="/>"&&(A=En(d[0]),A.Index&&(b=+A.Index-1)),P=0,++b):(A=En(d[0]),A.Index&&(b=+A.Index-1),Ge={},(A.AutoFitHeight=="0"||A.Height)&&(Ge.hpx=parseInt(A.Height,10),Ge.hpt=Gi(Ge.hpx),Le[b]=Ge),A.Hidden=="1"&&(Ge.hidden=!0,Le[b]=Ge));break;case"worksheet":if(d[1]==="/"){if((m=g.pop())[0]!==d[3])throw new Error("Bad state: "+m.join("|"));v.push(C),V.s.r<=V.e.r&&V.s.c<=V.e.c&&(_["!ref"]=it(V),t.sheetRows&&t.sheetRows<=V.e.r&&(_["!fullref"]=_["!ref"],V.e.r=t.sheetRows-1,_["!ref"]=it(V))),O.length&&(_["!merges"]=O),ue.length>0&&(_["!cols"]=ue),Le.length>0&&(_["!rows"]=Le),w[C]=_}else V={s:{r:2e6,c:2e6},e:{r:0,c:0}},b=P=0,g.push([d[3],!1]),m=En(d[0]),C=At(m.Name),_=t.dense?[]:{},O=[],se=[],Le=[],ee={name:C,Hidden:0},Z.Sheets.push(ee);break;case"table":if(d[1]==="/"){if((m=g.pop())[0]!==d[3])throw new Error("Bad state: "+m.join("|"))}else{if(d[0].slice(-2)=="/>")break;g.push([d[3],!1]),ue=[],We=!1}break;case"style":d[1]==="/"?RE(te,W,t):W=En(d[0]);break;case"numberformat":W.nf=At(En(d[0]).Format||"General"),Fi[W.nf]&&(W.nf=Fi[W.nf]);for(var Te=0;Te!=392&&qe[Te]!=W.nf;++Te);if(Te==392){for(Te=57;Te!=392;++Te)if(qe[Te]==null){Wn(W.nf,Te);break}}break;case"column":if(g[g.length-1][0]!=="table")break;if(de=En(d[0]),de.Hidden&&(de.hidden=!0,delete de.Hidden),de.Width&&(de.wpx=parseInt(de.Width,10)),!We&&de.wpx>10){We=!0,br=Pl;for(var Se=0;Se<ue.length;++Se)ue[Se]&&sa(ue[Se])}We&&sa(de),ue[de.Index-1||ue.length]=de;for(var Ye=0;Ye<+de.Span;++Ye)ue[ue.length]=Vt(de);break;case"namedrange":if(d[1]==="/")break;Z.Names||(Z.Names=[]);var K=et(d[0]),Xe={Name:K.Name,Ref:$a(K.RefersTo.slice(1),{r:0,c:0})};Z.Sheets.length>0&&(Xe.Sheet=Z.Sheets.length-1),Z.Names.push(Xe);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(d[0].slice(-2)==="/>")break;d[1]==="/"?N+=a.slice(j,d.index):j=d.index+d[0].length;break;case"interior":if(!t.cellStyles)break;W.Interior=En(d[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(d[0].slice(-2)==="/>")break;d[1]==="/"?ax(ae,oe,a.slice(X,d.index)):X=d.index+d[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(d[1]==="/"){if((m=g.pop())[0]!==d[3])throw new Error("Bad state: "+m.join("|"))}else g.push([d[3],!1]);break;case"comment":if(d[1]==="/"){if((m=g.pop())[0]!==d[3])throw new Error("Bad state: "+m.join("|"));DE(q),Ee.push(q)}else g.push([d[3],!1]),m=En(d[0]),q={a:m.Author};break;case"autofilter":if(d[1]==="/"){if((m=g.pop())[0]!==d[3])throw new Error("Bad state: "+m.join("|"))}else if(d[0].charAt(d[0].length-2)!=="/"){var st=En(d[0]);_["!autofilter"]={ref:$a(st.Range).replace(/\$/g,"")},g.push([d[3],!0])}break;case"name":break;case"datavalidation":if(d[1]==="/"){if((m=g.pop())[0]!==d[3])throw new Error("Bad state: "+m.join("|"))}else d[0].charAt(d[0].length-2)!=="/"&&g.push([d[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(d[1]==="/"){if((m=g.pop())[0]!==d[3])throw new Error("Bad state: "+m.join("|"))}else d[0].charAt(d[0].length-2)!=="/"&&g.push([d[3],!0]);break;case"null":break;default:if(g.length==0&&d[3]=="document"||g.length==0&&d[3]=="uof")return Af(a,t);var mt=!0;switch(g[g.length-1][0]){case"officedocumentsettings":switch(d[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:mt=!1}break;case"componentoptions":switch(d[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:mt=!1}break;case"excelworkbook":switch(d[3]){case"date1904":Z.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:mt=!1}break;case"workbookoptions":switch(d[3]){case"owcversion":break;case"height":break;case"width":break;default:mt=!1}break;case"worksheetoptions":switch(d[3]){case"visible":if(d[0].slice(-2)!=="/>")if(d[1]==="/")switch(a.slice(X,d.index)){case"SheetHidden":ee.Hidden=1;break;case"SheetVeryHidden":ee.Hidden=2;break}else X=d.index+d[0].length;break;case"header":_["!margins"]||Aa(_["!margins"]={},"xlml"),isNaN(+et(d[0]).Margin)||(_["!margins"].header=+et(d[0]).Margin);break;case"footer":_["!margins"]||Aa(_["!margins"]={},"xlml"),isNaN(+et(d[0]).Margin)||(_["!margins"].footer=+et(d[0]).Margin);break;case"pagemargins":var nt=et(d[0]);_["!margins"]||Aa(_["!margins"]={},"xlml"),isNaN(+nt.Top)||(_["!margins"].top=+nt.Top),isNaN(+nt.Left)||(_["!margins"].left=+nt.Left),isNaN(+nt.Right)||(_["!margins"].right=+nt.Right),isNaN(+nt.Bottom)||(_["!margins"].bottom=+nt.Bottom);break;case"displayrighttoleft":Z.Views||(Z.Views=[]),Z.Views[0]||(Z.Views[0]={}),Z.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":_["!outline"]||(_["!outline"]={}),_["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":_["!outline"]||(_["!outline"]={}),_["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:mt=!1}break;case"pivottable":case"pivotcache":switch(d[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:mt=!1}break;case"pagebreaks":switch(d[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:mt=!1}break;case"autofilter":switch(d[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:mt=!1}break;case"querytable":switch(d[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:mt=!1}break;case"datavalidation":switch(d[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:mt=!1}break;case"sorting":case"conditionalformatting":switch(d[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:mt=!1}break;case"mapinfo":case"schema":case"data":switch(d[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:mt=!1}break;case"smarttags":break;default:mt=!1;break}if(mt||d[3].match(/!\[CDATA/))break;if(!g[g.length-1][1])throw"Unrecognized tag: "+d[3]+"|"+g.join("|");if(g[g.length-1][0]==="customdocumentproperties"){if(d[0].slice(-2)==="/>")break;d[1]==="/"?NE(Q,oe,ie,a.slice(X,d.index)):(ie=d,X=d.index+d[0].length);break}if(t.WTF)throw"Unrecognized tag: "+d[3]+"|"+g.join("|")}var Ne={};return!t.bookSheets&&!t.bookProps&&(Ne.Sheets=w),Ne.SheetNames=v,Ne.Workbook=Z,Ne.SSF=Vt(qe),Ne.Props=ae,Ne.Custprops=Q,Ne}function ao(e,r){switch(zo(r=r||{}),r.type||"base64"){case"base64":return v0(en(e),r);case"binary":case"buffer":case"file":return v0(e,r);case"array":return v0(fa(e),r)}}function BE(e,r){var t=[];return e.Props&&t.push(ix(e.Props,r)),e.Custprops&&t.push(sx(e.Props,e.Custprops)),t.join("")}function ME(){return""}function PE(e,r){var t=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return r.cellXfs.forEach(function(a,i){var c=[];c.push(Me("NumberFormat",null,{"ss:Format":kt(qe[a.numFmtId])}));var u={"ss:ID":"s"+(21+i)};t.push(Me("Style",c.join(""),u))}),Me("Styles",t.join(""))}function lu(e){return Me("NamedRange",null,{"ss:Name":e.Name,"ss:RefersTo":"="+Uo(e.Ref,{r:0,c:0})})}function LE(e){if(!((e||{}).Workbook||{}).Names)return"";for(var r=e.Workbook.Names,t=[],a=0;a<r.length;++a){var i=r[a];i.Sheet==null&&(i.Name.match(/^_xlfn\./)||t.push(lu(i)))}return Me("Names",t.join(""))}function UE(e,r,t,a){if(!e||!((a||{}).Workbook||{}).Names)return"";for(var i=a.Workbook.Names,c=[],u=0;u<i.length;++u){var d=i[u];d.Sheet==t&&(d.Name.match(/^_xlfn\./)||c.push(lu(d)))}return c.join("")}function WE(e,r,t,a){if(!e)return"";var i=[];if(e["!margins"]&&(i.push("<PageSetup>"),e["!margins"].header&&i.push(Me("Header",null,{"x:Margin":e["!margins"].header})),e["!margins"].footer&&i.push(Me("Footer",null,{"x:Margin":e["!margins"].footer})),i.push(Me("PageMargins",null,{"x:Bottom":e["!margins"].bottom||"0.75","x:Left":e["!margins"].left||"0.7","x:Right":e["!margins"].right||"0.7","x:Top":e["!margins"].top||"0.75"})),i.push("</PageSetup>")),a&&a.Workbook&&a.Workbook.Sheets&&a.Workbook.Sheets[t])if(a.Workbook.Sheets[t].Hidden)i.push(Me("Visible",a.Workbook.Sheets[t].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var c=0;c<t&&!(a.Workbook.Sheets[c]&&!a.Workbook.Sheets[c].Hidden);++c);c==t&&i.push("<Selected/>")}return((((a||{}).Workbook||{}).Views||[])[0]||{}).RTL&&i.push("<DisplayRightToLeft/>"),e["!protect"]&&(i.push(Cr("ProtectContents","True")),e["!protect"].objects&&i.push(Cr("ProtectObjects","True")),e["!protect"].scenarios&&i.push(Cr("ProtectScenarios","True")),e["!protect"].selectLockedCells!=null&&!e["!protect"].selectLockedCells?i.push(Cr("EnableSelection","NoSelection")):e["!protect"].selectUnlockedCells!=null&&!e["!protect"].selectUnlockedCells&&i.push(Cr("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(u){e["!protect"][u[0]]&&i.push("<"+u[1]+"/>")})),i.length==0?"":Me("WorksheetOptions",i.join(""),{xmlns:qr.x})}function VE(e){return e.map(function(r){var t=cd(r.t||""),a=Me("ss:Data",t,{xmlns:"http://www.w3.org/TR/REC-html40"});return Me("Comment",a,{"ss:Author":r.a})}).join("")}function HE(e,r,t,a,i,c,u){if(!e||e.v==null&&e.f==null)return"";var d={};if(e.f&&(d["ss:Formula"]="="+kt(Uo(e.f,u))),e.F&&e.F.slice(0,r.length)==r){var g=Kt(e.F.slice(r.length+1));d["ss:ArrayRange"]="RC:R"+(g.r==u.r?"":"["+(g.r-u.r)+"]")+"C"+(g.c==u.c?"":"["+(g.c-u.c)+"]")}if(e.l&&e.l.Target&&(d["ss:HRef"]=kt(e.l.Target),e.l.Tooltip&&(d["x:HRefScreenTip"]=kt(e.l.Tooltip))),t["!merges"])for(var m=t["!merges"],w=0;w!=m.length;++w)m[w].s.c!=u.c||m[w].s.r!=u.r||(m[w].e.c>m[w].s.c&&(d["ss:MergeAcross"]=m[w].e.c-m[w].s.c),m[w].e.r>m[w].s.r&&(d["ss:MergeDown"]=m[w].e.r-m[w].s.r));var v="",_="";switch(e.t){case"z":if(!a.sheetStubs)return"";break;case"n":v="Number",_=String(e.v);break;case"b":v="Boolean",_=e.v?"1":"0";break;case"e":v="Error",_=zn[e.v];break;case"d":v="DateTime",_=new Date(e.v).toISOString(),e.z==null&&(e.z=e.z||qe[14]);break;case"s":v="String",_=od(e.v||"");break}var C=ua(a.cellXfs,e,a);d["ss:StyleID"]="s"+(21+C),d["ss:Index"]=u.c+1;var S=e.v!=null?_:"",A=e.t=="z"?"":'<Data ss:Type="'+v+'">'+S+"</Data>";return(e.c||[]).length>0&&(A+=VE(e.c)),Me("Cell",A,d)}function GE(e,r){var t='<Row ss:Index="'+(e+1)+'"';return r&&(r.hpt&&!r.hpx&&(r.hpx=ni(r.hpt)),r.hpx&&(t+=' ss:AutoFitHeight="0" ss:Height="'+r.hpx+'"'),r.hidden&&(t+=' ss:Hidden="1"')),t+">"}function XE(e,r,t,a){if(!e["!ref"])return"";var i=Ct(e["!ref"]),c=e["!merges"]||[],u=0,d=[];e["!cols"]&&e["!cols"].forEach(function(y,D){sa(y);var P=!!y.width,b=zs(D,y),V={"ss:Index":D+1};P&&(V["ss:Width"]=Vi(b.width)),y.hidden&&(V["ss:Hidden"]="1"),d.push(Me("Column",null,V))});for(var g=Array.isArray(e),m=i.s.r;m<=i.e.r;++m){for(var w=[GE(m,(e["!rows"]||[])[m])],v=i.s.c;v<=i.e.c;++v){var _=!1;for(u=0;u!=c.length;++u)if(!(c[u].s.c>v)&&!(c[u].s.r>m)&&!(c[u].e.c<v)&&!(c[u].e.r<m)){(c[u].s.c!=v||c[u].s.r!=m)&&(_=!0);break}if(!_){var C={r:m,c:v},S=Qe(C),A=g?(e[m]||[])[v]:e[S];w.push(HE(A,S,e,r,t,a,C))}}w.push("</Row>"),w.length>2&&d.push(w.join(""))}return d.join("")}function zE(e,r,t){var a=[],i=t.SheetNames[e],c=t.Sheets[i],u=c?UE(c,r,e,t):"";return u.length>0&&a.push("<Names>"+u+"</Names>"),u=c?XE(c,r,e,t):"",u.length>0&&a.push("<Table>"+u+"</Table>"),a.push(WE(c,r,e,t)),a.join("")}function YE(e,r){r||(r={}),e.SSF||(e.SSF=Vt(qe)),e.SSF&&(ii(),Ls(e.SSF),r.revssf=Ws(e.SSF),r.revssf[e.SSF[65535]]=0,r.ssf=e.SSF,r.cellXfs=[],ua(r.cellXfs,{},{revssf:{General:0}}));var t=[];t.push(BE(e,r)),t.push(ME()),t.push(""),t.push("");for(var a=0;a<e.SheetNames.length;++a)t.push(Me("Worksheet",zE(a,r,e),{"ss:Name":kt(e.SheetNames[a])}));return t[2]=PE(e,r),t[3]=LE(e),nr+Me("Workbook",t.join(""),{xmlns:qr.ss,"xmlns:o":qr.o,"xmlns:x":qr.x,"xmlns:ss":qr.ss,"xmlns:dt":qr.dt,"xmlns:html":qr.html})}function KE(e){var r={},t=e.content;if(t.l=28,r.AnsiUserType=t.read_shift(0,"lpstr-ansi"),r.AnsiClipboardFormat=Ld(t),t.length-t.l<=4)return r;var a=t.read_shift(4);if(a==0||a>40||(t.l-=4,r.Reserved1=t.read_shift(0,"lpstr-ansi"),t.length-t.l<=4)||(a=t.read_shift(4),a!==1907505652)||(r.UnicodeClipboardFormat=Ud(t),a=t.read_shift(4),a==0||a>40))return r;t.l-=4,r.Reserved2=t.read_shift(0,"lpwstr")}var jE=[60,1084,2066,2165,2175];function ZE(e,r,t,a,i){var c=a,u=[],d=t.slice(t.l,t.l+c);if(i&&i.enc&&i.enc.insitu&&d.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:i.enc.insitu(d)}u.push(d),t.l+=c;for(var g=Ln(t,t.l),m=io[g],w=0;m!=null&&jE.indexOf(g)>-1;)c=Ln(t,t.l+2),w=t.l+4,g==2066?w+=4:(g==2165||g==2175)&&(w+=12),d=t.slice(w,t.l+4+c),u.push(d),t.l+=4+c,m=io[g=Ln(t,t.l)];var v=mr(u);Ar(v,0);var _=0;v.lens=[];for(var C=0;C<u.length;++C)v.lens.push(_),_+=u[C].length;if(v.length<a)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+v.length+" < "+a;return r.f(v,v.length,i)}function kn(e,r,t){if(e.t!=="z"&&e.XF){var a=0;try{a=e.z||e.XF.numFmtId||0,r.cellNF&&(e.z=qe[a])}catch(c){if(r.WTF)throw c}if(!r||r.cellText!==!1)try{e.t==="e"?e.w=e.w||zn[e.v]:a===0||a=="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Bi(e.v):e.w=Ca(e.v):e.w=xn(a,e.v,{date1904:!!t,dateNF:r&&r.dateNF})}catch(c){if(r.WTF)throw c}if(r.cellDates&&a&&e.t=="n"&&ai(qe[a]||String(a))){var i=wa(e.v);i&&(e.t="d",e.v=new Date(i.y,i.m-1,i.d,i.H,i.M,i.S,i.u))}}}function ws(e,r,t){return{v:e,ixfe:r,t}}function qE(e,r){var t={opts:{}},a={},i=r.dense?[]:{},c={},u={},d=null,g=[],m="",w={},v,_="",C,S,A,y,D={},P=[],b,V,te=[],W=[],N={Sheets:[],WBProps:{date1904:!1},Views:[{}]},j={},O=function(ot){return ot<8?Ea[ot]:ot<64&&W[ot-8]||Ea[ot]},ae=function(ot,Dt,Lr){var ft=Dt.XF.data;if(!(!ft||!ft.patternType||!Lr||!Lr.cellStyles)){Dt.s={},Dt.s.patternType=ft.patternType;var Be;(Be=Wi(O(ft.icvFore)))&&(Dt.s.fgColor={rgb:Be}),(Be=Wi(O(ft.icvBack)))&&(Dt.s.bgColor={rgb:Be})}},Q=function(ot,Dt,Lr){if(!(Ge>1)&&!(Lr.sheetRows&&ot.r>=Lr.sheetRows)){if(Lr.cellStyles&&Dt.XF&&Dt.XF.data&&ae(ot,Dt,Lr),delete Dt.ixfe,delete Dt.XF,v=ot,_=Qe(ot),(!u||!u.s||!u.e)&&(u={s:{r:0,c:0},e:{r:0,c:0}}),ot.r<u.s.r&&(u.s.r=ot.r),ot.c<u.s.c&&(u.s.c=ot.c),ot.r+1>u.e.r&&(u.e.r=ot.r+1),ot.c+1>u.e.c&&(u.e.c=ot.c+1),Lr.cellFormula&&Dt.f){for(var ft=0;ft<P.length;++ft)if(!(P[ft][0].s.c>ot.c||P[ft][0].s.r>ot.r)&&!(P[ft][0].e.c<ot.c||P[ft][0].e.r<ot.r)){Dt.F=it(P[ft][0]),(P[ft][0].s.c!=ot.c||P[ft][0].s.r!=ot.r)&&delete Dt.f,Dt.f&&(Dt.f=""+kr(P[ft][1],u,ot,se,X));break}}Lr.dense?(i[ot.r]||(i[ot.r]=[]),i[ot.r][ot.c]=Dt):i[_]=Dt}},X={enc:!1,sbcch:0,snames:[],sharedf:D,arrayf:P,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!r&&!!r.cellStyles,WTF:!!r&&!!r.wtf};r.password&&(X.password=r.password);var ie,Ee=[],q=[],ue=[],de=[],We=!1,se=[];se.SheetNames=X.snames,se.sharedf=X.sharedf,se.arrayf=X.arrayf,se.names=[],se.XTI=[];var Le=0,Ge=0,z=0,ne=[],Z=[],ee;X.codepage=1200,vn(1200);for(var oe=!1;e.l<e.length-1;){var Ie=e.l,Ae=e.read_shift(2);if(Ae===0&&Le===10)break;var Te=e.l===e.length?0:e.read_shift(2),Se=io[Ae];if(Se&&Se.f){if(r.bookSheets&&Le===133&&Ae!==133)break;if(Le=Ae,Se.r===2||Se.r==12){var Ye=e.read_shift(2);if(Te-=2,!X.enc&&Ye!==Ae&&((Ye&255)<<8|Ye>>8)!==Ae)throw new Error("rt mismatch: "+Ye+"!="+Ae);Se.r==12&&(e.l+=10,Te-=10)}var K={};if(Ae===10?K=Se.f(e,Te,X):K=ZE(Ae,Se,e,Te,X),Ge==0&&[9,521,1033,2057].indexOf(Le)===-1)continue;switch(Ae){case 34:t.opts.Date1904=N.WBProps.date1904=K;break;case 134:t.opts.WriteProtect=!0;break;case 47:if(X.enc||(e.l=0),X.enc=K,!r.password)throw new Error("File is password-protected");if(K.valid==null)throw new Error("Encryption scheme unsupported");if(!K.valid)throw new Error("Password is incorrect");break;case 92:X.lastuser=K;break;case 66:var Xe=Number(K);switch(Xe){case 21010:Xe=1200;break;case 32768:Xe=1e4;break;case 32769:Xe=1252;break}vn(X.codepage=Xe),oe=!0;break;case 317:X.rrtabid=K;break;case 25:X.winlocked=K;break;case 439:t.opts.RefreshAll=K;break;case 12:t.opts.CalcCount=K;break;case 16:t.opts.CalcDelta=K;break;case 17:t.opts.CalcIter=K;break;case 13:t.opts.CalcMode=K;break;case 14:t.opts.CalcPrecision=K;break;case 95:t.opts.CalcSaveRecalc=K;break;case 15:X.CalcRefMode=K;break;case 2211:t.opts.FullCalc=K;break;case 129:K.fDialog&&(i["!type"]="dialog"),K.fBelow||((i["!outline"]||(i["!outline"]={})).above=!0),K.fRight||((i["!outline"]||(i["!outline"]={})).left=!0);break;case 224:te.push(K);break;case 430:se.push([K]),se[se.length-1].XTI=[];break;case 35:case 547:se[se.length-1].push(K);break;case 24:case 536:ee={Name:K.Name,Ref:kr(K.rgce,u,null,se,X)},K.itab>0&&(ee.Sheet=K.itab-1),se.names.push(ee),se[0]||(se[0]=[],se[0].XTI=[]),se[se.length-1].push(K),K.Name=="_xlnm._FilterDatabase"&&K.itab>0&&K.rgce&&K.rgce[0]&&K.rgce[0][0]&&K.rgce[0][0][0]=="PtgArea3d"&&(Z[K.itab-1]={ref:it(K.rgce[0][0][1][2])});break;case 22:X.ExternCount=K;break;case 23:se.length==0&&(se[0]=[],se[0].XTI=[]),se[se.length-1].XTI=se[se.length-1].XTI.concat(K),se.XTI=se.XTI.concat(K);break;case 2196:if(X.biff<8)break;ee!=null&&(ee.Comment=K[1]);break;case 18:i["!protect"]=K;break;case 19:K!==0&&X.WTF&&console.error("Password verifier: "+K);break;case 133:c[K.pos]=K,X.snames.push(K.name);break;case 10:{if(--Ge)break;if(u.e){if(u.e.r>0&&u.e.c>0){if(u.e.r--,u.e.c--,i["!ref"]=it(u),r.sheetRows&&r.sheetRows<=u.e.r){var st=u.e.r;u.e.r=r.sheetRows-1,i["!fullref"]=i["!ref"],i["!ref"]=it(u),u.e.r=st}u.e.r++,u.e.c++}Ee.length>0&&(i["!merges"]=Ee),q.length>0&&(i["!objects"]=q),ue.length>0&&(i["!cols"]=ue),de.length>0&&(i["!rows"]=de),N.Sheets.push(j)}m===""?w=i:a[m]=i,i=r.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(X.biff===8&&(X.biff={9:2,521:3,1033:4}[Ae]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[K.BIFFVer]||8),X.biffguess=K.BIFFVer==0,K.BIFFVer==0&&K.dt==4096&&(X.biff=5,oe=!0,vn(X.codepage=28591)),X.biff==8&&K.BIFFVer==0&&K.dt==16&&(X.biff=2),Ge++)break;if(i=r.dense?[]:{},X.biff<8&&!oe&&(oe=!0,vn(X.codepage=r.codepage||1252)),X.biff<5||K.BIFFVer==0&&K.dt==4096){m===""&&(m="Sheet1"),u={s:{r:0,c:0},e:{r:0,c:0}};var mt={pos:e.l-Te,name:m};c[mt.pos]=mt,X.snames.push(m)}else m=(c[Ie]||{name:""}).name;K.dt==32&&(i["!type"]="chart"),K.dt==64&&(i["!type"]="macro"),Ee=[],q=[],X.arrayf=P=[],ue=[],de=[],We=!1,j={Hidden:(c[Ie]||{hs:0}).hs,name:m}}break;case 515:case 3:case 2:i["!type"]=="chart"&&(r.dense?(i[K.r]||[])[K.c]:i[Qe({c:K.c,r:K.r})])&&++K.c,b={ixfe:K.ixfe,XF:te[K.ixfe]||{},v:K.val,t:"n"},z>0&&(b.z=ne[b.ixfe>>8&63]),kn(b,r,t.opts.Date1904),Q({c:K.c,r:K.r},b,r);break;case 5:case 517:b={ixfe:K.ixfe,XF:te[K.ixfe],v:K.val,t:K.t},z>0&&(b.z=ne[b.ixfe>>8&63]),kn(b,r,t.opts.Date1904),Q({c:K.c,r:K.r},b,r);break;case 638:b={ixfe:K.ixfe,XF:te[K.ixfe],v:K.rknum,t:"n"},z>0&&(b.z=ne[b.ixfe>>8&63]),kn(b,r,t.opts.Date1904),Q({c:K.c,r:K.r},b,r);break;case 189:for(var nt=K.c;nt<=K.C;++nt){var Ne=K.rkrec[nt-K.c][0];b={ixfe:Ne,XF:te[Ne],v:K.rkrec[nt-K.c][1],t:"n"},z>0&&(b.z=ne[b.ixfe>>8&63]),kn(b,r,t.opts.Date1904),Q({c:nt,r:K.r},b,r)}break;case 6:case 518:case 1030:{if(K.val=="String"){d=K;break}if(b=ws(K.val,K.cell.ixfe,K.tt),b.XF=te[b.ixfe],r.cellFormula){var $e=K.formula;if($e&&$e[0]&&$e[0][0]&&$e[0][0][0]=="PtgExp"){var rt=$e[0][0][1][0],Dr=$e[0][0][1][1],Ve=Qe({r:rt,c:Dr});D[Ve]?b.f=""+kr(K.formula,u,K.cell,se,X):b.F=((r.dense?(i[rt]||[])[Dr]:i[Ve])||{}).F}else b.f=""+kr(K.formula,u,K.cell,se,X)}z>0&&(b.z=ne[b.ixfe>>8&63]),kn(b,r,t.opts.Date1904),Q(K.cell,b,r),d=K}break;case 7:case 519:if(d)d.val=K,b=ws(K,d.cell.ixfe,"s"),b.XF=te[b.ixfe],r.cellFormula&&(b.f=""+kr(d.formula,u,d.cell,se,X)),z>0&&(b.z=ne[b.ixfe>>8&63]),kn(b,r,t.opts.Date1904),Q(d.cell,b,r),d=null;else throw new Error("String record expects Formula");break;case 33:case 545:{P.push(K);var Tn=Qe(K[0].s);if(C=r.dense?(i[K[0].s.r]||[])[K[0].s.c]:i[Tn],r.cellFormula&&C){if(!d||!Tn||!C)break;C.f=""+kr(K[1],u,K[0],se,X),C.F=it(K[0])}}break;case 1212:{if(!r.cellFormula)break;if(_){if(!d)break;D[Qe(d.cell)]=K[0],C=r.dense?(i[d.cell.r]||[])[d.cell.c]:i[Qe(d.cell)],(C||{}).f=""+kr(K[0],u,v,se,X)}}break;case 253:b=ws(g[K.isst].t,K.ixfe,"s"),g[K.isst].h&&(b.h=g[K.isst].h),b.XF=te[b.ixfe],z>0&&(b.z=ne[b.ixfe>>8&63]),kn(b,r,t.opts.Date1904),Q({c:K.c,r:K.r},b,r);break;case 513:r.sheetStubs&&(b={ixfe:K.ixfe,XF:te[K.ixfe],t:"z"},z>0&&(b.z=ne[b.ixfe>>8&63]),kn(b,r,t.opts.Date1904),Q({c:K.c,r:K.r},b,r));break;case 190:if(r.sheetStubs)for(var mn=K.c;mn<=K.C;++mn){var Xt=K.ixfe[mn-K.c];b={ixfe:Xt,XF:te[Xt],t:"z"},z>0&&(b.z=ne[b.ixfe>>8&63]),kn(b,r,t.opts.Date1904),Q({c:mn,r:K.r},b,r)}break;case 214:case 516:case 4:b=ws(K.val,K.ixfe,"s"),b.XF=te[b.ixfe],z>0&&(b.z=ne[b.ixfe>>8&63]),kn(b,r,t.opts.Date1904),Q({c:K.c,r:K.r},b,r);break;case 0:case 512:Ge===1&&(u=K);break;case 252:g=K;break;case 1054:if(X.biff==4){ne[z++]=K[1];for(var zr=0;zr<z+163&&qe[zr]!=K[1];++zr);zr>=163&&Wn(K[1],z+163)}else Wn(K[1],K[0]);break;case 30:{ne[z++]=K;for(var ar=0;ar<z+163&&qe[ar]!=K;++ar);ar>=163&&Wn(K,z+163)}break;case 229:Ee=Ee.concat(K);break;case 93:q[K.cmo[0]]=X.lastobj=K;break;case 438:X.lastobj.TxO=K;break;case 127:X.lastobj.ImData=K;break;case 440:for(y=K[0].s.r;y<=K[0].e.r;++y)for(A=K[0].s.c;A<=K[0].e.c;++A)C=r.dense?(i[y]||[])[A]:i[Qe({c:A,r:y})],C&&(C.l=K[1]);break;case 2048:for(y=K[0].s.r;y<=K[0].e.r;++y)for(A=K[0].s.c;A<=K[0].e.c;++A)C=r.dense?(i[y]||[])[A]:i[Qe({c:A,r:y})],C&&C.l&&(C.l.Tooltip=K[1]);break;case 28:{if(X.biff<=5&&X.biff>=2)break;C=r.dense?(i[K[0].r]||[])[K[0].c]:i[Qe(K[0])];var Yn=q[K[2]];C||(r.dense?(i[K[0].r]||(i[K[0].r]=[]),C=i[K[0].r][K[0].c]={t:"z"}):C=i[Qe(K[0])]={t:"z"},u.e.r=Math.max(u.e.r,K[0].r),u.s.r=Math.min(u.s.r,K[0].r),u.e.c=Math.max(u.e.c,K[0].c),u.s.c=Math.min(u.s.c,K[0].c)),C.c||(C.c=[]),S={a:K[1],t:Yn.TxO.t},C.c.push(S)}break;case 2173:Pm(te[K.ixfe],K.ext);break;case 125:{if(!X.cellStyles)break;for(;K.e>=K.s;)ue[K.e--]={width:K.w/256,level:K.level||0,hidden:!!(K.flags&1)},We||(We=!0,Mo(K.w/256)),sa(ue[K.e+1])}break;case 520:{var Ht={};K.level!=null&&(de[K.r]=Ht,Ht.level=K.level),K.hidden&&(de[K.r]=Ht,Ht.hidden=!0),K.hpt&&(de[K.r]=Ht,Ht.hpt=K.hpt,Ht.hpx=ni(K.hpt))}break;case 38:case 39:case 40:case 41:i["!margins"]||Aa(i["!margins"]={}),i["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[Ae]]=K;break;case 161:i["!margins"]||Aa(i["!margins"]={}),i["!margins"].header=K.header,i["!margins"].footer=K.footer;break;case 574:K.RTL&&(N.Views[0].RTL=!0);break;case 146:W=K;break;case 2198:ie=K;break;case 140:V=K;break;case 442:m?j.CodeName=K||j.name:N.WBProps.CodeName=K||"ThisWorkbook";break}}else Se||console.error("Missing Info for XLS Record 0x"+Ae.toString(16)),e.l+=Te}return t.SheetNames=$t(c).sort(function(Ot,ot){return Number(Ot)-Number(ot)}).map(function(Ot){return c[Ot].name}),r.bookSheets||(t.Sheets=a),!t.SheetNames.length&&w["!ref"]?(t.SheetNames.push("Sheet1"),t.Sheets&&(t.Sheets.Sheet1=w)):t.Preamble=w,t.Sheets&&Z.forEach(function(Ot,ot){t.Sheets[t.SheetNames[ot]]["!autofilter"]=Ot}),t.Strings=g,t.SSF=Vt(qe),X.enc&&(t.Encryption=X.enc),ie&&(t.Themes=ie),t.Metadata={},V!==void 0&&(t.Metadata.Country=V),se.names.length>0&&(N.Names=se.names),t.Workbook=N,t}var Ri={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function JE(e,r,t){var a=Ke.find(e,"/!DocumentSummaryInformation");if(a&&a.size>0)try{var i=Jc(a,Q0,Ri.DSI);for(var c in i)r[c]=i[c]}catch(m){if(t.WTF)throw m}var u=Ke.find(e,"/!SummaryInformation");if(u&&u.size>0)try{var d=Jc(u,$0,Ri.SI);for(var g in d)r[g]==null&&(r[g]=d[g])}catch(m){if(t.WTF)throw m}r.HeadingPairs&&r.TitlesOfParts&&(fl(r.HeadingPairs,r.TitlesOfParts,r,t),delete r.HeadingPairs,delete r.TitlesOfParts)}function QE(e,r){var t=[],a=[],i=[],c=0,u,d=Ic(Q0,"n"),g=Ic($0,"n");if(e.Props)for(u=$t(e.Props),c=0;c<u.length;++c)(Object.prototype.hasOwnProperty.call(d,u[c])?t:Object.prototype.hasOwnProperty.call(g,u[c])?a:i).push([u[c],e.Props[u[c]]]);if(e.Custprops)for(u=$t(e.Custprops),c=0;c<u.length;++c)Object.prototype.hasOwnProperty.call(e.Props||{},u[c])||(Object.prototype.hasOwnProperty.call(d,u[c])?t:Object.prototype.hasOwnProperty.call(g,u[c])?a:i).push([u[c],e.Custprops[u[c]]]);var m=[];for(c=0;c<i.length;++c)ml.indexOf(i[c][0])>-1||cl.indexOf(i[c][0])>-1||i[c][1]!=null&&m.push(i[c]);a.length&&Ke.utils.cfb_add(r,"/SummaryInformation",Qc(a,Ri.SI,g,$0)),(t.length||m.length)&&Ke.utils.cfb_add(r,"/DocumentSummaryInformation",Qc(t,Ri.DSI,d,Q0,m.length?m:null,Ri.UDI))}function uu(e,r){r||(r={}),zo(r),uo(),r.codepage&&lo(r.codepage);var t,a;if(e.FullPaths){if(Ke.find(e,"/encryption"))throw new Error("File is password-protected");t=Ke.find(e,"!CompObj"),a=Ke.find(e,"/Workbook")||Ke.find(e,"/Book")}else{switch(r.type){case"base64":e=Qr(en(e));break;case"binary":e=Qr(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e));break}Ar(e,0),a={content:e}}var i,c;if(t&&KE(t),r.bookProps&&!r.bookSheets)i={};else{var u=gt?"buffer":"array";if(a&&a.content)i=qE(a.content,r);else if((c=Ke.find(e,"PerfectOffice_MAIN"))&&c.content)i=_a.to_workbook(c.content,(r.type=u,r));else if((c=Ke.find(e,"NativeContent_MAIN"))&&c.content)i=_a.to_workbook(c.content,(r.type=u,r));else throw(c=Ke.find(e,"MN0"))&&c.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");r.bookVBA&&e.FullPaths&&Ke.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(i.vbaraw=up(e))}var d={};return e.FullPaths&&JE(e,d,r),i.Props=i.Custprops=d,r.bookFiles&&(i.cfb=e),i}function $E(e,r){var t=r||{},a=Ke.utils.cfb_new({root:"R"}),i="/Workbook";switch(t.bookType||"xls"){case"xls":t.bookType="biff8";case"xla":t.bookType||(t.bookType="xla");case"biff8":i="/Workbook",t.biff=8;break;case"biff5":i="/Book",t.biff=5;break;default:throw new Error("invalid type "+t.bookType+" for XLS CFB")}return Ke.utils.cfb_add(a,i,hu(e,t)),t.biff==8&&(e.Props||e.Custprops)&&QE(e,a),t.biff==8&&e.vbaraw&&hp(a,Ke.read(e.vbaraw,{type:typeof e.vbaraw=="string"?"binary":"buffer"})),a}var Xi={0:{f:C3},1:{f:F3},2:{f:q3},3:{f:U3},4:{f:B3},5:{f:K3},6:{f:t4},7:{f:G3},8:{f:c4},9:{f:o4},10:{f:i4},11:{f:s4},12:{f:O3},13:{f:Q3},14:{f:V3},15:{f:P3},16:{f:nu},17:{f:n4},18:{f:z3},19:{f:yo},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:nE},40:{},42:{},43:{f:tm},44:{f:$g},45:{f:am},46:{f:sm},47:{f:im},48:{},49:{f:yd},50:{},51:{f:Wm},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:Il},62:{f:e4},63:{f:Zm},64:{f:T4},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Rr,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:v4},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:b3},148:{f:y3,p:16},151:{f:x4},152:{},153:{f:eE},154:{},155:{},156:{f:Q4},157:{},158:{},159:{T:1,f:mg},160:{T:-1},161:{T:1,f:Oa},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:f4},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:Lm},336:{T:-1},337:{f:Gm,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:J0},357:{},358:{},359:{},360:{T:1},361:{},362:{f:yl},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:g4},427:{f:m4},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:w4},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:k3},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:h4},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:J0},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:sp},633:{T:1},634:{T:-1},635:{T:1,f:ap},636:{T:-1},637:{f:Nd},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:V4},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:S4},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},io={6:{f:w0},10:{f:ea},12:{f:or},13:{f:or},14:{f:tr},15:{f:tr},16:{f:Nr},17:{f:tr},18:{f:tr},19:{f:or},20:{f:af},21:{f:af},23:{f:yl},24:{f:of},25:{f:tr},26:{},27:{},28:{f:S2},29:{},34:{f:tr},35:{f:sf},38:{f:Nr},39:{f:Nr},40:{f:Nr},41:{f:Nr},42:{f:tr},43:{f:tr},47:{f:Pg},49:{f:Qx},51:{f:or},60:{},61:{f:Kx},64:{f:tr},65:{f:Jx},66:{f:or},77:{},80:{},81:{},82:{},85:{f:or},89:{},90:{},91:{},92:{f:Mx},93:{f:k2},94:{},95:{f:tr},96:{},97:{},99:{f:tr},125:{f:Il},128:{f:d2},129:{f:Lx},130:{f:or},131:{f:tr},132:{f:tr},133:{f:Ux},134:{},140:{f:M2},141:{f:or},144:{},146:{f:U2},151:{},152:{},153:{},154:{},155:{},156:{f:or},157:{},158:{},160:{f:Y2},161:{f:H2},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:f2},190:{f:l2},193:{f:ea},197:{},198:{},199:{},200:{},201:{},202:{f:tr},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:or},220:{},221:{f:tr},222:{},224:{f:h2},225:{f:Bx},226:{f:ea},227:{},229:{f:y2},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:Vx},253:{f:e2},255:{f:Gx},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:pl},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:tr},353:{f:ea},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:w2},431:{f:tr},432:{},433:{},434:{},437:{},438:{f:F2},439:{f:tr},440:{f:R2},441:{},442:{f:qi},443:{},444:{f:or},445:{},446:{},448:{f:ea},449:{f:Yx,r:2},450:{f:ea},512:{f:tf},513:{f:z2},515:{f:m2},516:{f:r2},517:{f:nf},519:{f:K2},520:{f:Xx},523:{},545:{f:cf},549:{f:ef},566:{},574:{f:Zx},638:{f:c2},659:{},1048:{},1054:{f:a2},1084:{},1212:{f:A2},2048:{f:D2},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:gs},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:ea},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:W2,r:12},2173:{f:Mm,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:tr,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:_2,r:12},2197:{},2198:{f:Nm,r:12},2199:{},2200:{},2201:{},2202:{f:C2,r:12},2203:{f:ea},2204:{},2205:{},2206:{},2207:{},2211:{f:zx},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:or},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:G2},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:L2},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:tf},1:{},2:{f:Q2},3:{f:q2},4:{f:Z2},5:{f:nf},7:{f:eg},8:{},9:{f:gs},11:{},22:{f:or},30:{f:s2},31:{},32:{},33:{f:cf},36:{},37:{f:ef},50:{f:tg},62:{},52:{},67:{},68:{f:or},69:{},86:{},126:{},127:{f:j2},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:rg},223:{},234:{},354:{},421:{},518:{f:w0},521:{f:gs},536:{f:of},547:{f:sf},561:{},579:{},1030:{f:w0},1033:{f:gs},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function Pe(e,r,t,a){var i=r;if(!isNaN(i)){var c=a||(t||[]).length||0,u=e.next(4);u.write_shift(2,i),u.write_shift(2,c),c>0&&Co(t)&&e.push(t)}}function ev(e,r,t,a){var i=(t||[]).length||0;if(i<=8224)return Pe(e,r,t,i);var c=r;if(!isNaN(c)){for(var u=t.parts||[],d=0,g=0,m=0;m+(u[d]||8224)<=8224;)m+=u[d]||8224,d++;var w=e.next(4);for(w.write_shift(2,c),w.write_shift(2,m),e.push(t.slice(g,g+m)),g+=m;g<i;){for(w=e.next(4),w.write_shift(2,60),m=0;m+(u[d]||8224)<=8224;)m+=u[d]||8224,d++;w.write_shift(2,m),e.push(t.slice(g,g+m)),g+=m}}}function es(e,r,t){return e||(e=ve(7)),e.write_shift(2,r),e.write_shift(2,t),e.write_shift(2,0),e.write_shift(1,0),e}function tv(e,r,t,a){var i=ve(9);return es(i,e,r),wl(t,a||"b",i),i}function rv(e,r,t){var a=ve(8+2*t.length);return es(a,e,r),a.write_shift(1,t.length),a.write_shift(t.length,t,"sbcs"),a.l<a.length?a.slice(0,a.l):a}function nv(e,r,t,a){if(r.v!=null)switch(r.t){case"d":case"n":var i=r.t=="d"?ur(Wt(r.v)):r.v;i==(i|0)&&i>=0&&i<65536?Pe(e,2,$2(t,a,i)):Pe(e,3,J2(t,a,i));return;case"b":case"e":Pe(e,5,tv(t,a,r.v,r.t));return;case"s":case"str":Pe(e,4,rv(t,a,(r.v||"").slice(0,255)));return}Pe(e,1,es(null,t,a))}function av(e,r,t,a){var i=Array.isArray(r),c=Ct(r["!ref"]||"A1"),u,d="",g=[];if(c.e.c>255||c.e.r>16383){if(a.WTF)throw new Error("Range "+(r["!ref"]||"A1")+" exceeds format limit A1:IV16384");c.e.c=Math.min(c.e.c,255),c.e.r=Math.min(c.e.c,16383),u=it(c)}for(var m=c.s.r;m<=c.e.r;++m){d=rr(m);for(var w=c.s.c;w<=c.e.c;++w){m===c.s.r&&(g[w]=Yt(w)),u=g[w]+d;var v=i?(r[m]||[])[w]:r[u];v&&nv(e,v,m,w)}}}function iv(e,r){for(var t=r||{},a=Gr(),i=0,c=0;c<e.SheetNames.length;++c)e.SheetNames[c]==t.sheet&&(i=c);if(i==0&&t.sheet&&e.SheetNames[0]!=t.sheet)throw new Error("Sheet not found: "+t.sheet);return Pe(a,t.biff==4?1033:t.biff==3?521:9,Oo(e,16,t)),av(a,e.Sheets[e.SheetNames[i]],i,t),Pe(a,10),a.end()}function sv(e,r,t){Pe(e,49,$x({sz:12,name:"Arial"},t))}function ov(e,r,t){r&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(a){for(var i=a[0];i<=a[1];++i)r[i]!=null&&Pe(e,1054,i2(i,r[i],t))})}function cv(e,r){var t=ve(19);t.write_shift(4,2151),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(2,3),t.write_shift(1,1),t.write_shift(4,0),Pe(e,2151,t),t=ve(39),t.write_shift(4,2152),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(2,3),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(2,1),t.write_shift(4,4),t.write_shift(2,0),Cl(Ct(r["!ref"]||"A1"),t),t.write_shift(4,4),Pe(e,2152,t)}function fv(e,r){for(var t=0;t<16;++t)Pe(e,224,rf({numFmtId:0,style:!0},0,r));r.cellXfs.forEach(function(a){Pe(e,224,rf(a,0,r))})}function lv(e,r){for(var t=0;t<r["!links"].length;++t){var a=r["!links"][t];Pe(e,440,O2(a)),a[1].Tooltip&&Pe(e,2048,B2(a))}delete r["!links"]}function uv(e,r){if(r){var t=0;r.forEach(function(a,i){++t<=256&&a&&Pe(e,125,V2(zs(i,a),i))})}}function hv(e,r,t,a,i){var c=16+ua(i.cellXfs,r,i);if(r.v==null&&!r.bf){Pe(e,513,Ia(t,a,c));return}if(r.bf)Pe(e,6,Lw(r,t,a,i,c));else switch(r.t){case"d":case"n":var u=r.t=="d"?ur(Wt(r.v)):r.v;Pe(e,515,p2(t,a,u,c));break;case"b":case"e":Pe(e,517,g2(t,a,r.v,c,i,r.t));break;case"s":case"str":if(i.bookSST){var d=Vo(i.Strings,r.v,i.revStrings);Pe(e,253,t2(t,a,d,c))}else Pe(e,516,n2(t,a,(r.v||"").slice(0,255),c,i));break;default:Pe(e,513,Ia(t,a,c))}}function dv(e,r,t){var a=Gr(),i=t.SheetNames[e],c=t.Sheets[i]||{},u=(t||{}).Workbook||{},d=(u.Sheets||[])[e]||{},g=Array.isArray(c),m=r.biff==8,w,v="",_=[],C=Ct(c["!ref"]||"A1"),S=m?65536:16384;if(C.e.c>255||C.e.r>=S){if(r.WTF)throw new Error("Range "+(c["!ref"]||"A1")+" exceeds format limit A1:IV16384");C.e.c=Math.min(C.e.c,255),C.e.r=Math.min(C.e.c,S-1)}Pe(a,2057,Oo(t,16,r)),Pe(a,13,hn(1)),Pe(a,12,hn(100)),Pe(a,15,Mr(!0)),Pe(a,17,Mr(!1)),Pe(a,16,Sa(.001)),Pe(a,95,Mr(!0)),Pe(a,42,Mr(!1)),Pe(a,43,Mr(!1)),Pe(a,130,hn(1)),Pe(a,128,x2()),Pe(a,131,Mr(!1)),Pe(a,132,Mr(!1)),m&&uv(a,c["!cols"]),Pe(a,512,o2(C,r)),m&&(c["!links"]=[]);for(var A=C.s.r;A<=C.e.r;++A){v=rr(A);for(var y=C.s.c;y<=C.e.c;++y){A===C.s.r&&(_[y]=Yt(y)),w=_[y]+v;var D=g?(c[A]||[])[y]:c[w];D&&(hv(a,D,A,y,r),m&&D.l&&c["!links"].push([w,D.l]))}}var P=d.CodeName||d.name||i;return m&&Pe(a,574,qx((u.Views||[])[0])),m&&(c["!merges"]||[]).length&&Pe(a,229,I2(c["!merges"])),m&&lv(a,c),Pe(a,442,El(P)),m&&cv(a,c),Pe(a,10),a.end()}function xv(e,r,t){var a=Gr(),i=(e||{}).Workbook||{},c=i.Sheets||[],u=i.WBProps||{},d=t.biff==8,g=t.biff==5;if(Pe(a,2057,Oo(e,5,t)),t.bookType=="xla"&&Pe(a,135),Pe(a,225,d?hn(1200):null),Pe(a,193,gx(2)),g&&Pe(a,191),g&&Pe(a,192),Pe(a,226),Pe(a,92,Px("SheetJS",t)),Pe(a,66,hn(d?1200:1252)),d&&Pe(a,353,hn(0)),d&&Pe(a,448),Pe(a,317,X2(e.SheetNames.length)),d&&e.vbaraw&&Pe(a,211),d&&e.vbaraw){var m=u.CodeName||"ThisWorkbook";Pe(a,442,El(m))}Pe(a,156,hn(17)),Pe(a,25,Mr(!1)),Pe(a,18,Mr(!1)),Pe(a,19,hn(0)),d&&Pe(a,431,Mr(!1)),d&&Pe(a,444,hn(0)),Pe(a,61,jx()),Pe(a,64,Mr(!1)),Pe(a,141,hn(0)),Pe(a,34,Mr(Y4(e)=="true")),Pe(a,14,Mr(!0)),d&&Pe(a,439,Mr(!1)),Pe(a,218,hn(0)),sv(a,e,t),ov(a,e.SSF,t),fv(a,t),d&&Pe(a,352,Mr(!1));var w=a.end(),v=Gr();d&&Pe(v,140,P2()),d&&t.Strings&&ev(v,252,Hx(t.Strings)),Pe(v,10);var _=v.end(),C=Gr(),S=0,A=0;for(A=0;A<e.SheetNames.length;++A)S+=(d?12:11)+(d?2:1)*e.SheetNames[A].length;var y=w.length+S+_.length;for(A=0;A<e.SheetNames.length;++A){var D=c[A]||{};Pe(C,133,Wx({pos:y,hs:D.Hidden||0,dt:0,name:e.SheetNames[A]},t)),y+=r[A].length}var P=C.end();if(S!=P.length)throw new Error("BS8 "+S+" != "+P.length);var b=[];return w.length&&b.push(w),P.length&&b.push(P),_.length&&b.push(_),mr(b)}function gv(e,r){var t=r||{},a=[];e&&!e.SSF&&(e.SSF=Vt(qe)),e&&e.SSF&&(ii(),Ls(e.SSF),t.revssf=Ws(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Yo(t),t.cellXfs=[],ua(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});for(var i=0;i<e.SheetNames.length;++i)a[a.length]=dv(i,t,e);return a.unshift(xv(e,a,t)),mr(a)}function hu(e,r){for(var t=0;t<=e.SheetNames.length;++t){var a=e.Sheets[e.SheetNames[t]];if(!(!a||!a["!ref"])){var i=Xr(a["!ref"]);i.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+e.SheetNames[t]+"' extends beyond column IV (255).  Data may be lost.")}}var c=r||{};switch(c.biff||2){case 8:case 5:return gv(e,r);case 4:case 3:case 2:return iv(e,r)}throw new Error("invalid type "+c.bookType+" for BIFF")}function wf(e,r){var t=r||{},a=t.dense?[]:{};e=e.replace(/<!--.*?-->/g,"");var i=e.match(/<table/i);if(!i)throw new Error("Invalid HTML: could not find <table>");var c=e.match(/<\/table/i),u=i.index,d=c&&c.index||e.length,g=$h(e.slice(u,d),/(:?<tr[^>]*>)/i,"<tr>"),m=-1,w=0,v=0,_=0,C={s:{r:1e7,c:1e7},e:{r:0,c:0}},S=[];for(u=0;u<g.length;++u){var A=g[u].trim(),y=A.slice(0,3).toLowerCase();if(y=="<tr"){if(++m,t.sheetRows&&t.sheetRows<=m){--m;break}w=0;continue}if(!(y!="<td"&&y!="<th")){var D=A.split(/<\/t[dh]>/i);for(d=0;d<D.length;++d){var P=D[d].trim();if(P.match(/<t[dh]/i)){for(var b=P,V=0;b.charAt(0)=="<"&&(V=b.indexOf(">"))>-1;)b=b.slice(V+1);for(var te=0;te<S.length;++te){var W=S[te];W.s.c==w&&W.s.r<m&&m<=W.e.r&&(w=W.e.c+1,te=-1)}var N=et(P.slice(0,P.indexOf(">")));_=N.colspan?+N.colspan:1,((v=+N.rowspan)>1||_>1)&&S.push({s:{r:m,c:w},e:{r:m+(v||1)-1,c:w+_-1}});var j=N.t||N["data-t"]||"";if(!b.length){w+=_;continue}if(b=M1(b),C.s.r>m&&(C.s.r=m),C.e.r<m&&(C.e.r=m),C.s.c>w&&(C.s.c=w),C.e.c<w&&(C.e.c=w),!b.length){w+=_;continue}var O={t:"s",v:b};t.raw||!b.trim().length||j=="s"||(b==="TRUE"?O={t:"b",v:!0}:b==="FALSE"?O={t:"b",v:!1}:isNaN(An(b))?isNaN(ti(b).getDate())||(O={t:"d",v:Wt(b)},t.cellDates||(O={t:"n",v:ur(O.v)}),O.z=t.dateNF||qe[14]):O={t:"n",v:An(b)}),t.dense?(a[m]||(a[m]=[]),a[m][w]=O):a[Qe({r:m,c:w})]=O,w+=_}}}}return a["!ref"]=it(C),S.length&&(a["!merges"]=S),a}function mv(e,r,t,a){for(var i=e["!merges"]||[],c=[],u=r.s.c;u<=r.e.c;++u){for(var d=0,g=0,m=0;m<i.length;++m)if(!(i[m].s.r>t||i[m].s.c>u)&&!(i[m].e.r<t||i[m].e.c<u)){if(i[m].s.r<t||i[m].s.c<u){d=-1;break}d=i[m].e.r-i[m].s.r+1,g=i[m].e.c-i[m].s.c+1;break}if(!(d<0)){var w=Qe({r:t,c:u}),v=a.dense?(e[t]||[])[u]:e[w],_=v&&v.v!=null&&(v.h||vo(v.w||(Hn(v),v.w)||""))||"",C={};d>1&&(C.rowspan=d),g>1&&(C.colspan=g),a.editable?_='<span contenteditable="true">'+_+"</span>":v&&(C["data-t"]=v&&v.t||"z",v.v!=null&&(C["data-v"]=v.v),v.z!=null&&(C["data-z"]=v.z),v.l&&(v.l.Target||"#").charAt(0)!="#"&&(_='<a href="'+v.l.Target+'">'+_+"</a>")),C.id=(a.id||"sjs")+"-"+w,c.push(Me("td",_,C))}}var S="<tr>";return S+c.join("")+"</tr>"}var pv='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',wv="</body></html>";function Ev(e,r){var t=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!t||t.length==0)throw new Error("Invalid HTML: could not find <table>");if(t.length==1)return la(wf(t[0],r),r);var a=Zo();return t.forEach(function(i,c){qo(a,wf(i,r),"Sheet"+(c+1))}),a}function vv(e,r,t){var a=[];return a.join("")+"<table"+(t&&t.id?' id="'+t.id+'"':"")+">"}function du(e,r){var t=r||{},a=t.header!=null?t.header:pv,i=t.footer!=null?t.footer:wv,c=[a],u=Xr(e["!ref"]);t.dense=Array.isArray(e),c.push(vv(e,u,t));for(var d=u.s.r;d<=u.e.r;++d)c.push(mv(e,u,d,t));return c.push("</table>"+i),c.join("")}function xu(e,r,t){var a=t||{},i=0,c=0;if(a.origin!=null)if(typeof a.origin=="number")i=a.origin;else{var u=typeof a.origin=="string"?Kt(a.origin):a.origin;i=u.r,c=u.c}var d=r.getElementsByTagName("tr"),g=Math.min(a.sheetRows||1e7,d.length),m={s:{r:0,c:0},e:{r:i,c}};if(e["!ref"]){var w=Xr(e["!ref"]);m.s.r=Math.min(m.s.r,w.s.r),m.s.c=Math.min(m.s.c,w.s.c),m.e.r=Math.max(m.e.r,w.e.r),m.e.c=Math.max(m.e.c,w.e.c),i==-1&&(m.e.r=i=w.e.r+1)}var v=[],_=0,C=e["!rows"]||(e["!rows"]=[]),S=0,A=0,y=0,D=0,P=0,b=0;for(e["!cols"]||(e["!cols"]=[]);S<d.length&&A<g;++S){var V=d[S];if(Ef(V)){if(a.display)continue;C[A]={hidden:!0}}var te=V.children;for(y=D=0;y<te.length;++y){var W=te[y];if(!(a.display&&Ef(W))){var N=W.hasAttribute("data-v")?W.getAttribute("data-v"):W.hasAttribute("v")?W.getAttribute("v"):M1(W.innerHTML),j=W.getAttribute("data-z")||W.getAttribute("z");for(_=0;_<v.length;++_){var O=v[_];O.s.c==D+c&&O.s.r<A+i&&A+i<=O.e.r&&(D=O.e.c+1-c,_=-1)}b=+W.getAttribute("colspan")||1,((P=+W.getAttribute("rowspan")||1)>1||b>1)&&v.push({s:{r:A+i,c:D+c},e:{r:A+i+(P||1)-1,c:D+c+(b||1)-1}});var ae={t:"s",v:N},Q=W.getAttribute("data-t")||W.getAttribute("t")||"";N!=null&&(N.length==0?ae.t=Q||"z":a.raw||N.trim().length==0||Q=="s"||(N==="TRUE"?ae={t:"b",v:!0}:N==="FALSE"?ae={t:"b",v:!1}:isNaN(An(N))?isNaN(ti(N).getDate())||(ae={t:"d",v:Wt(N)},a.cellDates||(ae={t:"n",v:ur(ae.v)}),ae.z=a.dateNF||qe[14]):ae={t:"n",v:An(N)})),ae.z===void 0&&j!=null&&(ae.z=j);var X="",ie=W.getElementsByTagName("A");if(ie&&ie.length)for(var Ee=0;Ee<ie.length&&!(ie[Ee].hasAttribute("href")&&(X=ie[Ee].getAttribute("href"),X.charAt(0)!="#"));++Ee);X&&X.charAt(0)!="#"&&(ae.l={Target:X}),a.dense?(e[A+i]||(e[A+i]=[]),e[A+i][D+c]=ae):e[Qe({c:D+c,r:A+i})]=ae,m.e.c<D+c&&(m.e.c=D+c),D+=b}}++A}return v.length&&(e["!merges"]=(e["!merges"]||[]).concat(v)),m.e.r=Math.max(m.e.r,A-1+i),e["!ref"]=it(m),A>=g&&(e["!fullref"]=it((m.e.r=d.length-S+A-1+i,m))),e}function gu(e,r){var t=r||{},a=t.dense?[]:{};return xu(a,e,r)}function _v(e,r){return la(gu(e,r),r)}function Ef(e){var r="",t=Av(e);return t&&(r=t(e).getPropertyValue("display")),r||(r=e.style&&e.style.display),r==="none"}function Av(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function Cv(e){var r=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(a,i){return Array(parseInt(i,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),t=At(r.replace(/<[^>]*>/g,""));return[t]}var vf={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function mu(e,r){var t=r||{},a=_o(e),i=[],c,u,d={name:""},g="",m=0,w,v,_={},C=[],S=t.dense?[]:{},A,y,D={value:""},P="",b=0,V=[],te=-1,W=-1,N={s:{r:1e6,c:1e7},e:{r:0,c:0}},j=0,O={},ae=[],Q={},X=0,ie=0,Ee=[],q=1,ue=1,de=[],We={Names:[]},se={},Le=["",""],Ge=[],z={},ne="",Z=0,ee=!1,oe=!1,Ie=0;for(Li.lastIndex=0,a=a.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");A=Li.exec(a);)switch(A[3]=A[3].replace(/_.*$/,"")){case"table":case"工作表":A[1]==="/"?(N.e.c>=N.s.c&&N.e.r>=N.s.r?S["!ref"]=it(N):S["!ref"]="A1:A1",t.sheetRows>0&&t.sheetRows<=N.e.r&&(S["!fullref"]=S["!ref"],N.e.r=t.sheetRows-1,S["!ref"]=it(N)),ae.length&&(S["!merges"]=ae),Ee.length&&(S["!rows"]=Ee),w.name=w.名称||w.name,typeof JSON<"u"&&JSON.stringify(w),C.push(w.name),_[w.name]=S,oe=!1):A[0].charAt(A[0].length-2)!=="/"&&(w=et(A[0],!1),te=W=-1,N.s.r=N.s.c=1e7,N.e.r=N.e.c=0,S=t.dense?[]:{},ae=[],Ee=[],oe=!0);break;case"table-row-group":A[1]==="/"?--j:++j;break;case"table-row":case"行":if(A[1]==="/"){te+=q,q=1;break}if(v=et(A[0],!1),v.行号?te=v.行号-1:te==-1&&(te=0),q=+v["number-rows-repeated"]||1,q<10)for(Ie=0;Ie<q;++Ie)j>0&&(Ee[te+Ie]={level:j});W=-1;break;case"covered-table-cell":A[1]!=="/"&&++W,t.sheetStubs&&(t.dense?(S[te]||(S[te]=[]),S[te][W]={t:"z"}):S[Qe({r:te,c:W})]={t:"z"}),P="",V=[];break;case"table-cell":case"数据":if(A[0].charAt(A[0].length-2)==="/")++W,D=et(A[0],!1),ue=parseInt(D["number-columns-repeated"]||"1",10),y={t:"z",v:null},D.formula&&t.cellFormula!=!1&&(y.f=gf(At(D.formula))),(D.数据类型||D["value-type"])=="string"&&(y.t="s",y.v=At(D["string-value"]||""),t.dense?(S[te]||(S[te]=[]),S[te][W]=y):S[Qe({r:te,c:W})]=y),W+=ue-1;else if(A[1]!=="/"){++W,P="",b=0,V=[],ue=1;var Ae=q?te+q-1:te;if(W>N.e.c&&(N.e.c=W),W<N.s.c&&(N.s.c=W),te<N.s.r&&(N.s.r=te),Ae>N.e.r&&(N.e.r=Ae),D=et(A[0],!1),Ge=[],z={},y={t:D.数据类型||D["value-type"],v:null},t.cellFormula)if(D.formula&&(D.formula=At(D.formula)),D["number-matrix-columns-spanned"]&&D["number-matrix-rows-spanned"]&&(X=parseInt(D["number-matrix-rows-spanned"],10)||0,ie=parseInt(D["number-matrix-columns-spanned"],10)||0,Q={s:{r:te,c:W},e:{r:te+X-1,c:W+ie-1}},y.F=it(Q),de.push([Q,y.F])),D.formula)y.f=gf(D.formula);else for(Ie=0;Ie<de.length;++Ie)te>=de[Ie][0].s.r&&te<=de[Ie][0].e.r&&W>=de[Ie][0].s.c&&W<=de[Ie][0].e.c&&(y.F=de[Ie][1]);switch((D["number-columns-spanned"]||D["number-rows-spanned"])&&(X=parseInt(D["number-rows-spanned"],10)||0,ie=parseInt(D["number-columns-spanned"],10)||0,Q={s:{r:te,c:W},e:{r:te+X-1,c:W+ie-1}},ae.push(Q)),D["number-columns-repeated"]&&(ue=parseInt(D["number-columns-repeated"],10)),y.t){case"boolean":y.t="b",y.v=Ut(D["boolean-value"]);break;case"float":y.t="n",y.v=parseFloat(D.value);break;case"percentage":y.t="n",y.v=parseFloat(D.value);break;case"currency":y.t="n",y.v=parseFloat(D.value);break;case"date":y.t="d",y.v=Wt(D["date-value"]),t.cellDates||(y.t="n",y.v=ur(y.v)),y.z="m/d/yy";break;case"time":y.t="n",y.v=qh(D["time-value"])/86400,t.cellDates&&(y.t="d",y.v=Vs(y.v)),y.z="HH:MM:SS";break;case"number":y.t="n",y.v=parseFloat(D.数据数值);break;default:if(y.t==="string"||y.t==="text"||!y.t)y.t="s",D["string-value"]!=null&&(P=At(D["string-value"]),V=[]);else throw new Error("Unsupported value type "+y.t)}}else{if(ee=!1,y.t==="s"&&(y.v=P||"",V.length&&(y.R=V),ee=b==0),se.Target&&(y.l=se),Ge.length>0&&(y.c=Ge,Ge=[]),P&&t.cellText!==!1&&(y.w=P),ee&&(y.t="z",delete y.v),(!ee||t.sheetStubs)&&!(t.sheetRows&&t.sheetRows<=te))for(var Te=0;Te<q;++Te){if(ue=parseInt(D["number-columns-repeated"]||"1",10),t.dense)for(S[te+Te]||(S[te+Te]=[]),S[te+Te][W]=Te==0?y:Vt(y);--ue>0;)S[te+Te][W+ue]=Vt(y);else for(S[Qe({r:te+Te,c:W})]=y;--ue>0;)S[Qe({r:te+Te,c:W+ue})]=Vt(y);N.e.c<=W&&(N.e.c=W)}ue=parseInt(D["number-columns-repeated"]||"1",10),W+=ue-1,ue=0,y={},P="",V=[]}se={};break;case"document":case"document-content":case"电子表格文档":case"spreadsheet":case"主体":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(A[1]==="/"){if((c=i.pop())[0]!==A[3])throw"Bad state: "+c}else A[0].charAt(A[0].length-2)!=="/"&&i.push([A[3],!0]);break;case"annotation":if(A[1]==="/"){if((c=i.pop())[0]!==A[3])throw"Bad state: "+c;z.t=P,V.length&&(z.R=V),z.a=ne,Ge.push(z)}else A[0].charAt(A[0].length-2)!=="/"&&i.push([A[3],!1]);ne="",Z=0,P="",b=0,V=[];break;case"creator":A[1]==="/"?ne=a.slice(Z,A.index):Z=A.index+A[0].length;break;case"meta":case"元数据":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(A[1]==="/"){if((c=i.pop())[0]!==A[3])throw"Bad state: "+c}else A[0].charAt(A[0].length-2)!=="/"&&i.push([A[3],!1]);P="",b=0,V=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(A[1]==="/"){if(O[d.name]=g,(c=i.pop())[0]!==A[3])throw"Bad state: "+c}else A[0].charAt(A[0].length-2)!=="/"&&(g="",d=et(A[0],!1),i.push([A[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(i[i.length-1][0]){case"time-style":case"date-style":u=et(A[0],!1),g+=vf[A[3]][u.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(i[i.length-1][0]){case"time-style":case"date-style":u=et(A[0],!1),g+=vf[A[3]][u.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(A[0].slice(-2)==="/>")break;if(A[1]==="/")switch(i[i.length-1][0]){case"number-style":case"date-style":case"time-style":g+=a.slice(m,A.index);break}else m=A.index+A[0].length;break;case"named-range":u=et(A[0],!1),Le=E0(u["cell-range-address"]);var Se={Name:u.name,Ref:Le[0]+"!"+Le[1]};oe&&(Se.Sheet=C.length),We.Names.push(Se);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"电子表格":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"文本串":if(["master-styles"].indexOf(i[i.length-1][0])>-1)break;if(A[1]==="/"&&(!D||!D["string-value"])){var Ye=Cv(a.slice(b,A.index));P=(P.length>0?P+`
`:"")+Ye[0]}else et(A[0],!1),b=A.index+A[0].length;break;case"s":break;case"database-range":if(A[1]==="/")break;try{Le=E0(et(A[0])["target-range-address"]),_[Le[0]]["!autofilter"]={ref:Le[1]}}catch{}break;case"date":break;case"object":break;case"title":case"标题":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(A[1]!=="/"){if(se=et(A[0],!1),!se.href)break;se.Target=At(se.href),delete se.href,se.Target.charAt(0)=="#"&&se.Target.indexOf(".")>-1?(Le=E0(se.Target.slice(1)),se.Target="#"+Le[0]+"!"+Le[1]):se.Target.match(/^\.\.[\\\/]/)&&(se.Target=se.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(A[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case"表:":case"字:":break;default:if(t.WTF)throw new Error(A)}}var K={Sheets:_,SheetNames:C,Workbook:We};return t.bookSheets&&delete K.Sheets,K}function _f(e,r){r=r||{},un(e,"META-INF/manifest.xml")&&qd(sr(e,"META-INF/manifest.xml"),r);var t=$r(e,"content.xml");if(!t)throw new Error("Missing content.xml in ODS / UOF file");var a=mu(Nt(t),r);return un(e,"meta.xml")&&(a.Props=sl(sr(e,"meta.xml"))),a}function Af(e,r){return mu(e,r)}var Tv=(function(){var e=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),r="<office:document-styles "+Pi({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+e+"</office:document-styles>";return function(){return nr+r}})(),Cf=(function(){var e=function(c){return kt(c).replace(/  +/g,function(u){return'<text:s text:c="'+u.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},r=`          <table:table-cell />
`,t=`          <table:covered-table-cell/>
`,a=function(c,u,d){var g=[];g.push('      <table:table table:name="'+kt(u.SheetNames[d])+`" table:style-name="ta1">
`);var m=0,w=0,v=Xr(c["!ref"]||"A1"),_=c["!merges"]||[],C=0,S=Array.isArray(c);if(c["!cols"])for(w=0;w<=v.e.c;++w)g.push("        <table:table-column"+(c["!cols"][w]?' table:style-name="co'+c["!cols"][w].ods+'"':"")+`></table:table-column>
`);var A="",y=c["!rows"]||[];for(m=0;m<v.s.r;++m)A=y[m]?' table:style-name="ro'+y[m].ods+'"':"",g.push("        <table:table-row"+A+`></table:table-row>
`);for(;m<=v.e.r;++m){for(A=y[m]?' table:style-name="ro'+y[m].ods+'"':"",g.push("        <table:table-row"+A+`>
`),w=0;w<v.s.c;++w)g.push(r);for(;w<=v.e.c;++w){var D=!1,P={},b="";for(C=0;C!=_.length;++C)if(!(_[C].s.c>w)&&!(_[C].s.r>m)&&!(_[C].e.c<w)&&!(_[C].e.r<m)){(_[C].s.c!=w||_[C].s.r!=m)&&(D=!0),P["table:number-columns-spanned"]=_[C].e.c-_[C].s.c+1,P["table:number-rows-spanned"]=_[C].e.r-_[C].s.r+1;break}if(D){g.push(t);continue}var V=Qe({r:m,c:w}),te=S?(c[m]||[])[w]:c[V];if(te&&te.f&&(P["table:formula"]=kt(Xw(te.f)),te.F&&te.F.slice(0,V.length)==V)){var W=Xr(te.F);P["table:number-matrix-columns-spanned"]=W.e.c-W.s.c+1,P["table:number-matrix-rows-spanned"]=W.e.r-W.s.r+1}if(!te){g.push(r);continue}switch(te.t){case"b":b=te.v?"TRUE":"FALSE",P["office:value-type"]="boolean",P["office:boolean-value"]=te.v?"true":"false";break;case"n":b=te.w||String(te.v||0),P["office:value-type"]="float",P["office:value"]=te.v||0;break;case"s":case"str":b=te.v==null?"":te.v,P["office:value-type"]="string";break;case"d":b=te.w||Wt(te.v).toISOString(),P["office:value-type"]="date",P["office:date-value"]=Wt(te.v).toISOString(),P["table:style-name"]="ce1";break;default:g.push(r);continue}var N=e(b);if(te.l&&te.l.Target){var j=te.l.Target;j=j.charAt(0)=="#"?"#"+zw(j.slice(1)):j,j.charAt(0)!="#"&&!j.match(/^\w+:/)&&(j="../"+j),N=Me("text:a",N,{"xlink:href":j.replace(/&/g,"&amp;")})}g.push("          "+Me("table:table-cell",Me("text:p",N,{}),P)+`
`)}g.push(`        </table:table-row>
`)}return g.push(`      </table:table>
`),g.join("")},i=function(c,u){c.push(` <office:automatic-styles>
`),c.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),c.push(`   <number:month number:style="long"/>
`),c.push(`   <number:text>/</number:text>
`),c.push(`   <number:day number:style="long"/>
`),c.push(`   <number:text>/</number:text>
`),c.push(`   <number:year/>
`),c.push(`  </number:date-style>
`);var d=0;u.SheetNames.map(function(m){return u.Sheets[m]}).forEach(function(m){if(m&&m["!cols"]){for(var w=0;w<m["!cols"].length;++w)if(m["!cols"][w]){var v=m["!cols"][w];if(v.width==null&&v.wpx==null&&v.wch==null)continue;sa(v),v.ods=d;var _=m["!cols"][w].wpx+"px";c.push('  <style:style style:name="co'+d+`" style:family="table-column">
`),c.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+_+`"/>
`),c.push(`  </style:style>
`),++d}}});var g=0;u.SheetNames.map(function(m){return u.Sheets[m]}).forEach(function(m){if(m&&m["!rows"]){for(var w=0;w<m["!rows"].length;++w)if(m["!rows"][w]){m["!rows"][w].ods=g;var v=m["!rows"][w].hpx+"px";c.push('  <style:style style:name="ro'+g+`" style:family="table-row">
`),c.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+v+`"/>
`),c.push(`  </style:style>
`),++g}}}),c.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),c.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),c.push(`  </style:style>
`),c.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),c.push(` </office:automatic-styles>
`)};return function(u,d){var g=[nr],m=Pi({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),w=Pi({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});d.bookType=="fods"?(g.push("<office:document"+m+w+`>
`),g.push(il().replace(/office:document-meta/g,"office:meta"))):g.push("<office:document-content"+m+`>
`),i(g,u),g.push(`  <office:body>
`),g.push(`    <office:spreadsheet>
`);for(var v=0;v!=u.SheetNames.length;++v)g.push(a(u.Sheets[u.SheetNames[v]],u,v));return g.push(`    </office:spreadsheet>
`),g.push(`  </office:body>
`),d.bookType=="fods"?g.push("</office:document>"):g.push("</office:document-content>"),g.join("")}})();function pu(e,r){if(r.bookType=="fods")return Cf(e,r);var t=po(),a="",i=[],c=[];return a="mimetype",ct(t,a,"application/vnd.oasis.opendocument.spreadsheet"),a="content.xml",ct(t,a,Cf(e,r)),i.push([a,"text/xml"]),c.push([a,"ContentFile"]),a="styles.xml",ct(t,a,Tv(e,r)),i.push([a,"text/xml"]),c.push([a,"StylesFile"]),a="meta.xml",ct(t,a,nr+il()),i.push([a,"text/xml"]),c.push([a,"MetadataFile"]),a="manifest.rdf",ct(t,a,$d(c)),i.push([a,"application/rdf+xml"]),a="META-INF/manifest.xml",ct(t,a,Jd(i)),t}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function ka(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function so(e){return typeof TextDecoder<"u"?new TextDecoder().decode(e):Nt(fa(e))}function Sv(e){return typeof TextEncoder<"u"?new TextEncoder().encode(e):Qr(Rn(e))}function yv(e,r){e:for(var t=0;t<=e.length-r.length;++t){for(var a=0;a<r.length;++a)if(e[t+a]!=r[a])continue e;return!0}return!1}function ca(e){var r=e.reduce(function(i,c){return i+c.length},0),t=new Uint8Array(r),a=0;return e.forEach(function(i){t.set(i,a),a+=i.length}),t}function Tf(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>>24}function Iv(e,r){for(var t=(e[r+15]&127)<<7|e[r+14]>>1,a=e[r+14]&1,i=r+13;i>=r;--i)a=a*256+e[i];return(e[r+15]&128?-a:a)*Math.pow(10,t-6176)}function kv(e,r,t){var a=Math.floor(t==0?0:Math.LOG10E*Math.log(Math.abs(t)))+6176-20,i=t/Math.pow(10,a-6176);e[r+15]|=a>>7,e[r+14]|=(a&127)<<1;for(var c=0;i>=1;++c,i/=256)e[r+c]=i&255;e[r+15]|=t>=0?0:128}function zi(e,r){var t=r?r[0]:0,a=e[t]&127;e:if(e[t++]>=128&&(a|=(e[t]&127)<<7,e[t++]<128||(a|=(e[t]&127)<<14,e[t++]<128)||(a|=(e[t]&127)<<21,e[t++]<128)||(a+=(e[t]&127)*Math.pow(2,28),++t,e[t++]<128)||(a+=(e[t]&127)*Math.pow(2,35),++t,e[t++]<128)||(a+=(e[t]&127)*Math.pow(2,42),++t,e[t++]<128)))break e;return r&&(r[0]=t),a}function yt(e){var r=new Uint8Array(7);r[0]=e&127;var t=1;e:if(e>127){if(r[t-1]|=128,r[t]=e>>7&127,++t,e<=16383||(r[t-1]|=128,r[t]=e>>14&127,++t,e<=2097151)||(r[t-1]|=128,r[t]=e>>21&127,++t,e<=268435455)||(r[t-1]|=128,r[t]=e/256>>>21&127,++t,e<=34359738367)||(r[t-1]|=128,r[t]=e/65536>>>21&127,++t,e<=4398046511103))break e;r[t-1]|=128,r[t]=e/16777216>>>21&127,++t}return r.slice(0,t)}function Qt(e){var r=0,t=e[r]&127;e:if(e[r++]>=128){if(t|=(e[r]&127)<<7,e[r++]<128||(t|=(e[r]&127)<<14,e[r++]<128)||(t|=(e[r]&127)<<21,e[r++]<128))break e;t|=(e[r]&127)<<28}return t}function Tt(e){for(var r=[],t=[0];t[0]<e.length;){var a=t[0],i=zi(e,t),c=i&7;i=Math.floor(i/8);var u=0,d;if(i==0)break;switch(c){case 0:{for(var g=t[0];e[t[0]++]>=128;);d=e.slice(g,t[0])}break;case 5:u=4,d=e.slice(t[0],t[0]+u),t[0]+=u;break;case 1:u=8,d=e.slice(t[0],t[0]+u),t[0]+=u;break;case 2:u=zi(e,t),d=e.slice(t[0],t[0]+u),t[0]+=u;break;case 3:case 4:default:throw new Error("PB Type ".concat(c," for Field ").concat(i," at offset ").concat(a))}var m={data:d,type:c};r[i]==null?r[i]=[m]:r[i].push(m)}return r}function _r(e){var r=[];return e.forEach(function(t,a){t.forEach(function(i){i.data&&(r.push(yt(a*8+i.type)),i.type==2&&r.push(yt(i.data.length)),r.push(i.data))})}),ca(r)}function Xo(e,r){return e?.map(function(t){return r(t.data)})||[]}function fn(e){for(var r,t=[],a=[0];a[0]<e.length;){var i=zi(e,a),c=Tt(e.slice(a[0],a[0]+i));a[0]+=i;var u={id:Qt(c[1][0].data),messages:[]};c[2].forEach(function(d){var g=Tt(d.data),m=Qt(g[3][0].data);u.messages.push({meta:g,data:e.slice(a[0],a[0]+m)}),a[0]+=m}),(r=c[3])!=null&&r[0]&&(u.merge=Qt(c[3][0].data)>>>0>0),t.push(u)}return t}function za(e){var r=[];return e.forEach(function(t){var a=[];a[1]=[{data:yt(t.id),type:0}],a[2]=[],t.merge!=null&&(a[3]=[{data:yt(+!!t.merge),type:0}]);var i=[];t.messages.forEach(function(u){i.push(u.data),u.meta[3]=[{type:0,data:yt(u.data.length)}],a[2].push({data:_r(u.meta),type:2})});var c=_r(a);r.push(yt(c.length)),r.push(c),i.forEach(function(u){return r.push(u)})}),ca(r)}function bv(e,r){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var t=[0],a=zi(r,t),i=[];t[0]<r.length;){var c=r[t[0]]&3;if(c==0){var u=r[t[0]++]>>2;if(u<60)++u;else{var d=u-59;u=r[t[0]],d>1&&(u|=r[t[0]+1]<<8),d>2&&(u|=r[t[0]+2]<<16),d>3&&(u|=r[t[0]+3]<<24),u>>>=0,u++,t[0]+=d}i.push(r.slice(t[0],t[0]+u)),t[0]+=u;continue}else{var g=0,m=0;if(c==1?(m=(r[t[0]]>>2&7)+4,g=(r[t[0]++]&224)<<3,g|=r[t[0]++]):(m=(r[t[0]++]>>2)+1,c==2?(g=r[t[0]]|r[t[0]+1]<<8,t[0]+=2):(g=(r[t[0]]|r[t[0]+1]<<8|r[t[0]+2]<<16|r[t[0]+3]<<24)>>>0,t[0]+=4)),i=[ca(i)],g==0)throw new Error("Invalid offset 0");if(g>i[0].length)throw new Error("Invalid offset beyond length");if(m>=g)for(i.push(i[0].slice(-g)),m-=g;m>=i[i.length-1].length;)i.push(i[i.length-1]),m-=i[i.length-1].length;i.push(i[0].slice(-g,-g+m))}}var w=ca(i);if(w.length!=a)throw new Error("Unexpected length: ".concat(w.length," != ").concat(a));return w}function ln(e){for(var r=[],t=0;t<e.length;){var a=e[t++],i=e[t]|e[t+1]<<8|e[t+2]<<16;t+=3,r.push(bv(a,e.slice(t,t+i))),t+=i}if(t!==e.length)throw new Error("data is not a valid framed stream!");return ca(r)}function Ya(e){for(var r=[],t=0;t<e.length;){var a=Math.min(e.length-t,268435455),i=new Uint8Array(4);r.push(i);var c=yt(a),u=c.length;r.push(c),a<=60?(u++,r.push(new Uint8Array([a-1<<2]))):a<=256?(u+=2,r.push(new Uint8Array([240,a-1&255]))):a<=65536?(u+=3,r.push(new Uint8Array([244,a-1&255,a-1>>8&255]))):a<=16777216?(u+=4,r.push(new Uint8Array([248,a-1&255,a-1>>8&255,a-1>>16&255]))):a<=4294967296&&(u+=5,r.push(new Uint8Array([252,a-1&255,a-1>>8&255,a-1>>16&255,a-1>>>24&255]))),r.push(e.slice(t,t+a)),u+=a,i[0]=0,i[1]=u&255,i[2]=u>>8&255,i[3]=u>>16&255,t+=a}return ca(r)}function Nv(e,r,t,a){var i=ka(e),c=i.getUint32(4,!0),u=(a>1?12:8)+Tf(c&(a>1?3470:398))*4,d=-1,g=-1,m=NaN,w=new Date(2001,0,1);c&512&&(d=i.getUint32(u,!0),u+=4),u+=Tf(c&(a>1?12288:4096))*4,c&16&&(g=i.getUint32(u,!0),u+=4),c&32&&(m=i.getFloat64(u,!0),u+=8),c&64&&(w.setTime(w.getTime()+i.getFloat64(u,!0)*1e3),u+=8);var v;switch(e[2]){case 0:break;case 2:v={t:"n",v:m};break;case 3:v={t:"s",v:r[g]};break;case 5:v={t:"d",v:w};break;case 6:v={t:"b",v:m>0};break;case 7:v={t:"n",v:m/86400};break;case 8:v={t:"e",v:0};break;case 9:if(d>-1)v={t:"s",v:t[d]};else if(g>-1)v={t:"s",v:r[g]};else if(!isNaN(m))v={t:"n",v:m};else throw new Error("Unsupported cell type ".concat(e.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return v}function Fv(e,r,t){var a=ka(e),i=a.getUint32(8,!0),c=12,u=-1,d=-1,g=NaN,m=NaN,w=new Date(2001,0,1);i&1&&(g=Iv(e,c),c+=16),i&2&&(m=a.getFloat64(c,!0),c+=8),i&4&&(w.setTime(w.getTime()+a.getFloat64(c,!0)*1e3),c+=8),i&8&&(d=a.getUint32(c,!0),c+=4),i&16&&(u=a.getUint32(c,!0),c+=4);var v;switch(e[1]){case 0:break;case 2:v={t:"n",v:g};break;case 3:v={t:"s",v:r[d]};break;case 5:v={t:"d",v:w};break;case 6:v={t:"b",v:m>0};break;case 7:v={t:"n",v:m/86400};break;case 8:v={t:"e",v:0};break;case 9:if(u>-1)v={t:"s",v:t[u]};else throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(i&31," : ").concat(e.slice(0,4)));break;case 10:v={t:"n",v:g};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(i&31," : ").concat(e.slice(0,4)))}return v}function _0(e,r){var t=new Uint8Array(32),a=ka(t),i=12,c=0;switch(t[0]=5,e.t){case"n":t[1]=2,kv(t,i,e.v),c|=1,i+=16;break;case"b":t[1]=6,a.setFloat64(i,e.v?1:0,!0),c|=2,i+=8;break;case"s":if(r.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));t[1]=3,a.setUint32(i,r.indexOf(e.v),!0),c|=8,i+=4;break;default:throw"unsupported cell type "+e.t}return a.setUint32(8,c,!0),t.slice(0,i)}function A0(e,r){var t=new Uint8Array(32),a=ka(t),i=12,c=0;switch(t[0]=3,e.t){case"n":t[2]=2,a.setFloat64(i,e.v,!0),c|=32,i+=8;break;case"b":t[2]=6,a.setFloat64(i,e.v?1:0,!0),c|=32,i+=8;break;case"s":if(r.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));t[2]=3,a.setUint32(i,r.indexOf(e.v),!0),c|=16,i+=4;break;default:throw"unsupported cell type "+e.t}return a.setUint32(4,c,!0),t.slice(0,i)}function Rv(e,r,t){switch(e[0]){case 0:case 1:case 2:case 3:return Nv(e,r,t,e[0]);case 5:return Fv(e,r,t);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function Ir(e){var r=Tt(e);return zi(r[1][0].data)}function Sf(e,r){var t=Tt(r.data),a=Qt(t[1][0].data),i=t[3],c=[];return(i||[]).forEach(function(u){var d=Tt(u.data),g=Qt(d[1][0].data)>>>0;switch(a){case 1:c[g]=so(d[3][0].data);break;case 8:{var m=e[Ir(d[9][0].data)][0],w=Tt(m.data),v=e[Ir(w[1][0].data)][0],_=Qt(v.meta[1][0].data);if(_!=2001)throw new Error("2000 unexpected reference to ".concat(_));var C=Tt(v.data);c[g]=C[3].map(function(S){return so(S.data)}).join("")}break}}),c}function Ov(e,r){var t,a,i,c,u,d,g,m,w,v,_,C,S,A,y=Tt(e),D=Qt(y[1][0].data)>>>0,P=Qt(y[2][0].data)>>>0,b=((a=(t=y[8])==null?void 0:t[0])==null?void 0:a.data)&&Qt(y[8][0].data)>0||!1,V,te;if((c=(i=y[7])==null?void 0:i[0])!=null&&c.data&&r!=0)V=(d=(u=y[7])==null?void 0:u[0])==null?void 0:d.data,te=(m=(g=y[6])==null?void 0:g[0])==null?void 0:m.data;else if((v=(w=y[4])==null?void 0:w[0])!=null&&v.data&&r!=1)V=(C=(_=y[4])==null?void 0:_[0])==null?void 0:C.data,te=(A=(S=y[3])==null?void 0:S[0])==null?void 0:A.data;else throw"NUMBERS Tile missing ".concat(r," cell storage");for(var W=b?4:1,N=ka(V),j=[],O=0;O<V.length/2;++O){var ae=N.getUint16(O*2,!0);ae<65535&&j.push([O,ae])}if(j.length!=P)throw"Expected ".concat(P," cells, found ").concat(j.length);var Q=[];for(O=0;O<j.length-1;++O)Q[j[O][0]]=te.subarray(j[O][1]*W,j[O+1][1]*W);return j.length>=1&&(Q[j[j.length-1][0]]=te.subarray(j[j.length-1][1]*W)),{R:D,cells:Q}}function Dv(e,r){var t,a=Tt(r.data),i=(t=a?.[7])!=null&&t[0]?Qt(a[7][0].data)>>>0>0?1:0:-1,c=Xo(a[5],function(u){return Ov(u,i)});return{nrows:Qt(a[4][0].data)>>>0,data:c.reduce(function(u,d){return u[d.R]||(u[d.R]=[]),d.cells.forEach(function(g,m){if(u[d.R][m])throw new Error("Duplicate cell r=".concat(d.R," c=").concat(m));u[d.R][m]=g}),u},[])}}function Bv(e,r,t){var a,i=Tt(r.data),c={s:{r:0,c:0},e:{r:0,c:0}};if(c.e.r=(Qt(i[6][0].data)>>>0)-1,c.e.r<0)throw new Error("Invalid row varint ".concat(i[6][0].data));if(c.e.c=(Qt(i[7][0].data)>>>0)-1,c.e.c<0)throw new Error("Invalid col varint ".concat(i[7][0].data));t["!ref"]=it(c);var u=Tt(i[4][0].data),d=Sf(e,e[Ir(u[4][0].data)][0]),g=(a=u[17])!=null&&a[0]?Sf(e,e[Ir(u[17][0].data)][0]):[],m=Tt(u[3][0].data),w=0;m[1].forEach(function(v){var _=Tt(v.data),C=e[Ir(_[2][0].data)][0],S=Qt(C.meta[1][0].data);if(S!=6002)throw new Error("6001 unexpected reference to ".concat(S));var A=Dv(e,C);A.data.forEach(function(y,D){y.forEach(function(P,b){var V=Qe({r:w+D,c:b}),te=Rv(P,d,g);te&&(t[V]=te)})}),w+=A.nrows})}function Mv(e,r){var t=Tt(r.data),a={"!ref":"A1"},i=e[Ir(t[2][0].data)],c=Qt(i[0].meta[1][0].data);if(c!=6001)throw new Error("6000 unexpected reference to ".concat(c));return Bv(e,i[0],a),a}function Pv(e,r){var t,a=Tt(r.data),i={name:(t=a[1])!=null&&t[0]?so(a[1][0].data):"",sheets:[]},c=Xo(a[2],Ir);return c.forEach(function(u){e[u].forEach(function(d){var g=Qt(d.meta[1][0].data);g==6e3&&i.sheets.push(Mv(e,d))})}),i}function Lv(e,r){var t=Zo(),a=Tt(r.data),i=Xo(a[1],Ir);if(i.forEach(function(c){e[c].forEach(function(u){var d=Qt(u.meta[1][0].data);if(d==2){var g=Pv(e,u);g.sheets.forEach(function(m,w){qo(t,m,w==0?g.name:g.name+"_"+w,!0)})}})}),t.SheetNames.length==0)throw new Error("Empty NUMBERS file");return t}function C0(e){var r,t,a,i,c={},u=[];if(e.FullPaths.forEach(function(g){if(g.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(g){if(g.name.match(/\.iwa$/)){var m;try{m=ln(g.content)}catch(v){return console.log("?? "+g.content.length+" "+(v.message||v))}var w;try{w=fn(m)}catch(v){return console.log("## "+(v.message||v))}w.forEach(function(v){c[v.id]=v.messages,u.push(v.id)})}}),!u.length)throw new Error("File has no messages");var d=((i=(a=(t=(r=c?.[1])==null?void 0:r[0])==null?void 0:t.meta)==null?void 0:a[1])==null?void 0:i[0].data)&&Qt(c[1][0].meta[1][0].data)==1&&c[1][0];if(d||u.forEach(function(g){c[g].forEach(function(m){var w=Qt(m.meta[1][0].data)>>>0;if(w==1)if(!d)d=m;else throw new Error("Document has multiple roots")})}),!d)throw new Error("Cannot find Document root");return Lv(c,d)}function Uv(e,r,t){var a,i,c,u;if(!((a=e[6])!=null&&a[0])||!((i=e[7])!=null&&i[0]))throw"Mutation only works on post-BNC storages!";var d=((u=(c=e[8])==null?void 0:c[0])==null?void 0:u.data)&&Qt(e[8][0].data)>0||!1;if(d)throw"Math only works with normal offsets";for(var g=0,m=ka(e[7][0].data),w=0,v=[],_=ka(e[4][0].data),C=0,S=[],A=0;A<r.length;++A){if(r[A]==null){m.setUint16(A*2,65535,!0),_.setUint16(A*2,65535);continue}m.setUint16(A*2,w,!0),_.setUint16(A*2,C,!0);var y,D;switch(typeof r[A]){case"string":y=_0({t:"s",v:r[A]},t),D=A0({t:"s",v:r[A]},t);break;case"number":y=_0({t:"n",v:r[A]},t),D=A0({t:"n",v:r[A]},t);break;case"boolean":y=_0({t:"b",v:r[A]},t),D=A0({t:"b",v:r[A]},t);break;default:throw new Error("Unsupported value "+r[A])}v.push(y),w+=y.length,S.push(D),C+=D.length,++g}for(e[2][0].data=yt(g);A<e[7][0].data.length/2;++A)m.setUint16(A*2,65535,!0),_.setUint16(A*2,65535,!0);return e[6][0].data=ca(v),e[3][0].data=ca(S),g}function Wv(e,r){if(!r||!r.numbers)throw new Error("Must pass a `numbers` option -- check the README");var t=e.Sheets[e.SheetNames[0]];e.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var a=Xr(t["!ref"]);a.s.r=a.s.c=0;var i=!1;a.e.c>9&&(i=!0,a.e.c=9),a.e.r>49&&(i=!0,a.e.r=49),i&&console.error("The Numbers writer is currently limited to ".concat(it(a)));var c=Os(t,{range:a,header:1}),u=["~Sh33tJ5~"];c.forEach(function(ne){return ne.forEach(function(Z){typeof Z=="string"&&u.push(Z)})});var d={},g=[],m=Ke.read(r.numbers,{type:"base64"});m.FileIndex.map(function(ne,Z){return[ne,m.FullPaths[Z]]}).forEach(function(ne){var Z=ne[0],ee=ne[1];if(Z.type==2&&Z.name.match(/\.iwa/)){var oe=Z.content,Ie=ln(oe),Ae=fn(Ie);Ae.forEach(function(Te){g.push(Te.id),d[Te.id]={deps:[],location:ee,type:Qt(Te.messages[0].meta[1][0].data)}})}}),g.sort(function(ne,Z){return ne-Z});var w=g.filter(function(ne){return ne>1}).map(function(ne){return[ne,yt(ne)]});m.FileIndex.map(function(ne,Z){return[ne,m.FullPaths[Z]]}).forEach(function(ne){var Z=ne[0];if(ne[1],!!Z.name.match(/\.iwa/)){var ee=fn(ln(Z.content));ee.forEach(function(oe){oe.messages.forEach(function(Ie){w.forEach(function(Ae){oe.messages.some(function(Te){return Qt(Te.meta[1][0].data)!=11006&&yv(Te.data,Ae[1])})&&d[Ae[0]].deps.push(oe.id)})})})}});for(var v=Ke.find(m,d[1].location),_=fn(ln(v.content)),C,S=0;S<_.length;++S){var A=_[S];A.id==1&&(C=A)}var y=Ir(Tt(C.messages[0].data)[1][0].data);for(v=Ke.find(m,d[y].location),_=fn(ln(v.content)),S=0;S<_.length;++S)A=_[S],A.id==y&&(C=A);for(y=Ir(Tt(C.messages[0].data)[2][0].data),v=Ke.find(m,d[y].location),_=fn(ln(v.content)),S=0;S<_.length;++S)A=_[S],A.id==y&&(C=A);for(y=Ir(Tt(C.messages[0].data)[2][0].data),v=Ke.find(m,d[y].location),_=fn(ln(v.content)),S=0;S<_.length;++S)A=_[S],A.id==y&&(C=A);var D=Tt(C.messages[0].data);{D[6][0].data=yt(a.e.r+1),D[7][0].data=yt(a.e.c+1);var P=Ir(D[46][0].data),b=Ke.find(m,d[P].location),V=fn(ln(b.content));{for(var te=0;te<V.length&&V[te].id!=P;++te);if(V[te].id!=P)throw"Bad ColumnRowUIDMapArchive";var W=Tt(V[te].messages[0].data);W[1]=[],W[2]=[],W[3]=[];for(var N=0;N<=a.e.c;++N){var j=[];j[1]=j[2]=[{type:0,data:yt(N+420690)}],W[1].push({type:2,data:_r(j)}),W[2].push({type:0,data:yt(N)}),W[3].push({type:0,data:yt(N)})}W[4]=[],W[5]=[],W[6]=[];for(var O=0;O<=a.e.r;++O)j=[],j[1]=j[2]=[{type:0,data:yt(O+726270)}],W[4].push({type:2,data:_r(j)}),W[5].push({type:0,data:yt(O)}),W[6].push({type:0,data:yt(O)});V[te].messages[0].data=_r(W)}b.content=Ya(za(V)),b.size=b.content.length,delete D[46];var ae=Tt(D[4][0].data);{ae[7][0].data=yt(a.e.r+1);var Q=Tt(ae[1][0].data),X=Ir(Q[2][0].data);b=Ke.find(m,d[X].location),V=fn(ln(b.content));{if(V[0].id!=X)throw"Bad HeaderStorageBucket";var ie=Tt(V[0].messages[0].data);for(O=0;O<c.length;++O){var Ee=Tt(ie[2][0].data);Ee[1][0].data=yt(O),Ee[4][0].data=yt(c[O].length),ie[2][O]={type:ie[2][0].type,data:_r(Ee)}}V[0].messages[0].data=_r(ie)}b.content=Ya(za(V)),b.size=b.content.length;var q=Ir(ae[2][0].data);b=Ke.find(m,d[q].location),V=fn(ln(b.content));{if(V[0].id!=q)throw"Bad HeaderStorageBucket";for(ie=Tt(V[0].messages[0].data),N=0;N<=a.e.c;++N)Ee=Tt(ie[2][0].data),Ee[1][0].data=yt(N),Ee[4][0].data=yt(a.e.r+1),ie[2][N]={type:ie[2][0].type,data:_r(Ee)};V[0].messages[0].data=_r(ie)}b.content=Ya(za(V)),b.size=b.content.length;var ue=Ir(ae[4][0].data);(function(){for(var ne=Ke.find(m,d[ue].location),Z=fn(ln(ne.content)),ee,oe=0;oe<Z.length;++oe){var Ie=Z[oe];Ie.id==ue&&(ee=Ie)}var Ae=Tt(ee.messages[0].data);{Ae[3]=[];var Te=[];u.forEach(function(K,Xe){Te[1]=[{type:0,data:yt(Xe)}],Te[2]=[{type:0,data:yt(1)}],Te[3]=[{type:2,data:Sv(K)}],Ae[3].push({type:2,data:_r(Te)})})}ee.messages[0].data=_r(Ae);var Se=za(Z),Ye=Ya(Se);ne.content=Ye,ne.size=ne.content.length})();var de=Tt(ae[3][0].data);{var We=de[1][0];delete de[2];var se=Tt(We.data);{var Le=Ir(se[2][0].data);(function(){for(var ne=Ke.find(m,d[Le].location),Z=fn(ln(ne.content)),ee,oe=0;oe<Z.length;++oe){var Ie=Z[oe];Ie.id==Le&&(ee=Ie)}var Ae=Tt(ee.messages[0].data);{delete Ae[6],delete de[7];var Te=new Uint8Array(Ae[5][0].data);Ae[5]=[];for(var Se=0,Ye=0;Ye<=a.e.r;++Ye){var K=Tt(Te);Se+=Uv(K,c[Ye],u),K[1][0].data=yt(Ye),Ae[5].push({data:_r(K),type:2})}Ae[1]=[{type:0,data:yt(a.e.c+1)}],Ae[2]=[{type:0,data:yt(a.e.r+1)}],Ae[3]=[{type:0,data:yt(Se)}],Ae[4]=[{type:0,data:yt(a.e.r+1)}]}ee.messages[0].data=_r(Ae);var Xe=za(Z),st=Ya(Xe);ne.content=st,ne.size=ne.content.length})()}We.data=_r(se)}ae[3][0].data=_r(de)}D[4][0].data=_r(ae)}C.messages[0].data=_r(D);var Ge=za(_),z=Ya(Ge);return v.content=z,v.size=v.content.length,m}function wu(e){return function(t){for(var a=0;a!=e.length;++a){var i=e[a];t[i[0]]===void 0&&(t[i[0]]=i[1]),i[2]==="n"&&(t[i[0]]=Number(t[i[0]]))}}}function zo(e){wu([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function Yo(e){wu([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(e)}function Vv(e){return pt.WS.indexOf(e)>-1?"sheet":e==pt.CS?"chart":e==pt.DS?"dialog":e==pt.MS?"macro":e&&e.length?e:"sheet"}function Hv(e,r){if(!e)return 0;try{e=r.map(function(a){return a.id||(a.id=a.strRelID),[a.name,e["!id"][a.id].Target,Vv(e["!id"][a.id].Type)]})}catch{return null}return!e||e.length===0?null:e}function Gv(e,r,t,a,i,c,u,d,g,m,w,v){try{c[a]=ki($r(e,t,!0),r);var _=sr(e,r),C;switch(d){case"sheet":C=uE(_,r,i,g,c[a],m,w,v);break;case"chart":if(C=hE(_,r,i,g,c[a],m,w,v),!C||!C["!drawel"])break;var S=Ci(C["!drawel"].Target,r),A=Ui(S),y=Qm($r(e,S,!0),ki($r(e,A,!0),S)),D=Ci(y,S),P=Ui(D);C=U4($r(e,D,!0),D,g,ki($r(e,P,!0),D),m,C);break;case"macro":C=dE(_,r,i,g,c[a],m,w,v);break;case"dialog":C=xE(_,r,i,g,c[a],m,w,v);break;default:throw new Error("Unrecognized sheet type "+d)}u[a]=C;var b=[];c&&c[a]&&$t(c[a]).forEach(function(V){var te="";if(c[a][V].Type==pt.CMNT){te=Ci(c[a][V].Target,r);var W=wE(sr(e,te,!0),te,g);if(!W||!W.length)return;lf(C,W,!1)}c[a][V].Type==pt.TCMNT&&(te=Ci(c[a][V].Target,r),b=b.concat(ep(sr(e,te,!0),g)))}),b&&b.length&&lf(C,b,!0,g.people||[])}catch(V){if(g.WTF)throw V}}function on(e){return e.charAt(0)=="/"?e.slice(1):e}function Xv(e,r){if(ii(),r=r||{},zo(r),un(e,"META-INF/manifest.xml")||un(e,"objectdata.xml"))return _f(e,r);if(un(e,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof C0<"u"){if(e.FileIndex)return C0(e);var t=Ke.utils.cfb_new();return Nc(e).forEach(function(Ee){ct(t,Ee,td(e,Ee))}),C0(t)}throw new Error("Unsupported NUMBERS file")}if(!un(e,"[Content_Types].xml"))throw un(e,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):un(e,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var a=Nc(e),i=jd($r(e,"[Content_Types].xml")),c=!1,u,d;if(i.workbooks.length===0&&(d="xl/workbook.xml",sr(e,d,!0)&&i.workbooks.push(d)),i.workbooks.length===0){if(d="xl/workbook.bin",!sr(e,d,!0))throw new Error("Could not find workbook");i.workbooks.push(d),c=!0}i.workbooks[0].slice(-3)=="bin"&&(c=!0);var g={},m={};if(!r.bookSheets&&!r.bookProps){if(bi=[],i.sst)try{bi=pE(sr(e,on(i.sst)),i.sst,r)}catch(Ee){if(r.WTF)throw Ee}r.cellStyles&&i.themes.length&&(g=mE($r(e,i.themes[0].replace(/^\//,""),!0)||"",i.themes[0],r)),i.style&&(m=gE(sr(e,on(i.style)),i.style,g,r))}i.links.map(function(Ee){try{var q=ki($r(e,Ui(on(Ee))),Ee);return vE(sr(e,on(Ee)),q,Ee,r)}catch{}});var w=lE(sr(e,on(i.workbooks[0])),i.workbooks[0],r),v={},_="";i.coreprops.length&&(_=sr(e,on(i.coreprops[0]),!0),_&&(v=sl(_)),i.extprops.length!==0&&(_=sr(e,on(i.extprops[0]),!0),_&&tx(_,v,r)));var C={};(!r.bookSheets||r.bookProps)&&i.custprops.length!==0&&(_=$r(e,on(i.custprops[0]),!0),_&&(C=nx(_,r)));var S={};if((r.bookSheets||r.bookProps)&&(w.Sheets?u=w.Sheets.map(function(q){return q.name}):v.Worksheets&&v.SheetNames.length>0&&(u=v.SheetNames),r.bookProps&&(S.Props=v,S.Custprops=C),r.bookSheets&&typeof u<"u"&&(S.SheetNames=u),r.bookSheets?S.SheetNames:r.bookProps))return S;u={};var A={};r.bookDeps&&i.calcchain&&(A=EE(sr(e,on(i.calcchain)),i.calcchain));var y=0,D={},P,b;{var V=w.Sheets;v.Worksheets=V.length,v.SheetNames=[];for(var te=0;te!=V.length;++te)v.SheetNames[te]=V[te].name}var W=c?"bin":"xml",N=i.workbooks[0].lastIndexOf("/"),j=(i.workbooks[0].slice(0,N+1)+"_rels/"+i.workbooks[0].slice(N+1)+".rels").replace(/^\//,"");un(e,j)||(j="xl/_rels/workbook."+W+".rels");var O=ki($r(e,j,!0),j.replace(/_rels.*/,"s5s"));(i.metadata||[]).length>=1&&(r.xlmeta=_E(sr(e,on(i.metadata[0])),i.metadata[0],r)),(i.people||[]).length>=1&&(r.people=rp(sr(e,on(i.people[0])),r)),O&&(O=Hv(O,w.Sheets));var ae=sr(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(y=0;y!=v.Worksheets;++y){var Q="sheet";if(O&&O[y]?(P="xl/"+O[y][1].replace(/[\/]?xl\//,""),un(e,P)||(P=O[y][1]),un(e,P)||(P=j.replace(/_rels\/.*$/,"")+O[y][1]),Q=O[y][2]):(P="xl/worksheets/sheet"+(y+1-ae)+"."+W,P=P.replace(/sheet0\./,"sheet.")),b=P.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),r&&r.sheets!=null)switch(typeof r.sheets){case"number":if(y!=r.sheets)continue e;break;case"string":if(v.SheetNames[y].toLowerCase()!=r.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(r.sheets)){for(var X=!1,ie=0;ie!=r.sheets.length;++ie)typeof r.sheets[ie]=="number"&&r.sheets[ie]==y&&(X=1),typeof r.sheets[ie]=="string"&&r.sheets[ie].toLowerCase()==v.SheetNames[y].toLowerCase()&&(X=1);if(!X)continue e}}Gv(e,P,b,v.SheetNames[y],y,D,u,Q,r,w,g,m)}return S={Directory:i,Workbook:w,Props:v,Custprops:C,Deps:A,Sheets:u,SheetNames:v.SheetNames,Strings:bi,Styles:m,Themes:g,SSF:Vt(qe)},r&&r.bookFiles&&(e.files?(S.keys=a,S.files=e.files):(S.keys=[],S.files={},e.FullPaths.forEach(function(Ee,q){Ee=Ee.replace(/^Root Entry[\/]/,""),S.keys.push(Ee),S.files[Ee]=e.FileIndex[q]}))),r&&r.bookVBA&&(i.vba.length>0?S.vbaraw=sr(e,on(i.vba[0]),!0):i.defaults&&i.defaults.bin===lp&&(S.vbaraw=sr(e,"xl/vbaProject.bin",!0))),S}function zv(e,r){var t=r||{},a="Workbook",i=Ke.find(e,a);try{if(a="/!DataSpaces/Version",i=Ke.find(e,a),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+a);if(_g(i.content),a="/!DataSpaces/DataSpaceMap",i=Ke.find(e,a),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+a);var c=Cg(i.content);if(c.length!==1||c[0].comps.length!==1||c[0].comps[0].t!==0||c[0].name!=="StrongEncryptionDataSpace"||c[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+a);if(a="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",i=Ke.find(e,a),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+a);var u=Tg(i.content);if(u.length!=1||u[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+a);if(a="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",i=Ke.find(e,a),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+a);yg(i.content)}catch{}if(a="/EncryptionInfo",i=Ke.find(e,a),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+a);var d=Ig(i.content);if(a="/EncryptedPackage",i=Ke.find(e,a),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+a);if(d[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(d[1],i.content,t.password||"",t);if(d[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(d[1],i.content,t.password||"",t);throw new Error("File is password-protected")}function Yv(e,r){return r.bookType=="ods"?pu(e,r):r.bookType=="numbers"?Wv(e,r):r.bookType=="xlsb"?Kv(e,r):jv(e,r)}function Kv(e,r){Za=1024,e&&!e.SSF&&(e.SSF=Vt(qe)),e&&e.SSF&&(ii(),Ls(e.SSF),r.revssf=Ws(e.SSF),r.revssf[e.SSF[65535]]=0,r.ssf=e.SSF),r.rels={},r.wbrels={},r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,Ni?r.revStrings=new Map:(r.revStrings={},r.revStrings.foo=[],delete r.revStrings.foo);var t=r.bookType=="xlsb"?"bin":"xml",a=zl.indexOf(r.bookType)>-1,i=Fo();Yo(r=r||{});var c=po(),u="",d=0;if(r.cellXfs=[],ua(r.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),u="docProps/core.xml",ct(c,u,ol(e.Props,r)),i.coreprops.push(u),It(r.rels,2,u,pt.CORE_PROPS),u="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var g=[],m=0;m<e.SheetNames.length;++m)(e.Workbook.Sheets[m]||{}).Hidden!=2&&g.push(e.SheetNames[m]);e.Props.SheetNames=g}for(e.Props.Worksheets=e.Props.SheetNames.length,ct(c,u,ll(e.Props)),i.extprops.push(u),It(r.rels,3,u,pt.EXT_PROPS),e.Custprops!==e.Props&&$t(e.Custprops||{}).length>0&&(u="docProps/custom.xml",ct(c,u,ul(e.Custprops)),i.custprops.push(u),It(r.rels,4,u,pt.CUST_PROPS)),d=1;d<=e.SheetNames.length;++d){var w={"!id":{}},v=e.Sheets[e.SheetNames[d-1]],_=(v||{})["!type"]||"sheet";switch(_){case"chart":default:u="xl/worksheets/sheet"+d+"."+t,ct(c,u,CE(d-1,u,r,e,w)),i.sheets.push(u),It(r.wbrels,-1,"worksheets/sheet"+d+"."+t,pt.WS[0])}if(v){var C=v["!comments"],S=!1,A="";C&&C.length>0&&(A="xl/comments"+d+"."+t,ct(c,A,yE(C,A)),i.comments.push(A),It(w,-1,"../comments"+d+"."+t,pt.CMNT),S=!0),v["!legacy"]&&S&&ct(c,"xl/drawings/vmlDrawing"+d+".vml",Gl(d,v["!comments"])),delete v["!comments"],delete v["!legacy"]}w["!id"].rId1&&ct(c,Ui(u),Qa(w))}return r.Strings!=null&&r.Strings.length>0&&(u="xl/sharedStrings."+t,ct(c,u,SE(r.Strings,u,r)),i.strs.push(u),It(r.wbrels,-1,"sharedStrings."+t,pt.SST)),u="xl/workbook."+t,ct(c,u,AE(e,u)),i.workbooks.push(u),It(r.rels,1,u,pt.WB),u="xl/theme/theme1.xml",ct(c,u,Po(e.Themes,r)),i.themes.push(u),It(r.wbrels,-1,"theme/theme1.xml",pt.THEME),u="xl/styles."+t,ct(c,u,TE(e,u,r)),i.styles.push(u),It(r.wbrels,-1,"styles."+t,pt.STY),e.vbaraw&&a&&(u="xl/vbaProject.bin",ct(c,u,e.vbaraw),i.vba.push(u),It(r.wbrels,-1,"vbaProject.bin",pt.VBA)),u="xl/metadata."+t,ct(c,u,IE(u)),i.metadata.push(u),It(r.wbrels,-1,"metadata."+t,pt.XLMETA),ct(c,"[Content_Types].xml",al(i,r)),ct(c,"_rels/.rels",Qa(r.rels)),ct(c,"xl/_rels/workbook."+t+".rels",Qa(r.wbrels)),delete r.revssf,delete r.ssf,c}function jv(e,r){Za=1024,e&&!e.SSF&&(e.SSF=Vt(qe)),e&&e.SSF&&(ii(),Ls(e.SSF),r.revssf=Ws(e.SSF),r.revssf[e.SSF[65535]]=0,r.ssf=e.SSF),r.rels={},r.wbrels={},r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,Ni?r.revStrings=new Map:(r.revStrings={},r.revStrings.foo=[],delete r.revStrings.foo);var t="xml",a=zl.indexOf(r.bookType)>-1,i=Fo();Yo(r=r||{});var c=po(),u="",d=0;if(r.cellXfs=[],ua(r.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),u="docProps/core.xml",ct(c,u,ol(e.Props,r)),i.coreprops.push(u),It(r.rels,2,u,pt.CORE_PROPS),u="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var g=[],m=0;m<e.SheetNames.length;++m)(e.Workbook.Sheets[m]||{}).Hidden!=2&&g.push(e.SheetNames[m]);e.Props.SheetNames=g}e.Props.Worksheets=e.Props.SheetNames.length,ct(c,u,ll(e.Props)),i.extprops.push(u),It(r.rels,3,u,pt.EXT_PROPS),e.Custprops!==e.Props&&$t(e.Custprops||{}).length>0&&(u="docProps/custom.xml",ct(c,u,ul(e.Custprops)),i.custprops.push(u),It(r.rels,4,u,pt.CUST_PROPS));var w=["SheetJ5"];for(r.tcid=0,d=1;d<=e.SheetNames.length;++d){var v={"!id":{}},_=e.Sheets[e.SheetNames[d-1]],C=(_||{})["!type"]||"sheet";switch(C){case"chart":default:u="xl/worksheets/sheet"+d+"."+t,ct(c,u,ru(d-1,r,e,v)),i.sheets.push(u),It(r.wbrels,-1,"worksheets/sheet"+d+"."+t,pt.WS[0])}if(_){var S=_["!comments"],A=!1,y="";if(S&&S.length>0){var D=!1;S.forEach(function(P){P[1].forEach(function(b){b.T==!0&&(D=!0)})}),D&&(y="xl/threadedComments/threadedComment"+d+"."+t,ct(c,y,tp(S,w,r)),i.threadedcomments.push(y),It(v,-1,"../threadedComments/threadedComment"+d+"."+t,pt.TCMNT)),y="xl/comments"+d+"."+t,ct(c,y,Xl(S)),i.comments.push(y),It(v,-1,"../comments"+d+"."+t,pt.CMNT),A=!0}_["!legacy"]&&A&&ct(c,"xl/drawings/vmlDrawing"+d+".vml",Gl(d,_["!comments"])),delete _["!comments"],delete _["!legacy"]}v["!id"].rId1&&ct(c,Ui(u),Qa(v))}return r.Strings!=null&&r.Strings.length>0&&(u="xl/sharedStrings."+t,ct(c,u,Fl(r.Strings,r)),i.strs.push(u),It(r.wbrels,-1,"sharedStrings."+t,pt.SST)),u="xl/workbook."+t,ct(c,u,ou(e)),i.workbooks.push(u),It(r.rels,1,u,pt.WB),u="xl/theme/theme1.xml",ct(c,u,Po(e.Themes,r)),i.themes.push(u),It(r.wbrels,-1,"theme/theme1.xml",pt.THEME),u="xl/styles."+t,ct(c,u,Ul(e,r)),i.styles.push(u),It(r.wbrels,-1,"styles."+t,pt.STY),e.vbaraw&&a&&(u="xl/vbaProject.bin",ct(c,u,e.vbaraw),i.vba.push(u),It(r.wbrels,-1,"vbaProject.bin",pt.VBA)),u="xl/metadata."+t,ct(c,u,Hl()),i.metadata.push(u),It(r.wbrels,-1,"metadata."+t,pt.XLMETA),w.length>1&&(u="xl/persons/person.xml",ct(c,u,np(w)),i.people.push(u),It(r.wbrels,-1,"persons/person.xml",pt.PEOPLE)),ct(c,"[Content_Types].xml",al(i,r)),ct(c,"_rels/.rels",Qa(r.rels)),ct(c,"xl/_rels/workbook."+t+".rels",Qa(r.wbrels)),delete r.revssf,delete r.ssf,c}function Ko(e,r){var t="";switch((r||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":t=en(e.slice(0,12));break;case"binary":t=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(r&&r.type||"undefined"))}return[t.charCodeAt(0),t.charCodeAt(1),t.charCodeAt(2),t.charCodeAt(3),t.charCodeAt(4),t.charCodeAt(5),t.charCodeAt(6),t.charCodeAt(7)]}function Zv(e,r){return Ke.find(e,"EncryptedPackage")?zv(e,r):uu(e,r)}function qv(e,r){var t,a=e,i=r||{};return i.type||(i.type=gt&&Buffer.isBuffer(e)?"buffer":"base64"),t=O1(a,i),Xv(t,i)}function Eu(e,r){var t=0;e:for(;t<e.length;)switch(e.charCodeAt(t)){case 10:case 13:case 32:++t;break;case 60:return ao(e.slice(t),r);default:break e}return ri.to_workbook(e,r)}function Jv(e,r){var t="",a=Ko(e,r);switch(r.type){case"base64":t=en(e);break;case"binary":t=e;break;case"buffer":t=e.toString("binary");break;case"array":t=Ta(e);break;default:throw new Error("Unrecognized type "+r.type)}return a[0]==239&&a[1]==187&&a[2]==191&&(t=Nt(t)),r.type="binary",Eu(t,r)}function Qv(e,r){var t=e;return r.type=="base64"&&(t=en(t)),t=Oi.utils.decode(1200,t.slice(2),"str"),r.type="binary",Eu(t,r)}function $v(e){return e.match(/[^\x00-\x7F]/)?Rn(e):e}function T0(e,r,t,a){return a?(t.type="string",ri.to_workbook(e,t)):ri.to_workbook(r,t)}function yf(e,r){uo();var t=r||{};if(typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer)return yf(new Uint8Array(e),(t=Vt(t),t.type="array",t));typeof Uint8Array<"u"&&e instanceof Uint8Array&&!t.type&&(t.type=typeof Deno<"u"?"buffer":"array");var a=e,i=[0,0,0,0],c=!1;if(t.cellStyles&&(t.cellNF=!0,t.sheetStubs=!0),ei={},t.dateNF&&(ei.dateNF=t.dateNF),t.type||(t.type=gt&&Buffer.isBuffer(e)?"buffer":"base64"),t.type=="file"&&(t.type=gt?"buffer":"binary",a=Kh(e),typeof Uint8Array<"u"&&!gt&&(t.type="array")),t.type=="string"&&(c=!0,t.type="binary",t.codepage=65001,a=$v(e)),t.type=="array"&&typeof Uint8Array<"u"&&e instanceof Uint8Array&&typeof ArrayBuffer<"u"){var u=new ArrayBuffer(3),d=new Uint8Array(u);if(d.foo="bar",!d.foo)return t=Vt(t),t.type="array",yf(ho(a),t)}switch((i=Ko(a,t))[0]){case 208:if(i[1]===207&&i[2]===17&&i[3]===224&&i[4]===161&&i[5]===177&&i[6]===26&&i[7]===225)return Zv(Ke.read(a,t),t);break;case 9:if(i[1]<=8)return uu(a,t);break;case 60:return ao(a,t);case 73:if(i[1]===73&&i[2]===42&&i[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(i[1]===68)return ag(a,t);break;case 84:if(i[1]===65&&i[2]===66&&i[3]===76)return bl.to_workbook(a,t);break;case 80:return i[1]===75&&i[2]<9&&i[3]<9?qv(a,t):T0(e,a,t,c);case 239:return i[3]===60?ao(a,t):T0(e,a,t,c);case 255:if(i[1]===254)return Qv(a,t);if(i[1]===0&&i[2]===2&&i[3]===0)return _a.to_workbook(a,t);break;case 0:if(i[1]===0&&(i[2]>=2&&i[3]===0||i[2]===0&&(i[3]===8||i[3]===9)))return _a.to_workbook(a,t);break;case 3:case 131:case 139:case 140:return no.to_workbook(a,t);case 123:if(i[1]===92&&i[2]===114&&i[3]===116)return Ml.to_workbook(a,t);break;case 10:case 13:case 32:return Jv(a,t);case 137:if(i[1]===80&&i[2]===78&&i[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return ng.indexOf(i[0])>-1&&i[2]<=12&&i[3]<=31?no.to_workbook(a,t):T0(e,a,t,c)}function vu(e,r){switch(r.type){case"base64":case"binary":break;case"buffer":case"array":r.type="";break;case"file":return Ki(r.file,Ke.write(e,{type:gt?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+r.bookType+"' files");default:throw new Error("Unrecognized type "+r.type)}return Ke.write(e,r)}function e_(e,r){var t=Vt(r||{}),a=Yv(e,t);return t_(a,t)}function t_(e,r){var t={},a=gt?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(r.compression&&(t.compression="DEFLATE"),r.password)t.type=a;else switch(r.type){case"base64":t.type="base64";break;case"binary":t.type="string";break;case"string":throw new Error("'string' output type invalid for '"+r.bookType+"' files");case"buffer":case"file":t.type=a;break;default:throw new Error("Unrecognized type "+r.type)}var i=e.FullPaths?Ke.write(e,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[t.type]||t.type,compression:!!r.compression}):e.generate(t);if(typeof Deno<"u"&&typeof i=="string"){if(r.type=="binary"||r.type=="base64")return i;i=new Uint8Array(Ps(i))}return r.password&&typeof encrypt_agile<"u"?vu(encrypt_agile(i,r.password),r):r.type==="file"?Ki(r.file,i):r.type=="string"?Nt(i):i}function r_(e,r){var t=r||{},a=$E(e,t);return vu(a,t)}function Fn(e,r,t){t||(t="");var a=t+e;switch(r.type){case"base64":return Di(Rn(a));case"binary":return Rn(a);case"string":return e;case"file":return Ki(r.file,a,"utf8");case"buffer":return gt?Gn(a,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(a):Fn(a,{type:"binary"}).split("").map(function(i){return i.charCodeAt(0)})}throw new Error("Unrecognized type "+r.type)}function n_(e,r){switch(r.type){case"base64":return Di(e);case"binary":return e;case"string":return e;case"file":return Ki(r.file,e,"binary");case"buffer":return gt?Gn(e,"binary"):e.split("").map(function(t){return t.charCodeAt(0)})}throw new Error("Unrecognized type "+r.type)}function Es(e,r){switch(r.type){case"string":case"base64":case"binary":for(var t="",a=0;a<e.length;++a)t+=String.fromCharCode(e[a]);return r.type=="base64"?Di(t):r.type=="string"?Nt(t):t;case"file":return Ki(r.file,e);case"buffer":return e;default:throw new Error("Unrecognized type "+r.type)}}function _u(e,r){uo(),Z4(e);var t=Vt(r||{});if(t.cellStyles&&(t.cellNF=!0,t.sheetStubs=!0),t.type=="array"){t.type="binary";var a=_u(e,t);return t.type="array",Ps(a)}var i=0;if(t.sheet&&(typeof t.sheet=="number"?i=t.sheet:i=e.SheetNames.indexOf(t.sheet),!e.SheetNames[i]))throw new Error("Sheet not found: "+t.sheet+" : "+typeof t.sheet);switch(t.bookType||"xlsb"){case"xml":case"xlml":return Fn(YE(e,t),t);case"slk":case"sylk":return Fn(kl.from_sheet(e.Sheets[e.SheetNames[i]],t),t);case"htm":case"html":return Fn(du(e.Sheets[e.SheetNames[i]],t),t);case"txt":return n_(Au(e.Sheets[e.SheetNames[i]],t),t);case"csv":return Fn(jo(e.Sheets[e.SheetNames[i]],t),t,"\uFEFF");case"dif":return Fn(bl.from_sheet(e.Sheets[e.SheetNames[i]],t),t);case"dbf":return Es(no.from_sheet(e.Sheets[e.SheetNames[i]],t),t);case"prn":return Fn(ri.from_sheet(e.Sheets[e.SheetNames[i]],t),t);case"rtf":return Fn(Ml.from_sheet(e.Sheets[e.SheetNames[i]],t),t);case"eth":return Fn(Nl.from_sheet(e.Sheets[e.SheetNames[i]],t),t);case"fods":return Fn(pu(e,t),t);case"wk1":return Es(_a.sheet_to_wk1(e.Sheets[e.SheetNames[i]],t),t);case"wk3":return Es(_a.book_to_wk3(e,t),t);case"biff2":t.biff||(t.biff=2);case"biff3":t.biff||(t.biff=3);case"biff4":return t.biff||(t.biff=4),Es(hu(e,t),t);case"biff5":t.biff||(t.biff=5);case"biff8":case"xla":case"xls":return t.biff||(t.biff=8),r_(e,t);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return e_(e,t);default:throw new Error("Unrecognized bookType |"+t.bookType+"|")}}function a_(e){if(!e.bookType){var r={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},t=e.file.slice(e.file.lastIndexOf(".")).toLowerCase();t.match(/^\.[a-z]+$/)&&(e.bookType=t.slice(1)),e.bookType=r[e.bookType]||e.bookType}}function u8(e,r,t){var a={};return a.type="file",a.file=r,a_(a),_u(e,a)}function i_(e,r,t,a,i,c,u,d){var g=rr(t),m=d.defval,w=d.raw||!Object.prototype.hasOwnProperty.call(d,"raw"),v=!0,_=i===1?[]:{};if(i!==1)if(Object.defineProperty)try{Object.defineProperty(_,"__rowNum__",{value:t,enumerable:!1})}catch{_.__rowNum__=t}else _.__rowNum__=t;if(!u||e[t])for(var C=r.s.c;C<=r.e.c;++C){var S=u?e[t][C]:e[a[C]+g];if(S===void 0||S.t===void 0){if(m===void 0)continue;c[C]!=null&&(_[c[C]]=m);continue}var A=S.v;switch(S.t){case"z":if(A==null)break;continue;case"e":A=A==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+S.t)}if(c[C]!=null){if(A==null)if(S.t=="e"&&A===null)_[c[C]]=null;else if(m!==void 0)_[c[C]]=m;else if(w&&A===null)_[c[C]]=null;else continue;else _[c[C]]=w&&(S.t!=="n"||S.t==="n"&&d.rawNumbers!==!1)?A:Hn(S,A,d);A!=null&&(v=!1)}}return{row:_,isempty:v}}function Os(e,r){if(e==null||e["!ref"]==null)return[];var t={t:"n",v:0},a=0,i=1,c=[],u=0,d="",g={s:{r:0,c:0},e:{r:0,c:0}},m=r||{},w=m.range!=null?m.range:e["!ref"];switch(m.header===1?a=1:m.header==="A"?a=2:Array.isArray(m.header)?a=3:m.header==null&&(a=0),typeof w){case"string":g=Ct(w);break;case"number":g=Ct(e["!ref"]),g.s.r=w;break;default:g=w}a>0&&(i=0);var v=rr(g.s.r),_=[],C=[],S=0,A=0,y=Array.isArray(e),D=g.s.r,P=0,b={};y&&!e[D]&&(e[D]=[]);var V=m.skipHidden&&e["!cols"]||[],te=m.skipHidden&&e["!rows"]||[];for(P=g.s.c;P<=g.e.c;++P)if(!(V[P]||{}).hidden)switch(_[P]=Yt(P),t=y?e[D][P]:e[_[P]+v],a){case 1:c[P]=P-g.s.c;break;case 2:c[P]=_[P];break;case 3:c[P]=m.header[P-g.s.c];break;default:if(t==null&&(t={w:"__EMPTY",t:"s"}),d=u=Hn(t,null,m),A=b[u]||0,!A)b[u]=1;else{do d=u+"_"+A++;while(b[d]);b[u]=A,b[d]=1}c[P]=d}for(D=g.s.r+i;D<=g.e.r;++D)if(!(te[D]||{}).hidden){var W=i_(e,g,D,_,a,c,y,m);(W.isempty===!1||(a===1?m.blankrows!==!1:m.blankrows))&&(C[S++]=W.row)}return C.length=S,C}var If=/"/g;function s_(e,r,t,a,i,c,u,d){for(var g=!0,m=[],w="",v=rr(t),_=r.s.c;_<=r.e.c;++_)if(a[_]){var C=d.dense?(e[t]||[])[_]:e[a[_]+v];if(C==null)w="";else if(C.v!=null){g=!1,w=""+(d.rawNumbers&&C.t=="n"?C.v:Hn(C,null,d));for(var S=0,A=0;S!==w.length;++S)if((A=w.charCodeAt(S))===i||A===c||A===34||d.forceQuotes){w='"'+w.replace(If,'""')+'"';break}w=="ID"&&(w='"ID"')}else C.f!=null&&!C.F?(g=!1,w="="+C.f,w.indexOf(",")>=0&&(w='"'+w.replace(If,'""')+'"')):w="";m.push(w)}return d.blankrows===!1&&g?null:m.join(u)}function jo(e,r){var t=[],a=r??{};if(e==null||e["!ref"]==null)return"";var i=Ct(e["!ref"]),c=a.FS!==void 0?a.FS:",",u=c.charCodeAt(0),d=a.RS!==void 0?a.RS:`
`,g=d.charCodeAt(0),m=new RegExp((c=="|"?"\\|":c)+"+$"),w="",v=[];a.dense=Array.isArray(e);for(var _=a.skipHidden&&e["!cols"]||[],C=a.skipHidden&&e["!rows"]||[],S=i.s.c;S<=i.e.c;++S)(_[S]||{}).hidden||(v[S]=Yt(S));for(var A=0,y=i.s.r;y<=i.e.r;++y)(C[y]||{}).hidden||(w=s_(e,i,y,v,u,g,c,a),w!=null&&(a.strip&&(w=w.replace(m,"")),(w||a.blankrows!==!1)&&t.push((A++?d:"")+w)));return delete a.dense,t.join("")}function Au(e,r){r||(r={}),r.FS="	",r.RS=`
`;var t=jo(e,r);return t}function o_(e){var r="",t,a="";if(e==null||e["!ref"]==null)return[];var i=Ct(e["!ref"]),c="",u=[],d,g=[],m=Array.isArray(e);for(d=i.s.c;d<=i.e.c;++d)u[d]=Yt(d);for(var w=i.s.r;w<=i.e.r;++w)for(c=rr(w),d=i.s.c;d<=i.e.c;++d)if(r=u[d]+c,t=m?(e[w]||[])[d]:e[r],a="",t!==void 0){if(t.F!=null){if(r=t.F,!t.f)continue;a=t.f,r.indexOf(":")==-1&&(r=r+":"+r)}if(t.f!=null)a=t.f;else{if(t.t=="z")continue;if(t.t=="n"&&t.v!=null)a=""+t.v;else if(t.t=="b")a=t.v?"TRUE":"FALSE";else if(t.w!==void 0)a="'"+t.w;else{if(t.v===void 0)continue;t.t=="s"?a="'"+t.v:a=""+t.v}}g[g.length]=r+"="+a}return g}function Cu(e,r,t){var a=t||{},i=+!a.skipHeader,c=e||{},u=0,d=0;if(c&&a.origin!=null)if(typeof a.origin=="number")u=a.origin;else{var g=typeof a.origin=="string"?Kt(a.origin):a.origin;u=g.r,d=g.c}var m,w={s:{c:0,r:0},e:{c:d,r:u+r.length-1+i}};if(c["!ref"]){var v=Ct(c["!ref"]);w.e.c=Math.max(w.e.c,v.e.c),w.e.r=Math.max(w.e.r,v.e.r),u==-1&&(u=v.e.r+1,w.e.r=u+r.length-1+i)}else u==-1&&(u=0,w.e.r=r.length-1+i);var _=a.header||[],C=0;r.forEach(function(A,y){$t(A).forEach(function(D){(C=_.indexOf(D))==-1&&(_[C=_.length]=D);var P=A[D],b="z",V="",te=Qe({c:d+C,r:u+y+i});m=Yi(c,te),P&&typeof P=="object"&&!(P instanceof Date)?c[te]=P:(typeof P=="number"?b="n":typeof P=="boolean"?b="b":typeof P=="string"?b="s":P instanceof Date?(b="d",a.cellDates||(b="n",P=ur(P)),V=a.dateNF||qe[14]):P===null&&a.nullError&&(b="e",P=0),m?(m.t=b,m.v=P,delete m.w,delete m.R,V&&(m.z=V)):c[te]=m={t:b,v:P},V&&(m.z=V))})}),w.e.c=Math.max(w.e.c,d+_.length-1);var S=rr(u);if(i)for(C=0;C<_.length;++C)c[Yt(C+d)+S]={t:"s",v:_[C]};return c["!ref"]=it(w),c}function c_(e,r){return Cu(null,e,r)}function Yi(e,r,t){if(typeof r=="string"){if(Array.isArray(e)){var a=Kt(r);return e[a.r]||(e[a.r]=[]),e[a.r][a.c]||(e[a.r][a.c]={t:"z"})}return e[r]||(e[r]={t:"z"})}return typeof r!="number"?Yi(e,Qe(r)):Yi(e,Qe({r,c:t||0}))}function f_(e,r){if(typeof r=="number"){if(r>=0&&e.SheetNames.length>r)return r;throw new Error("Cannot find sheet # "+r)}else if(typeof r=="string"){var t=e.SheetNames.indexOf(r);if(t>-1)return t;throw new Error("Cannot find sheet name |"+r+"|")}else throw new Error("Cannot find sheet |"+r+"|")}function Zo(){return{SheetNames:[],Sheets:{}}}function qo(e,r,t,a){var i=1;if(!t)for(;i<=65535&&e.SheetNames.indexOf(t="Sheet"+i)!=-1;++i,t=void 0);if(!t||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(a&&e.SheetNames.indexOf(t)>=0){var c=t.match(/(^.*?)(\d+)$/);i=c&&+c[2]||0;var u=c&&c[1]||t;for(++i;i<=65535&&e.SheetNames.indexOf(t=u+i)!=-1;++i);}if(su(t),e.SheetNames.indexOf(t)>=0)throw new Error("Worksheet with name |"+t+"| already exists!");return e.SheetNames.push(t),e.Sheets[t]=r,t}function l_(e,r,t){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var a=f_(e,r);switch(e.Workbook.Sheets[a]||(e.Workbook.Sheets[a]={}),t){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+t)}e.Workbook.Sheets[a].Hidden=t}function u_(e,r){return e.z=r,e}function Tu(e,r,t){return r?(e.l={Target:r},t&&(e.l.Tooltip=t)):delete e.l,e}function h_(e,r,t){return Tu(e,"#"+r,t)}function d_(e,r,t){e.c||(e.c=[]),e.c.push({t:r,a:t||"SheetJS"})}function x_(e,r,t,a){for(var i=typeof r!="string"?r:Ct(r),c=typeof r=="string"?r:it(r),u=i.s.r;u<=i.e.r;++u)for(var d=i.s.c;d<=i.e.c;++d){var g=Yi(e,u,d);g.t="n",g.F=c,delete g.v,u==i.s.r&&d==i.s.c&&(g.f=t,a&&(g.D=!0))}return e}var h8={encode_col:Yt,encode_row:rr,encode_cell:Qe,encode_range:it,decode_col:So,decode_row:To,split_cell:Sd,decode_cell:Kt,decode_range:Xr,format_cell:Hn,sheet_add_aoa:J1,sheet_add_json:Cu,sheet_add_dom:xu,aoa_to_sheet:si,json_to_sheet:c_,table_to_sheet:gu,table_to_book:_v,sheet_to_csv:jo,sheet_to_txt:Au,sheet_to_json:Os,sheet_to_html:du,sheet_to_formulae:o_,sheet_to_row_object_array:Os,sheet_get_cell:Yi,book_new:Zo,book_append_sheet:qo,book_set_sheet_visibility:l_,cell_set_number_format:u_,cell_set_hyperlink:Tu,cell_set_internal_link:h_,cell_add_comment:d_,sheet_set_array_formula:x_,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}},Ka={},S0,kf;function g_(){return kf||(kf=1,S0=function(){return typeof Promise=="function"&&Promise.prototype&&Promise.prototype.then}),S0}var y0={},ta={},bf;function Ba(){if(bf)return ta;bf=1;let e;const r=[0,26,44,70,100,134,172,196,242,292,346,404,466,532,581,655,733,815,901,991,1085,1156,1258,1364,1474,1588,1706,1828,1921,2051,2185,2323,2465,2611,2761,2876,3034,3196,3362,3532,3706];return ta.getSymbolSize=function(a){if(!a)throw new Error('"version" cannot be null or undefined');if(a<1||a>40)throw new Error('"version" should be in range from 1 to 40');return a*4+17},ta.getSymbolTotalCodewords=function(a){return r[a]},ta.getBCHDigit=function(t){let a=0;for(;t!==0;)a++,t>>>=1;return a},ta.setToSJISFunction=function(a){if(typeof a!="function")throw new Error('"toSJISFunc" is not a valid function.');e=a},ta.isKanjiModeEnabled=function(){return typeof e<"u"},ta.toSJIS=function(a){return e(a)},ta}var I0={},Nf;function Jo(){return Nf||(Nf=1,(function(e){e.L={bit:1},e.M={bit:0},e.Q={bit:3},e.H={bit:2};function r(t){if(typeof t!="string")throw new Error("Param is not a string");switch(t.toLowerCase()){case"l":case"low":return e.L;case"m":case"medium":return e.M;case"q":case"quartile":return e.Q;case"h":case"high":return e.H;default:throw new Error("Unknown EC Level: "+t)}}e.isValid=function(a){return a&&typeof a.bit<"u"&&a.bit>=0&&a.bit<4},e.from=function(a,i){if(e.isValid(a))return a;try{return r(a)}catch{return i}}})(I0)),I0}var k0,Ff;function m_(){if(Ff)return k0;Ff=1;function e(){this.buffer=[],this.length=0}return e.prototype={get:function(r){const t=Math.floor(r/8);return(this.buffer[t]>>>7-r%8&1)===1},put:function(r,t){for(let a=0;a<t;a++)this.putBit((r>>>t-a-1&1)===1)},getLengthInBits:function(){return this.length},putBit:function(r){const t=Math.floor(this.length/8);this.buffer.length<=t&&this.buffer.push(0),r&&(this.buffer[t]|=128>>>this.length%8),this.length++}},k0=e,k0}var b0,Rf;function p_(){if(Rf)return b0;Rf=1;function e(r){if(!r||r<1)throw new Error("BitMatrix size must be defined and greater than 0");this.size=r,this.data=new Uint8Array(r*r),this.reservedBit=new Uint8Array(r*r)}return e.prototype.set=function(r,t,a,i){const c=r*this.size+t;this.data[c]=a,i&&(this.reservedBit[c]=!0)},e.prototype.get=function(r,t){return this.data[r*this.size+t]},e.prototype.xor=function(r,t,a){this.data[r*this.size+t]^=a},e.prototype.isReserved=function(r,t){return this.reservedBit[r*this.size+t]},b0=e,b0}var N0={},Of;function w_(){return Of||(Of=1,(function(e){const r=Ba().getSymbolSize;e.getRowColCoords=function(a){if(a===1)return[];const i=Math.floor(a/7)+2,c=r(a),u=c===145?26:Math.ceil((c-13)/(2*i-2))*2,d=[c-7];for(let g=1;g<i-1;g++)d[g]=d[g-1]-u;return d.push(6),d.reverse()},e.getPositions=function(a){const i=[],c=e.getRowColCoords(a),u=c.length;for(let d=0;d<u;d++)for(let g=0;g<u;g++)d===0&&g===0||d===0&&g===u-1||d===u-1&&g===0||i.push([c[d],c[g]]);return i}})(N0)),N0}var F0={},Df;function E_(){if(Df)return F0;Df=1;const e=Ba().getSymbolSize,r=7;return F0.getPositions=function(a){const i=e(a);return[[0,0],[i-r,0],[0,i-r]]},F0}var R0={},Bf;function v_(){return Bf||(Bf=1,(function(e){e.Patterns={PATTERN000:0,PATTERN001:1,PATTERN010:2,PATTERN011:3,PATTERN100:4,PATTERN101:5,PATTERN110:6,PATTERN111:7};const r={N1:3,N2:3,N3:40,N4:10};e.isValid=function(i){return i!=null&&i!==""&&!isNaN(i)&&i>=0&&i<=7},e.from=function(i){return e.isValid(i)?parseInt(i,10):void 0},e.getPenaltyN1=function(i){const c=i.size;let u=0,d=0,g=0,m=null,w=null;for(let v=0;v<c;v++){d=g=0,m=w=null;for(let _=0;_<c;_++){let C=i.get(v,_);C===m?d++:(d>=5&&(u+=r.N1+(d-5)),m=C,d=1),C=i.get(_,v),C===w?g++:(g>=5&&(u+=r.N1+(g-5)),w=C,g=1)}d>=5&&(u+=r.N1+(d-5)),g>=5&&(u+=r.N1+(g-5))}return u},e.getPenaltyN2=function(i){const c=i.size;let u=0;for(let d=0;d<c-1;d++)for(let g=0;g<c-1;g++){const m=i.get(d,g)+i.get(d,g+1)+i.get(d+1,g)+i.get(d+1,g+1);(m===4||m===0)&&u++}return u*r.N2},e.getPenaltyN3=function(i){const c=i.size;let u=0,d=0,g=0;for(let m=0;m<c;m++){d=g=0;for(let w=0;w<c;w++)d=d<<1&2047|i.get(m,w),w>=10&&(d===1488||d===93)&&u++,g=g<<1&2047|i.get(w,m),w>=10&&(g===1488||g===93)&&u++}return u*r.N3},e.getPenaltyN4=function(i){let c=0;const u=i.data.length;for(let g=0;g<u;g++)c+=i.data[g];return Math.abs(Math.ceil(c*100/u/5)-10)*r.N4};function t(a,i,c){switch(a){case e.Patterns.PATTERN000:return(i+c)%2===0;case e.Patterns.PATTERN001:return i%2===0;case e.Patterns.PATTERN010:return c%3===0;case e.Patterns.PATTERN011:return(i+c)%3===0;case e.Patterns.PATTERN100:return(Math.floor(i/2)+Math.floor(c/3))%2===0;case e.Patterns.PATTERN101:return i*c%2+i*c%3===0;case e.Patterns.PATTERN110:return(i*c%2+i*c%3)%2===0;case e.Patterns.PATTERN111:return(i*c%3+(i+c)%2)%2===0;default:throw new Error("bad maskPattern:"+a)}}e.applyMask=function(i,c){const u=c.size;for(let d=0;d<u;d++)for(let g=0;g<u;g++)c.isReserved(g,d)||c.xor(g,d,t(i,g,d))},e.getBestMask=function(i,c){const u=Object.keys(e.Patterns).length;let d=0,g=1/0;for(let m=0;m<u;m++){c(m),e.applyMask(m,i);const w=e.getPenaltyN1(i)+e.getPenaltyN2(i)+e.getPenaltyN3(i)+e.getPenaltyN4(i);e.applyMask(m,i),w<g&&(g=w,d=m)}return d}})(R0)),R0}var vs={},Mf;function Su(){if(Mf)return vs;Mf=1;const e=Jo(),r=[1,1,1,1,1,1,1,1,1,1,2,2,1,2,2,4,1,2,4,4,2,4,4,4,2,4,6,5,2,4,6,6,2,5,8,8,4,5,8,8,4,5,8,11,4,8,10,11,4,9,12,16,4,9,16,16,6,10,12,18,6,10,17,16,6,11,16,19,6,13,18,21,7,14,21,25,8,16,20,25,8,17,23,25,9,17,23,34,9,18,25,30,10,20,27,32,12,21,29,35,12,23,34,37,12,25,34,40,13,26,35,42,14,28,38,45,15,29,40,48,16,31,43,51,17,33,45,54,18,35,48,57,19,37,51,60,19,38,53,63,20,40,56,66,21,43,59,70,22,45,62,74,24,47,65,77,25,49,68,81],t=[7,10,13,17,10,16,22,28,15,26,36,44,20,36,52,64,26,48,72,88,36,64,96,112,40,72,108,130,48,88,132,156,60,110,160,192,72,130,192,224,80,150,224,264,96,176,260,308,104,198,288,352,120,216,320,384,132,240,360,432,144,280,408,480,168,308,448,532,180,338,504,588,196,364,546,650,224,416,600,700,224,442,644,750,252,476,690,816,270,504,750,900,300,560,810,960,312,588,870,1050,336,644,952,1110,360,700,1020,1200,390,728,1050,1260,420,784,1140,1350,450,812,1200,1440,480,868,1290,1530,510,924,1350,1620,540,980,1440,1710,570,1036,1530,1800,570,1064,1590,1890,600,1120,1680,1980,630,1204,1770,2100,660,1260,1860,2220,720,1316,1950,2310,750,1372,2040,2430];return vs.getBlocksCount=function(i,c){switch(c){case e.L:return r[(i-1)*4+0];case e.M:return r[(i-1)*4+1];case e.Q:return r[(i-1)*4+2];case e.H:return r[(i-1)*4+3];default:return}},vs.getTotalCodewordsCount=function(i,c){switch(c){case e.L:return t[(i-1)*4+0];case e.M:return t[(i-1)*4+1];case e.Q:return t[(i-1)*4+2];case e.H:return t[(i-1)*4+3];default:return}},vs}var O0={},vi={},Pf;function __(){if(Pf)return vi;Pf=1;const e=new Uint8Array(512),r=new Uint8Array(256);return(function(){let a=1;for(let i=0;i<255;i++)e[i]=a,r[a]=i,a<<=1,a&256&&(a^=285);for(let i=255;i<512;i++)e[i]=e[i-255]})(),vi.log=function(a){if(a<1)throw new Error("log("+a+")");return r[a]},vi.exp=function(a){return e[a]},vi.mul=function(a,i){return a===0||i===0?0:e[r[a]+r[i]]},vi}var Lf;function A_(){return Lf||(Lf=1,(function(e){const r=__();e.mul=function(a,i){const c=new Uint8Array(a.length+i.length-1);for(let u=0;u<a.length;u++)for(let d=0;d<i.length;d++)c[u+d]^=r.mul(a[u],i[d]);return c},e.mod=function(a,i){let c=new Uint8Array(a);for(;c.length-i.length>=0;){const u=c[0];for(let g=0;g<i.length;g++)c[g]^=r.mul(i[g],u);let d=0;for(;d<c.length&&c[d]===0;)d++;c=c.slice(d)}return c},e.generateECPolynomial=function(a){let i=new Uint8Array([1]);for(let c=0;c<a;c++)i=e.mul(i,new Uint8Array([1,r.exp(c)]));return i}})(O0)),O0}var D0,Uf;function C_(){if(Uf)return D0;Uf=1;const e=A_();function r(t){this.genPoly=void 0,this.degree=t,this.degree&&this.initialize(this.degree)}return r.prototype.initialize=function(a){this.degree=a,this.genPoly=e.generateECPolynomial(this.degree)},r.prototype.encode=function(a){if(!this.genPoly)throw new Error("Encoder not initialized");const i=new Uint8Array(a.length+this.degree);i.set(a);const c=e.mod(i,this.genPoly),u=this.degree-c.length;if(u>0){const d=new Uint8Array(this.degree);return d.set(c,u),d}return c},D0=r,D0}var B0={},M0={},P0={},Wf;function yu(){return Wf||(Wf=1,P0.isValid=function(r){return!isNaN(r)&&r>=1&&r<=40}),P0}var bn={},Vf;function Iu(){if(Vf)return bn;Vf=1;const e="[0-9]+",r="[A-Z $%*+\\-./:]+";let t="(?:[u3000-u303F]|[u3040-u309F]|[u30A0-u30FF]|[uFF00-uFFEF]|[u4E00-u9FAF]|[u2605-u2606]|[u2190-u2195]|u203B|[u2010u2015u2018u2019u2025u2026u201Cu201Du2225u2260]|[u0391-u0451]|[u00A7u00A8u00B1u00B4u00D7u00F7])+";t=t.replace(/u/g,"\\u");const a="(?:(?![A-Z0-9 $%*+\\-./:]|"+t+`)(?:.|[\r
]))+`;bn.KANJI=new RegExp(t,"g"),bn.BYTE_KANJI=new RegExp("[^A-Z0-9 $%*+\\-./:]+","g"),bn.BYTE=new RegExp(a,"g"),bn.NUMERIC=new RegExp(e,"g"),bn.ALPHANUMERIC=new RegExp(r,"g");const i=new RegExp("^"+t+"$"),c=new RegExp("^"+e+"$"),u=new RegExp("^[A-Z0-9 $%*+\\-./:]+$");return bn.testKanji=function(g){return i.test(g)},bn.testNumeric=function(g){return c.test(g)},bn.testAlphanumeric=function(g){return u.test(g)},bn}var Hf;function Ma(){return Hf||(Hf=1,(function(e){const r=yu(),t=Iu();e.NUMERIC={id:"Numeric",bit:1,ccBits:[10,12,14]},e.ALPHANUMERIC={id:"Alphanumeric",bit:2,ccBits:[9,11,13]},e.BYTE={id:"Byte",bit:4,ccBits:[8,16,16]},e.KANJI={id:"Kanji",bit:8,ccBits:[8,10,12]},e.MIXED={bit:-1},e.getCharCountIndicator=function(c,u){if(!c.ccBits)throw new Error("Invalid mode: "+c);if(!r.isValid(u))throw new Error("Invalid version: "+u);return u>=1&&u<10?c.ccBits[0]:u<27?c.ccBits[1]:c.ccBits[2]},e.getBestModeForData=function(c){return t.testNumeric(c)?e.NUMERIC:t.testAlphanumeric(c)?e.ALPHANUMERIC:t.testKanji(c)?e.KANJI:e.BYTE},e.toString=function(c){if(c&&c.id)return c.id;throw new Error("Invalid mode")},e.isValid=function(c){return c&&c.bit&&c.ccBits};function a(i){if(typeof i!="string")throw new Error("Param is not a string");switch(i.toLowerCase()){case"numeric":return e.NUMERIC;case"alphanumeric":return e.ALPHANUMERIC;case"kanji":return e.KANJI;case"byte":return e.BYTE;default:throw new Error("Unknown mode: "+i)}}e.from=function(c,u){if(e.isValid(c))return c;try{return a(c)}catch{return u}}})(M0)),M0}var Gf;function T_(){return Gf||(Gf=1,(function(e){const r=Ba(),t=Su(),a=Jo(),i=Ma(),c=yu(),u=7973,d=r.getBCHDigit(u);function g(_,C,S){for(let A=1;A<=40;A++)if(C<=e.getCapacity(A,S,_))return A}function m(_,C){return i.getCharCountIndicator(_,C)+4}function w(_,C){let S=0;return _.forEach(function(A){const y=m(A.mode,C);S+=y+A.getBitsLength()}),S}function v(_,C){for(let S=1;S<=40;S++)if(w(_,S)<=e.getCapacity(S,C,i.MIXED))return S}e.from=function(C,S){return c.isValid(C)?parseInt(C,10):S},e.getCapacity=function(C,S,A){if(!c.isValid(C))throw new Error("Invalid QR Code version");typeof A>"u"&&(A=i.BYTE);const y=r.getSymbolTotalCodewords(C),D=t.getTotalCodewordsCount(C,S),P=(y-D)*8;if(A===i.MIXED)return P;const b=P-m(A,C);switch(A){case i.NUMERIC:return Math.floor(b/10*3);case i.ALPHANUMERIC:return Math.floor(b/11*2);case i.KANJI:return Math.floor(b/13);case i.BYTE:default:return Math.floor(b/8)}},e.getBestVersionForData=function(C,S){let A;const y=a.from(S,a.M);if(Array.isArray(C)){if(C.length>1)return v(C,y);if(C.length===0)return 1;A=C[0]}else A=C;return g(A.mode,A.getLength(),y)},e.getEncodedBits=function(C){if(!c.isValid(C)||C<7)throw new Error("Invalid QR Code version");let S=C<<12;for(;r.getBCHDigit(S)-d>=0;)S^=u<<r.getBCHDigit(S)-d;return C<<12|S}})(B0)),B0}var L0={},Xf;function S_(){if(Xf)return L0;Xf=1;const e=Ba(),r=1335,t=21522,a=e.getBCHDigit(r);return L0.getEncodedBits=function(c,u){const d=c.bit<<3|u;let g=d<<10;for(;e.getBCHDigit(g)-a>=0;)g^=r<<e.getBCHDigit(g)-a;return(d<<10|g)^t},L0}var U0={},W0,zf;function y_(){if(zf)return W0;zf=1;const e=Ma();function r(t){this.mode=e.NUMERIC,this.data=t.toString()}return r.getBitsLength=function(a){return 10*Math.floor(a/3)+(a%3?a%3*3+1:0)},r.prototype.getLength=function(){return this.data.length},r.prototype.getBitsLength=function(){return r.getBitsLength(this.data.length)},r.prototype.write=function(a){let i,c,u;for(i=0;i+3<=this.data.length;i+=3)c=this.data.substr(i,3),u=parseInt(c,10),a.put(u,10);const d=this.data.length-i;d>0&&(c=this.data.substr(i),u=parseInt(c,10),a.put(u,d*3+1))},W0=r,W0}var V0,Yf;function I_(){if(Yf)return V0;Yf=1;const e=Ma(),r=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"," ","$","%","*","+","-",".","/",":"];function t(a){this.mode=e.ALPHANUMERIC,this.data=a}return t.getBitsLength=function(i){return 11*Math.floor(i/2)+6*(i%2)},t.prototype.getLength=function(){return this.data.length},t.prototype.getBitsLength=function(){return t.getBitsLength(this.data.length)},t.prototype.write=function(i){let c;for(c=0;c+2<=this.data.length;c+=2){let u=r.indexOf(this.data[c])*45;u+=r.indexOf(this.data[c+1]),i.put(u,11)}this.data.length%2&&i.put(r.indexOf(this.data[c]),6)},V0=t,V0}var H0,Kf;function k_(){if(Kf)return H0;Kf=1;const e=Ma();function r(t){this.mode=e.BYTE,typeof t=="string"?this.data=new TextEncoder().encode(t):this.data=new Uint8Array(t)}return r.getBitsLength=function(a){return a*8},r.prototype.getLength=function(){return this.data.length},r.prototype.getBitsLength=function(){return r.getBitsLength(this.data.length)},r.prototype.write=function(t){for(let a=0,i=this.data.length;a<i;a++)t.put(this.data[a],8)},H0=r,H0}var G0,jf;function b_(){if(jf)return G0;jf=1;const e=Ma(),r=Ba();function t(a){this.mode=e.KANJI,this.data=a}return t.getBitsLength=function(i){return i*13},t.prototype.getLength=function(){return this.data.length},t.prototype.getBitsLength=function(){return t.getBitsLength(this.data.length)},t.prototype.write=function(a){let i;for(i=0;i<this.data.length;i++){let c=r.toSJIS(this.data[i]);if(c>=33088&&c<=40956)c-=33088;else if(c>=57408&&c<=60351)c-=49472;else throw new Error("Invalid SJIS character: "+this.data[i]+`
Make sure your charset is UTF-8`);c=(c>>>8&255)*192+(c&255),a.put(c,13)}},G0=t,G0}var X0={exports:{}},Zf;function N_(){return Zf||(Zf=1,(function(e){var r={single_source_shortest_paths:function(t,a,i){var c={},u={};u[a]=0;var d=r.PriorityQueue.make();d.push(a,0);for(var g,m,w,v,_,C,S,A,y;!d.empty();){g=d.pop(),m=g.value,v=g.cost,_=t[m]||{};for(w in _)_.hasOwnProperty(w)&&(C=_[w],S=v+C,A=u[w],y=typeof u[w]>"u",(y||A>S)&&(u[w]=S,d.push(w,S),c[w]=m))}if(typeof i<"u"&&typeof u[i]>"u"){var D=["Could not find a path from ",a," to ",i,"."].join("");throw new Error(D)}return c},extract_shortest_path_from_predecessor_list:function(t,a){for(var i=[],c=a;c;)i.push(c),t[c],c=t[c];return i.reverse(),i},find_path:function(t,a,i){var c=r.single_source_shortest_paths(t,a,i);return r.extract_shortest_path_from_predecessor_list(c,i)},PriorityQueue:{make:function(t){var a=r.PriorityQueue,i={},c;t=t||{};for(c in a)a.hasOwnProperty(c)&&(i[c]=a[c]);return i.queue=[],i.sorter=t.sorter||a.default_sorter,i},default_sorter:function(t,a){return t.cost-a.cost},push:function(t,a){var i={value:t,cost:a};this.queue.push(i),this.queue.sort(this.sorter)},pop:function(){return this.queue.shift()},empty:function(){return this.queue.length===0}}};e.exports=r})(X0)),X0.exports}var qf;function F_(){return qf||(qf=1,(function(e){const r=Ma(),t=y_(),a=I_(),i=k_(),c=b_(),u=Iu(),d=Ba(),g=N_();function m(D){return unescape(encodeURIComponent(D)).length}function w(D,P,b){const V=[];let te;for(;(te=D.exec(b))!==null;)V.push({data:te[0],index:te.index,mode:P,length:te[0].length});return V}function v(D){const P=w(u.NUMERIC,r.NUMERIC,D),b=w(u.ALPHANUMERIC,r.ALPHANUMERIC,D);let V,te;return d.isKanjiModeEnabled()?(V=w(u.BYTE,r.BYTE,D),te=w(u.KANJI,r.KANJI,D)):(V=w(u.BYTE_KANJI,r.BYTE,D),te=[]),P.concat(b,V,te).sort(function(N,j){return N.index-j.index}).map(function(N){return{data:N.data,mode:N.mode,length:N.length}})}function _(D,P){switch(P){case r.NUMERIC:return t.getBitsLength(D);case r.ALPHANUMERIC:return a.getBitsLength(D);case r.KANJI:return c.getBitsLength(D);case r.BYTE:return i.getBitsLength(D)}}function C(D){return D.reduce(function(P,b){const V=P.length-1>=0?P[P.length-1]:null;return V&&V.mode===b.mode?(P[P.length-1].data+=b.data,P):(P.push(b),P)},[])}function S(D){const P=[];for(let b=0;b<D.length;b++){const V=D[b];switch(V.mode){case r.NUMERIC:P.push([V,{data:V.data,mode:r.ALPHANUMERIC,length:V.length},{data:V.data,mode:r.BYTE,length:V.length}]);break;case r.ALPHANUMERIC:P.push([V,{data:V.data,mode:r.BYTE,length:V.length}]);break;case r.KANJI:P.push([V,{data:V.data,mode:r.BYTE,length:m(V.data)}]);break;case r.BYTE:P.push([{data:V.data,mode:r.BYTE,length:m(V.data)}])}}return P}function A(D,P){const b={},V={start:{}};let te=["start"];for(let W=0;W<D.length;W++){const N=D[W],j=[];for(let O=0;O<N.length;O++){const ae=N[O],Q=""+W+O;j.push(Q),b[Q]={node:ae,lastCount:0},V[Q]={};for(let X=0;X<te.length;X++){const ie=te[X];b[ie]&&b[ie].node.mode===ae.mode?(V[ie][Q]=_(b[ie].lastCount+ae.length,ae.mode)-_(b[ie].lastCount,ae.mode),b[ie].lastCount+=ae.length):(b[ie]&&(b[ie].lastCount=ae.length),V[ie][Q]=_(ae.length,ae.mode)+4+r.getCharCountIndicator(ae.mode,P))}}te=j}for(let W=0;W<te.length;W++)V[te[W]].end=0;return{map:V,table:b}}function y(D,P){let b;const V=r.getBestModeForData(D);if(b=r.from(P,V),b!==r.BYTE&&b.bit<V.bit)throw new Error('"'+D+'" cannot be encoded with mode '+r.toString(b)+`.
 Suggested mode is: `+r.toString(V));switch(b===r.KANJI&&!d.isKanjiModeEnabled()&&(b=r.BYTE),b){case r.NUMERIC:return new t(D);case r.ALPHANUMERIC:return new a(D);case r.KANJI:return new c(D);case r.BYTE:return new i(D)}}e.fromArray=function(P){return P.reduce(function(b,V){return typeof V=="string"?b.push(y(V,null)):V.data&&b.push(y(V.data,V.mode)),b},[])},e.fromString=function(P,b){const V=v(P,d.isKanjiModeEnabled()),te=S(V),W=A(te,b),N=g.find_path(W.map,"start","end"),j=[];for(let O=1;O<N.length-1;O++)j.push(W.table[N[O]].node);return e.fromArray(C(j))},e.rawSplit=function(P){return e.fromArray(v(P,d.isKanjiModeEnabled()))}})(U0)),U0}var Jf;function R_(){if(Jf)return y0;Jf=1;const e=Ba(),r=Jo(),t=m_(),a=p_(),i=w_(),c=E_(),u=v_(),d=Su(),g=C_(),m=T_(),w=S_(),v=Ma(),_=F_();function C(W,N){const j=W.size,O=c.getPositions(N);for(let ae=0;ae<O.length;ae++){const Q=O[ae][0],X=O[ae][1];for(let ie=-1;ie<=7;ie++)if(!(Q+ie<=-1||j<=Q+ie))for(let Ee=-1;Ee<=7;Ee++)X+Ee<=-1||j<=X+Ee||(ie>=0&&ie<=6&&(Ee===0||Ee===6)||Ee>=0&&Ee<=6&&(ie===0||ie===6)||ie>=2&&ie<=4&&Ee>=2&&Ee<=4?W.set(Q+ie,X+Ee,!0,!0):W.set(Q+ie,X+Ee,!1,!0))}}function S(W){const N=W.size;for(let j=8;j<N-8;j++){const O=j%2===0;W.set(j,6,O,!0),W.set(6,j,O,!0)}}function A(W,N){const j=i.getPositions(N);for(let O=0;O<j.length;O++){const ae=j[O][0],Q=j[O][1];for(let X=-2;X<=2;X++)for(let ie=-2;ie<=2;ie++)X===-2||X===2||ie===-2||ie===2||X===0&&ie===0?W.set(ae+X,Q+ie,!0,!0):W.set(ae+X,Q+ie,!1,!0)}}function y(W,N){const j=W.size,O=m.getEncodedBits(N);let ae,Q,X;for(let ie=0;ie<18;ie++)ae=Math.floor(ie/3),Q=ie%3+j-8-3,X=(O>>ie&1)===1,W.set(ae,Q,X,!0),W.set(Q,ae,X,!0)}function D(W,N,j){const O=W.size,ae=w.getEncodedBits(N,j);let Q,X;for(Q=0;Q<15;Q++)X=(ae>>Q&1)===1,Q<6?W.set(Q,8,X,!0):Q<8?W.set(Q+1,8,X,!0):W.set(O-15+Q,8,X,!0),Q<8?W.set(8,O-Q-1,X,!0):Q<9?W.set(8,15-Q-1+1,X,!0):W.set(8,15-Q-1,X,!0);W.set(O-8,8,1,!0)}function P(W,N){const j=W.size;let O=-1,ae=j-1,Q=7,X=0;for(let ie=j-1;ie>0;ie-=2)for(ie===6&&ie--;;){for(let Ee=0;Ee<2;Ee++)if(!W.isReserved(ae,ie-Ee)){let q=!1;X<N.length&&(q=(N[X]>>>Q&1)===1),W.set(ae,ie-Ee,q),Q--,Q===-1&&(X++,Q=7)}if(ae+=O,ae<0||j<=ae){ae-=O,O=-O;break}}}function b(W,N,j){const O=new t;j.forEach(function(Ee){O.put(Ee.mode.bit,4),O.put(Ee.getLength(),v.getCharCountIndicator(Ee.mode,W)),Ee.write(O)});const ae=e.getSymbolTotalCodewords(W),Q=d.getTotalCodewordsCount(W,N),X=(ae-Q)*8;for(O.getLengthInBits()+4<=X&&O.put(0,4);O.getLengthInBits()%8!==0;)O.putBit(0);const ie=(X-O.getLengthInBits())/8;for(let Ee=0;Ee<ie;Ee++)O.put(Ee%2?17:236,8);return V(O,W,N)}function V(W,N,j){const O=e.getSymbolTotalCodewords(N),ae=d.getTotalCodewordsCount(N,j),Q=O-ae,X=d.getBlocksCount(N,j),ie=O%X,Ee=X-ie,q=Math.floor(O/X),ue=Math.floor(Q/X),de=ue+1,We=q-ue,se=new g(We);let Le=0;const Ge=new Array(X),z=new Array(X);let ne=0;const Z=new Uint8Array(W.buffer);for(let Te=0;Te<X;Te++){const Se=Te<Ee?ue:de;Ge[Te]=Z.slice(Le,Le+Se),z[Te]=se.encode(Ge[Te]),Le+=Se,ne=Math.max(ne,Se)}const ee=new Uint8Array(O);let oe=0,Ie,Ae;for(Ie=0;Ie<ne;Ie++)for(Ae=0;Ae<X;Ae++)Ie<Ge[Ae].length&&(ee[oe++]=Ge[Ae][Ie]);for(Ie=0;Ie<We;Ie++)for(Ae=0;Ae<X;Ae++)ee[oe++]=z[Ae][Ie];return ee}function te(W,N,j,O){let ae;if(Array.isArray(W))ae=_.fromArray(W);else if(typeof W=="string"){let q=N;if(!q){const ue=_.rawSplit(W);q=m.getBestVersionForData(ue,j)}ae=_.fromString(W,q||40)}else throw new Error("Invalid data");const Q=m.getBestVersionForData(ae,j);if(!Q)throw new Error("The amount of data is too big to be stored in a QR Code");if(!N)N=Q;else if(N<Q)throw new Error(`
The chosen QR Code version cannot contain this amount of data.
Minimum version required to store current data is: `+Q+`.
`);const X=b(N,j,ae),ie=e.getSymbolSize(N),Ee=new a(ie);return C(Ee,N),S(Ee),A(Ee,N),D(Ee,j,0),N>=7&&y(Ee,N),P(Ee,X),isNaN(O)&&(O=u.getBestMask(Ee,D.bind(null,Ee,j))),u.applyMask(O,Ee),D(Ee,j,O),{modules:Ee,version:N,errorCorrectionLevel:j,maskPattern:O,segments:ae}}return y0.create=function(N,j){if(typeof N>"u"||N==="")throw new Error("No input text");let O=r.M,ae,Q;return typeof j<"u"&&(O=r.from(j.errorCorrectionLevel,r.M),ae=m.from(j.version),Q=u.from(j.maskPattern),j.toSJISFunc&&e.setToSJISFunction(j.toSJISFunc)),te(N,ae,O,Q)},y0}var z0={},Y0={},Qf;function ku(){return Qf||(Qf=1,(function(e){function r(t){if(typeof t=="number"&&(t=t.toString()),typeof t!="string")throw new Error("Color should be defined as hex string");let a=t.slice().replace("#","").split("");if(a.length<3||a.length===5||a.length>8)throw new Error("Invalid hex color: "+t);(a.length===3||a.length===4)&&(a=Array.prototype.concat.apply([],a.map(function(c){return[c,c]}))),a.length===6&&a.push("F","F");const i=parseInt(a.join(""),16);return{r:i>>24&255,g:i>>16&255,b:i>>8&255,a:i&255,hex:"#"+a.slice(0,6).join("")}}e.getOptions=function(a){a||(a={}),a.color||(a.color={});const i=typeof a.margin>"u"||a.margin===null||a.margin<0?4:a.margin,c=a.width&&a.width>=21?a.width:void 0,u=a.scale||4;return{width:c,scale:c?4:u,margin:i,color:{dark:r(a.color.dark||"#000000ff"),light:r(a.color.light||"#ffffffff")},type:a.type,rendererOpts:a.rendererOpts||{}}},e.getScale=function(a,i){return i.width&&i.width>=a+i.margin*2?i.width/(a+i.margin*2):i.scale},e.getImageWidth=function(a,i){const c=e.getScale(a,i);return Math.floor((a+i.margin*2)*c)},e.qrToImageData=function(a,i,c){const u=i.modules.size,d=i.modules.data,g=e.getScale(u,c),m=Math.floor((u+c.margin*2)*g),w=c.margin*g,v=[c.color.light,c.color.dark];for(let _=0;_<m;_++)for(let C=0;C<m;C++){let S=(_*m+C)*4,A=c.color.light;if(_>=w&&C>=w&&_<m-w&&C<m-w){const y=Math.floor((_-w)/g),D=Math.floor((C-w)/g);A=v[d[y*u+D]?1:0]}a[S++]=A.r,a[S++]=A.g,a[S++]=A.b,a[S]=A.a}}})(Y0)),Y0}var $f;function O_(){return $f||($f=1,(function(e){const r=ku();function t(i,c,u){i.clearRect(0,0,c.width,c.height),c.style||(c.style={}),c.height=u,c.width=u,c.style.height=u+"px",c.style.width=u+"px"}function a(){try{return document.createElement("canvas")}catch{throw new Error("You need to specify a canvas element")}}e.render=function(c,u,d){let g=d,m=u;typeof g>"u"&&(!u||!u.getContext)&&(g=u,u=void 0),u||(m=a()),g=r.getOptions(g);const w=r.getImageWidth(c.modules.size,g),v=m.getContext("2d"),_=v.createImageData(w,w);return r.qrToImageData(_.data,c,g),t(v,m,w),v.putImageData(_,0,0),m},e.renderToDataURL=function(c,u,d){let g=d;typeof g>"u"&&(!u||!u.getContext)&&(g=u,u=void 0),g||(g={});const m=e.render(c,u,g),w=g.type||"image/png",v=g.rendererOpts||{};return m.toDataURL(w,v.quality)}})(z0)),z0}var K0={},e1;function D_(){if(e1)return K0;e1=1;const e=ku();function r(i,c){const u=i.a/255,d=c+'="'+i.hex+'"';return u<1?d+" "+c+'-opacity="'+u.toFixed(2).slice(1)+'"':d}function t(i,c,u){let d=i+c;return typeof u<"u"&&(d+=" "+u),d}function a(i,c,u){let d="",g=0,m=!1,w=0;for(let v=0;v<i.length;v++){const _=Math.floor(v%c),C=Math.floor(v/c);!_&&!m&&(m=!0),i[v]?(w++,v>0&&_>0&&i[v-1]||(d+=m?t("M",_+u,.5+C+u):t("m",g,0),g=0,m=!1),_+1<c&&i[v+1]||(d+=t("h",w),w=0)):g++}return d}return K0.render=function(c,u,d){const g=e.getOptions(u),m=c.modules.size,w=c.modules.data,v=m+g.margin*2,_=g.color.light.a?"<path "+r(g.color.light,"fill")+' d="M0 0h'+v+"v"+v+'H0z"/>':"",C="<path "+r(g.color.dark,"stroke")+' d="'+a(w,m,g.margin)+'"/>',S='viewBox="0 0 '+v+" "+v+'"',y='<svg xmlns="http://www.w3.org/2000/svg" '+(g.width?'width="'+g.width+'" height="'+g.width+'" ':"")+S+' shape-rendering="crispEdges">'+_+C+`</svg>
`;return typeof d=="function"&&d(null,y),y},K0}var t1;function B_(){if(t1)return Ka;t1=1;const e=g_(),r=R_(),t=O_(),a=D_();function i(c,u,d,g,m){const w=[].slice.call(arguments,1),v=w.length,_=typeof w[v-1]=="function";if(!_&&!e())throw new Error("Callback required as last argument");if(_){if(v<2)throw new Error("Too few arguments provided");v===2?(m=d,d=u,u=g=void 0):v===3&&(u.getContext&&typeof m>"u"?(m=g,g=void 0):(m=g,g=d,d=u,u=void 0))}else{if(v<1)throw new Error("Too few arguments provided");return v===1?(d=u,u=g=void 0):v===2&&!u.getContext&&(g=d,d=u,u=void 0),new Promise(function(C,S){try{const A=r.create(d,g);C(c(A,u,g))}catch(A){S(A)}})}try{const C=r.create(d,g);m(null,c(C,u,g))}catch(C){m(C)}}return Ka.create=r.create,Ka.toCanvas=i.bind(null,t.render),Ka.toDataURL=i.bind(null,t.renderToDataURL),Ka.toString=i.bind(null,function(c,u,d){return a.render(c,d)}),Ka}var M_=B_();const d8=d1(M_);var He;(function(e){e[e.QR_CODE=0]="QR_CODE",e[e.AZTEC=1]="AZTEC",e[e.CODABAR=2]="CODABAR",e[e.CODE_39=3]="CODE_39",e[e.CODE_93=4]="CODE_93",e[e.CODE_128=5]="CODE_128",e[e.DATA_MATRIX=6]="DATA_MATRIX",e[e.MAXICODE=7]="MAXICODE",e[e.ITF=8]="ITF",e[e.EAN_13=9]="EAN_13",e[e.EAN_8=10]="EAN_8",e[e.PDF_417=11]="PDF_417",e[e.RSS_14=12]="RSS_14",e[e.RSS_EXPANDED=13]="RSS_EXPANDED",e[e.UPC_A=14]="UPC_A",e[e.UPC_E=15]="UPC_E",e[e.UPC_EAN_EXTENSION=16]="UPC_EAN_EXTENSION"})(He||(He={}));var r1=new Map([[He.QR_CODE,"QR_CODE"],[He.AZTEC,"AZTEC"],[He.CODABAR,"CODABAR"],[He.CODE_39,"CODE_39"],[He.CODE_93,"CODE_93"],[He.CODE_128,"CODE_128"],[He.DATA_MATRIX,"DATA_MATRIX"],[He.MAXICODE,"MAXICODE"],[He.ITF,"ITF"],[He.EAN_13,"EAN_13"],[He.EAN_8,"EAN_8"],[He.PDF_417,"PDF_417"],[He.RSS_14,"RSS_14"],[He.RSS_EXPANDED,"RSS_EXPANDED"],[He.UPC_A,"UPC_A"],[He.UPC_E,"UPC_E"],[He.UPC_EAN_EXTENSION,"UPC_EAN_EXTENSION"]]),n1;(function(e){e[e.UNKNOWN=0]="UNKNOWN",e[e.URL=1]="URL"})(n1||(n1={}));function P_(e){return Object.values(He).includes(e)}var Ds;(function(e){e[e.SCAN_TYPE_CAMERA=0]="SCAN_TYPE_CAMERA",e[e.SCAN_TYPE_FILE=1]="SCAN_TYPE_FILE"})(Ds||(Ds={}));var L_=(function(){function e(){}return e.GITHUB_PROJECT_URL="https://github.com/mebjas/html5-qrcode",e.SCAN_DEFAULT_FPS=2,e.DEFAULT_DISABLE_FLIP=!1,e.DEFAULT_REMEMBER_LAST_CAMERA_USED=!0,e.DEFAULT_SUPPORTED_SCAN_TYPE=[Ds.SCAN_TYPE_CAMERA,Ds.SCAN_TYPE_FILE],e})(),bu=(function(){function e(r,t){this.format=r,this.formatName=t}return e.prototype.toString=function(){return this.formatName},e.create=function(r){if(!r1.has(r))throw"".concat(r," not in html5QrcodeSupportedFormatsTextMap");return new e(r,r1.get(r))},e})(),a1=(function(){function e(){}return e.createFromText=function(r){var t={text:r};return{decodedText:r,result:t}},e.createFromQrcodeResult=function(r){return{decodedText:r.text,result:r}},e})(),oo;(function(e){e[e.UNKWOWN_ERROR=0]="UNKWOWN_ERROR",e[e.IMPLEMENTATION_ERROR=1]="IMPLEMENTATION_ERROR",e[e.NO_CODE_FOUND_ERROR=2]="NO_CODE_FOUND_ERROR"})(oo||(oo={}));var U_=(function(){function e(){}return e.createFrom=function(r){return{errorMessage:r,type:oo.UNKWOWN_ERROR}},e})(),W_=(function(){function e(r){this.verbose=r}return e.prototype.log=function(r){this.verbose&&console.log(r)},e.prototype.warn=function(r){this.verbose&&console.warn(r)},e.prototype.logError=function(r,t){(this.verbose||t===!0)&&console.error(r)},e.prototype.logErrors=function(r){if(r.length===0)throw"Logger#logError called without arguments";this.verbose&&console.error(r)},e})();function Pn(e){return typeof e>"u"||e===null}var qa=(function(){function e(){}return e.codeParseError=function(r){return"QR code parse error, error = ".concat(r)},e.errorGettingUserMedia=function(r){return"Error getting userMedia, error = ".concat(r)},e.onlyDeviceSupportedError=function(){return"The device doesn't support navigator.mediaDevices , only supported cameraIdOrConfig in this case is deviceId parameter (string)."},e.cameraStreamingNotSupported=function(){return"Camera streaming not supported by the browser."},e.unableToQuerySupportedDevices=function(){return"Unable to query supported devices, unknown error."},e.insecureContextCameraQueryError=function(){return"Camera access is only supported in secure context like https or localhost."},e.scannerPaused=function(){return"Scanner paused"},e})(),Nu=(function(){function e(){}return e.isMediaStreamConstraintsValid=function(r,t){if(typeof r!="object"){var a=typeof r;return t.logError("videoConstraints should be of type object, the "+"object passed is of type ".concat(a,"."),!0),!1}for(var i=["autoGainControl","channelCount","echoCancellation","latency","noiseSuppression","sampleRate","sampleSize","volume"],c=new Set(i),u=Object.keys(r),d=0,g=u;d<g.length;d++){var m=g[d];if(c.has(m))return t.logError("".concat(m," is not supported videoConstaints."),!0),!1}return!0},e})(),Ti={exports:{}},V_=Ti.exports,i1;function H_(){return i1||(i1=1,(function(e,r){(function(t,a){a(r)})(V_,(function(t){function a(I){return I==null}var i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(I,n){I.__proto__=n}||function(I,n){for(var s in n)n.hasOwnProperty(s)&&(I[s]=n[s])};function c(I,n){i(I,n);function s(){this.constructor=I}I.prototype=n===null?Object.create(n):(s.prototype=n.prototype,new s)}function u(I,n){var s=Object.setPrototypeOf;s?s(I,n):I.__proto__=n}function d(I,n){n===void 0&&(n=I.constructor);var s=Error.captureStackTrace;s&&s(I,n)}var g=(function(I){c(n,I);function n(s){var o=this.constructor,f=I.call(this,s)||this;return Object.defineProperty(f,"name",{value:o.name,enumerable:!1}),u(f,o.prototype),d(f),f}return n})(Error);class m extends g{constructor(n=void 0){super(n),this.message=n}getKind(){return this.constructor.kind}}m.kind="Exception";class w extends m{}w.kind="ArgumentException";class v extends m{}v.kind="IllegalArgumentException";class _{constructor(n){if(this.binarizer=n,n===null)throw new v("Binarizer must be non-null.")}getWidth(){return this.binarizer.getWidth()}getHeight(){return this.binarizer.getHeight()}getBlackRow(n,s){return this.binarizer.getBlackRow(n,s)}getBlackMatrix(){return(this.matrix===null||this.matrix===void 0)&&(this.matrix=this.binarizer.getBlackMatrix()),this.matrix}isCropSupported(){return this.binarizer.getLuminanceSource().isCropSupported()}crop(n,s,o,f){const l=this.binarizer.getLuminanceSource().crop(n,s,o,f);return new _(this.binarizer.createBinarizer(l))}isRotateSupported(){return this.binarizer.getLuminanceSource().isRotateSupported()}rotateCounterClockwise(){const n=this.binarizer.getLuminanceSource().rotateCounterClockwise();return new _(this.binarizer.createBinarizer(n))}rotateCounterClockwise45(){const n=this.binarizer.getLuminanceSource().rotateCounterClockwise45();return new _(this.binarizer.createBinarizer(n))}toString(){try{return this.getBlackMatrix().toString()}catch{return""}}}class C extends m{static getChecksumInstance(){return new C}}C.kind="ChecksumException";class S{constructor(n){this.source=n}getLuminanceSource(){return this.source}getWidth(){return this.source.getWidth()}getHeight(){return this.source.getHeight()}}class A{static arraycopy(n,s,o,f,l){for(;l--;)o[f++]=n[s++]}static currentTimeMillis(){return Date.now()}}class y extends m{}y.kind="IndexOutOfBoundsException";class D extends y{constructor(n=void 0,s=void 0){super(s),this.index=n,this.message=s}}D.kind="ArrayIndexOutOfBoundsException";class P{static fill(n,s){for(let o=0,f=n.length;o<f;o++)n[o]=s}static fillWithin(n,s,o,f){P.rangeCheck(n.length,s,o);for(let l=s;l<o;l++)n[l]=f}static rangeCheck(n,s,o){if(s>o)throw new v("fromIndex("+s+") > toIndex("+o+")");if(s<0)throw new D(s);if(o>n)throw new D(o)}static asList(...n){return n}static create(n,s,o){return Array.from({length:n}).map(l=>Array.from({length:s}).fill(o))}static createInt32Array(n,s,o){return Array.from({length:n}).map(l=>Int32Array.from({length:s}).fill(o))}static equals(n,s){if(!n||!s||!n.length||!s.length||n.length!==s.length)return!1;for(let o=0,f=n.length;o<f;o++)if(n[o]!==s[o])return!1;return!0}static hashCode(n){if(n===null)return 0;let s=1;for(const o of n)s=31*s+o;return s}static fillUint8Array(n,s){for(let o=0;o!==n.length;o++)n[o]=s}static copyOf(n,s){return n.slice(0,s)}static copyOfUint8Array(n,s){if(n.length<=s){const o=new Uint8Array(s);return o.set(n),o}return n.slice(0,s)}static copyOfRange(n,s,o){const f=o-s,l=new Int32Array(f);return A.arraycopy(n,s,l,0,f),l}static binarySearch(n,s,o){o===void 0&&(o=P.numberComparator);let f=0,l=n.length-1;for(;f<=l;){const h=l+f>>1,x=o(s,n[h]);if(x>0)f=h+1;else if(x<0)l=h-1;else return h}return-f-1}static numberComparator(n,s){return n-s}}class b{static numberOfTrailingZeros(n){let s;if(n===0)return 32;let o=31;return s=n<<16,s!==0&&(o-=16,n=s),s=n<<8,s!==0&&(o-=8,n=s),s=n<<4,s!==0&&(o-=4,n=s),s=n<<2,s!==0&&(o-=2,n=s),o-(n<<1>>>31)}static numberOfLeadingZeros(n){if(n===0)return 32;let s=1;return n>>>16||(s+=16,n<<=16),n>>>24||(s+=8,n<<=8),n>>>28||(s+=4,n<<=4),n>>>30||(s+=2,n<<=2),s-=n>>>31,s}static toHexString(n){return n.toString(16)}static toBinaryString(n){return String(parseInt(String(n),2))}static bitCount(n){return n=n-(n>>>1&1431655765),n=(n&858993459)+(n>>>2&858993459),n=n+(n>>>4)&252645135,n=n+(n>>>8),n=n+(n>>>16),n&63}static truncDivision(n,s){return Math.trunc(n/s)}static parseInt(n,s=void 0){return parseInt(n,s)}}b.MIN_VALUE_32_BITS=-2147483648,b.MAX_VALUE=Number.MAX_SAFE_INTEGER;class V{constructor(n,s){n===void 0?(this.size=0,this.bits=new Int32Array(1)):(this.size=n,s==null?this.bits=V.makeArray(n):this.bits=s)}getSize(){return this.size}getSizeInBytes(){return Math.floor((this.size+7)/8)}ensureCapacity(n){if(n>this.bits.length*32){const s=V.makeArray(n);A.arraycopy(this.bits,0,s,0,this.bits.length),this.bits=s}}get(n){return(this.bits[Math.floor(n/32)]&1<<(n&31))!==0}set(n){this.bits[Math.floor(n/32)]|=1<<(n&31)}flip(n){this.bits[Math.floor(n/32)]^=1<<(n&31)}getNextSet(n){const s=this.size;if(n>=s)return s;const o=this.bits;let f=Math.floor(n/32),l=o[f];l&=~((1<<(n&31))-1);const h=o.length;for(;l===0;){if(++f===h)return s;l=o[f]}const x=f*32+b.numberOfTrailingZeros(l);return x>s?s:x}getNextUnset(n){const s=this.size;if(n>=s)return s;const o=this.bits;let f=Math.floor(n/32),l=~o[f];l&=~((1<<(n&31))-1);const h=o.length;for(;l===0;){if(++f===h)return s;l=~o[f]}const x=f*32+b.numberOfTrailingZeros(l);return x>s?s:x}setBulk(n,s){this.bits[Math.floor(n/32)]=s}setRange(n,s){if(s<n||n<0||s>this.size)throw new v;if(s===n)return;s--;const o=Math.floor(n/32),f=Math.floor(s/32),l=this.bits;for(let h=o;h<=f;h++){const x=h>o?0:n&31,E=(2<<(h<f?31:s&31))-(1<<x);l[h]|=E}}clear(){const n=this.bits.length,s=this.bits;for(let o=0;o<n;o++)s[o]=0}isRange(n,s,o){if(s<n||n<0||s>this.size)throw new v;if(s===n)return!0;s--;const f=Math.floor(n/32),l=Math.floor(s/32),h=this.bits;for(let x=f;x<=l;x++){const p=x>f?0:n&31,T=(2<<(x<l?31:s&31))-(1<<p)&4294967295;if((h[x]&T)!==(o?T:0))return!1}return!0}appendBit(n){this.ensureCapacity(this.size+1),n&&(this.bits[Math.floor(this.size/32)]|=1<<(this.size&31)),this.size++}appendBits(n,s){if(s<0||s>32)throw new v("Num bits must be between 0 and 32");this.ensureCapacity(this.size+s);for(let o=s;o>0;o--)this.appendBit((n>>o-1&1)===1)}appendBitArray(n){const s=n.size;this.ensureCapacity(this.size+s);for(let o=0;o<s;o++)this.appendBit(n.get(o))}xor(n){if(this.size!==n.size)throw new v("Sizes don't match");const s=this.bits;for(let o=0,f=s.length;o<f;o++)s[o]^=n.bits[o]}toBytes(n,s,o,f){for(let l=0;l<f;l++){let h=0;for(let x=0;x<8;x++)this.get(n)&&(h|=1<<7-x),n++;s[o+l]=h}}getBitArray(){return this.bits}reverse(){const n=new Int32Array(this.bits.length),s=Math.floor((this.size-1)/32),o=s+1,f=this.bits;for(let l=0;l<o;l++){let h=f[l];h=h>>1&1431655765|(h&1431655765)<<1,h=h>>2&858993459|(h&858993459)<<2,h=h>>4&252645135|(h&252645135)<<4,h=h>>8&16711935|(h&16711935)<<8,h=h>>16&65535|(h&65535)<<16,n[s-l]=h}if(this.size!==o*32){const l=o*32-this.size;let h=n[0]>>>l;for(let x=1;x<o;x++){const p=n[x];h|=p<<32-l,n[x-1]=h,h=p>>>l}n[o-1]=h}this.bits=n}static makeArray(n){return new Int32Array(Math.floor((n+31)/32))}equals(n){if(!(n instanceof V))return!1;const s=n;return this.size===s.size&&P.equals(this.bits,s.bits)}hashCode(){return 31*this.size+P.hashCode(this.bits)}toString(){let n="";for(let s=0,o=this.size;s<o;s++)(s&7)===0&&(n+=" "),n+=this.get(s)?"X":".";return n}clone(){return new V(this.size,this.bits.slice())}}var te;(function(I){I[I.OTHER=0]="OTHER",I[I.PURE_BARCODE=1]="PURE_BARCODE",I[I.POSSIBLE_FORMATS=2]="POSSIBLE_FORMATS",I[I.TRY_HARDER=3]="TRY_HARDER",I[I.CHARACTER_SET=4]="CHARACTER_SET",I[I.ALLOWED_LENGTHS=5]="ALLOWED_LENGTHS",I[I.ASSUME_CODE_39_CHECK_DIGIT=6]="ASSUME_CODE_39_CHECK_DIGIT",I[I.ASSUME_GS1=7]="ASSUME_GS1",I[I.RETURN_CODABAR_START_END=8]="RETURN_CODABAR_START_END",I[I.NEED_RESULT_POINT_CALLBACK=9]="NEED_RESULT_POINT_CALLBACK",I[I.ALLOWED_EAN_EXTENSIONS=10]="ALLOWED_EAN_EXTENSIONS"})(te||(te={}));var W=te;class N extends m{static getFormatInstance(){return new N}}N.kind="FormatException";var j;(function(I){I[I.Cp437=0]="Cp437",I[I.ISO8859_1=1]="ISO8859_1",I[I.ISO8859_2=2]="ISO8859_2",I[I.ISO8859_3=3]="ISO8859_3",I[I.ISO8859_4=4]="ISO8859_4",I[I.ISO8859_5=5]="ISO8859_5",I[I.ISO8859_6=6]="ISO8859_6",I[I.ISO8859_7=7]="ISO8859_7",I[I.ISO8859_8=8]="ISO8859_8",I[I.ISO8859_9=9]="ISO8859_9",I[I.ISO8859_10=10]="ISO8859_10",I[I.ISO8859_11=11]="ISO8859_11",I[I.ISO8859_13=12]="ISO8859_13",I[I.ISO8859_14=13]="ISO8859_14",I[I.ISO8859_15=14]="ISO8859_15",I[I.ISO8859_16=15]="ISO8859_16",I[I.SJIS=16]="SJIS",I[I.Cp1250=17]="Cp1250",I[I.Cp1251=18]="Cp1251",I[I.Cp1252=19]="Cp1252",I[I.Cp1256=20]="Cp1256",I[I.UnicodeBigUnmarked=21]="UnicodeBigUnmarked",I[I.UTF8=22]="UTF8",I[I.ASCII=23]="ASCII",I[I.Big5=24]="Big5",I[I.GB18030=25]="GB18030",I[I.EUC_KR=26]="EUC_KR"})(j||(j={}));class O{constructor(n,s,o,...f){this.valueIdentifier=n,this.name=o,typeof s=="number"?this.values=Int32Array.from([s]):this.values=s,this.otherEncodingNames=f,O.VALUE_IDENTIFIER_TO_ECI.set(n,this),O.NAME_TO_ECI.set(o,this);const l=this.values;for(let h=0,x=l.length;h!==x;h++){const p=l[h];O.VALUES_TO_ECI.set(p,this)}for(const h of f)O.NAME_TO_ECI.set(h,this)}getValueIdentifier(){return this.valueIdentifier}getName(){return this.name}getValue(){return this.values[0]}static getCharacterSetECIByValue(n){if(n<0||n>=900)throw new N("incorect value");const s=O.VALUES_TO_ECI.get(n);if(s===void 0)throw new N("incorect value");return s}static getCharacterSetECIByName(n){const s=O.NAME_TO_ECI.get(n);if(s===void 0)throw new N("incorect value");return s}equals(n){if(!(n instanceof O))return!1;const s=n;return this.getName()===s.getName()}}O.VALUE_IDENTIFIER_TO_ECI=new Map,O.VALUES_TO_ECI=new Map,O.NAME_TO_ECI=new Map,O.Cp437=new O(j.Cp437,Int32Array.from([0,2]),"Cp437"),O.ISO8859_1=new O(j.ISO8859_1,Int32Array.from([1,3]),"ISO-8859-1","ISO88591","ISO8859_1"),O.ISO8859_2=new O(j.ISO8859_2,4,"ISO-8859-2","ISO88592","ISO8859_2"),O.ISO8859_3=new O(j.ISO8859_3,5,"ISO-8859-3","ISO88593","ISO8859_3"),O.ISO8859_4=new O(j.ISO8859_4,6,"ISO-8859-4","ISO88594","ISO8859_4"),O.ISO8859_5=new O(j.ISO8859_5,7,"ISO-8859-5","ISO88595","ISO8859_5"),O.ISO8859_6=new O(j.ISO8859_6,8,"ISO-8859-6","ISO88596","ISO8859_6"),O.ISO8859_7=new O(j.ISO8859_7,9,"ISO-8859-7","ISO88597","ISO8859_7"),O.ISO8859_8=new O(j.ISO8859_8,10,"ISO-8859-8","ISO88598","ISO8859_8"),O.ISO8859_9=new O(j.ISO8859_9,11,"ISO-8859-9","ISO88599","ISO8859_9"),O.ISO8859_10=new O(j.ISO8859_10,12,"ISO-8859-10","ISO885910","ISO8859_10"),O.ISO8859_11=new O(j.ISO8859_11,13,"ISO-8859-11","ISO885911","ISO8859_11"),O.ISO8859_13=new O(j.ISO8859_13,15,"ISO-8859-13","ISO885913","ISO8859_13"),O.ISO8859_14=new O(j.ISO8859_14,16,"ISO-8859-14","ISO885914","ISO8859_14"),O.ISO8859_15=new O(j.ISO8859_15,17,"ISO-8859-15","ISO885915","ISO8859_15"),O.ISO8859_16=new O(j.ISO8859_16,18,"ISO-8859-16","ISO885916","ISO8859_16"),O.SJIS=new O(j.SJIS,20,"SJIS","Shift_JIS"),O.Cp1250=new O(j.Cp1250,21,"Cp1250","windows-1250"),O.Cp1251=new O(j.Cp1251,22,"Cp1251","windows-1251"),O.Cp1252=new O(j.Cp1252,23,"Cp1252","windows-1252"),O.Cp1256=new O(j.Cp1256,24,"Cp1256","windows-1256"),O.UnicodeBigUnmarked=new O(j.UnicodeBigUnmarked,25,"UnicodeBigUnmarked","UTF-16BE","UnicodeBig"),O.UTF8=new O(j.UTF8,26,"UTF8","UTF-8"),O.ASCII=new O(j.ASCII,Int32Array.from([27,170]),"ASCII","US-ASCII"),O.Big5=new O(j.Big5,28,"Big5"),O.GB18030=new O(j.GB18030,29,"GB18030","GB2312","EUC_CN","GBK"),O.EUC_KR=new O(j.EUC_KR,30,"EUC_KR","EUC-KR");class ae extends m{}ae.kind="UnsupportedOperationException";class Q{static decode(n,s){const o=this.encodingName(s);return this.customDecoder?this.customDecoder(n,o):typeof TextDecoder>"u"||this.shouldDecodeOnFallback(o)?this.decodeFallback(n,o):new TextDecoder(o).decode(n)}static shouldDecodeOnFallback(n){return!Q.isBrowser()&&n==="ISO-8859-1"}static encode(n,s){const o=this.encodingName(s);return this.customEncoder?this.customEncoder(n,o):typeof TextEncoder>"u"?this.encodeFallback(n):new TextEncoder().encode(n)}static isBrowser(){return typeof window<"u"&&{}.toString.call(window)==="[object Window]"}static encodingName(n){return typeof n=="string"?n:n.getName()}static encodingCharacterSet(n){return n instanceof O?n:O.getCharacterSetECIByName(n)}static decodeFallback(n,s){const o=this.encodingCharacterSet(s);if(Q.isDecodeFallbackSupported(o)){let f="";for(let l=0,h=n.length;l<h;l++){let x=n[l].toString(16);x.length<2&&(x="0"+x),f+="%"+x}return decodeURIComponent(f)}if(o.equals(O.UnicodeBigUnmarked))return String.fromCharCode.apply(null,new Uint16Array(n.buffer));throw new ae(`Encoding ${this.encodingName(s)} not supported by fallback.`)}static isDecodeFallbackSupported(n){return n.equals(O.UTF8)||n.equals(O.ISO8859_1)||n.equals(O.ASCII)}static encodeFallback(n){const o=btoa(unescape(encodeURIComponent(n))).split(""),f=[];for(let l=0;l<o.length;l++)f.push(o[l].charCodeAt(0));return new Uint8Array(f)}}class X{static castAsNonUtf8Char(n,s=null){const o=s?s.getName():this.ISO88591;return Q.decode(new Uint8Array([n]),o)}static guessEncoding(n,s){if(s!=null&&s.get(W.CHARACTER_SET)!==void 0)return s.get(W.CHARACTER_SET).toString();const o=n.length;let f=!0,l=!0,h=!0,x=0,p=0,E=0,T=0,k=0,R=0,G=0,J=0,re=0,fe=0,pe=0;const Re=n.length>3&&n[0]===239&&n[1]===187&&n[2]===191;for(let De=0;De<o&&(f||l||h);De++){const ke=n[De]&255;h&&(x>0?(ke&128)===0?h=!1:x--:(ke&128)!==0&&((ke&64)===0?h=!1:(x++,(ke&32)===0?p++:(x++,(ke&16)===0?E++:(x++,(ke&8)===0?T++:h=!1))))),f&&(ke>127&&ke<160?f=!1:ke>159&&(ke<192||ke===215||ke===247)&&pe++),l&&(k>0?ke<64||ke===127||ke>252?l=!1:k--:ke===128||ke===160||ke>239?l=!1:ke>160&&ke<224?(R++,J=0,G++,G>re&&(re=G)):ke>127?(k++,G=0,J++,J>fe&&(fe=J)):(G=0,J=0))}return h&&x>0&&(h=!1),l&&k>0&&(l=!1),h&&(Re||p+E+T>0)?X.UTF8:l&&(X.ASSUME_SHIFT_JIS||re>=3||fe>=3)?X.SHIFT_JIS:f&&l?re===2&&R===2||pe*10>=o?X.SHIFT_JIS:X.ISO88591:f?X.ISO88591:l?X.SHIFT_JIS:h?X.UTF8:X.PLATFORM_DEFAULT_ENCODING}static format(n,...s){let o=-1;function f(h,x,p,E,T,k){if(h==="%%")return"%";if(s[++o]===void 0)return;h=E?parseInt(E.substr(1)):void 0;let R=T?parseInt(T.substr(1)):void 0,G;switch(k){case"s":G=s[o];break;case"c":G=s[o][0];break;case"f":G=parseFloat(s[o]).toFixed(h);break;case"p":G=parseFloat(s[o]).toPrecision(h);break;case"e":G=parseFloat(s[o]).toExponential(h);break;case"x":G=parseInt(s[o]).toString(R||16);break;case"d":G=parseFloat(parseInt(s[o],R||10).toPrecision(h)).toFixed(0);break}G=typeof G=="object"?JSON.stringify(G):(+G).toString(R);let J=parseInt(p),re=p&&p[0]+""=="0"?"0":" ";for(;G.length<J;)G=x!==void 0?G+re:re+G;return G}let l=/%(-)?(0?[0-9]+)?([.][0-9]+)?([#][0-9]+)?([scfpexd%])/g;return n.replace(l,f)}static getBytes(n,s){return Q.encode(n,s)}static getCharCode(n,s=0){return n.charCodeAt(s)}static getCharAt(n){return String.fromCharCode(n)}}X.SHIFT_JIS=O.SJIS.getName(),X.GB2312="GB2312",X.ISO88591=O.ISO8859_1.getName(),X.EUC_JP="EUC_JP",X.UTF8=O.UTF8.getName(),X.PLATFORM_DEFAULT_ENCODING=X.UTF8,X.ASSUME_SHIFT_JIS=!1;class ie{constructor(n=""){this.value=n}enableDecoding(n){return this.encoding=n,this}append(n){return typeof n=="string"?this.value+=n.toString():this.encoding?this.value+=X.castAsNonUtf8Char(n,this.encoding):this.value+=String.fromCharCode(n),this}appendChars(n,s,o){for(let f=s;s<s+o;f++)this.append(n[f]);return this}length(){return this.value.length}charAt(n){return this.value.charAt(n)}deleteCharAt(n){this.value=this.value.substr(0,n)+this.value.substring(n+1)}setCharAt(n,s){this.value=this.value.substr(0,n)+s+this.value.substr(n+1)}substring(n,s){return this.value.substring(n,s)}setLengthToZero(){this.value=""}toString(){return this.value}insert(n,s){this.value=this.value.substr(0,n)+s+this.value.substr(n+s.length)}}class Ee{constructor(n,s,o,f){if(this.width=n,this.height=s,this.rowSize=o,this.bits=f,s==null&&(s=n),this.height=s,n<1||s<1)throw new v("Both dimensions must be greater than 0");o==null&&(o=Math.floor((n+31)/32)),this.rowSize=o,f==null&&(this.bits=new Int32Array(this.rowSize*this.height))}static parseFromBooleanArray(n){const s=n.length,o=n[0].length,f=new Ee(o,s);for(let l=0;l<s;l++){const h=n[l];for(let x=0;x<o;x++)h[x]&&f.set(x,l)}return f}static parseFromString(n,s,o){if(n===null)throw new v("stringRepresentation cannot be null");const f=new Array(n.length);let l=0,h=0,x=-1,p=0,E=0;for(;E<n.length;)if(n.charAt(E)===`
`||n.charAt(E)==="\r"){if(l>h){if(x===-1)x=l-h;else if(l-h!==x)throw new v("row lengths do not match");h=l,p++}E++}else if(n.substring(E,E+s.length)===s)E+=s.length,f[l]=!0,l++;else if(n.substring(E,E+o.length)===o)E+=o.length,f[l]=!1,l++;else throw new v("illegal character encountered: "+n.substring(E));if(l>h){if(x===-1)x=l-h;else if(l-h!==x)throw new v("row lengths do not match");p++}const T=new Ee(x,p);for(let k=0;k<l;k++)f[k]&&T.set(Math.floor(k%x),Math.floor(k/x));return T}get(n,s){const o=s*this.rowSize+Math.floor(n/32);return(this.bits[o]>>>(n&31)&1)!==0}set(n,s){const o=s*this.rowSize+Math.floor(n/32);this.bits[o]|=1<<(n&31)&4294967295}unset(n,s){const o=s*this.rowSize+Math.floor(n/32);this.bits[o]&=~(1<<(n&31)&4294967295)}flip(n,s){const o=s*this.rowSize+Math.floor(n/32);this.bits[o]^=1<<(n&31)&4294967295}xor(n){if(this.width!==n.getWidth()||this.height!==n.getHeight()||this.rowSize!==n.getRowSize())throw new v("input matrix dimensions do not match");const s=new V(Math.floor(this.width/32)+1),o=this.rowSize,f=this.bits;for(let l=0,h=this.height;l<h;l++){const x=l*o,p=n.getRow(l,s).getBitArray();for(let E=0;E<o;E++)f[x+E]^=p[E]}}clear(){const n=this.bits,s=n.length;for(let o=0;o<s;o++)n[o]=0}setRegion(n,s,o,f){if(s<0||n<0)throw new v("Left and top must be nonnegative");if(f<1||o<1)throw new v("Height and width must be at least 1");const l=n+o,h=s+f;if(h>this.height||l>this.width)throw new v("The region must fit inside the matrix");const x=this.rowSize,p=this.bits;for(let E=s;E<h;E++){const T=E*x;for(let k=n;k<l;k++)p[T+Math.floor(k/32)]|=1<<(k&31)&4294967295}}getRow(n,s){s==null||s.getSize()<this.width?s=new V(this.width):s.clear();const o=this.rowSize,f=this.bits,l=n*o;for(let h=0;h<o;h++)s.setBulk(h*32,f[l+h]);return s}setRow(n,s){A.arraycopy(s.getBitArray(),0,this.bits,n*this.rowSize,this.rowSize)}rotate180(){const n=this.getWidth(),s=this.getHeight();let o=new V(n),f=new V(n);for(let l=0,h=Math.floor((s+1)/2);l<h;l++)o=this.getRow(l,o),f=this.getRow(s-1-l,f),o.reverse(),f.reverse(),this.setRow(l,f),this.setRow(s-1-l,o)}getEnclosingRectangle(){const n=this.width,s=this.height,o=this.rowSize,f=this.bits;let l=n,h=s,x=-1,p=-1;for(let E=0;E<s;E++)for(let T=0;T<o;T++){const k=f[E*o+T];if(k!==0){if(E<h&&(h=E),E>p&&(p=E),T*32<l){let R=0;for(;(k<<31-R&4294967295)===0;)R++;T*32+R<l&&(l=T*32+R)}if(T*32+31>x){let R=31;for(;!(k>>>R);)R--;T*32+R>x&&(x=T*32+R)}}}return x<l||p<h?null:Int32Array.from([l,h,x-l+1,p-h+1])}getTopLeftOnBit(){const n=this.rowSize,s=this.bits;let o=0;for(;o<s.length&&s[o]===0;)o++;if(o===s.length)return null;const f=o/n;let l=o%n*32;const h=s[o];let x=0;for(;(h<<31-x&4294967295)===0;)x++;return l+=x,Int32Array.from([l,f])}getBottomRightOnBit(){const n=this.rowSize,s=this.bits;let o=s.length-1;for(;o>=0&&s[o]===0;)o--;if(o<0)return null;const f=Math.floor(o/n);let l=Math.floor(o%n)*32;const h=s[o];let x=31;for(;!(h>>>x);)x--;return l+=x,Int32Array.from([l,f])}getWidth(){return this.width}getHeight(){return this.height}getRowSize(){return this.rowSize}equals(n){if(!(n instanceof Ee))return!1;const s=n;return this.width===s.width&&this.height===s.height&&this.rowSize===s.rowSize&&P.equals(this.bits,s.bits)}hashCode(){let n=this.width;return n=31*n+this.width,n=31*n+this.height,n=31*n+this.rowSize,n=31*n+P.hashCode(this.bits),n}toString(n="X ",s="  ",o=`
`){return this.buildToString(n,s,o)}buildToString(n,s,o){let f=new ie;for(let l=0,h=this.height;l<h;l++){for(let x=0,p=this.width;x<p;x++)f.append(this.get(x,l)?n:s);f.append(o)}return f.toString()}clone(){return new Ee(this.width,this.height,this.rowSize,this.bits.slice())}}class q extends m{static getNotFoundInstance(){return new q}}q.kind="NotFoundException";class ue extends S{constructor(n){super(n),this.luminances=ue.EMPTY,this.buckets=new Int32Array(ue.LUMINANCE_BUCKETS)}getBlackRow(n,s){const o=this.getLuminanceSource(),f=o.getWidth();s==null||s.getSize()<f?s=new V(f):s.clear(),this.initArrays(f);const l=o.getRow(n,this.luminances),h=this.buckets;for(let p=0;p<f;p++)h[(l[p]&255)>>ue.LUMINANCE_SHIFT]++;const x=ue.estimateBlackPoint(h);if(f<3)for(let p=0;p<f;p++)(l[p]&255)<x&&s.set(p);else{let p=l[0]&255,E=l[1]&255;for(let T=1;T<f-1;T++){const k=l[T+1]&255;(E*4-p-k)/2<x&&s.set(T),p=E,E=k}}return s}getBlackMatrix(){const n=this.getLuminanceSource(),s=n.getWidth(),o=n.getHeight(),f=new Ee(s,o);this.initArrays(s);const l=this.buckets;for(let p=1;p<5;p++){const E=Math.floor(o*p/5),T=n.getRow(E,this.luminances),k=Math.floor(s*4/5);for(let R=Math.floor(s/5);R<k;R++){const G=T[R]&255;l[G>>ue.LUMINANCE_SHIFT]++}}const h=ue.estimateBlackPoint(l),x=n.getMatrix();for(let p=0;p<o;p++){const E=p*s;for(let T=0;T<s;T++)(x[E+T]&255)<h&&f.set(T,p)}return f}createBinarizer(n){return new ue(n)}initArrays(n){this.luminances.length<n&&(this.luminances=new Uint8ClampedArray(n));const s=this.buckets;for(let o=0;o<ue.LUMINANCE_BUCKETS;o++)s[o]=0}static estimateBlackPoint(n){const s=n.length;let o=0,f=0,l=0;for(let T=0;T<s;T++)n[T]>l&&(f=T,l=n[T]),n[T]>o&&(o=n[T]);let h=0,x=0;for(let T=0;T<s;T++){const k=T-f,R=n[T]*k*k;R>x&&(h=T,x=R)}if(f>h){const T=f;f=h,h=T}if(h-f<=s/16)throw new q;let p=h-1,E=-1;for(let T=h-1;T>f;T--){const k=T-f,R=k*k*(h-T)*(o-n[T]);R>E&&(p=T,E=R)}return p<<ue.LUMINANCE_SHIFT}}ue.LUMINANCE_BITS=5,ue.LUMINANCE_SHIFT=8-ue.LUMINANCE_BITS,ue.LUMINANCE_BUCKETS=1<<ue.LUMINANCE_BITS,ue.EMPTY=Uint8ClampedArray.from([0]);class de extends ue{constructor(n){super(n),this.matrix=null}getBlackMatrix(){if(this.matrix!==null)return this.matrix;const n=this.getLuminanceSource(),s=n.getWidth(),o=n.getHeight();if(s>=de.MINIMUM_DIMENSION&&o>=de.MINIMUM_DIMENSION){const f=n.getMatrix();let l=s>>de.BLOCK_SIZE_POWER;(s&de.BLOCK_SIZE_MASK)!==0&&l++;let h=o>>de.BLOCK_SIZE_POWER;(o&de.BLOCK_SIZE_MASK)!==0&&h++;const x=de.calculateBlackPoints(f,l,h,s,o),p=new Ee(s,o);de.calculateThresholdForBlock(f,l,h,s,o,x,p),this.matrix=p}else this.matrix=super.getBlackMatrix();return this.matrix}createBinarizer(n){return new de(n)}static calculateThresholdForBlock(n,s,o,f,l,h,x){const p=l-de.BLOCK_SIZE,E=f-de.BLOCK_SIZE;for(let T=0;T<o;T++){let k=T<<de.BLOCK_SIZE_POWER;k>p&&(k=p);const R=de.cap(T,2,o-3);for(let G=0;G<s;G++){let J=G<<de.BLOCK_SIZE_POWER;J>E&&(J=E);const re=de.cap(G,2,s-3);let fe=0;for(let Re=-2;Re<=2;Re++){const De=h[R+Re];fe+=De[re-2]+De[re-1]+De[re]+De[re+1]+De[re+2]}const pe=fe/25;de.thresholdBlock(n,J,k,pe,f,x)}}}static cap(n,s,o){return n<s?s:n>o?o:n}static thresholdBlock(n,s,o,f,l,h){for(let x=0,p=o*l+s;x<de.BLOCK_SIZE;x++,p+=l)for(let E=0;E<de.BLOCK_SIZE;E++)(n[p+E]&255)<=f&&h.set(s+E,o+x)}static calculateBlackPoints(n,s,o,f,l){const h=l-de.BLOCK_SIZE,x=f-de.BLOCK_SIZE,p=new Array(o);for(let E=0;E<o;E++){p[E]=new Int32Array(s);let T=E<<de.BLOCK_SIZE_POWER;T>h&&(T=h);for(let k=0;k<s;k++){let R=k<<de.BLOCK_SIZE_POWER;R>x&&(R=x);let G=0,J=255,re=0;for(let pe=0,Re=T*f+R;pe<de.BLOCK_SIZE;pe++,Re+=f){for(let De=0;De<de.BLOCK_SIZE;De++){const ke=n[Re+De]&255;G+=ke,ke<J&&(J=ke),ke>re&&(re=ke)}if(re-J>de.MIN_DYNAMIC_RANGE)for(pe++,Re+=f;pe<de.BLOCK_SIZE;pe++,Re+=f)for(let De=0;De<de.BLOCK_SIZE;De++)G+=n[Re+De]&255}let fe=G>>de.BLOCK_SIZE_POWER*2;if(re-J<=de.MIN_DYNAMIC_RANGE&&(fe=J/2,E>0&&k>0)){const pe=(p[E-1][k]+2*p[E][k-1]+p[E-1][k-1])/4;J<pe&&(fe=pe)}p[E][k]=fe}}return p}}de.BLOCK_SIZE_POWER=3,de.BLOCK_SIZE=1<<de.BLOCK_SIZE_POWER,de.BLOCK_SIZE_MASK=de.BLOCK_SIZE-1,de.MINIMUM_DIMENSION=de.BLOCK_SIZE*5,de.MIN_DYNAMIC_RANGE=24;class We{constructor(n,s){this.width=n,this.height=s}getWidth(){return this.width}getHeight(){return this.height}isCropSupported(){return!1}crop(n,s,o,f){throw new ae("This luminance source does not support cropping.")}isRotateSupported(){return!1}rotateCounterClockwise(){throw new ae("This luminance source does not support rotation by 90 degrees.")}rotateCounterClockwise45(){throw new ae("This luminance source does not support rotation by 45 degrees.")}toString(){const n=new Uint8ClampedArray(this.width);let s=new ie;for(let o=0;o<this.height;o++){const f=this.getRow(o,n);for(let l=0;l<this.width;l++){const h=f[l]&255;let x;h<64?x="#":h<128?x="+":h<192?x=".":x=" ",s.append(x)}s.append(`
`)}return s.toString()}}class se extends We{constructor(n){super(n.getWidth(),n.getHeight()),this.delegate=n}getRow(n,s){const o=this.delegate.getRow(n,s),f=this.getWidth();for(let l=0;l<f;l++)o[l]=255-(o[l]&255);return o}getMatrix(){const n=this.delegate.getMatrix(),s=this.getWidth()*this.getHeight(),o=new Uint8ClampedArray(s);for(let f=0;f<s;f++)o[f]=255-(n[f]&255);return o}isCropSupported(){return this.delegate.isCropSupported()}crop(n,s,o,f){return new se(this.delegate.crop(n,s,o,f))}isRotateSupported(){return this.delegate.isRotateSupported()}invert(){return this.delegate}rotateCounterClockwise(){return new se(this.delegate.rotateCounterClockwise())}rotateCounterClockwise45(){return new se(this.delegate.rotateCounterClockwise45())}}class Le extends We{constructor(n){super(n.width,n.height),this.canvas=n,this.tempCanvasElement=null,this.buffer=Le.makeBufferFromCanvasImageData(n)}static makeBufferFromCanvasImageData(n){const s=n.getContext("2d").getImageData(0,0,n.width,n.height);return Le.toGrayscaleBuffer(s.data,n.width,n.height)}static toGrayscaleBuffer(n,s,o){const f=new Uint8ClampedArray(s*o);for(let l=0,h=0,x=n.length;l<x;l+=4,h++){let p;if(n[l+3]===0)p=255;else{const T=n[l],k=n[l+1],R=n[l+2];p=306*T+601*k+117*R+512>>10}f[h]=p}return f}getRow(n,s){if(n<0||n>=this.getHeight())throw new v("Requested row is outside the image: "+n);const o=this.getWidth(),f=n*o;return s===null?s=this.buffer.slice(f,f+o):(s.length<o&&(s=new Uint8ClampedArray(o)),s.set(this.buffer.slice(f,f+o))),s}getMatrix(){return this.buffer}isCropSupported(){return!0}crop(n,s,o,f){return super.crop(n,s,o,f),this}isRotateSupported(){return!0}rotateCounterClockwise(){return this.rotate(-90),this}rotateCounterClockwise45(){return this.rotate(-45),this}getTempCanvasElement(){if(this.tempCanvasElement===null){const n=this.canvas.ownerDocument.createElement("canvas");n.width=this.canvas.width,n.height=this.canvas.height,this.tempCanvasElement=n}return this.tempCanvasElement}rotate(n){const s=this.getTempCanvasElement(),o=s.getContext("2d"),f=n*Le.DEGREE_TO_RADIANS,l=this.canvas.width,h=this.canvas.height,x=Math.ceil(Math.abs(Math.cos(f))*l+Math.abs(Math.sin(f))*h),p=Math.ceil(Math.abs(Math.sin(f))*l+Math.abs(Math.cos(f))*h);return s.width=x,s.height=p,o.translate(x/2,p/2),o.rotate(f),o.drawImage(this.canvas,l/-2,h/-2),this.buffer=Le.makeBufferFromCanvasImageData(s),this}invert(){return new se(this)}}Le.DEGREE_TO_RADIANS=Math.PI/180;class Ge{constructor(n,s,o){this.deviceId=n,this.label=s,this.kind="videoinput",this.groupId=o||void 0}toJSON(){return{kind:this.kind,groupId:this.groupId,deviceId:this.deviceId,label:this.label}}}var z=(globalThis||cs||self||window||void 0)&&(globalThis||cs||self||window||void 0).__awaiter||function(I,n,s,o){function f(l){return l instanceof s?l:new s(function(h){h(l)})}return new(s||(s=Promise))(function(l,h){function x(T){try{E(o.next(T))}catch(k){h(k)}}function p(T){try{E(o.throw(T))}catch(k){h(k)}}function E(T){T.done?l(T.value):f(T.value).then(x,p)}E((o=o.apply(I,n||[])).next())})};class ne{constructor(n,s=500,o){this.reader=n,this.timeBetweenScansMillis=s,this._hints=o,this._stopContinuousDecode=!1,this._stopAsyncDecode=!1,this._timeBetweenDecodingAttempts=0}get hasNavigator(){return typeof navigator<"u"}get isMediaDevicesSuported(){return this.hasNavigator&&!!navigator.mediaDevices}get canEnumerateDevices(){return!!(this.isMediaDevicesSuported&&navigator.mediaDevices.enumerateDevices)}get timeBetweenDecodingAttempts(){return this._timeBetweenDecodingAttempts}set timeBetweenDecodingAttempts(n){this._timeBetweenDecodingAttempts=n<0?0:n}set hints(n){this._hints=n||null}get hints(){return this._hints}listVideoInputDevices(){return z(this,void 0,void 0,function*(){if(!this.hasNavigator)throw new Error("Can't enumerate devices, navigator is not present.");if(!this.canEnumerateDevices)throw new Error("Can't enumerate devices, method not supported.");const n=yield navigator.mediaDevices.enumerateDevices(),s=[];for(const o of n){const f=o.kind==="video"?"videoinput":o.kind;if(f!=="videoinput")continue;const l=o.deviceId||o.id,h=o.label||`Video device ${s.length+1}`,x=o.groupId,p={deviceId:l,label:h,kind:f,groupId:x};s.push(p)}return s})}getVideoInputDevices(){return z(this,void 0,void 0,function*(){return(yield this.listVideoInputDevices()).map(s=>new Ge(s.deviceId,s.label))})}findDeviceById(n){return z(this,void 0,void 0,function*(){const s=yield this.listVideoInputDevices();return s?s.find(o=>o.deviceId===n):null})}decodeFromInputVideoDevice(n,s){return z(this,void 0,void 0,function*(){return yield this.decodeOnceFromVideoDevice(n,s)})}decodeOnceFromVideoDevice(n,s){return z(this,void 0,void 0,function*(){this.reset();let o;n?o={deviceId:{exact:n}}:o={facingMode:"environment"};const f={video:o};return yield this.decodeOnceFromConstraints(f,s)})}decodeOnceFromConstraints(n,s){return z(this,void 0,void 0,function*(){const o=yield navigator.mediaDevices.getUserMedia(n);return yield this.decodeOnceFromStream(o,s)})}decodeOnceFromStream(n,s){return z(this,void 0,void 0,function*(){this.reset();const o=yield this.attachStreamToVideo(n,s);return yield this.decodeOnce(o)})}decodeFromInputVideoDeviceContinuously(n,s,o){return z(this,void 0,void 0,function*(){return yield this.decodeFromVideoDevice(n,s,o)})}decodeFromVideoDevice(n,s,o){return z(this,void 0,void 0,function*(){let f;n?f={deviceId:{exact:n}}:f={facingMode:"environment"};const l={video:f};return yield this.decodeFromConstraints(l,s,o)})}decodeFromConstraints(n,s,o){return z(this,void 0,void 0,function*(){const f=yield navigator.mediaDevices.getUserMedia(n);return yield this.decodeFromStream(f,s,o)})}decodeFromStream(n,s,o){return z(this,void 0,void 0,function*(){this.reset();const f=yield this.attachStreamToVideo(n,s);return yield this.decodeContinuously(f,o)})}stopAsyncDecode(){this._stopAsyncDecode=!0}stopContinuousDecode(){this._stopContinuousDecode=!0}attachStreamToVideo(n,s){return z(this,void 0,void 0,function*(){const o=this.prepareVideoElement(s);return this.addVideoSource(o,n),this.videoElement=o,this.stream=n,yield this.playVideoOnLoadAsync(o),o})}playVideoOnLoadAsync(n){return new Promise((s,o)=>this.playVideoOnLoad(n,()=>s()))}playVideoOnLoad(n,s){this.videoEndedListener=()=>this.stopStreams(),this.videoCanPlayListener=()=>this.tryPlayVideo(n),n.addEventListener("ended",this.videoEndedListener),n.addEventListener("canplay",this.videoCanPlayListener),n.addEventListener("playing",s),this.tryPlayVideo(n)}isVideoPlaying(n){return n.currentTime>0&&!n.paused&&!n.ended&&n.readyState>2}tryPlayVideo(n){return z(this,void 0,void 0,function*(){if(this.isVideoPlaying(n)){console.warn("Trying to play video that is already playing.");return}try{yield n.play()}catch{console.warn("It was not possible to play the video.")}})}getMediaElement(n,s){const o=document.getElementById(n);if(!o)throw new w(`element with id '${n}' not found`);if(o.nodeName.toLowerCase()!==s.toLowerCase())throw new w(`element with id '${n}' must be an ${s} element`);return o}decodeFromImage(n,s){if(!n&&!s)throw new w("either imageElement with a src set or an url must be provided");return s&&!n?this.decodeFromImageUrl(s):this.decodeFromImageElement(n)}decodeFromVideo(n,s){if(!n&&!s)throw new w("Either an element with a src set or an URL must be provided");return s&&!n?this.decodeFromVideoUrl(s):this.decodeFromVideoElement(n)}decodeFromVideoContinuously(n,s,o){if(n===void 0&&s===void 0)throw new w("Either an element with a src set or an URL must be provided");return s&&!n?this.decodeFromVideoUrlContinuously(s,o):this.decodeFromVideoElementContinuously(n,o)}decodeFromImageElement(n){if(!n)throw new w("An image element must be provided.");this.reset();const s=this.prepareImageElement(n);this.imageElement=s;let o;return this.isImageLoaded(s)?o=this.decodeOnce(s,!1,!0):o=this._decodeOnLoadImage(s),o}decodeFromVideoElement(n){const s=this._decodeFromVideoElementSetup(n);return this._decodeOnLoadVideo(s)}decodeFromVideoElementContinuously(n,s){const o=this._decodeFromVideoElementSetup(n);return this._decodeOnLoadVideoContinuously(o,s)}_decodeFromVideoElementSetup(n){if(!n)throw new w("A video element must be provided.");this.reset();const s=this.prepareVideoElement(n);return this.videoElement=s,s}decodeFromImageUrl(n){if(!n)throw new w("An URL must be provided.");this.reset();const s=this.prepareImageElement();this.imageElement=s;const o=this._decodeOnLoadImage(s);return s.src=n,o}decodeFromVideoUrl(n){if(!n)throw new w("An URL must be provided.");this.reset();const s=this.prepareVideoElement(),o=this.decodeFromVideoElement(s);return s.src=n,o}decodeFromVideoUrlContinuously(n,s){if(!n)throw new w("An URL must be provided.");this.reset();const o=this.prepareVideoElement(),f=this.decodeFromVideoElementContinuously(o,s);return o.src=n,f}_decodeOnLoadImage(n){return new Promise((s,o)=>{this.imageLoadedListener=()=>this.decodeOnce(n,!1,!0).then(s,o),n.addEventListener("load",this.imageLoadedListener)})}_decodeOnLoadVideo(n){return z(this,void 0,void 0,function*(){return yield this.playVideoOnLoadAsync(n),yield this.decodeOnce(n)})}_decodeOnLoadVideoContinuously(n,s){return z(this,void 0,void 0,function*(){yield this.playVideoOnLoadAsync(n),this.decodeContinuously(n,s)})}isImageLoaded(n){return!(!n.complete||n.naturalWidth===0)}prepareImageElement(n){let s;return typeof n>"u"&&(s=document.createElement("img"),s.width=200,s.height=200),typeof n=="string"&&(s=this.getMediaElement(n,"img")),n instanceof HTMLImageElement&&(s=n),s}prepareVideoElement(n){let s;return!n&&typeof document<"u"&&(s=document.createElement("video"),s.width=200,s.height=200),typeof n=="string"&&(s=this.getMediaElement(n,"video")),n instanceof HTMLVideoElement&&(s=n),s.setAttribute("autoplay","true"),s.setAttribute("muted","true"),s.setAttribute("playsinline","true"),s}decodeOnce(n,s=!0,o=!0){this._stopAsyncDecode=!1;const f=(l,h)=>{if(this._stopAsyncDecode){h(new q("Video stream has ended before any code could be detected.")),this._stopAsyncDecode=void 0;return}try{const x=this.decode(n);l(x)}catch(x){const p=s&&x instanceof q,T=(x instanceof C||x instanceof N)&&o;if(p||T)return setTimeout(f,this._timeBetweenDecodingAttempts,l,h);h(x)}};return new Promise((l,h)=>f(l,h))}decodeContinuously(n,s){this._stopContinuousDecode=!1;const o=()=>{if(this._stopContinuousDecode){this._stopContinuousDecode=void 0;return}try{const f=this.decode(n);s(f,null),setTimeout(o,this.timeBetweenScansMillis)}catch(f){s(null,f);const l=f instanceof C||f instanceof N,h=f instanceof q;(l||h)&&setTimeout(o,this._timeBetweenDecodingAttempts)}};o()}decode(n){const s=this.createBinaryBitmap(n);return this.decodeBitmap(s)}_isHTMLVideoElement(n){return n.videoWidth!==0}drawFrameOnCanvas(n,s,o){s||(s={sx:0,sy:0,sWidth:n.videoWidth,sHeight:n.videoHeight,dx:0,dy:0,dWidth:n.videoWidth,dHeight:n.videoHeight}),o||(o=this.captureCanvasContext),o.drawImage(n,s.sx,s.sy,s.sWidth,s.sHeight,s.dx,s.dy,s.dWidth,s.dHeight)}drawImageOnCanvas(n,s,o=this.captureCanvasContext){s||(s={sx:0,sy:0,sWidth:n.naturalWidth,sHeight:n.naturalHeight,dx:0,dy:0,dWidth:n.naturalWidth,dHeight:n.naturalHeight}),o||(o=this.captureCanvasContext),o.drawImage(n,s.sx,s.sy,s.sWidth,s.sHeight,s.dx,s.dy,s.dWidth,s.dHeight)}createBinaryBitmap(n){this.getCaptureCanvasContext(n),this._isHTMLVideoElement(n)?this.drawFrameOnCanvas(n):this.drawImageOnCanvas(n);const s=this.getCaptureCanvas(n),o=new Le(s),f=new de(o);return new _(f)}getCaptureCanvasContext(n){if(!this.captureCanvasContext){const o=this.getCaptureCanvas(n).getContext("2d");this.captureCanvasContext=o}return this.captureCanvasContext}getCaptureCanvas(n){if(!this.captureCanvas){const s=this.createCaptureCanvas(n);this.captureCanvas=s}return this.captureCanvas}decodeBitmap(n){return this.reader.decode(n,this._hints)}createCaptureCanvas(n){if(typeof document>"u")return this._destroyCaptureCanvas(),null;const s=document.createElement("canvas");let o,f;return typeof n<"u"&&(n instanceof HTMLVideoElement?(o=n.videoWidth,f=n.videoHeight):n instanceof HTMLImageElement&&(o=n.naturalWidth||n.width,f=n.naturalHeight||n.height)),s.style.width=o+"px",s.style.height=f+"px",s.width=o,s.height=f,s}stopStreams(){this.stream&&(this.stream.getVideoTracks().forEach(n=>n.stop()),this.stream=void 0),this._stopAsyncDecode===!1&&this.stopAsyncDecode(),this._stopContinuousDecode===!1&&this.stopContinuousDecode()}reset(){this.stopStreams(),this._destroyVideoElement(),this._destroyImageElement(),this._destroyCaptureCanvas()}_destroyVideoElement(){this.videoElement&&(typeof this.videoEndedListener<"u"&&this.videoElement.removeEventListener("ended",this.videoEndedListener),typeof this.videoPlayingEventListener<"u"&&this.videoElement.removeEventListener("playing",this.videoPlayingEventListener),typeof this.videoCanPlayListener<"u"&&this.videoElement.removeEventListener("loadedmetadata",this.videoCanPlayListener),this.cleanVideoSource(this.videoElement),this.videoElement=void 0)}_destroyImageElement(){this.imageElement&&(this.imageLoadedListener!==void 0&&this.imageElement.removeEventListener("load",this.imageLoadedListener),this.imageElement.src=void 0,this.imageElement.removeAttribute("src"),this.imageElement=void 0)}_destroyCaptureCanvas(){this.captureCanvasContext=void 0,this.captureCanvas=void 0}addVideoSource(n,s){try{n.srcObject=s}catch{n.src=URL.createObjectURL(s)}}cleanVideoSource(n){try{n.srcObject=null}catch{n.src=""}this.videoElement.removeAttribute("src")}}class Z{constructor(n,s,o=s==null?0:8*s.length,f,l,h=A.currentTimeMillis()){this.text=n,this.rawBytes=s,this.numBits=o,this.resultPoints=f,this.format=l,this.timestamp=h,this.text=n,this.rawBytes=s,o==null?this.numBits=s==null?0:8*s.length:this.numBits=o,this.resultPoints=f,this.format=l,this.resultMetadata=null,h==null?this.timestamp=A.currentTimeMillis():this.timestamp=h}getText(){return this.text}getRawBytes(){return this.rawBytes}getNumBits(){return this.numBits}getResultPoints(){return this.resultPoints}getBarcodeFormat(){return this.format}getResultMetadata(){return this.resultMetadata}putMetadata(n,s){this.resultMetadata===null&&(this.resultMetadata=new Map),this.resultMetadata.set(n,s)}putAllMetadata(n){n!==null&&(this.resultMetadata===null?this.resultMetadata=n:this.resultMetadata=new Map(n))}addResultPoints(n){const s=this.resultPoints;if(s===null)this.resultPoints=n;else if(n!==null&&n.length>0){const o=new Array(s.length+n.length);A.arraycopy(s,0,o,0,s.length),A.arraycopy(n,0,o,s.length,n.length),this.resultPoints=o}}getTimestamp(){return this.timestamp}toString(){return this.text}}var ee;(function(I){I[I.AZTEC=0]="AZTEC",I[I.CODABAR=1]="CODABAR",I[I.CODE_39=2]="CODE_39",I[I.CODE_93=3]="CODE_93",I[I.CODE_128=4]="CODE_128",I[I.DATA_MATRIX=5]="DATA_MATRIX",I[I.EAN_8=6]="EAN_8",I[I.EAN_13=7]="EAN_13",I[I.ITF=8]="ITF",I[I.MAXICODE=9]="MAXICODE",I[I.PDF_417=10]="PDF_417",I[I.QR_CODE=11]="QR_CODE",I[I.RSS_14=12]="RSS_14",I[I.RSS_EXPANDED=13]="RSS_EXPANDED",I[I.UPC_A=14]="UPC_A",I[I.UPC_E=15]="UPC_E",I[I.UPC_EAN_EXTENSION=16]="UPC_EAN_EXTENSION"})(ee||(ee={}));var oe=ee,Ie;(function(I){I[I.OTHER=0]="OTHER",I[I.ORIENTATION=1]="ORIENTATION",I[I.BYTE_SEGMENTS=2]="BYTE_SEGMENTS",I[I.ERROR_CORRECTION_LEVEL=3]="ERROR_CORRECTION_LEVEL",I[I.ISSUE_NUMBER=4]="ISSUE_NUMBER",I[I.SUGGESTED_PRICE=5]="SUGGESTED_PRICE",I[I.POSSIBLE_COUNTRY=6]="POSSIBLE_COUNTRY",I[I.UPC_EAN_EXTENSION=7]="UPC_EAN_EXTENSION",I[I.PDF417_EXTRA_METADATA=8]="PDF417_EXTRA_METADATA",I[I.STRUCTURED_APPEND_SEQUENCE=9]="STRUCTURED_APPEND_SEQUENCE",I[I.STRUCTURED_APPEND_PARITY=10]="STRUCTURED_APPEND_PARITY"})(Ie||(Ie={}));var Ae=Ie;class Te{constructor(n,s,o,f,l=-1,h=-1){this.rawBytes=n,this.text=s,this.byteSegments=o,this.ecLevel=f,this.structuredAppendSequenceNumber=l,this.structuredAppendParity=h,this.numBits=n==null?0:8*n.length}getRawBytes(){return this.rawBytes}getNumBits(){return this.numBits}setNumBits(n){this.numBits=n}getText(){return this.text}getByteSegments(){return this.byteSegments}getECLevel(){return this.ecLevel}getErrorsCorrected(){return this.errorsCorrected}setErrorsCorrected(n){this.errorsCorrected=n}getErasures(){return this.erasures}setErasures(n){this.erasures=n}getOther(){return this.other}setOther(n){this.other=n}hasStructuredAppend(){return this.structuredAppendParity>=0&&this.structuredAppendSequenceNumber>=0}getStructuredAppendParity(){return this.structuredAppendParity}getStructuredAppendSequenceNumber(){return this.structuredAppendSequenceNumber}}class Se{exp(n){return this.expTable[n]}log(n){if(n===0)throw new v;return this.logTable[n]}static addOrSubtract(n,s){return n^s}}class Ye{constructor(n,s){if(s.length===0)throw new v;this.field=n;const o=s.length;if(o>1&&s[0]===0){let f=1;for(;f<o&&s[f]===0;)f++;f===o?this.coefficients=Int32Array.from([0]):(this.coefficients=new Int32Array(o-f),A.arraycopy(s,f,this.coefficients,0,this.coefficients.length))}else this.coefficients=s}getCoefficients(){return this.coefficients}getDegree(){return this.coefficients.length-1}isZero(){return this.coefficients[0]===0}getCoefficient(n){return this.coefficients[this.coefficients.length-1-n]}evaluateAt(n){if(n===0)return this.getCoefficient(0);const s=this.coefficients;let o;if(n===1){o=0;for(let h=0,x=s.length;h!==x;h++){const p=s[h];o=Se.addOrSubtract(o,p)}return o}o=s[0];const f=s.length,l=this.field;for(let h=1;h<f;h++)o=Se.addOrSubtract(l.multiply(n,o),s[h]);return o}addOrSubtract(n){if(!this.field.equals(n.field))throw new v("GenericGFPolys do not have same GenericGF field");if(this.isZero())return n;if(n.isZero())return this;let s=this.coefficients,o=n.coefficients;if(s.length>o.length){const h=s;s=o,o=h}let f=new Int32Array(o.length);const l=o.length-s.length;A.arraycopy(o,0,f,0,l);for(let h=l;h<o.length;h++)f[h]=Se.addOrSubtract(s[h-l],o[h]);return new Ye(this.field,f)}multiply(n){if(!this.field.equals(n.field))throw new v("GenericGFPolys do not have same GenericGF field");if(this.isZero()||n.isZero())return this.field.getZero();const s=this.coefficients,o=s.length,f=n.coefficients,l=f.length,h=new Int32Array(o+l-1),x=this.field;for(let p=0;p<o;p++){const E=s[p];for(let T=0;T<l;T++)h[p+T]=Se.addOrSubtract(h[p+T],x.multiply(E,f[T]))}return new Ye(x,h)}multiplyScalar(n){if(n===0)return this.field.getZero();if(n===1)return this;const s=this.coefficients.length,o=this.field,f=new Int32Array(s),l=this.coefficients;for(let h=0;h<s;h++)f[h]=o.multiply(l[h],n);return new Ye(o,f)}multiplyByMonomial(n,s){if(n<0)throw new v;if(s===0)return this.field.getZero();const o=this.coefficients,f=o.length,l=new Int32Array(f+n),h=this.field;for(let x=0;x<f;x++)l[x]=h.multiply(o[x],s);return new Ye(h,l)}divide(n){if(!this.field.equals(n.field))throw new v("GenericGFPolys do not have same GenericGF field");if(n.isZero())throw new v("Divide by 0");const s=this.field;let o=s.getZero(),f=this;const l=n.getCoefficient(n.getDegree()),h=s.inverse(l);for(;f.getDegree()>=n.getDegree()&&!f.isZero();){const x=f.getDegree()-n.getDegree(),p=s.multiply(f.getCoefficient(f.getDegree()),h),E=n.multiplyByMonomial(x,p),T=s.buildMonomial(x,p);o=o.addOrSubtract(T),f=f.addOrSubtract(E)}return[o,f]}toString(){let n="";for(let s=this.getDegree();s>=0;s--){let o=this.getCoefficient(s);if(o!==0){if(o<0?(n+=" - ",o=-o):n.length>0&&(n+=" + "),s===0||o!==1){const f=this.field.log(o);f===0?n+="1":f===1?n+="a":(n+="a^",n+=f)}s!==0&&(s===1?n+="x":(n+="x^",n+=s))}}return n}}class K extends m{}K.kind="ArithmeticException";class Xe extends Se{constructor(n,s,o){super(),this.primitive=n,this.size=s,this.generatorBase=o;const f=new Int32Array(s);let l=1;for(let x=0;x<s;x++)f[x]=l,l*=2,l>=s&&(l^=n,l&=s-1);this.expTable=f;const h=new Int32Array(s);for(let x=0;x<s-1;x++)h[f[x]]=x;this.logTable=h,this.zero=new Ye(this,Int32Array.from([0])),this.one=new Ye(this,Int32Array.from([1]))}getZero(){return this.zero}getOne(){return this.one}buildMonomial(n,s){if(n<0)throw new v;if(s===0)return this.zero;const o=new Int32Array(n+1);return o[0]=s,new Ye(this,o)}inverse(n){if(n===0)throw new K;return this.expTable[this.size-this.logTable[n]-1]}multiply(n,s){return n===0||s===0?0:this.expTable[(this.logTable[n]+this.logTable[s])%(this.size-1)]}getSize(){return this.size}getGeneratorBase(){return this.generatorBase}toString(){return"GF(0x"+b.toHexString(this.primitive)+","+this.size+")"}equals(n){return n===this}}Xe.AZTEC_DATA_12=new Xe(4201,4096,1),Xe.AZTEC_DATA_10=new Xe(1033,1024,1),Xe.AZTEC_DATA_6=new Xe(67,64,1),Xe.AZTEC_PARAM=new Xe(19,16,1),Xe.QR_CODE_FIELD_256=new Xe(285,256,0),Xe.DATA_MATRIX_FIELD_256=new Xe(301,256,1),Xe.AZTEC_DATA_8=Xe.DATA_MATRIX_FIELD_256,Xe.MAXICODE_FIELD_64=Xe.AZTEC_DATA_6;class st extends m{}st.kind="ReedSolomonException";class mt extends m{}mt.kind="IllegalStateException";class nt{constructor(n){this.field=n}decode(n,s){const o=this.field,f=new Ye(o,n),l=new Int32Array(s);let h=!0;for(let G=0;G<s;G++){const J=f.evaluateAt(o.exp(G+o.getGeneratorBase()));l[l.length-1-G]=J,J!==0&&(h=!1)}if(h)return;const x=new Ye(o,l),p=this.runEuclideanAlgorithm(o.buildMonomial(s,1),x,s),E=p[0],T=p[1],k=this.findErrorLocations(E),R=this.findErrorMagnitudes(T,k);for(let G=0;G<k.length;G++){const J=n.length-1-o.log(k[G]);if(J<0)throw new st("Bad error location");n[J]=Xe.addOrSubtract(n[J],R[G])}}runEuclideanAlgorithm(n,s,o){if(n.getDegree()<s.getDegree()){const G=n;n=s,s=G}const f=this.field;let l=n,h=s,x=f.getZero(),p=f.getOne();for(;h.getDegree()>=(o/2|0);){let G=l,J=x;if(l=h,x=p,l.isZero())throw new st("r_{i-1} was zero");h=G;let re=f.getZero();const fe=l.getCoefficient(l.getDegree()),pe=f.inverse(fe);for(;h.getDegree()>=l.getDegree()&&!h.isZero();){const Re=h.getDegree()-l.getDegree(),De=f.multiply(h.getCoefficient(h.getDegree()),pe);re=re.addOrSubtract(f.buildMonomial(Re,De)),h=h.addOrSubtract(l.multiplyByMonomial(Re,De))}if(p=re.multiply(x).addOrSubtract(J),h.getDegree()>=l.getDegree())throw new mt("Division algorithm failed to reduce polynomial?")}const E=p.getCoefficient(0);if(E===0)throw new st("sigmaTilde(0) was zero");const T=f.inverse(E),k=p.multiplyScalar(T),R=h.multiplyScalar(T);return[k,R]}findErrorLocations(n){const s=n.getDegree();if(s===1)return Int32Array.from([n.getCoefficient(1)]);const o=new Int32Array(s);let f=0;const l=this.field;for(let h=1;h<l.getSize()&&f<s;h++)n.evaluateAt(h)===0&&(o[f]=l.inverse(h),f++);if(f!==s)throw new st("Error locator degree does not match number of roots");return o}findErrorMagnitudes(n,s){const o=s.length,f=new Int32Array(o),l=this.field;for(let h=0;h<o;h++){const x=l.inverse(s[h]);let p=1;for(let E=0;E<o;E++)if(h!==E){const T=l.multiply(s[E],x),k=(T&1)===0?T|1:T&-2;p=l.multiply(p,k)}f[h]=l.multiply(n.evaluateAt(x),l.inverse(p)),l.getGeneratorBase()!==0&&(f[h]=l.multiply(f[h],x))}return f}}var Ne;(function(I){I[I.UPPER=0]="UPPER",I[I.LOWER=1]="LOWER",I[I.MIXED=2]="MIXED",I[I.DIGIT=3]="DIGIT",I[I.PUNCT=4]="PUNCT",I[I.BINARY=5]="BINARY"})(Ne||(Ne={}));class $e{decode(n){this.ddata=n;let s=n.getBits(),o=this.extractBits(s),f=this.correctBits(o),l=$e.convertBoolArrayToByteArray(f),h=$e.getEncodedData(f),x=new Te(l,h,null,null);return x.setNumBits(f.length),x}static highLevelDecode(n){return this.getEncodedData(n)}static getEncodedData(n){let s=n.length,o=Ne.UPPER,f=Ne.UPPER,l="",h=0;for(;h<s;)if(f===Ne.BINARY){if(s-h<5)break;let x=$e.readCode(n,h,5);if(h+=5,x===0){if(s-h<11)break;x=$e.readCode(n,h,11)+31,h+=11}for(let p=0;p<x;p++){if(s-h<8){h=s;break}const E=$e.readCode(n,h,8);l+=X.castAsNonUtf8Char(E),h+=8}f=o}else{let x=f===Ne.DIGIT?4:5;if(s-h<x)break;let p=$e.readCode(n,h,x);h+=x;let E=$e.getCharacter(f,p);E.startsWith("CTRL_")?(o=f,f=$e.getTable(E.charAt(5)),E.charAt(6)==="L"&&(o=f)):(l+=E,f=o)}return l}static getTable(n){switch(n){case"L":return Ne.LOWER;case"P":return Ne.PUNCT;case"M":return Ne.MIXED;case"D":return Ne.DIGIT;case"B":return Ne.BINARY;case"U":default:return Ne.UPPER}}static getCharacter(n,s){switch(n){case Ne.UPPER:return $e.UPPER_TABLE[s];case Ne.LOWER:return $e.LOWER_TABLE[s];case Ne.MIXED:return $e.MIXED_TABLE[s];case Ne.PUNCT:return $e.PUNCT_TABLE[s];case Ne.DIGIT:return $e.DIGIT_TABLE[s];default:throw new mt("Bad table")}}correctBits(n){let s,o;this.ddata.getNbLayers()<=2?(o=6,s=Xe.AZTEC_DATA_6):this.ddata.getNbLayers()<=8?(o=8,s=Xe.AZTEC_DATA_8):this.ddata.getNbLayers()<=22?(o=10,s=Xe.AZTEC_DATA_10):(o=12,s=Xe.AZTEC_DATA_12);let f=this.ddata.getNbDatablocks(),l=n.length/o;if(l<f)throw new N;let h=n.length%o,x=new Int32Array(l);for(let R=0;R<l;R++,h+=o)x[R]=$e.readCode(n,h,o);try{new nt(s).decode(x,l-f)}catch(R){throw new N(R)}let p=(1<<o)-1,E=0;for(let R=0;R<f;R++){let G=x[R];if(G===0||G===p)throw new N;(G===1||G===p-1)&&E++}let T=new Array(f*o-E),k=0;for(let R=0;R<f;R++){let G=x[R];if(G===1||G===p-1)T.fill(G>1,k,k+o-1),k+=o-1;else for(let J=o-1;J>=0;--J)T[k++]=(G&1<<J)!==0}return T}extractBits(n){let s=this.ddata.isCompact(),o=this.ddata.getNbLayers(),f=(s?11:14)+o*4,l=new Int32Array(f),h=new Array(this.totalBitsInLayer(o,s));if(s)for(let x=0;x<l.length;x++)l[x]=x;else{let x=f+1+2*b.truncDivision(b.truncDivision(f,2)-1,15),p=f/2,E=b.truncDivision(x,2);for(let T=0;T<p;T++){let k=T+b.truncDivision(T,15);l[p-T-1]=E-k-1,l[p+T]=E+k+1}}for(let x=0,p=0;x<o;x++){let E=(o-x)*4+(s?9:12),T=x*2,k=f-1-T;for(let R=0;R<E;R++){let G=R*2;for(let J=0;J<2;J++)h[p+G+J]=n.get(l[T+J],l[T+R]),h[p+2*E+G+J]=n.get(l[T+R],l[k-J]),h[p+4*E+G+J]=n.get(l[k-J],l[k-R]),h[p+6*E+G+J]=n.get(l[k-R],l[T+J])}p+=E*8}return h}static readCode(n,s,o){let f=0;for(let l=s;l<s+o;l++)f<<=1,n[l]&&(f|=1);return f}static readByte(n,s){let o=n.length-s;return o>=8?$e.readCode(n,s,8):$e.readCode(n,s,o)<<8-o}static convertBoolArrayToByteArray(n){let s=new Uint8Array((n.length+7)/8);for(let o=0;o<s.length;o++)s[o]=$e.readByte(n,8*o);return s}totalBitsInLayer(n,s){return((s?88:112)+16*n)*n}}$e.UPPER_TABLE=["CTRL_PS"," ","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","CTRL_LL","CTRL_ML","CTRL_DL","CTRL_BS"],$e.LOWER_TABLE=["CTRL_PS"," ","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","CTRL_US","CTRL_ML","CTRL_DL","CTRL_BS"],$e.MIXED_TABLE=["CTRL_PS"," ","\\1","\\2","\\3","\\4","\\5","\\6","\\7","\b","	",`
`,"\\13","\f","\r","\\33","\\34","\\35","\\36","\\37","@","\\","^","_","`","|","~","\\177","CTRL_LL","CTRL_UL","CTRL_PL","CTRL_BS"],$e.PUNCT_TABLE=["","\r",`\r
`,". ",", ",": ","!",'"',"#","$","%","&","'","(",")","*","+",",","-",".","/",":",";","<","=",">","?","[","]","{","}","CTRL_UL"],$e.DIGIT_TABLE=["CTRL_PS"," ","0","1","2","3","4","5","6","7","8","9",",",".","CTRL_UL","CTRL_US"];class rt{constructor(){}static round(n){return n===NaN?0:n<=Number.MIN_SAFE_INTEGER?Number.MIN_SAFE_INTEGER:n>=Number.MAX_SAFE_INTEGER?Number.MAX_SAFE_INTEGER:n+(n<0?-.5:.5)|0}static distance(n,s,o,f){const l=n-o,h=s-f;return Math.sqrt(l*l+h*h)}static sum(n){let s=0;for(let o=0,f=n.length;o!==f;o++){const l=n[o];s+=l}return s}}class Dr{static floatToIntBits(n){return n}}Dr.MAX_VALUE=Number.MAX_SAFE_INTEGER;class Ve{constructor(n,s){this.x=n,this.y=s}getX(){return this.x}getY(){return this.y}equals(n){if(n instanceof Ve){const s=n;return this.x===s.x&&this.y===s.y}return!1}hashCode(){return 31*Dr.floatToIntBits(this.x)+Dr.floatToIntBits(this.y)}toString(){return"("+this.x+","+this.y+")"}static orderBestPatterns(n){const s=this.distance(n[0],n[1]),o=this.distance(n[1],n[2]),f=this.distance(n[0],n[2]);let l,h,x;if(o>=s&&o>=f?(h=n[0],l=n[1],x=n[2]):f>=o&&f>=s?(h=n[1],l=n[0],x=n[2]):(h=n[2],l=n[0],x=n[1]),this.crossProductZ(l,h,x)<0){const p=l;l=x,x=p}n[0]=l,n[1]=h,n[2]=x}static distance(n,s){return rt.distance(n.x,n.y,s.x,s.y)}static crossProductZ(n,s,o){const f=s.x,l=s.y;return(o.x-f)*(n.y-l)-(o.y-l)*(n.x-f)}}class Tn{constructor(n,s){this.bits=n,this.points=s}getBits(){return this.bits}getPoints(){return this.points}}class mn extends Tn{constructor(n,s,o,f,l){super(n,s),this.compact=o,this.nbDatablocks=f,this.nbLayers=l}getNbLayers(){return this.nbLayers}getNbDatablocks(){return this.nbDatablocks}isCompact(){return this.compact}}class Xt{constructor(n,s,o,f){this.image=n,this.height=n.getHeight(),this.width=n.getWidth(),s==null&&(s=Xt.INIT_SIZE),o==null&&(o=n.getWidth()/2|0),f==null&&(f=n.getHeight()/2|0);const l=s/2|0;if(this.leftInit=o-l,this.rightInit=o+l,this.upInit=f-l,this.downInit=f+l,this.upInit<0||this.leftInit<0||this.downInit>=this.height||this.rightInit>=this.width)throw new q}detect(){let n=this.leftInit,s=this.rightInit,o=this.upInit,f=this.downInit,l=!1,h=!0,x=!1,p=!1,E=!1,T=!1,k=!1;const R=this.width,G=this.height;for(;h;){h=!1;let J=!0;for(;(J||!p)&&s<R;)J=this.containsBlackPoint(o,f,s,!1),J?(s++,h=!0,p=!0):p||s++;if(s>=R){l=!0;break}let re=!0;for(;(re||!E)&&f<G;)re=this.containsBlackPoint(n,s,f,!0),re?(f++,h=!0,E=!0):E||f++;if(f>=G){l=!0;break}let fe=!0;for(;(fe||!T)&&n>=0;)fe=this.containsBlackPoint(o,f,n,!1),fe?(n--,h=!0,T=!0):T||n--;if(n<0){l=!0;break}let pe=!0;for(;(pe||!k)&&o>=0;)pe=this.containsBlackPoint(n,s,o,!0),pe?(o--,h=!0,k=!0):k||o--;if(o<0){l=!0;break}h&&(x=!0)}if(!l&&x){const J=s-n;let re=null;for(let De=1;re===null&&De<J;De++)re=this.getBlackPointOnSegment(n,f-De,n+De,f);if(re==null)throw new q;let fe=null;for(let De=1;fe===null&&De<J;De++)fe=this.getBlackPointOnSegment(n,o+De,n+De,o);if(fe==null)throw new q;let pe=null;for(let De=1;pe===null&&De<J;De++)pe=this.getBlackPointOnSegment(s,o+De,s-De,o);if(pe==null)throw new q;let Re=null;for(let De=1;Re===null&&De<J;De++)Re=this.getBlackPointOnSegment(s,f-De,s-De,f);if(Re==null)throw new q;return this.centerEdges(Re,re,pe,fe)}else throw new q}getBlackPointOnSegment(n,s,o,f){const l=rt.round(rt.distance(n,s,o,f)),h=(o-n)/l,x=(f-s)/l,p=this.image;for(let E=0;E<l;E++){const T=rt.round(n+E*h),k=rt.round(s+E*x);if(p.get(T,k))return new Ve(T,k)}return null}centerEdges(n,s,o,f){const l=n.getX(),h=n.getY(),x=s.getX(),p=s.getY(),E=o.getX(),T=o.getY(),k=f.getX(),R=f.getY(),G=Xt.CORR;return l<this.width/2?[new Ve(k-G,R+G),new Ve(x+G,p+G),new Ve(E-G,T-G),new Ve(l+G,h-G)]:[new Ve(k+G,R+G),new Ve(x+G,p-G),new Ve(E-G,T+G),new Ve(l-G,h-G)]}containsBlackPoint(n,s,o,f){const l=this.image;if(f){for(let h=n;h<=s;h++)if(l.get(h,o))return!0}else for(let h=n;h<=s;h++)if(l.get(o,h))return!0;return!1}}Xt.INIT_SIZE=10,Xt.CORR=1;class zr{static checkAndNudgePoints(n,s){const o=n.getWidth(),f=n.getHeight();let l=!0;for(let h=0;h<s.length&&l;h+=2){const x=Math.floor(s[h]),p=Math.floor(s[h+1]);if(x<-1||x>o||p<-1||p>f)throw new q;l=!1,x===-1?(s[h]=0,l=!0):x===o&&(s[h]=o-1,l=!0),p===-1?(s[h+1]=0,l=!0):p===f&&(s[h+1]=f-1,l=!0)}l=!0;for(let h=s.length-2;h>=0&&l;h-=2){const x=Math.floor(s[h]),p=Math.floor(s[h+1]);if(x<-1||x>o||p<-1||p>f)throw new q;l=!1,x===-1?(s[h]=0,l=!0):x===o&&(s[h]=o-1,l=!0),p===-1?(s[h+1]=0,l=!0):p===f&&(s[h+1]=f-1,l=!0)}}}class ar{constructor(n,s,o,f,l,h,x,p,E){this.a11=n,this.a21=s,this.a31=o,this.a12=f,this.a22=l,this.a32=h,this.a13=x,this.a23=p,this.a33=E}static quadrilateralToQuadrilateral(n,s,o,f,l,h,x,p,E,T,k,R,G,J,re,fe){const pe=ar.quadrilateralToSquare(n,s,o,f,l,h,x,p);return ar.squareToQuadrilateral(E,T,k,R,G,J,re,fe).times(pe)}transformPoints(n){const s=n.length,o=this.a11,f=this.a12,l=this.a13,h=this.a21,x=this.a22,p=this.a23,E=this.a31,T=this.a32,k=this.a33;for(let R=0;R<s;R+=2){const G=n[R],J=n[R+1],re=l*G+p*J+k;n[R]=(o*G+h*J+E)/re,n[R+1]=(f*G+x*J+T)/re}}transformPointsWithValues(n,s){const o=this.a11,f=this.a12,l=this.a13,h=this.a21,x=this.a22,p=this.a23,E=this.a31,T=this.a32,k=this.a33,R=n.length;for(let G=0;G<R;G++){const J=n[G],re=s[G],fe=l*J+p*re+k;n[G]=(o*J+h*re+E)/fe,s[G]=(f*J+x*re+T)/fe}}static squareToQuadrilateral(n,s,o,f,l,h,x,p){const E=n-o+l-x,T=s-f+h-p;if(E===0&&T===0)return new ar(o-n,l-o,n,f-s,h-f,s,0,0,1);{const k=o-l,R=x-l,G=f-h,J=p-h,re=k*J-R*G,fe=(E*J-R*T)/re,pe=(k*T-E*G)/re;return new ar(o-n+fe*o,x-n+pe*x,n,f-s+fe*f,p-s+pe*p,s,fe,pe,1)}}static quadrilateralToSquare(n,s,o,f,l,h,x,p){return ar.squareToQuadrilateral(n,s,o,f,l,h,x,p).buildAdjoint()}buildAdjoint(){return new ar(this.a22*this.a33-this.a23*this.a32,this.a23*this.a31-this.a21*this.a33,this.a21*this.a32-this.a22*this.a31,this.a13*this.a32-this.a12*this.a33,this.a11*this.a33-this.a13*this.a31,this.a12*this.a31-this.a11*this.a32,this.a12*this.a23-this.a13*this.a22,this.a13*this.a21-this.a11*this.a23,this.a11*this.a22-this.a12*this.a21)}times(n){return new ar(this.a11*n.a11+this.a21*n.a12+this.a31*n.a13,this.a11*n.a21+this.a21*n.a22+this.a31*n.a23,this.a11*n.a31+this.a21*n.a32+this.a31*n.a33,this.a12*n.a11+this.a22*n.a12+this.a32*n.a13,this.a12*n.a21+this.a22*n.a22+this.a32*n.a23,this.a12*n.a31+this.a22*n.a32+this.a32*n.a33,this.a13*n.a11+this.a23*n.a12+this.a33*n.a13,this.a13*n.a21+this.a23*n.a22+this.a33*n.a23,this.a13*n.a31+this.a23*n.a32+this.a33*n.a33)}}class Yn extends zr{sampleGrid(n,s,o,f,l,h,x,p,E,T,k,R,G,J,re,fe,pe,Re,De){const ke=ar.quadrilateralToQuadrilateral(f,l,h,x,p,E,T,k,R,G,J,re,fe,pe,Re,De);return this.sampleGridWithTransform(n,s,o,ke)}sampleGridWithTransform(n,s,o,f){if(s<=0||o<=0)throw new q;const l=new Ee(s,o),h=new Float32Array(2*s);for(let x=0;x<o;x++){const p=h.length,E=x+.5;for(let T=0;T<p;T+=2)h[T]=T/2+.5,h[T+1]=E;f.transformPoints(h),zr.checkAndNudgePoints(n,h);try{for(let T=0;T<p;T+=2)n.get(Math.floor(h[T]),Math.floor(h[T+1]))&&l.set(T/2,x)}catch{throw new q}}return l}}class Ht{static setGridSampler(n){Ht.gridSampler=n}static getInstance(){return Ht.gridSampler}}Ht.gridSampler=new Yn;class Ot{constructor(n,s){this.x=n,this.y=s}toResultPoint(){return new Ve(this.getX(),this.getY())}getX(){return this.x}getY(){return this.y}}class ot{constructor(n){this.EXPECTED_CORNER_BITS=new Int32Array([3808,476,2107,1799]),this.image=n}detect(){return this.detectMirror(!1)}detectMirror(n){let s=this.getMatrixCenter(),o=this.getBullsEyeCorners(s);if(n){let h=o[0];o[0]=o[2],o[2]=h}this.extractParameters(o);let f=this.sampleGrid(this.image,o[this.shift%4],o[(this.shift+1)%4],o[(this.shift+2)%4],o[(this.shift+3)%4]),l=this.getMatrixCornerPoints(o);return new mn(f,l,this.compact,this.nbDataBlocks,this.nbLayers)}extractParameters(n){if(!this.isValidPoint(n[0])||!this.isValidPoint(n[1])||!this.isValidPoint(n[2])||!this.isValidPoint(n[3]))throw new q;let s=2*this.nbCenterLayers,o=new Int32Array([this.sampleLine(n[0],n[1],s),this.sampleLine(n[1],n[2],s),this.sampleLine(n[2],n[3],s),this.sampleLine(n[3],n[0],s)]);this.shift=this.getRotation(o,s);let f=0;for(let h=0;h<4;h++){let x=o[(this.shift+h)%4];this.compact?(f<<=7,f+=x>>1&127):(f<<=10,f+=(x>>2&992)+(x>>1&31))}let l=this.getCorrectedParameterData(f,this.compact);this.compact?(this.nbLayers=(l>>6)+1,this.nbDataBlocks=(l&63)+1):(this.nbLayers=(l>>11)+1,this.nbDataBlocks=(l&2047)+1)}getRotation(n,s){let o=0;n.forEach((f,l,h)=>{let x=(f>>s-2<<1)+(f&1);o=(o<<3)+x}),o=((o&1)<<11)+(o>>1);for(let f=0;f<4;f++)if(b.bitCount(o^this.EXPECTED_CORNER_BITS[f])<=2)return f;throw new q}getCorrectedParameterData(n,s){let o,f;s?(o=7,f=2):(o=10,f=4);let l=o-f,h=new Int32Array(o);for(let p=o-1;p>=0;--p)h[p]=n&15,n>>=4;try{new nt(Xe.AZTEC_PARAM).decode(h,l)}catch{throw new q}let x=0;for(let p=0;p<f;p++)x=(x<<4)+h[p];return x}getBullsEyeCorners(n){let s=n,o=n,f=n,l=n,h=!0;for(this.nbCenterLayers=1;this.nbCenterLayers<9;this.nbCenterLayers++){let k=this.getFirstDifferent(s,h,1,-1),R=this.getFirstDifferent(o,h,1,1),G=this.getFirstDifferent(f,h,-1,1),J=this.getFirstDifferent(l,h,-1,-1);if(this.nbCenterLayers>2){let re=this.distancePoint(J,k)*this.nbCenterLayers/(this.distancePoint(l,s)*(this.nbCenterLayers+2));if(re<.75||re>1.25||!this.isWhiteOrBlackRectangle(k,R,G,J))break}s=k,o=R,f=G,l=J,h=!h}if(this.nbCenterLayers!==5&&this.nbCenterLayers!==7)throw new q;this.compact=this.nbCenterLayers===5;let x=new Ve(s.getX()+.5,s.getY()-.5),p=new Ve(o.getX()+.5,o.getY()+.5),E=new Ve(f.getX()-.5,f.getY()+.5),T=new Ve(l.getX()-.5,l.getY()-.5);return this.expandSquare([x,p,E,T],2*this.nbCenterLayers-3,2*this.nbCenterLayers)}getMatrixCenter(){let n,s,o,f;try{let x=new Xt(this.image).detect();n=x[0],s=x[1],o=x[2],f=x[3]}catch{let p=this.image.getWidth()/2,E=this.image.getHeight()/2;n=this.getFirstDifferent(new Ot(p+7,E-7),!1,1,-1).toResultPoint(),s=this.getFirstDifferent(new Ot(p+7,E+7),!1,1,1).toResultPoint(),o=this.getFirstDifferent(new Ot(p-7,E+7),!1,-1,1).toResultPoint(),f=this.getFirstDifferent(new Ot(p-7,E-7),!1,-1,-1).toResultPoint()}let l=rt.round((n.getX()+f.getX()+s.getX()+o.getX())/4),h=rt.round((n.getY()+f.getY()+s.getY()+o.getY())/4);try{let x=new Xt(this.image,15,l,h).detect();n=x[0],s=x[1],o=x[2],f=x[3]}catch{n=this.getFirstDifferent(new Ot(l+7,h-7),!1,1,-1).toResultPoint(),s=this.getFirstDifferent(new Ot(l+7,h+7),!1,1,1).toResultPoint(),o=this.getFirstDifferent(new Ot(l-7,h+7),!1,-1,1).toResultPoint(),f=this.getFirstDifferent(new Ot(l-7,h-7),!1,-1,-1).toResultPoint()}return l=rt.round((n.getX()+f.getX()+s.getX()+o.getX())/4),h=rt.round((n.getY()+f.getY()+s.getY()+o.getY())/4),new Ot(l,h)}getMatrixCornerPoints(n){return this.expandSquare(n,2*this.nbCenterLayers,this.getDimension())}sampleGrid(n,s,o,f,l){let h=Ht.getInstance(),x=this.getDimension(),p=x/2-this.nbCenterLayers,E=x/2+this.nbCenterLayers;return h.sampleGrid(n,x,x,p,p,E,p,E,E,p,E,s.getX(),s.getY(),o.getX(),o.getY(),f.getX(),f.getY(),l.getX(),l.getY())}sampleLine(n,s,o){let f=0,l=this.distanceResultPoint(n,s),h=l/o,x=n.getX(),p=n.getY(),E=h*(s.getX()-n.getX())/l,T=h*(s.getY()-n.getY())/l;for(let k=0;k<o;k++)this.image.get(rt.round(x+k*E),rt.round(p+k*T))&&(f|=1<<o-k-1);return f}isWhiteOrBlackRectangle(n,s,o,f){let l=3;n=new Ot(n.getX()-l,n.getY()+l),s=new Ot(s.getX()-l,s.getY()-l),o=new Ot(o.getX()+l,o.getY()-l),f=new Ot(f.getX()+l,f.getY()+l);let h=this.getColor(f,n);if(h===0)return!1;let x=this.getColor(n,s);return x!==h||(x=this.getColor(s,o),x!==h)?!1:(x=this.getColor(o,f),x===h)}getColor(n,s){let o=this.distancePoint(n,s),f=(s.getX()-n.getX())/o,l=(s.getY()-n.getY())/o,h=0,x=n.getX(),p=n.getY(),E=this.image.get(n.getX(),n.getY()),T=Math.ceil(o);for(let R=0;R<T;R++)x+=f,p+=l,this.image.get(rt.round(x),rt.round(p))!==E&&h++;let k=h/o;return k>.1&&k<.9?0:k<=.1===E?1:-1}getFirstDifferent(n,s,o,f){let l=n.getX()+o,h=n.getY()+f;for(;this.isValid(l,h)&&this.image.get(l,h)===s;)l+=o,h+=f;for(l-=o,h-=f;this.isValid(l,h)&&this.image.get(l,h)===s;)l+=o;for(l-=o;this.isValid(l,h)&&this.image.get(l,h)===s;)h+=f;return h-=f,new Ot(l,h)}expandSquare(n,s,o){let f=o/(2*s),l=n[0].getX()-n[2].getX(),h=n[0].getY()-n[2].getY(),x=(n[0].getX()+n[2].getX())/2,p=(n[0].getY()+n[2].getY())/2,E=new Ve(x+f*l,p+f*h),T=new Ve(x-f*l,p-f*h);l=n[1].getX()-n[3].getX(),h=n[1].getY()-n[3].getY(),x=(n[1].getX()+n[3].getX())/2,p=(n[1].getY()+n[3].getY())/2;let k=new Ve(x+f*l,p+f*h),R=new Ve(x-f*l,p-f*h);return[E,k,T,R]}isValid(n,s){return n>=0&&n<this.image.getWidth()&&s>0&&s<this.image.getHeight()}isValidPoint(n){let s=rt.round(n.getX()),o=rt.round(n.getY());return this.isValid(s,o)}distancePoint(n,s){return rt.distance(n.getX(),n.getY(),s.getX(),s.getY())}distanceResultPoint(n,s){return rt.distance(n.getX(),n.getY(),s.getX(),s.getY())}getDimension(){return this.compact?4*this.nbLayers+11:this.nbLayers<=4?4*this.nbLayers+15:4*this.nbLayers+2*(b.truncDivision(this.nbLayers-4,8)+1)+15}}class Dt{decode(n,s=null){let o=null,f=new ot(n.getBlackMatrix()),l=null,h=null;try{let T=f.detectMirror(!1);l=T.getPoints(),this.reportFoundResultPoints(s,l),h=new $e().decode(T)}catch(T){o=T}if(h==null)try{let T=f.detectMirror(!0);l=T.getPoints(),this.reportFoundResultPoints(s,l),h=new $e().decode(T)}catch(T){throw o??T}let x=new Z(h.getText(),h.getRawBytes(),h.getNumBits(),l,oe.AZTEC,A.currentTimeMillis()),p=h.getByteSegments();p!=null&&x.putMetadata(Ae.BYTE_SEGMENTS,p);let E=h.getECLevel();return E!=null&&x.putMetadata(Ae.ERROR_CORRECTION_LEVEL,E),x}reportFoundResultPoints(n,s){if(n!=null){let o=n.get(W.NEED_RESULT_POINT_CALLBACK);o!=null&&s.forEach((f,l,h)=>{o.foundPossibleResultPoint(f)})}}reset(){}}class Lr extends ne{constructor(n=500){super(new Dt,n)}}class ft{decode(n,s){try{return this.doDecode(n,s)}catch{if(s&&s.get(W.TRY_HARDER)===!0&&n.isRotateSupported()){const l=n.rotateCounterClockwise(),h=this.doDecode(l,s),x=h.getResultMetadata();let p=270;x!==null&&x.get(Ae.ORIENTATION)===!0&&(p=p+x.get(Ae.ORIENTATION)%360),h.putMetadata(Ae.ORIENTATION,p);const E=h.getResultPoints();if(E!==null){const T=l.getHeight();for(let k=0;k<E.length;k++)E[k]=new Ve(T-E[k].getY()-1,E[k].getX())}return h}else throw new q}}reset(){}doDecode(n,s){const o=n.getWidth(),f=n.getHeight();let l=new V(o);const h=s&&s.get(W.TRY_HARDER)===!0,x=Math.max(1,f>>(h?8:5));let p;h?p=f:p=15;const E=Math.trunc(f/2);for(let T=0;T<p;T++){const k=Math.trunc((T+1)/2),R=(T&1)===0,G=E+x*(R?k:-k);if(G<0||G>=f)break;try{l=n.getBlackRow(G,l)}catch{continue}for(let J=0;J<2;J++){if(J===1&&(l.reverse(),s&&s.get(W.NEED_RESULT_POINT_CALLBACK)===!0)){const re=new Map;s.forEach((fe,pe)=>re.set(pe,fe)),re.delete(W.NEED_RESULT_POINT_CALLBACK),s=re}try{const re=this.decodeRow(G,l,s);if(J===1){re.putMetadata(Ae.ORIENTATION,180);const fe=re.getResultPoints();fe!==null&&(fe[0]=new Ve(o-fe[0].getX()-1,fe[0].getY()),fe[1]=new Ve(o-fe[1].getX()-1,fe[1].getY()))}return re}catch{}}}throw new q}static recordPattern(n,s,o){const f=o.length;for(let E=0;E<f;E++)o[E]=0;const l=n.getSize();if(s>=l)throw new q;let h=!n.get(s),x=0,p=s;for(;p<l;){if(n.get(p)!==h)o[x]++;else{if(++x===f)break;o[x]=1,h=!h}p++}if(!(x===f||x===f-1&&p===l))throw new q}static recordPatternInReverse(n,s,o){let f=o.length,l=n.get(s);for(;s>0&&f>=0;)n.get(--s)!==l&&(f--,l=!l);if(f>=0)throw new q;ft.recordPattern(n,s+1,o)}static patternMatchVariance(n,s,o){const f=n.length;let l=0,h=0;for(let E=0;E<f;E++)l+=n[E],h+=s[E];if(l<h)return Number.POSITIVE_INFINITY;const x=l/h;o*=x;let p=0;for(let E=0;E<f;E++){const T=n[E],k=s[E]*x,R=T>k?T-k:k-T;if(R>o)return Number.POSITIVE_INFINITY;p+=R}return p/l}}class Be extends ft{static findStartPattern(n){const s=n.getSize(),o=n.getNextSet(0);let f=0,l=Int32Array.from([0,0,0,0,0,0]),h=o,x=!1;const p=6;for(let E=o;E<s;E++)if(n.get(E)!==x)l[f]++;else{if(f===p-1){let T=Be.MAX_AVG_VARIANCE,k=-1;for(let R=Be.CODE_START_A;R<=Be.CODE_START_C;R++){const G=ft.patternMatchVariance(l,Be.CODE_PATTERNS[R],Be.MAX_INDIVIDUAL_VARIANCE);G<T&&(T=G,k=R)}if(k>=0&&n.isRange(Math.max(0,h-(E-h)/2),h,!1))return Int32Array.from([h,E,k]);h+=l[0]+l[1],l=l.slice(2,l.length-1),l[f-1]=0,l[f]=0,f--}else f++;l[f]=1,x=!x}throw new q}static decodeCode(n,s,o){ft.recordPattern(n,o,s);let f=Be.MAX_AVG_VARIANCE,l=-1;for(let h=0;h<Be.CODE_PATTERNS.length;h++){const x=Be.CODE_PATTERNS[h],p=this.patternMatchVariance(s,x,Be.MAX_INDIVIDUAL_VARIANCE);p<f&&(f=p,l=h)}if(l>=0)return l;throw new q}decodeRow(n,s,o){const f=o&&o.get(W.ASSUME_GS1)===!0,l=Be.findStartPattern(s),h=l[2];let x=0;const p=new Uint8Array(20);p[x++]=h;let E;switch(h){case Be.CODE_START_A:E=Be.CODE_CODE_A;break;case Be.CODE_START_B:E=Be.CODE_CODE_B;break;case Be.CODE_START_C:E=Be.CODE_CODE_C;break;default:throw new N}let T=!1,k=!1,R="",G=l[0],J=l[1];const re=Int32Array.from([0,0,0,0,0,0]);let fe=0,pe=0,Re=h,De=0,ke=!0,Et=!1,at=!1;for(;!T;){const Ga=k;switch(k=!1,fe=pe,pe=Be.decodeCode(s,re,J),p[x++]=pe,pe!==Be.CODE_STOP&&(ke=!0),pe!==Be.CODE_STOP&&(De++,Re+=De*pe),G=J,J+=re.reduce((th,rh)=>th+rh,0),pe){case Be.CODE_START_A:case Be.CODE_START_B:case Be.CODE_START_C:throw new N}switch(E){case Be.CODE_CODE_A:if(pe<64)at===Et?R+=String.fromCharCode(32+pe):R+=String.fromCharCode(32+pe+128),at=!1;else if(pe<96)at===Et?R+=String.fromCharCode(pe-64):R+=String.fromCharCode(pe+64),at=!1;else switch(pe!==Be.CODE_STOP&&(ke=!1),pe){case Be.CODE_FNC_1:f&&(R.length===0?R+="]C1":R+="");break;case Be.CODE_FNC_2:case Be.CODE_FNC_3:break;case Be.CODE_FNC_4_A:!Et&&at?(Et=!0,at=!1):Et&&at?(Et=!1,at=!1):at=!0;break;case Be.CODE_SHIFT:k=!0,E=Be.CODE_CODE_B;break;case Be.CODE_CODE_B:E=Be.CODE_CODE_B;break;case Be.CODE_CODE_C:E=Be.CODE_CODE_C;break;case Be.CODE_STOP:T=!0;break}break;case Be.CODE_CODE_B:if(pe<96)at===Et?R+=String.fromCharCode(32+pe):R+=String.fromCharCode(32+pe+128),at=!1;else switch(pe!==Be.CODE_STOP&&(ke=!1),pe){case Be.CODE_FNC_1:f&&(R.length===0?R+="]C1":R+="");break;case Be.CODE_FNC_2:case Be.CODE_FNC_3:break;case Be.CODE_FNC_4_B:!Et&&at?(Et=!0,at=!1):Et&&at?(Et=!1,at=!1):at=!0;break;case Be.CODE_SHIFT:k=!0,E=Be.CODE_CODE_A;break;case Be.CODE_CODE_A:E=Be.CODE_CODE_A;break;case Be.CODE_CODE_C:E=Be.CODE_CODE_C;break;case Be.CODE_STOP:T=!0;break}break;case Be.CODE_CODE_C:if(pe<100)pe<10&&(R+="0"),R+=pe;else switch(pe!==Be.CODE_STOP&&(ke=!1),pe){case Be.CODE_FNC_1:f&&(R.length===0?R+="]C1":R+="");break;case Be.CODE_CODE_A:E=Be.CODE_CODE_A;break;case Be.CODE_CODE_B:E=Be.CODE_CODE_B;break;case Be.CODE_STOP:T=!0;break}break}Ga&&(E=E===Be.CODE_CODE_A?Be.CODE_CODE_B:Be.CODE_CODE_A)}const Wr=J-G;if(J=s.getNextUnset(J),!s.isRange(J,Math.min(s.getSize(),J+(J-G)/2),!1))throw new q;if(Re-=De*fe,Re%103!==fe)throw new C;const wn=R.length;if(wn===0)throw new q;wn>0&&ke&&(E===Be.CODE_CODE_C?R=R.substring(0,wn-2):R=R.substring(0,wn-1));const Vr=(l[1]+l[0])/2,Rt=G+Wr/2,vr=p.length,jr=new Uint8Array(vr);for(let Ga=0;Ga<vr;Ga++)jr[Ga]=p[Ga];const Ha=[new Ve(Vr,n),new Ve(Rt,n)];return new Z(R,jr,0,Ha,oe.CODE_128,new Date().getTime())}}Be.CODE_PATTERNS=[Int32Array.from([2,1,2,2,2,2]),Int32Array.from([2,2,2,1,2,2]),Int32Array.from([2,2,2,2,2,1]),Int32Array.from([1,2,1,2,2,3]),Int32Array.from([1,2,1,3,2,2]),Int32Array.from([1,3,1,2,2,2]),Int32Array.from([1,2,2,2,1,3]),Int32Array.from([1,2,2,3,1,2]),Int32Array.from([1,3,2,2,1,2]),Int32Array.from([2,2,1,2,1,3]),Int32Array.from([2,2,1,3,1,2]),Int32Array.from([2,3,1,2,1,2]),Int32Array.from([1,1,2,2,3,2]),Int32Array.from([1,2,2,1,3,2]),Int32Array.from([1,2,2,2,3,1]),Int32Array.from([1,1,3,2,2,2]),Int32Array.from([1,2,3,1,2,2]),Int32Array.from([1,2,3,2,2,1]),Int32Array.from([2,2,3,2,1,1]),Int32Array.from([2,2,1,1,3,2]),Int32Array.from([2,2,1,2,3,1]),Int32Array.from([2,1,3,2,1,2]),Int32Array.from([2,2,3,1,1,2]),Int32Array.from([3,1,2,1,3,1]),Int32Array.from([3,1,1,2,2,2]),Int32Array.from([3,2,1,1,2,2]),Int32Array.from([3,2,1,2,2,1]),Int32Array.from([3,1,2,2,1,2]),Int32Array.from([3,2,2,1,1,2]),Int32Array.from([3,2,2,2,1,1]),Int32Array.from([2,1,2,1,2,3]),Int32Array.from([2,1,2,3,2,1]),Int32Array.from([2,3,2,1,2,1]),Int32Array.from([1,1,1,3,2,3]),Int32Array.from([1,3,1,1,2,3]),Int32Array.from([1,3,1,3,2,1]),Int32Array.from([1,1,2,3,1,3]),Int32Array.from([1,3,2,1,1,3]),Int32Array.from([1,3,2,3,1,1]),Int32Array.from([2,1,1,3,1,3]),Int32Array.from([2,3,1,1,1,3]),Int32Array.from([2,3,1,3,1,1]),Int32Array.from([1,1,2,1,3,3]),Int32Array.from([1,1,2,3,3,1]),Int32Array.from([1,3,2,1,3,1]),Int32Array.from([1,1,3,1,2,3]),Int32Array.from([1,1,3,3,2,1]),Int32Array.from([1,3,3,1,2,1]),Int32Array.from([3,1,3,1,2,1]),Int32Array.from([2,1,1,3,3,1]),Int32Array.from([2,3,1,1,3,1]),Int32Array.from([2,1,3,1,1,3]),Int32Array.from([2,1,3,3,1,1]),Int32Array.from([2,1,3,1,3,1]),Int32Array.from([3,1,1,1,2,3]),Int32Array.from([3,1,1,3,2,1]),Int32Array.from([3,3,1,1,2,1]),Int32Array.from([3,1,2,1,1,3]),Int32Array.from([3,1,2,3,1,1]),Int32Array.from([3,3,2,1,1,1]),Int32Array.from([3,1,4,1,1,1]),Int32Array.from([2,2,1,4,1,1]),Int32Array.from([4,3,1,1,1,1]),Int32Array.from([1,1,1,2,2,4]),Int32Array.from([1,1,1,4,2,2]),Int32Array.from([1,2,1,1,2,4]),Int32Array.from([1,2,1,4,2,1]),Int32Array.from([1,4,1,1,2,2]),Int32Array.from([1,4,1,2,2,1]),Int32Array.from([1,1,2,2,1,4]),Int32Array.from([1,1,2,4,1,2]),Int32Array.from([1,2,2,1,1,4]),Int32Array.from([1,2,2,4,1,1]),Int32Array.from([1,4,2,1,1,2]),Int32Array.from([1,4,2,2,1,1]),Int32Array.from([2,4,1,2,1,1]),Int32Array.from([2,2,1,1,1,4]),Int32Array.from([4,1,3,1,1,1]),Int32Array.from([2,4,1,1,1,2]),Int32Array.from([1,3,4,1,1,1]),Int32Array.from([1,1,1,2,4,2]),Int32Array.from([1,2,1,1,4,2]),Int32Array.from([1,2,1,2,4,1]),Int32Array.from([1,1,4,2,1,2]),Int32Array.from([1,2,4,1,1,2]),Int32Array.from([1,2,4,2,1,1]),Int32Array.from([4,1,1,2,1,2]),Int32Array.from([4,2,1,1,1,2]),Int32Array.from([4,2,1,2,1,1]),Int32Array.from([2,1,2,1,4,1]),Int32Array.from([2,1,4,1,2,1]),Int32Array.from([4,1,2,1,2,1]),Int32Array.from([1,1,1,1,4,3]),Int32Array.from([1,1,1,3,4,1]),Int32Array.from([1,3,1,1,4,1]),Int32Array.from([1,1,4,1,1,3]),Int32Array.from([1,1,4,3,1,1]),Int32Array.from([4,1,1,1,1,3]),Int32Array.from([4,1,1,3,1,1]),Int32Array.from([1,1,3,1,4,1]),Int32Array.from([1,1,4,1,3,1]),Int32Array.from([3,1,1,1,4,1]),Int32Array.from([4,1,1,1,3,1]),Int32Array.from([2,1,1,4,1,2]),Int32Array.from([2,1,1,2,1,4]),Int32Array.from([2,1,1,2,3,2]),Int32Array.from([2,3,3,1,1,1,2])],Be.MAX_AVG_VARIANCE=.25,Be.MAX_INDIVIDUAL_VARIANCE=.7,Be.CODE_SHIFT=98,Be.CODE_CODE_C=99,Be.CODE_CODE_B=100,Be.CODE_CODE_A=101,Be.CODE_FNC_1=102,Be.CODE_FNC_2=97,Be.CODE_FNC_3=96,Be.CODE_FNC_4_A=101,Be.CODE_FNC_4_B=100,Be.CODE_START_A=103,Be.CODE_START_B=104,Be.CODE_START_C=105,Be.CODE_STOP=106;class jt extends ft{constructor(n=!1,s=!1){super(),this.usingCheckDigit=n,this.extendedMode=s,this.decodeRowResult="",this.counters=new Int32Array(9)}decodeRow(n,s,o){let f=this.counters;f.fill(0),this.decodeRowResult="";let l=jt.findAsteriskPattern(s,f),h=s.getNextSet(l[1]),x=s.getSize(),p,E;do{jt.recordPattern(s,h,f);let re=jt.toNarrowWidePattern(f);if(re<0)throw new q;p=jt.patternToChar(re),this.decodeRowResult+=p,E=h;for(let fe of f)h+=fe;h=s.getNextSet(h)}while(p!=="*");this.decodeRowResult=this.decodeRowResult.substring(0,this.decodeRowResult.length-1);let T=0;for(let re of f)T+=re;let k=h-E-T;if(h!==x&&k*2<T)throw new q;if(this.usingCheckDigit){let re=this.decodeRowResult.length-1,fe=0;for(let pe=0;pe<re;pe++)fe+=jt.ALPHABET_STRING.indexOf(this.decodeRowResult.charAt(pe));if(this.decodeRowResult.charAt(re)!==jt.ALPHABET_STRING.charAt(fe%43))throw new C;this.decodeRowResult=this.decodeRowResult.substring(0,re)}if(this.decodeRowResult.length===0)throw new q;let R;this.extendedMode?R=jt.decodeExtended(this.decodeRowResult):R=this.decodeRowResult;let G=(l[1]+l[0])/2,J=E+T/2;return new Z(R,null,0,[new Ve(G,n),new Ve(J,n)],oe.CODE_39,new Date().getTime())}static findAsteriskPattern(n,s){let o=n.getSize(),f=n.getNextSet(0),l=0,h=f,x=!1,p=s.length;for(let E=f;E<o;E++)if(n.get(E)!==x)s[l]++;else{if(l===p-1){if(this.toNarrowWidePattern(s)===jt.ASTERISK_ENCODING&&n.isRange(Math.max(0,h-Math.floor((E-h)/2)),h,!1))return[h,E];h+=s[0]+s[1],s.copyWithin(0,2,2+l-1),s[l-1]=0,s[l]=0,l--}else l++;s[l]=1,x=!x}throw new q}static toNarrowWidePattern(n){let s=n.length,o=0,f;do{let l=2147483647;for(let p of n)p<l&&p>o&&(l=p);o=l,f=0;let h=0,x=0;for(let p=0;p<s;p++){let E=n[p];E>o&&(x|=1<<s-1-p,f++,h+=E)}if(f===3){for(let p=0;p<s&&f>0;p++){let E=n[p];if(E>o&&(f--,E*2>=h))return-1}return x}}while(f>3);return-1}static patternToChar(n){for(let s=0;s<jt.CHARACTER_ENCODINGS.length;s++)if(jt.CHARACTER_ENCODINGS[s]===n)return jt.ALPHABET_STRING.charAt(s);if(n===jt.ASTERISK_ENCODING)return"*";throw new q}static decodeExtended(n){let s=n.length,o="";for(let f=0;f<s;f++){let l=n.charAt(f);if(l==="+"||l==="$"||l==="%"||l==="/"){let h=n.charAt(f+1),x="\0";switch(l){case"+":if(h>="A"&&h<="Z")x=String.fromCharCode(h.charCodeAt(0)+32);else throw new N;break;case"$":if(h>="A"&&h<="Z")x=String.fromCharCode(h.charCodeAt(0)-64);else throw new N;break;case"%":if(h>="A"&&h<="E")x=String.fromCharCode(h.charCodeAt(0)-38);else if(h>="F"&&h<="J")x=String.fromCharCode(h.charCodeAt(0)-11);else if(h>="K"&&h<="O")x=String.fromCharCode(h.charCodeAt(0)+16);else if(h>="P"&&h<="T")x=String.fromCharCode(h.charCodeAt(0)+43);else if(h==="U")x="\0";else if(h==="V")x="@";else if(h==="W")x="`";else if(h==="X"||h==="Y"||h==="Z")x="";else throw new N;break;case"/":if(h>="A"&&h<="O")x=String.fromCharCode(h.charCodeAt(0)-32);else if(h==="Z")x=":";else throw new N;break}o+=x,f++}else o+=l}return o}}jt.ALPHABET_STRING="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ-. $/+%",jt.CHARACTER_ENCODINGS=[52,289,97,352,49,304,112,37,292,100,265,73,328,25,280,88,13,268,76,28,259,67,322,19,274,82,7,262,70,22,385,193,448,145,400,208,133,388,196,168,162,138,42],jt.ASTERISK_ENCODING=148;class St extends ft{constructor(){super(...arguments),this.narrowLineWidth=-1}decodeRow(n,s,o){let f=this.decodeStart(s),l=this.decodeEnd(s),h=new ie;St.decodeMiddle(s,f[1],l[0],h);let x=h.toString(),p=null;o!=null&&(p=o.get(W.ALLOWED_LENGTHS)),p==null&&(p=St.DEFAULT_ALLOWED_LENGTHS);let E=x.length,T=!1,k=0;for(let J of p){if(E===J){T=!0;break}J>k&&(k=J)}if(!T&&E>k&&(T=!0),!T)throw new N;const R=[new Ve(f[1],n),new Ve(l[0],n)];return new Z(x,null,0,R,oe.ITF,new Date().getTime())}static decodeMiddle(n,s,o,f){let l=new Int32Array(10),h=new Int32Array(5),x=new Int32Array(5);for(l.fill(0),h.fill(0),x.fill(0);s<o;){ft.recordPattern(n,s,l);for(let E=0;E<5;E++){let T=2*E;h[E]=l[T],x[E]=l[T+1]}let p=St.decodeDigit(h);f.append(p.toString()),p=this.decodeDigit(x),f.append(p.toString()),l.forEach(function(E){s+=E})}}decodeStart(n){let s=St.skipWhiteSpace(n),o=St.findGuardPattern(n,s,St.START_PATTERN);return this.narrowLineWidth=(o[1]-o[0])/4,this.validateQuietZone(n,o[0]),o}validateQuietZone(n,s){let o=this.narrowLineWidth*10;o=o<s?o:s;for(let f=s-1;o>0&&f>=0&&!n.get(f);f--)o--;if(o!==0)throw new q}static skipWhiteSpace(n){const s=n.getSize(),o=n.getNextSet(0);if(o===s)throw new q;return o}decodeEnd(n){n.reverse();try{let s=St.skipWhiteSpace(n),o;try{o=St.findGuardPattern(n,s,St.END_PATTERN_REVERSED[0])}catch(l){l instanceof q&&(o=St.findGuardPattern(n,s,St.END_PATTERN_REVERSED[1]))}this.validateQuietZone(n,o[0]);let f=o[0];return o[0]=n.getSize()-o[1],o[1]=n.getSize()-f,o}finally{n.reverse()}}static findGuardPattern(n,s,o){let f=o.length,l=new Int32Array(f),h=n.getSize(),x=!1,p=0,E=s;l.fill(0);for(let T=s;T<h;T++)if(n.get(T)!==x)l[p]++;else{if(p===f-1){if(ft.patternMatchVariance(l,o,St.MAX_INDIVIDUAL_VARIANCE)<St.MAX_AVG_VARIANCE)return[E,T];E+=l[0]+l[1],A.arraycopy(l,2,l,0,p-1),l[p-1]=0,l[p]=0,p--}else p++;l[p]=1,x=!x}throw new q}static decodeDigit(n){let s=St.MAX_AVG_VARIANCE,o=-1,f=St.PATTERNS.length;for(let l=0;l<f;l++){let h=St.PATTERNS[l],x=ft.patternMatchVariance(n,h,St.MAX_INDIVIDUAL_VARIANCE);x<s?(s=x,o=l):x===s&&(o=-1)}if(o>=0)return o%10;throw new q}}St.PATTERNS=[Int32Array.from([1,1,2,2,1]),Int32Array.from([2,1,1,1,2]),Int32Array.from([1,2,1,1,2]),Int32Array.from([2,2,1,1,1]),Int32Array.from([1,1,2,1,2]),Int32Array.from([2,1,2,1,1]),Int32Array.from([1,2,2,1,1]),Int32Array.from([1,1,1,2,2]),Int32Array.from([2,1,1,2,1]),Int32Array.from([1,2,1,2,1]),Int32Array.from([1,1,3,3,1]),Int32Array.from([3,1,1,1,3]),Int32Array.from([1,3,1,1,3]),Int32Array.from([3,3,1,1,1]),Int32Array.from([1,1,3,1,3]),Int32Array.from([3,1,3,1,1]),Int32Array.from([1,3,3,1,1]),Int32Array.from([1,1,1,3,3]),Int32Array.from([3,1,1,3,1]),Int32Array.from([1,3,1,3,1])],St.MAX_AVG_VARIANCE=.38,St.MAX_INDIVIDUAL_VARIANCE=.5,St.DEFAULT_ALLOWED_LENGTHS=[6,8,10,12,14],St.START_PATTERN=Int32Array.from([1,1,1,1]),St.END_PATTERN_REVERSED=[Int32Array.from([1,1,2]),Int32Array.from([1,1,3])];class Gt extends ft{constructor(){super(...arguments),this.decodeRowStringBuffer=""}static findStartGuardPattern(n){let s=!1,o,f=0,l=Int32Array.from([0,0,0]);for(;!s;){l=Int32Array.from([0,0,0]),o=Gt.findGuardPattern(n,f,!1,this.START_END_PATTERN,l);let h=o[0];f=o[1];let x=h-(f-h);x>=0&&(s=n.isRange(x,h,!1))}return o}static checkChecksum(n){return Gt.checkStandardUPCEANChecksum(n)}static checkStandardUPCEANChecksum(n){let s=n.length;if(s===0)return!1;let o=parseInt(n.charAt(s-1),10);return Gt.getStandardUPCEANChecksum(n.substring(0,s-1))===o}static getStandardUPCEANChecksum(n){let s=n.length,o=0;for(let f=s-1;f>=0;f-=2){let l=n.charAt(f).charCodeAt(0)-48;if(l<0||l>9)throw new N;o+=l}o*=3;for(let f=s-2;f>=0;f-=2){let l=n.charAt(f).charCodeAt(0)-48;if(l<0||l>9)throw new N;o+=l}return(1e3-o)%10}static decodeEnd(n,s){return Gt.findGuardPattern(n,s,!1,Gt.START_END_PATTERN,new Int32Array(Gt.START_END_PATTERN.length).fill(0))}static findGuardPatternWithoutCounters(n,s,o,f){return this.findGuardPattern(n,s,o,f,new Int32Array(f.length))}static findGuardPattern(n,s,o,f,l){let h=n.getSize();s=o?n.getNextUnset(s):n.getNextSet(s);let x=0,p=s,E=f.length,T=o;for(let k=s;k<h;k++)if(n.get(k)!==T)l[x]++;else{if(x===E-1){if(ft.patternMatchVariance(l,f,Gt.MAX_INDIVIDUAL_VARIANCE)<Gt.MAX_AVG_VARIANCE)return Int32Array.from([p,k]);p+=l[0]+l[1];let R=l.slice(2,l.length-1);for(let G=0;G<x-1;G++)l[G]=R[G];l[x-1]=0,l[x]=0,x--}else x++;l[x]=1,T=!T}throw new q}static decodeDigit(n,s,o,f){this.recordPattern(n,o,s);let l=this.MAX_AVG_VARIANCE,h=-1,x=f.length;for(let p=0;p<x;p++){let E=f[p],T=ft.patternMatchVariance(s,E,Gt.MAX_INDIVIDUAL_VARIANCE);T<l&&(l=T,h=p)}if(h>=0)return h;throw new q}}Gt.MAX_AVG_VARIANCE=.48,Gt.MAX_INDIVIDUAL_VARIANCE=.7,Gt.START_END_PATTERN=Int32Array.from([1,1,1]),Gt.MIDDLE_PATTERN=Int32Array.from([1,1,1,1,1]),Gt.END_PATTERN=Int32Array.from([1,1,1,1,1,1]),Gt.L_PATTERNS=[Int32Array.from([3,2,1,1]),Int32Array.from([2,2,2,1]),Int32Array.from([2,1,2,2]),Int32Array.from([1,4,1,1]),Int32Array.from([1,1,3,2]),Int32Array.from([1,2,3,1]),Int32Array.from([1,1,1,4]),Int32Array.from([1,3,1,2]),Int32Array.from([1,2,1,3]),Int32Array.from([3,1,1,2])];class Kn{constructor(){this.CHECK_DIGIT_ENCODINGS=[24,20,18,17,12,6,3,10,9,5],this.decodeMiddleCounters=Int32Array.from([0,0,0,0]),this.decodeRowStringBuffer=""}decodeRow(n,s,o){let f=this.decodeRowStringBuffer,l=this.decodeMiddle(s,o,f),h=f.toString(),x=Kn.parseExtensionString(h),p=[new Ve((o[0]+o[1])/2,n),new Ve(l,n)],E=new Z(h,null,0,p,oe.UPC_EAN_EXTENSION,new Date().getTime());return x!=null&&E.putAllMetadata(x),E}decodeMiddle(n,s,o){let f=this.decodeMiddleCounters;f[0]=0,f[1]=0,f[2]=0,f[3]=0;let l=n.getSize(),h=s[1],x=0;for(let E=0;E<5&&h<l;E++){let T=Gt.decodeDigit(n,f,h,Gt.L_AND_G_PATTERNS);o+=String.fromCharCode(48+T%10);for(let k of f)h+=k;T>=10&&(x|=1<<4-E),E!==4&&(h=n.getNextSet(h),h=n.getNextUnset(h))}if(o.length!==5)throw new q;let p=this.determineCheckDigit(x);if(Kn.extensionChecksum(o.toString())!==p)throw new q;return h}static extensionChecksum(n){let s=n.length,o=0;for(let f=s-2;f>=0;f-=2)o+=n.charAt(f).charCodeAt(0)-48;o*=3;for(let f=s-1;f>=0;f-=2)o+=n.charAt(f).charCodeAt(0)-48;return o*=3,o%10}determineCheckDigit(n){for(let s=0;s<10;s++)if(n===this.CHECK_DIGIT_ENCODINGS[s])return s;throw new q}static parseExtensionString(n){if(n.length!==5)return null;let s=Kn.parseExtension5String(n);return s==null?null:new Map([[Ae.SUGGESTED_PRICE,s]])}static parseExtension5String(n){let s;switch(n.charAt(0)){case"0":s="£";break;case"5":s="$";break;case"9":switch(n){case"90000":return null;case"99991":return"0.00";case"99990":return"Used"}s="";break;default:s="";break}let o=parseInt(n.substring(1)),f=(o/100).toString(),l=o%100,h=l<10?"0"+l:l.toString();return s+f+"."+h}}class Pa{constructor(){this.decodeMiddleCounters=Int32Array.from([0,0,0,0]),this.decodeRowStringBuffer=""}decodeRow(n,s,o){let f=this.decodeRowStringBuffer,l=this.decodeMiddle(s,o,f),h=f.toString(),x=Pa.parseExtensionString(h),p=[new Ve((o[0]+o[1])/2,n),new Ve(l,n)],E=new Z(h,null,0,p,oe.UPC_EAN_EXTENSION,new Date().getTime());return x!=null&&E.putAllMetadata(x),E}decodeMiddle(n,s,o){let f=this.decodeMiddleCounters;f[0]=0,f[1]=0,f[2]=0,f[3]=0;let l=n.getSize(),h=s[1],x=0;for(let p=0;p<2&&h<l;p++){let E=Gt.decodeDigit(n,f,h,Gt.L_AND_G_PATTERNS);o+=String.fromCharCode(48+E%10);for(let T of f)h+=T;E>=10&&(x|=1<<1-p),p!==1&&(h=n.getNextSet(h),h=n.getNextUnset(h))}if(o.length!==2)throw new q;if(parseInt(o.toString())%4!==x)throw new q;return h}static parseExtensionString(n){return n.length!==2?null:new Map([[Ae.ISSUE_NUMBER,parseInt(n)]])}}class ci{static decodeRow(n,s,o){let f=Gt.findGuardPattern(s,o,!1,this.EXTENSION_START_PATTERN,new Int32Array(this.EXTENSION_START_PATTERN.length).fill(0));try{return new Kn().decodeRow(n,s,f)}catch{return new Pa().decodeRow(n,s,f)}}}ci.EXTENSION_START_PATTERN=Int32Array.from([1,1,2]);class vt extends Gt{constructor(){super(),this.decodeRowStringBuffer="",vt.L_AND_G_PATTERNS=vt.L_PATTERNS.map(n=>Int32Array.from(n));for(let n=10;n<20;n++){let s=vt.L_PATTERNS[n-10],o=new Int32Array(s.length);for(let f=0;f<s.length;f++)o[f]=s[s.length-f-1];vt.L_AND_G_PATTERNS[n]=o}}decodeRow(n,s,o){let f=vt.findStartGuardPattern(s),l=o==null?null:o.get(W.NEED_RESULT_POINT_CALLBACK);if(l!=null){const ke=new Ve((f[0]+f[1])/2,n);l.foundPossibleResultPoint(ke)}let h=this.decodeMiddle(s,f,this.decodeRowStringBuffer),x=h.rowOffset,p=h.resultString;if(l!=null){const ke=new Ve(x,n);l.foundPossibleResultPoint(ke)}let E=this.decodeEnd(s,x);if(l!=null){const ke=new Ve((E[0]+E[1])/2,n);l.foundPossibleResultPoint(ke)}let T=E[1],k=T+(T-E[0]);if(k>=s.getSize()||!s.isRange(T,k,!1))throw new q;let R=p.toString();if(R.length<8)throw new N;if(!vt.checkChecksum(R))throw new C;let G=(f[1]+f[0])/2,J=(E[1]+E[0])/2,re=this.getBarcodeFormat(),fe=[new Ve(G,n),new Ve(J,n)],pe=new Z(R,null,0,fe,re,new Date().getTime()),Re=0;try{let ke=ci.decodeRow(n,s,E[1]);pe.putMetadata(Ae.UPC_EAN_EXTENSION,ke.getText()),pe.putAllMetadata(ke.getResultMetadata()),pe.addResultPoints(ke.getResultPoints()),Re=ke.getText().length}catch{}let De=o==null?null:o.get(W.ALLOWED_EAN_EXTENSIONS);if(De!=null){let ke=!1;for(let Et in De)if(Re.toString()===Et){ke=!0;break}if(!ke)throw new q}return pe}decodeEnd(n,s){return vt.findGuardPattern(n,s,!1,vt.START_END_PATTERN,new Int32Array(vt.START_END_PATTERN.length).fill(0))}static checkChecksum(n){return vt.checkStandardUPCEANChecksum(n)}static checkStandardUPCEANChecksum(n){let s=n.length;if(s===0)return!1;let o=parseInt(n.charAt(s-1),10);return vt.getStandardUPCEANChecksum(n.substring(0,s-1))===o}static getStandardUPCEANChecksum(n){let s=n.length,o=0;for(let f=s-1;f>=0;f-=2){let l=n.charAt(f).charCodeAt(0)-48;if(l<0||l>9)throw new N;o+=l}o*=3;for(let f=s-2;f>=0;f-=2){let l=n.charAt(f).charCodeAt(0)-48;if(l<0||l>9)throw new N;o+=l}return(1e3-o)%10}}class Bn extends vt{constructor(){super(),this.decodeMiddleCounters=Int32Array.from([0,0,0,0])}decodeMiddle(n,s,o){let f=this.decodeMiddleCounters;f[0]=0,f[1]=0,f[2]=0,f[3]=0;let l=n.getSize(),h=s[1],x=0;for(let E=0;E<6&&h<l;E++){let T=vt.decodeDigit(n,f,h,vt.L_AND_G_PATTERNS);o+=String.fromCharCode(48+T%10);for(let k of f)h+=k;T>=10&&(x|=1<<5-E)}o=Bn.determineFirstDigit(o,x),h=vt.findGuardPattern(n,h,!0,vt.MIDDLE_PATTERN,new Int32Array(vt.MIDDLE_PATTERN.length).fill(0))[1];for(let E=0;E<6&&h<l;E++){let T=vt.decodeDigit(n,f,h,vt.L_PATTERNS);o+=String.fromCharCode(48+T);for(let k of f)h+=k}return{rowOffset:h,resultString:o}}getBarcodeFormat(){return oe.EAN_13}static determineFirstDigit(n,s){for(let o=0;o<10;o++)if(s===this.FIRST_DIGIT_ENCODINGS[o])return n=String.fromCharCode(48+o)+n,n;throw new q}}Bn.FIRST_DIGIT_ENCODINGS=[0,11,13,14,19,25,28,21,22,26];class ha extends vt{constructor(){super(),this.decodeMiddleCounters=Int32Array.from([0,0,0,0])}decodeMiddle(n,s,o){const f=this.decodeMiddleCounters;f[0]=0,f[1]=0,f[2]=0,f[3]=0;let l=n.getSize(),h=s[1];for(let p=0;p<4&&h<l;p++){let E=vt.decodeDigit(n,f,h,vt.L_PATTERNS);o+=String.fromCharCode(48+E);for(let T of f)h+=T}h=vt.findGuardPattern(n,h,!0,vt.MIDDLE_PATTERN,new Int32Array(vt.MIDDLE_PATTERN.length).fill(0))[1];for(let p=0;p<4&&h<l;p++){let E=vt.decodeDigit(n,f,h,vt.L_PATTERNS);o+=String.fromCharCode(48+E);for(let T of f)h+=T}return{rowOffset:h,resultString:o}}getBarcodeFormat(){return oe.EAN_8}}class ts extends vt{constructor(){super(...arguments),this.ean13Reader=new Bn}getBarcodeFormat(){return oe.UPC_A}decode(n,s){return this.maybeReturnResult(this.ean13Reader.decode(n))}decodeRow(n,s,o){return this.maybeReturnResult(this.ean13Reader.decodeRow(n,s,o))}decodeMiddle(n,s,o){return this.ean13Reader.decodeMiddle(n,s,o)}maybeReturnResult(n){let s=n.getText();if(s.charAt(0)==="0"){let o=new Z(s.substring(1),null,null,n.getResultPoints(),oe.UPC_A);return n.getResultMetadata()!=null&&o.putAllMetadata(n.getResultMetadata()),o}else throw new q}reset(){this.ean13Reader.reset()}}class Yr extends vt{constructor(){super(),this.decodeMiddleCounters=new Int32Array(4)}decodeMiddle(n,s,o){const f=this.decodeMiddleCounters.map(E=>E);f[0]=0,f[1]=0,f[2]=0,f[3]=0;const l=n.getSize();let h=s[1],x=0;for(let E=0;E<6&&h<l;E++){const T=Yr.decodeDigit(n,f,h,Yr.L_AND_G_PATTERNS);o+=String.fromCharCode(48+T%10);for(let k of f)h+=k;T>=10&&(x|=1<<5-E)}let p=Yr.determineNumSysAndCheckDigit(o,x);return{rowOffset:h,resultString:p}}decodeEnd(n,s){return Yr.findGuardPatternWithoutCounters(n,s,!0,Yr.MIDDLE_END_PATTERN)}checkChecksum(n){return vt.checkChecksum(Yr.convertUPCEtoUPCA(n))}static determineNumSysAndCheckDigit(n,s){for(let o=0;o<=1;o++)for(let f=0;f<10;f++)if(s===this.NUMSYS_AND_CHECK_DIGIT_PATTERNS[o][f]){let l=String.fromCharCode(48+o),h=String.fromCharCode(48+f);return l+n+h}throw q.getNotFoundInstance()}getBarcodeFormat(){return oe.UPC_E}static convertUPCEtoUPCA(n){const s=n.slice(1,7).split("").map(l=>l.charCodeAt(0)),o=new ie;o.append(n.charAt(0));let f=s[5];switch(f){case 0:case 1:case 2:o.appendChars(s,0,2),o.append(f),o.append("0000"),o.appendChars(s,2,3);break;case 3:o.appendChars(s,0,3),o.append("00000"),o.appendChars(s,3,2);break;case 4:o.appendChars(s,0,4),o.append("00000"),o.append(s[4]);break;default:o.appendChars(s,0,5),o.append("0000"),o.append(f);break}return n.length>=8&&o.append(n.charAt(7)),o.toString()}}Yr.MIDDLE_END_PATTERN=Int32Array.from([1,1,1,1,1,1]),Yr.NUMSYS_AND_CHECK_DIGIT_PATTERNS=[Int32Array.from([56,52,50,49,44,38,35,42,41,37]),Int32Array.from([7,11,13,14,19,25,28,21,22,26])];class fi extends ft{constructor(n){super();let s=n==null?null:n.get(W.POSSIBLE_FORMATS),o=[];a(s)?(o.push(new Bn),o.push(new ts),o.push(new ha),o.push(new Yr)):(s.indexOf(oe.EAN_13)>-1&&o.push(new Bn),s.indexOf(oe.UPC_A)>-1&&o.push(new ts),s.indexOf(oe.EAN_8)>-1&&o.push(new ha),s.indexOf(oe.UPC_E)>-1&&o.push(new Yr)),this.readers=o}decodeRow(n,s,o){for(let f of this.readers)try{const l=f.decodeRow(n,s,o),h=l.getBarcodeFormat()===oe.EAN_13&&l.getText().charAt(0)==="0",x=o==null?null:o.get(W.POSSIBLE_FORMATS),p=x==null||x.includes(oe.UPC_A);if(h&&p){const E=l.getRawBytes(),T=new Z(l.getText().substring(1),E,E?E.length:null,l.getResultPoints(),oe.UPC_A);return T.putAllMetadata(l.getResultMetadata()),T}return l}catch{}throw new q}reset(){for(let n of this.readers)n.reset()}}class hr extends ft{constructor(){super(),this.decodeFinderCounters=new Int32Array(4),this.dataCharacterCounters=new Int32Array(8),this.oddRoundingErrors=new Array(4),this.evenRoundingErrors=new Array(4),this.oddCounts=new Array(this.dataCharacterCounters.length/2),this.evenCounts=new Array(this.dataCharacterCounters.length/2)}getDecodeFinderCounters(){return this.decodeFinderCounters}getDataCharacterCounters(){return this.dataCharacterCounters}getOddRoundingErrors(){return this.oddRoundingErrors}getEvenRoundingErrors(){return this.evenRoundingErrors}getOddCounts(){return this.oddCounts}getEvenCounts(){return this.evenCounts}parseFinderValue(n,s){for(let o=0;o<s.length;o++)if(ft.patternMatchVariance(n,s[o],hr.MAX_INDIVIDUAL_VARIANCE)<hr.MAX_AVG_VARIANCE)return o;throw new q}static count(n){return rt.sum(new Int32Array(n))}static increment(n,s){let o=0,f=s[0];for(let l=1;l<n.length;l++)s[l]>f&&(f=s[l],o=l);n[o]++}static decrement(n,s){let o=0,f=s[0];for(let l=1;l<n.length;l++)s[l]<f&&(f=s[l],o=l);n[o]--}static isFinderPattern(n){let s=n[0]+n[1],o=s+n[2]+n[3],f=s/o;if(f>=hr.MIN_FINDER_PATTERN_RATIO&&f<=hr.MAX_FINDER_PATTERN_RATIO){let l=Number.MAX_SAFE_INTEGER,h=Number.MIN_SAFE_INTEGER;for(let x of n)x>h&&(h=x),x<l&&(l=x);return h<10*l}return!1}}hr.MAX_AVG_VARIANCE=.2,hr.MAX_INDIVIDUAL_VARIANCE=.45,hr.MIN_FINDER_PATTERN_RATIO=9.5/12,hr.MAX_FINDER_PATTERN_RATIO=12.5/14;class jn{constructor(n,s){this.value=n,this.checksumPortion=s}getValue(){return this.value}getChecksumPortion(){return this.checksumPortion}toString(){return this.value+"("+this.checksumPortion+")"}equals(n){if(!(n instanceof jn))return!1;const s=n;return this.value===s.value&&this.checksumPortion===s.checksumPortion}hashCode(){return this.value^this.checksumPortion}}class La{constructor(n,s,o,f,l){this.value=n,this.startEnd=s,this.value=n,this.startEnd=s,this.resultPoints=new Array,this.resultPoints.push(new Ve(o,l)),this.resultPoints.push(new Ve(f,l))}getValue(){return this.value}getStartEnd(){return this.startEnd}getResultPoints(){return this.resultPoints}equals(n){if(!(n instanceof La))return!1;const s=n;return this.value===s.value}hashCode(){return this.value}}class tn{constructor(){}static getRSSvalue(n,s,o){let f=0;for(let p of n)f+=p;let l=0,h=0,x=n.length;for(let p=0;p<x-1;p++){let E;for(E=1,h|=1<<p;E<n[p];E++,h&=~(1<<p)){let T=tn.combins(f-E-1,x-p-2);if(o&&h===0&&f-E-(x-p-1)>=x-p-1&&(T-=tn.combins(f-E-(x-p),x-p-2)),x-p-1>1){let k=0;for(let R=f-E-(x-p-2);R>s;R--)k+=tn.combins(f-E-R-1,x-p-3);T-=k*(x-1-p)}else f-E>s&&T--;l+=T}f-=E}return l}static combins(n,s){let o,f;n-s>s?(f=s,o=n-s):(f=n-s,o=s);let l=1,h=1;for(let x=n;x>o;x--)l*=x,h<=f&&(l/=h,h++);for(;h<=f;)l/=h,h++;return l}}class Ys{static buildBitArray(n){let s=n.length*2-1;n[n.length-1].getRightChar()==null&&(s-=1);let o=12*s,f=new V(o),l=0,x=n[0].getRightChar().getValue();for(let p=11;p>=0;--p)(x&1<<p)!=0&&f.set(l),l++;for(let p=1;p<n.length;++p){let E=n[p],T=E.getLeftChar().getValue();for(let k=11;k>=0;--k)(T&1<<k)!=0&&f.set(l),l++;if(E.getRightChar()!=null){let k=E.getRightChar().getValue();for(let R=11;R>=0;--R)(k&1<<R)!=0&&f.set(l),l++}}return f}}class pn{constructor(n,s){s?this.decodedInformation=null:(this.finished=n,this.decodedInformation=s)}getDecodedInformation(){return this.decodedInformation}isFinished(){return this.finished}}class li{constructor(n){this.newPosition=n}getNewPosition(){return this.newPosition}}class Tr extends li{constructor(n,s){super(n),this.value=s}getValue(){return this.value}isFNC1(){return this.value===Tr.FNC1}}Tr.FNC1="$";class Mn extends li{constructor(n,s,o){super(n),o?(this.remaining=!0,this.remainingValue=this.remainingValue):(this.remaining=!1,this.remainingValue=0),this.newString=s}getNewString(){return this.newString}isRemaining(){return this.remaining}getRemainingValue(){return this.remainingValue}}class F extends li{constructor(n,s,o){if(super(n),s<0||s>10||o<0||o>10)throw new N;this.firstDigit=s,this.secondDigit=o}getFirstDigit(){return this.firstDigit}getSecondDigit(){return this.secondDigit}getValue(){return this.firstDigit*10+this.secondDigit}isFirstDigitFNC1(){return this.firstDigit===F.FNC1}isSecondDigitFNC1(){return this.secondDigit===F.FNC1}isAnyFNC1(){return this.firstDigit===F.FNC1||this.secondDigit===F.FNC1}}F.FNC1=10;class B{constructor(){}static parseFieldsInGeneralPurpose(n){if(!n)return null;if(n.length<2)throw new q;let s=n.substring(0,2);for(let l of B.TWO_DIGIT_DATA_LENGTH)if(l[0]===s)return l[1]===B.VARIABLE_LENGTH?B.processVariableAI(2,l[2],n):B.processFixedAI(2,l[1],n);if(n.length<3)throw new q;let o=n.substring(0,3);for(let l of B.THREE_DIGIT_DATA_LENGTH)if(l[0]===o)return l[1]===B.VARIABLE_LENGTH?B.processVariableAI(3,l[2],n):B.processFixedAI(3,l[1],n);for(let l of B.THREE_DIGIT_PLUS_DIGIT_DATA_LENGTH)if(l[0]===o)return l[1]===B.VARIABLE_LENGTH?B.processVariableAI(4,l[2],n):B.processFixedAI(4,l[1],n);if(n.length<4)throw new q;let f=n.substring(0,4);for(let l of B.FOUR_DIGIT_DATA_LENGTH)if(l[0]===f)return l[1]===B.VARIABLE_LENGTH?B.processVariableAI(4,l[2],n):B.processFixedAI(4,l[1],n);throw new q}static processFixedAI(n,s,o){if(o.length<n)throw new q;let f=o.substring(0,n);if(o.length<n+s)throw new q;let l=o.substring(n,n+s),h=o.substring(n+s),x="("+f+")"+l,p=B.parseFieldsInGeneralPurpose(h);return p==null?x:x+p}static processVariableAI(n,s,o){let f=o.substring(0,n),l;o.length<n+s?l=o.length:l=n+s;let h=o.substring(n,l),x=o.substring(l),p="("+f+")"+h,E=B.parseFieldsInGeneralPurpose(x);return E==null?p:p+E}}B.VARIABLE_LENGTH=[],B.TWO_DIGIT_DATA_LENGTH=[["00",18],["01",14],["02",14],["10",B.VARIABLE_LENGTH,20],["11",6],["12",6],["13",6],["15",6],["17",6],["20",2],["21",B.VARIABLE_LENGTH,20],["22",B.VARIABLE_LENGTH,29],["30",B.VARIABLE_LENGTH,8],["37",B.VARIABLE_LENGTH,8],["90",B.VARIABLE_LENGTH,30],["91",B.VARIABLE_LENGTH,30],["92",B.VARIABLE_LENGTH,30],["93",B.VARIABLE_LENGTH,30],["94",B.VARIABLE_LENGTH,30],["95",B.VARIABLE_LENGTH,30],["96",B.VARIABLE_LENGTH,30],["97",B.VARIABLE_LENGTH,3],["98",B.VARIABLE_LENGTH,30],["99",B.VARIABLE_LENGTH,30]],B.THREE_DIGIT_DATA_LENGTH=[["240",B.VARIABLE_LENGTH,30],["241",B.VARIABLE_LENGTH,30],["242",B.VARIABLE_LENGTH,6],["250",B.VARIABLE_LENGTH,30],["251",B.VARIABLE_LENGTH,30],["253",B.VARIABLE_LENGTH,17],["254",B.VARIABLE_LENGTH,20],["400",B.VARIABLE_LENGTH,30],["401",B.VARIABLE_LENGTH,30],["402",17],["403",B.VARIABLE_LENGTH,30],["410",13],["411",13],["412",13],["413",13],["414",13],["420",B.VARIABLE_LENGTH,20],["421",B.VARIABLE_LENGTH,15],["422",3],["423",B.VARIABLE_LENGTH,15],["424",3],["425",3],["426",3]],B.THREE_DIGIT_PLUS_DIGIT_DATA_LENGTH=[["310",6],["311",6],["312",6],["313",6],["314",6],["315",6],["316",6],["320",6],["321",6],["322",6],["323",6],["324",6],["325",6],["326",6],["327",6],["328",6],["329",6],["330",6],["331",6],["332",6],["333",6],["334",6],["335",6],["336",6],["340",6],["341",6],["342",6],["343",6],["344",6],["345",6],["346",6],["347",6],["348",6],["349",6],["350",6],["351",6],["352",6],["353",6],["354",6],["355",6],["356",6],["357",6],["360",6],["361",6],["362",6],["363",6],["364",6],["365",6],["366",6],["367",6],["368",6],["369",6],["390",B.VARIABLE_LENGTH,15],["391",B.VARIABLE_LENGTH,18],["392",B.VARIABLE_LENGTH,15],["393",B.VARIABLE_LENGTH,18],["703",B.VARIABLE_LENGTH,30]],B.FOUR_DIGIT_DATA_LENGTH=[["7001",13],["7002",B.VARIABLE_LENGTH,30],["7003",10],["8001",14],["8002",B.VARIABLE_LENGTH,20],["8003",B.VARIABLE_LENGTH,30],["8004",B.VARIABLE_LENGTH,30],["8005",6],["8006",18],["8007",B.VARIABLE_LENGTH,30],["8008",B.VARIABLE_LENGTH,12],["8018",18],["8020",B.VARIABLE_LENGTH,25],["8100",6],["8101",10],["8102",2],["8110",B.VARIABLE_LENGTH,70],["8200",B.VARIABLE_LENGTH,70]];class M{constructor(n){this.buffer=new ie,this.information=n}decodeAllCodes(n,s){let o=s,f=null;do{let l=this.decodeGeneralPurposeField(o,f),h=B.parseFieldsInGeneralPurpose(l.getNewString());if(h!=null&&n.append(h),l.isRemaining()?f=""+l.getRemainingValue():f=null,o===l.getNewPosition())break;o=l.getNewPosition()}while(!0);return n.toString()}isStillNumeric(n){if(n+7>this.information.getSize())return n+4<=this.information.getSize();for(let s=n;s<n+3;++s)if(this.information.get(s))return!0;return this.information.get(n+3)}decodeNumeric(n){if(n+7>this.information.getSize()){let l=this.extractNumericValueFromBitArray(n,4);return l===0?new F(this.information.getSize(),F.FNC1,F.FNC1):new F(this.information.getSize(),l-1,F.FNC1)}let s=this.extractNumericValueFromBitArray(n,7),o=(s-8)/11,f=(s-8)%11;return new F(n+7,o,f)}extractNumericValueFromBitArray(n,s){return M.extractNumericValueFromBitArray(this.information,n,s)}static extractNumericValueFromBitArray(n,s,o){let f=0;for(let l=0;l<o;++l)n.get(s+l)&&(f|=1<<o-l-1);return f}decodeGeneralPurposeField(n,s){this.buffer.setLengthToZero(),s!=null&&this.buffer.append(s),this.current.setPosition(n);let o=this.parseBlocks();return o!=null&&o.isRemaining()?new Mn(this.current.getPosition(),this.buffer.toString(),o.getRemainingValue()):new Mn(this.current.getPosition(),this.buffer.toString())}parseBlocks(){let n,s;do{let o=this.current.getPosition();if(this.current.isAlpha()?(s=this.parseAlphaBlock(),n=s.isFinished()):this.current.isIsoIec646()?(s=this.parseIsoIec646Block(),n=s.isFinished()):(s=this.parseNumericBlock(),n=s.isFinished()),!(o!==this.current.getPosition())&&!n)break}while(!n);return s.getDecodedInformation()}parseNumericBlock(){for(;this.isStillNumeric(this.current.getPosition());){let n=this.decodeNumeric(this.current.getPosition());if(this.current.setPosition(n.getNewPosition()),n.isFirstDigitFNC1()){let s;return n.isSecondDigitFNC1()?s=new Mn(this.current.getPosition(),this.buffer.toString()):s=new Mn(this.current.getPosition(),this.buffer.toString(),n.getSecondDigit()),new pn(!0,s)}if(this.buffer.append(n.getFirstDigit()),n.isSecondDigitFNC1()){let s=new Mn(this.current.getPosition(),this.buffer.toString());return new pn(!0,s)}this.buffer.append(n.getSecondDigit())}return this.isNumericToAlphaNumericLatch(this.current.getPosition())&&(this.current.setAlpha(),this.current.incrementPosition(4)),new pn(!1)}parseIsoIec646Block(){for(;this.isStillIsoIec646(this.current.getPosition());){let n=this.decodeIsoIec646(this.current.getPosition());if(this.current.setPosition(n.getNewPosition()),n.isFNC1()){let s=new Mn(this.current.getPosition(),this.buffer.toString());return new pn(!0,s)}this.buffer.append(n.getValue())}return this.isAlphaOr646ToNumericLatch(this.current.getPosition())?(this.current.incrementPosition(3),this.current.setNumeric()):this.isAlphaTo646ToAlphaLatch(this.current.getPosition())&&(this.current.getPosition()+5<this.information.getSize()?this.current.incrementPosition(5):this.current.setPosition(this.information.getSize()),this.current.setAlpha()),new pn(!1)}parseAlphaBlock(){for(;this.isStillAlpha(this.current.getPosition());){let n=this.decodeAlphanumeric(this.current.getPosition());if(this.current.setPosition(n.getNewPosition()),n.isFNC1()){let s=new Mn(this.current.getPosition(),this.buffer.toString());return new pn(!0,s)}this.buffer.append(n.getValue())}return this.isAlphaOr646ToNumericLatch(this.current.getPosition())?(this.current.incrementPosition(3),this.current.setNumeric()):this.isAlphaTo646ToAlphaLatch(this.current.getPosition())&&(this.current.getPosition()+5<this.information.getSize()?this.current.incrementPosition(5):this.current.setPosition(this.information.getSize()),this.current.setIsoIec646()),new pn(!1)}isStillIsoIec646(n){if(n+5>this.information.getSize())return!1;let s=this.extractNumericValueFromBitArray(n,5);if(s>=5&&s<16)return!0;if(n+7>this.information.getSize())return!1;let o=this.extractNumericValueFromBitArray(n,7);if(o>=64&&o<116)return!0;if(n+8>this.information.getSize())return!1;let f=this.extractNumericValueFromBitArray(n,8);return f>=232&&f<253}decodeIsoIec646(n){let s=this.extractNumericValueFromBitArray(n,5);if(s===15)return new Tr(n+5,Tr.FNC1);if(s>=5&&s<15)return new Tr(n+5,"0"+(s-5));let o=this.extractNumericValueFromBitArray(n,7);if(o>=64&&o<90)return new Tr(n+7,""+(o+1));if(o>=90&&o<116)return new Tr(n+7,""+(o+7));let f=this.extractNumericValueFromBitArray(n,8),l;switch(f){case 232:l="!";break;case 233:l='"';break;case 234:l="%";break;case 235:l="&";break;case 236:l="'";break;case 237:l="(";break;case 238:l=")";break;case 239:l="*";break;case 240:l="+";break;case 241:l=",";break;case 242:l="-";break;case 243:l=".";break;case 244:l="/";break;case 245:l=":";break;case 246:l=";";break;case 247:l="<";break;case 248:l="=";break;case 249:l=">";break;case 250:l="?";break;case 251:l="_";break;case 252:l=" ";break;default:throw new N}return new Tr(n+8,l)}isStillAlpha(n){if(n+5>this.information.getSize())return!1;let s=this.extractNumericValueFromBitArray(n,5);if(s>=5&&s<16)return!0;if(n+6>this.information.getSize())return!1;let o=this.extractNumericValueFromBitArray(n,6);return o>=16&&o<63}decodeAlphanumeric(n){let s=this.extractNumericValueFromBitArray(n,5);if(s===15)return new Tr(n+5,Tr.FNC1);if(s>=5&&s<15)return new Tr(n+5,"0"+(s-5));let o=this.extractNumericValueFromBitArray(n,6);if(o>=32&&o<58)return new Tr(n+6,""+(o+33));let f;switch(o){case 58:f="*";break;case 59:f=",";break;case 60:f="-";break;case 61:f=".";break;case 62:f="/";break;default:throw new mt("Decoding invalid alphanumeric value: "+o)}return new Tr(n+6,f)}isAlphaTo646ToAlphaLatch(n){if(n+1>this.information.getSize())return!1;for(let s=0;s<5&&s+n<this.information.getSize();++s)if(s===2){if(!this.information.get(n+2))return!1}else if(this.information.get(n+s))return!1;return!0}isAlphaOr646ToNumericLatch(n){if(n+3>this.information.getSize())return!1;for(let s=n;s<n+3;++s)if(this.information.get(s))return!1;return!0}isNumericToAlphaNumericLatch(n){if(n+1>this.information.getSize())return!1;for(let s=0;s<4&&s+n<this.information.getSize();++s)if(this.information.get(n+s))return!1;return!0}}class L{constructor(n){this.information=n,this.generalDecoder=new M(n)}getInformation(){return this.information}getGeneralDecoder(){return this.generalDecoder}}class H extends L{constructor(n){super(n)}encodeCompressedGtin(n,s){n.append("(01)");let o=n.length();n.append("9"),this.encodeCompressedGtinWithoutAI(n,s,o)}encodeCompressedGtinWithoutAI(n,s,o){for(let f=0;f<4;++f){let l=this.getGeneralDecoder().extractNumericValueFromBitArray(s+10*f,10);l/100===0&&n.append("0"),l/10===0&&n.append("0"),n.append(l)}H.appendCheckDigit(n,o)}static appendCheckDigit(n,s){let o=0;for(let f=0;f<13;f++){let l=n.charAt(f+s).charCodeAt(0)-48;o+=(f&1)===0?3*l:l}o=10-o%10,o===10&&(o=0),n.append(o)}}H.GTIN_SIZE=40;class Y extends H{constructor(n){super(n)}parseInformation(){let n=new ie;n.append("(01)");let s=n.length(),o=this.getGeneralDecoder().extractNumericValueFromBitArray(Y.HEADER_SIZE,4);return n.append(o),this.encodeCompressedGtinWithoutAI(n,Y.HEADER_SIZE+4,s),this.getGeneralDecoder().decodeAllCodes(n,Y.HEADER_SIZE+44)}}Y.HEADER_SIZE=4;class he extends L{constructor(n){super(n)}parseInformation(){let n=new ie;return this.getGeneralDecoder().decodeAllCodes(n,he.HEADER_SIZE)}}he.HEADER_SIZE=5;class _e extends H{constructor(n){super(n)}encodeCompressedWeight(n,s,o){let f=this.getGeneralDecoder().extractNumericValueFromBitArray(s,o);this.addWeightCode(n,f);let l=this.checkWeight(f),h=1e5;for(let x=0;x<5;++x)l/h===0&&n.append("0"),h/=10;n.append(l)}}class ce extends _e{constructor(n){super(n)}parseInformation(){if(this.getInformation().getSize()!=ce.HEADER_SIZE+_e.GTIN_SIZE+ce.WEIGHT_SIZE)throw new q;let n=new ie;return this.encodeCompressedGtin(n,ce.HEADER_SIZE),this.encodeCompressedWeight(n,ce.HEADER_SIZE+_e.GTIN_SIZE,ce.WEIGHT_SIZE),n.toString()}}ce.HEADER_SIZE=5,ce.WEIGHT_SIZE=15;class xe extends ce{constructor(n){super(n)}addWeightCode(n,s){n.append("(3103)")}checkWeight(n){return n}}class ge extends ce{constructor(n){super(n)}addWeightCode(n,s){s<1e4?n.append("(3202)"):n.append("(3203)")}checkWeight(n){return n<1e4?n:n-1e4}}class ye extends H{constructor(n){super(n)}parseInformation(){if(this.getInformation().getSize()<ye.HEADER_SIZE+H.GTIN_SIZE)throw new q;let n=new ie;this.encodeCompressedGtin(n,ye.HEADER_SIZE);let s=this.getGeneralDecoder().extractNumericValueFromBitArray(ye.HEADER_SIZE+H.GTIN_SIZE,ye.LAST_DIGIT_SIZE);n.append("(392"),n.append(s),n.append(")");let o=this.getGeneralDecoder().decodeGeneralPurposeField(ye.HEADER_SIZE+H.GTIN_SIZE+ye.LAST_DIGIT_SIZE,null);return n.append(o.getNewString()),n.toString()}}ye.HEADER_SIZE=8,ye.LAST_DIGIT_SIZE=2;class be extends H{constructor(n){super(n)}parseInformation(){if(this.getInformation().getSize()<be.HEADER_SIZE+H.GTIN_SIZE)throw new q;let n=new ie;this.encodeCompressedGtin(n,be.HEADER_SIZE);let s=this.getGeneralDecoder().extractNumericValueFromBitArray(be.HEADER_SIZE+H.GTIN_SIZE,be.LAST_DIGIT_SIZE);n.append("(393"),n.append(s),n.append(")");let o=this.getGeneralDecoder().extractNumericValueFromBitArray(be.HEADER_SIZE+H.GTIN_SIZE+be.LAST_DIGIT_SIZE,be.FIRST_THREE_DIGITS_SIZE);o/100==0&&n.append("0"),o/10==0&&n.append("0"),n.append(o);let f=this.getGeneralDecoder().decodeGeneralPurposeField(be.HEADER_SIZE+H.GTIN_SIZE+be.LAST_DIGIT_SIZE+be.FIRST_THREE_DIGITS_SIZE,null);return n.append(f.getNewString()),n.toString()}}be.HEADER_SIZE=8,be.LAST_DIGIT_SIZE=2,be.FIRST_THREE_DIGITS_SIZE=10;class Fe extends _e{constructor(n,s,o){super(n),this.dateCode=o,this.firstAIdigits=s}parseInformation(){if(this.getInformation().getSize()!=Fe.HEADER_SIZE+Fe.GTIN_SIZE+Fe.WEIGHT_SIZE+Fe.DATE_SIZE)throw new q;let n=new ie;return this.encodeCompressedGtin(n,Fe.HEADER_SIZE),this.encodeCompressedWeight(n,Fe.HEADER_SIZE+Fe.GTIN_SIZE,Fe.WEIGHT_SIZE),this.encodeCompressedDate(n,Fe.HEADER_SIZE+Fe.GTIN_SIZE+Fe.WEIGHT_SIZE),n.toString()}encodeCompressedDate(n,s){let o=this.getGeneralDecoder().extractNumericValueFromBitArray(s,Fe.DATE_SIZE);if(o==38400)return;n.append("("),n.append(this.dateCode),n.append(")");let f=o%32;o/=32;let l=o%12+1;o/=12;let h=o;h/10==0&&n.append("0"),n.append(h),l/10==0&&n.append("0"),n.append(l),f/10==0&&n.append("0"),n.append(f)}addWeightCode(n,s){n.append("("),n.append(this.firstAIdigits),n.append(s/1e5),n.append(")")}checkWeight(n){return n%1e5}}Fe.HEADER_SIZE=8,Fe.WEIGHT_SIZE=20,Fe.DATE_SIZE=16;function Oe(I){try{if(I.get(1))return new Y(I);if(!I.get(2))return new he(I);switch(M.extractNumericValueFromBitArray(I,1,4)){case 4:return new xe(I);case 5:return new ge(I)}switch(M.extractNumericValueFromBitArray(I,1,5)){case 12:return new ye(I);case 13:return new be(I)}switch(M.extractNumericValueFromBitArray(I,1,7)){case 56:return new Fe(I,"310","11");case 57:return new Fe(I,"320","11");case 58:return new Fe(I,"310","13");case 59:return new Fe(I,"320","13");case 60:return new Fe(I,"310","15");case 61:return new Fe(I,"320","15");case 62:return new Fe(I,"310","17");case 63:return new Fe(I,"320","17")}}catch(n){throw console.log(n),new mt("unknown decoder: "+I)}}class Ue{constructor(n,s,o,f){this.leftchar=n,this.rightchar=s,this.finderpattern=o,this.maybeLast=f}mayBeLast(){return this.maybeLast}getLeftChar(){return this.leftchar}getRightChar(){return this.rightchar}getFinderPattern(){return this.finderpattern}mustBeLast(){return this.rightchar==null}toString(){return"[ "+this.leftchar+", "+this.rightchar+" : "+(this.finderpattern==null?"null":this.finderpattern.getValue())+" ]"}static equals(n,s){return n instanceof Ue?Ue.equalsOrNull(n.leftchar,s.leftchar)&&Ue.equalsOrNull(n.rightchar,s.rightchar)&&Ue.equalsOrNull(n.finderpattern,s.finderpattern):!1}static equalsOrNull(n,s){return n===null?s===null:Ue.equals(n,s)}hashCode(){return this.leftchar.getValue()^this.rightchar.getValue()^this.finderpattern.getValue()}}class tt{constructor(n,s,o){this.pairs=n,this.rowNumber=s,this.wasReversed=o}getPairs(){return this.pairs}getRowNumber(){return this.rowNumber}isReversed(){return this.wasReversed}isEquivalent(n){return this.checkEqualitity(this,n)}toString(){return"{ "+this.pairs+" }"}equals(n,s){return n instanceof tt?this.checkEqualitity(n,s)&&n.wasReversed===s.wasReversed:!1}checkEqualitity(n,s){if(!n||!s)return;let o;return n.forEach((f,l)=>{s.forEach(h=>{f.getLeftChar().getValue()===h.getLeftChar().getValue()&&f.getRightChar().getValue()===h.getRightChar().getValue()&&f.getFinderPatter().getValue()===h.getFinderPatter().getValue()&&(o=!0)})}),o}}class we extends hr{constructor(n){super(...arguments),this.pairs=new Array(we.MAX_PAIRS),this.rows=new Array,this.startEnd=[2],this.verbose=n===!0}decodeRow(n,s,o){this.pairs.length=0,this.startFromEven=!1;try{return we.constructResult(this.decodeRow2pairs(n,s))}catch(f){this.verbose&&console.log(f)}return this.pairs.length=0,this.startFromEven=!0,we.constructResult(this.decodeRow2pairs(n,s))}reset(){this.pairs.length=0,this.rows.length=0}decodeRow2pairs(n,s){let o=!1;for(;!o;)try{this.pairs.push(this.retrieveNextPair(s,this.pairs,n))}catch(l){if(l instanceof q){if(!this.pairs.length)throw new q;o=!0}}if(this.checkChecksum())return this.pairs;let f;if(this.rows.length?f=!0:f=!1,this.storeRow(n,!1),f){let l=this.checkRowsBoolean(!1);if(l!=null||(l=this.checkRowsBoolean(!0),l!=null))return l}throw new q}checkRowsBoolean(n){if(this.rows.length>25)return this.rows.length=0,null;this.pairs.length=0,n&&(this.rows=this.rows.reverse());let s=null;try{s=this.checkRows(new Array,0)}catch(o){this.verbose&&console.log(o)}return n&&(this.rows=this.rows.reverse()),s}checkRows(n,s){for(let o=s;o<this.rows.length;o++){let f=this.rows[o];this.pairs.length=0;for(let h of n)this.pairs.push(h.getPairs());if(this.pairs.push(f.getPairs()),!we.isValidSequence(this.pairs))continue;if(this.checkChecksum())return this.pairs;let l=new Array(n);l.push(f);try{return this.checkRows(l,o+1)}catch(h){this.verbose&&console.log(h)}}throw new q}static isValidSequence(n){for(let s of we.FINDER_PATTERN_SEQUENCES){if(n.length>s.length)continue;let o=!0;for(let f=0;f<n.length;f++)if(n[f].getFinderPattern().getValue()!=s[f]){o=!1;break}if(o)return!0}return!1}storeRow(n,s){let o=0,f=!1,l=!1;for(;o<this.rows.length;){let h=this.rows[o];if(h.getRowNumber()>n){l=h.isEquivalent(this.pairs);break}f=h.isEquivalent(this.pairs),o++}l||f||we.isPartialRow(this.pairs,this.rows)||(this.rows.push(o,new tt(this.pairs,n,s)),this.removePartialRows(this.pairs,this.rows))}removePartialRows(n,s){for(let o of s)if(o.getPairs().length!==n.length){for(let f of o.getPairs())for(let l of n)if(Ue.equals(f,l))break}}static isPartialRow(n,s){for(let o of s){let f=!0;for(let l of n){let h=!1;for(let x of o.getPairs())if(l.equals(x)){h=!0;break}if(!h){f=!1;break}}if(f)return!0}return!1}getRows(){return this.rows}static constructResult(n){let s=Ys.buildBitArray(n),f=Oe(s).parseInformation(),l=n[0].getFinderPattern().getResultPoints(),h=n[n.length-1].getFinderPattern().getResultPoints(),x=[l[0],l[1],h[0],h[1]];return new Z(f,null,null,x,oe.RSS_EXPANDED,null)}checkChecksum(){let n=this.pairs.get(0),s=n.getLeftChar(),o=n.getRightChar();if(o==null)return!1;let f=o.getChecksumPortion(),l=2;for(let x=1;x<this.pairs.size();++x){let p=this.pairs.get(x);f+=p.getLeftChar().getChecksumPortion(),l++;let E=p.getRightChar();E!=null&&(f+=E.getChecksumPortion(),l++)}return f%=211,211*(l-4)+f==s.getValue()}static getNextSecondBar(n,s){let o;return n.get(s)?(o=n.getNextUnset(s),o=n.getNextSet(o)):(o=n.getNextSet(s),o=n.getNextUnset(o)),o}retrieveNextPair(n,s,o){let f=s.length%2==0;this.startFromEven&&(f=!f);let l,h=!0,x=-1;do this.findNextPair(n,s,x),l=this.parseFoundFinderPattern(n,o,f),l==null?x=we.getNextSecondBar(n,this.startEnd[0]):h=!1;while(h);let p=this.decodeDataCharacter(n,l,f,!0);if(!this.isEmptyPair(s)&&s[s.length-1].mustBeLast())throw new q;let E;try{E=this.decodeDataCharacter(n,l,f,!1)}catch(T){E=null,this.verbose&&console.log(T)}return new Ue(p,E,l,!0)}isEmptyPair(n){return n.length===0}findNextPair(n,s,o){let f=this.getDecodeFinderCounters();f[0]=0,f[1]=0,f[2]=0,f[3]=0;let l=n.getSize(),h;o>=0?h=o:this.isEmptyPair(s)?h=0:h=s[s.length-1].getFinderPattern().getStartEnd()[1];let x=s.length%2!=0;this.startFromEven&&(x=!x);let p=!1;for(;h<l&&(p=!n.get(h),!!p);)h++;let E=0,T=h;for(let k=h;k<l;k++)if(n.get(k)!=p)f[E]++;else{if(E==3){if(x&&we.reverseCounters(f),we.isFinderPattern(f)){this.startEnd[0]=T,this.startEnd[1]=k;return}x&&we.reverseCounters(f),T+=f[0]+f[1],f[0]=f[2],f[1]=f[3],f[2]=0,f[3]=0,E--}else E++;f[E]=1,p=!p}throw new q}static reverseCounters(n){let s=n.length;for(let o=0;o<s/2;++o){let f=n[o];n[o]=n[s-o-1],n[s-o-1]=f}}parseFoundFinderPattern(n,s,o){let f,l,h;if(o){let E=this.startEnd[0]-1;for(;E>=0&&!n.get(E);)E--;E++,f=this.startEnd[0]-E,l=E,h=this.startEnd[1]}else l=this.startEnd[0],h=n.getNextUnset(this.startEnd[1]+1),f=h-this.startEnd[1];let x=this.getDecodeFinderCounters();A.arraycopy(x,0,x,1,x.length-1),x[0]=f;let p;try{p=this.parseFinderValue(x,we.FINDER_PATTERNS)}catch{return null}return new La(p,[l,h],l,h,s)}decodeDataCharacter(n,s,o,f){let l=this.getDataCharacterCounters();for(let Rt=0;Rt<l.length;Rt++)l[Rt]=0;if(f)we.recordPatternInReverse(n,s.getStartEnd()[0],l);else{we.recordPattern(n,s.getStartEnd()[1],l);for(let Rt=0,vr=l.length-1;Rt<vr;Rt++,vr--){let jr=l[Rt];l[Rt]=l[vr],l[vr]=jr}}let h=17,x=rt.sum(new Int32Array(l))/h,p=(s.getStartEnd()[1]-s.getStartEnd()[0])/15;if(Math.abs(x-p)/p>.3)throw new q;let E=this.getOddCounts(),T=this.getEvenCounts(),k=this.getOddRoundingErrors(),R=this.getEvenRoundingErrors();for(let Rt=0;Rt<l.length;Rt++){let vr=1*l[Rt]/x,jr=vr+.5;if(jr<1){if(vr<.3)throw new q;jr=1}else if(jr>8){if(vr>8.7)throw new q;jr=8}let Ha=Rt/2;(Rt&1)==0?(E[Ha]=jr,k[Ha]=vr-jr):(T[Ha]=jr,R[Ha]=vr-jr)}this.adjustOddEvenCounts(h);let G=4*s.getValue()+(o?0:2)+(f?0:1)-1,J=0,re=0;for(let Rt=E.length-1;Rt>=0;Rt--){if(we.isNotA1left(s,o,f)){let vr=we.WEIGHTS[G][2*Rt];re+=E[Rt]*vr}J+=E[Rt]}let fe=0;for(let Rt=T.length-1;Rt>=0;Rt--)if(we.isNotA1left(s,o,f)){let vr=we.WEIGHTS[G][2*Rt+1];fe+=T[Rt]*vr}let pe=re+fe;if((J&1)!=0||J>13||J<4)throw new q;let Re=(13-J)/2,De=we.SYMBOL_WIDEST[Re],ke=9-De,Et=tn.getRSSvalue(E,De,!0),at=tn.getRSSvalue(T,ke,!1),Wr=we.EVEN_TOTAL_SUBSET[Re],wn=we.GSUM[Re],Vr=Et*Wr+at+wn;return new jn(Vr,pe)}static isNotA1left(n,s,o){return!(n.getValue()==0&&s&&o)}adjustOddEvenCounts(n){let s=rt.sum(new Int32Array(this.getOddCounts())),o=rt.sum(new Int32Array(this.getEvenCounts())),f=!1,l=!1;s>13?l=!0:s<4&&(f=!0);let h=!1,x=!1;o>13?x=!0:o<4&&(h=!0);let p=s+o-n,E=(s&1)==1,T=(o&1)==0;if(p==1)if(E){if(T)throw new q;l=!0}else{if(!T)throw new q;x=!0}else if(p==-1)if(E){if(T)throw new q;f=!0}else{if(!T)throw new q;h=!0}else if(p==0){if(E){if(!T)throw new q;s<o?(f=!0,x=!0):(l=!0,h=!0)}else if(T)throw new q}else throw new q;if(f){if(l)throw new q;we.increment(this.getOddCounts(),this.getOddRoundingErrors())}if(l&&we.decrement(this.getOddCounts(),this.getOddRoundingErrors()),h){if(x)throw new q;we.increment(this.getEvenCounts(),this.getOddRoundingErrors())}x&&we.decrement(this.getEvenCounts(),this.getEvenRoundingErrors())}}we.SYMBOL_WIDEST=[7,5,4,3,1],we.EVEN_TOTAL_SUBSET=[4,20,52,104,204],we.GSUM=[0,348,1388,2948,3988],we.FINDER_PATTERNS=[Int32Array.from([1,8,4,1]),Int32Array.from([3,6,4,1]),Int32Array.from([3,4,6,1]),Int32Array.from([3,2,8,1]),Int32Array.from([2,6,5,1]),Int32Array.from([2,2,9,1])],we.WEIGHTS=[[1,3,9,27,81,32,96,77],[20,60,180,118,143,7,21,63],[189,145,13,39,117,140,209,205],[193,157,49,147,19,57,171,91],[62,186,136,197,169,85,44,132],[185,133,188,142,4,12,36,108],[113,128,173,97,80,29,87,50],[150,28,84,41,123,158,52,156],[46,138,203,187,139,206,196,166],[76,17,51,153,37,111,122,155],[43,129,176,106,107,110,119,146],[16,48,144,10,30,90,59,177],[109,116,137,200,178,112,125,164],[70,210,208,202,184,130,179,115],[134,191,151,31,93,68,204,190],[148,22,66,198,172,94,71,2],[6,18,54,162,64,192,154,40],[120,149,25,75,14,42,126,167],[79,26,78,23,69,207,199,175],[103,98,83,38,114,131,182,124],[161,61,183,127,170,88,53,159],[55,165,73,8,24,72,5,15],[45,135,194,160,58,174,100,89]],we.FINDER_PAT_A=0,we.FINDER_PAT_B=1,we.FINDER_PAT_C=2,we.FINDER_PAT_D=3,we.FINDER_PAT_E=4,we.FINDER_PAT_F=5,we.FINDER_PATTERN_SEQUENCES=[[we.FINDER_PAT_A,we.FINDER_PAT_A],[we.FINDER_PAT_A,we.FINDER_PAT_B,we.FINDER_PAT_B],[we.FINDER_PAT_A,we.FINDER_PAT_C,we.FINDER_PAT_B,we.FINDER_PAT_D],[we.FINDER_PAT_A,we.FINDER_PAT_E,we.FINDER_PAT_B,we.FINDER_PAT_D,we.FINDER_PAT_C],[we.FINDER_PAT_A,we.FINDER_PAT_E,we.FINDER_PAT_B,we.FINDER_PAT_D,we.FINDER_PAT_D,we.FINDER_PAT_F],[we.FINDER_PAT_A,we.FINDER_PAT_E,we.FINDER_PAT_B,we.FINDER_PAT_D,we.FINDER_PAT_E,we.FINDER_PAT_F,we.FINDER_PAT_F],[we.FINDER_PAT_A,we.FINDER_PAT_A,we.FINDER_PAT_B,we.FINDER_PAT_B,we.FINDER_PAT_C,we.FINDER_PAT_C,we.FINDER_PAT_D,we.FINDER_PAT_D],[we.FINDER_PAT_A,we.FINDER_PAT_A,we.FINDER_PAT_B,we.FINDER_PAT_B,we.FINDER_PAT_C,we.FINDER_PAT_C,we.FINDER_PAT_D,we.FINDER_PAT_E,we.FINDER_PAT_E],[we.FINDER_PAT_A,we.FINDER_PAT_A,we.FINDER_PAT_B,we.FINDER_PAT_B,we.FINDER_PAT_C,we.FINDER_PAT_C,we.FINDER_PAT_D,we.FINDER_PAT_E,we.FINDER_PAT_F,we.FINDER_PAT_F],[we.FINDER_PAT_A,we.FINDER_PAT_A,we.FINDER_PAT_B,we.FINDER_PAT_B,we.FINDER_PAT_C,we.FINDER_PAT_D,we.FINDER_PAT_D,we.FINDER_PAT_E,we.FINDER_PAT_E,we.FINDER_PAT_F,we.FINDER_PAT_F]],we.MAX_PAIRS=11;class Mt extends jn{constructor(n,s,o){super(n,s),this.count=0,this.finderPattern=o}getFinderPattern(){return this.finderPattern}getCount(){return this.count}incrementCount(){this.count++}}class ut extends hr{constructor(){super(...arguments),this.possibleLeftPairs=[],this.possibleRightPairs=[]}decodeRow(n,s,o){const f=this.decodePair(s,!1,n,o);ut.addOrTally(this.possibleLeftPairs,f),s.reverse();let l=this.decodePair(s,!0,n,o);ut.addOrTally(this.possibleRightPairs,l),s.reverse();for(let h of this.possibleLeftPairs)if(h.getCount()>1){for(let x of this.possibleRightPairs)if(x.getCount()>1&&ut.checkChecksum(h,x))return ut.constructResult(h,x)}throw new q}static addOrTally(n,s){if(s==null)return;let o=!1;for(let f of n)if(f.getValue()===s.getValue()){f.incrementCount(),o=!0;break}o||n.push(s)}reset(){this.possibleLeftPairs.length=0,this.possibleRightPairs.length=0}static constructResult(n,s){let o=4537077*n.getValue()+s.getValue(),f=new String(o).toString(),l=new ie;for(let E=13-f.length;E>0;E--)l.append("0");l.append(f);let h=0;for(let E=0;E<13;E++){let T=l.charAt(E).charCodeAt(0)-48;h+=(E&1)===0?3*T:T}h=10-h%10,h===10&&(h=0),l.append(h.toString());let x=n.getFinderPattern().getResultPoints(),p=s.getFinderPattern().getResultPoints();return new Z(l.toString(),null,0,[x[0],x[1],p[0],p[1]],oe.RSS_14,new Date().getTime())}static checkChecksum(n,s){let o=(n.getChecksumPortion()+16*s.getChecksumPortion())%79,f=9*n.getFinderPattern().getValue()+s.getFinderPattern().getValue();return f>72&&f--,f>8&&f--,o===f}decodePair(n,s,o,f){try{let l=this.findFinderPattern(n,s),h=this.parseFoundFinderPattern(n,o,s,l),x=f==null?null:f.get(W.NEED_RESULT_POINT_CALLBACK);if(x!=null){let T=(l[0]+l[1])/2;s&&(T=n.getSize()-1-T),x.foundPossibleResultPoint(new Ve(T,o))}let p=this.decodeDataCharacter(n,h,!0),E=this.decodeDataCharacter(n,h,!1);return new Mt(1597*p.getValue()+E.getValue(),p.getChecksumPortion()+4*E.getChecksumPortion(),h)}catch{return null}}decodeDataCharacter(n,s,o){let f=this.getDataCharacterCounters();for(let fe=0;fe<f.length;fe++)f[fe]=0;if(o)ft.recordPatternInReverse(n,s.getStartEnd()[0],f);else{ft.recordPattern(n,s.getStartEnd()[1]+1,f);for(let fe=0,pe=f.length-1;fe<pe;fe++,pe--){let Re=f[fe];f[fe]=f[pe],f[pe]=Re}}let l=o?16:15,h=rt.sum(new Int32Array(f))/l,x=this.getOddCounts(),p=this.getEvenCounts(),E=this.getOddRoundingErrors(),T=this.getEvenRoundingErrors();for(let fe=0;fe<f.length;fe++){let pe=f[fe]/h,Re=Math.floor(pe+.5);Re<1?Re=1:Re>8&&(Re=8);let De=Math.floor(fe/2);(fe&1)===0?(x[De]=Re,E[De]=pe-Re):(p[De]=Re,T[De]=pe-Re)}this.adjustOddEvenCounts(o,l);let k=0,R=0;for(let fe=x.length-1;fe>=0;fe--)R*=9,R+=x[fe],k+=x[fe];let G=0,J=0;for(let fe=p.length-1;fe>=0;fe--)G*=9,G+=p[fe],J+=p[fe];let re=R+3*G;if(o){if((k&1)!==0||k>12||k<4)throw new q;let fe=(12-k)/2,pe=ut.OUTSIDE_ODD_WIDEST[fe],Re=9-pe,De=tn.getRSSvalue(x,pe,!1),ke=tn.getRSSvalue(p,Re,!0),Et=ut.OUTSIDE_EVEN_TOTAL_SUBSET[fe],at=ut.OUTSIDE_GSUM[fe];return new jn(De*Et+ke+at,re)}else{if((J&1)!==0||J>10||J<4)throw new q;let fe=(10-J)/2,pe=ut.INSIDE_ODD_WIDEST[fe],Re=9-pe,De=tn.getRSSvalue(x,pe,!0),ke=tn.getRSSvalue(p,Re,!1),Et=ut.INSIDE_ODD_TOTAL_SUBSET[fe],at=ut.INSIDE_GSUM[fe];return new jn(ke*Et+De+at,re)}}findFinderPattern(n,s){let o=this.getDecodeFinderCounters();o[0]=0,o[1]=0,o[2]=0,o[3]=0;let f=n.getSize(),l=!1,h=0;for(;h<f&&(l=!n.get(h),s!==l);)h++;let x=0,p=h;for(let E=h;E<f;E++)if(n.get(E)!==l)o[x]++;else{if(x===3){if(hr.isFinderPattern(o))return[p,E];p+=o[0]+o[1],o[0]=o[2],o[1]=o[3],o[2]=0,o[3]=0,x--}else x++;o[x]=1,l=!l}throw new q}parseFoundFinderPattern(n,s,o,f){let l=n.get(f[0]),h=f[0]-1;for(;h>=0&&l!==n.get(h);)h--;h++;const x=f[0]-h,p=this.getDecodeFinderCounters(),E=new Int32Array(p.length);A.arraycopy(p,0,E,1,p.length-1),E[0]=x;const T=this.parseFinderValue(E,ut.FINDER_PATTERNS);let k=h,R=f[1];return o&&(k=n.getSize()-1-k,R=n.getSize()-1-R),new La(T,[h,f[1]],k,R,s)}adjustOddEvenCounts(n,s){let o=rt.sum(new Int32Array(this.getOddCounts())),f=rt.sum(new Int32Array(this.getEvenCounts())),l=!1,h=!1,x=!1,p=!1;n?(o>12?h=!0:o<4&&(l=!0),f>12?p=!0:f<4&&(x=!0)):(o>11?h=!0:o<5&&(l=!0),f>10?p=!0:f<4&&(x=!0));let E=o+f-s,T=(o&1)===(n?1:0),k=(f&1)===1;if(E===1)if(T){if(k)throw new q;h=!0}else{if(!k)throw new q;p=!0}else if(E===-1)if(T){if(k)throw new q;l=!0}else{if(!k)throw new q;x=!0}else if(E===0){if(T){if(!k)throw new q;o<f?(l=!0,p=!0):(h=!0,x=!0)}else if(k)throw new q}else throw new q;if(l){if(h)throw new q;hr.increment(this.getOddCounts(),this.getOddRoundingErrors())}if(h&&hr.decrement(this.getOddCounts(),this.getOddRoundingErrors()),x){if(p)throw new q;hr.increment(this.getEvenCounts(),this.getOddRoundingErrors())}p&&hr.decrement(this.getEvenCounts(),this.getEvenRoundingErrors())}}ut.OUTSIDE_EVEN_TOTAL_SUBSET=[1,10,34,70,126],ut.INSIDE_ODD_TOTAL_SUBSET=[4,20,48,81],ut.OUTSIDE_GSUM=[0,161,961,2015,2715],ut.INSIDE_GSUM=[0,336,1036,1516],ut.OUTSIDE_ODD_WIDEST=[8,6,4,3,1],ut.INSIDE_ODD_WIDEST=[2,4,6,8],ut.FINDER_PATTERNS=[Int32Array.from([3,8,2,1]),Int32Array.from([3,5,5,1]),Int32Array.from([3,3,7,1]),Int32Array.from([3,1,9,1]),Int32Array.from([2,7,4,1]),Int32Array.from([2,5,6,1]),Int32Array.from([2,3,8,1]),Int32Array.from([1,5,7,1]),Int32Array.from([1,3,9,1])];class rn extends ft{constructor(n,s){super(),this.readers=[],this.verbose=s===!0;const o=n?n.get(W.POSSIBLE_FORMATS):null,f=n&&n.get(W.ASSUME_CODE_39_CHECK_DIGIT)!==void 0;o?((o.includes(oe.EAN_13)||o.includes(oe.UPC_A)||o.includes(oe.EAN_8)||o.includes(oe.UPC_E))&&this.readers.push(new fi(n)),o.includes(oe.CODE_39)&&this.readers.push(new jt(f)),o.includes(oe.CODE_128)&&this.readers.push(new Be),o.includes(oe.ITF)&&this.readers.push(new St),o.includes(oe.RSS_14)&&this.readers.push(new ut),o.includes(oe.RSS_EXPANDED)&&this.readers.push(new we(this.verbose))):(this.readers.push(new fi(n)),this.readers.push(new jt),this.readers.push(new fi(n)),this.readers.push(new Be),this.readers.push(new St),this.readers.push(new ut),this.readers.push(new we(this.verbose)))}decodeRow(n,s,o){for(let f=0;f<this.readers.length;f++)try{return this.readers[f].decodeRow(n,s,o)}catch{}throw new q}reset(){this.readers.forEach(n=>n.reset())}}class da extends ne{constructor(n=500,s){super(new rn(s),n,s)}}class wt{constructor(n,s,o){this.ecCodewords=n,this.ecBlocks=[s],o&&this.ecBlocks.push(o)}getECCodewords(){return this.ecCodewords}getECBlocks(){return this.ecBlocks}}class ht{constructor(n,s){this.count=n,this.dataCodewords=s}getCount(){return this.count}getDataCodewords(){return this.dataCodewords}}class dt{constructor(n,s,o,f,l,h){this.versionNumber=n,this.symbolSizeRows=s,this.symbolSizeColumns=o,this.dataRegionSizeRows=f,this.dataRegionSizeColumns=l,this.ecBlocks=h;let x=0;const p=h.getECCodewords(),E=h.getECBlocks();for(let T of E)x+=T.getCount()*(T.getDataCodewords()+p);this.totalCodewords=x}getVersionNumber(){return this.versionNumber}getSymbolSizeRows(){return this.symbolSizeRows}getSymbolSizeColumns(){return this.symbolSizeColumns}getDataRegionSizeRows(){return this.dataRegionSizeRows}getDataRegionSizeColumns(){return this.dataRegionSizeColumns}getTotalCodewords(){return this.totalCodewords}getECBlocks(){return this.ecBlocks}static getVersionForDimensions(n,s){if((n&1)!==0||(s&1)!==0)throw new N;for(let o of dt.VERSIONS)if(o.symbolSizeRows===n&&o.symbolSizeColumns===s)return o;throw new N}toString(){return""+this.versionNumber}static buildVersions(){return[new dt(1,10,10,8,8,new wt(5,new ht(1,3))),new dt(2,12,12,10,10,new wt(7,new ht(1,5))),new dt(3,14,14,12,12,new wt(10,new ht(1,8))),new dt(4,16,16,14,14,new wt(12,new ht(1,12))),new dt(5,18,18,16,16,new wt(14,new ht(1,18))),new dt(6,20,20,18,18,new wt(18,new ht(1,22))),new dt(7,22,22,20,20,new wt(20,new ht(1,30))),new dt(8,24,24,22,22,new wt(24,new ht(1,36))),new dt(9,26,26,24,24,new wt(28,new ht(1,44))),new dt(10,32,32,14,14,new wt(36,new ht(1,62))),new dt(11,36,36,16,16,new wt(42,new ht(1,86))),new dt(12,40,40,18,18,new wt(48,new ht(1,114))),new dt(13,44,44,20,20,new wt(56,new ht(1,144))),new dt(14,48,48,22,22,new wt(68,new ht(1,174))),new dt(15,52,52,24,24,new wt(42,new ht(2,102))),new dt(16,64,64,14,14,new wt(56,new ht(2,140))),new dt(17,72,72,16,16,new wt(36,new ht(4,92))),new dt(18,80,80,18,18,new wt(48,new ht(4,114))),new dt(19,88,88,20,20,new wt(56,new ht(4,144))),new dt(20,96,96,22,22,new wt(68,new ht(4,174))),new dt(21,104,104,24,24,new wt(56,new ht(6,136))),new dt(22,120,120,18,18,new wt(68,new ht(6,175))),new dt(23,132,132,20,20,new wt(62,new ht(8,163))),new dt(24,144,144,22,22,new wt(62,new ht(8,156),new ht(2,155))),new dt(25,8,18,6,16,new wt(7,new ht(1,5))),new dt(26,8,32,6,14,new wt(11,new ht(1,10))),new dt(27,12,26,10,24,new wt(14,new ht(1,16))),new dt(28,12,36,10,16,new wt(18,new ht(1,22))),new dt(29,16,36,14,16,new wt(24,new ht(1,32))),new dt(30,16,48,14,22,new wt(28,new ht(1,49)))]}}dt.VERSIONS=dt.buildVersions();class Kr{constructor(n){const s=n.getHeight();if(s<8||s>144||(s&1)!==0)throw new N;this.version=Kr.readVersion(n),this.mappingBitMatrix=this.extractDataRegion(n),this.readMappingMatrix=new Ee(this.mappingBitMatrix.getWidth(),this.mappingBitMatrix.getHeight())}getVersion(){return this.version}static readVersion(n){const s=n.getHeight(),o=n.getWidth();return dt.getVersionForDimensions(s,o)}readCodewords(){const n=new Int8Array(this.version.getTotalCodewords());let s=0,o=4,f=0;const l=this.mappingBitMatrix.getHeight(),h=this.mappingBitMatrix.getWidth();let x=!1,p=!1,E=!1,T=!1;do if(o===l&&f===0&&!x)n[s++]=this.readCorner1(l,h)&255,o-=2,f+=2,x=!0;else if(o===l-2&&f===0&&(h&3)!==0&&!p)n[s++]=this.readCorner2(l,h)&255,o-=2,f+=2,p=!0;else if(o===l+4&&f===2&&(h&7)===0&&!E)n[s++]=this.readCorner3(l,h)&255,o-=2,f+=2,E=!0;else if(o===l-2&&f===0&&(h&7)===4&&!T)n[s++]=this.readCorner4(l,h)&255,o-=2,f+=2,T=!0;else{do o<l&&f>=0&&!this.readMappingMatrix.get(f,o)&&(n[s++]=this.readUtah(o,f,l,h)&255),o-=2,f+=2;while(o>=0&&f<h);o+=1,f+=3;do o>=0&&f<h&&!this.readMappingMatrix.get(f,o)&&(n[s++]=this.readUtah(o,f,l,h)&255),o+=2,f-=2;while(o<l&&f>=0);o+=3,f+=1}while(o<l||f<h);if(s!==this.version.getTotalCodewords())throw new N;return n}readModule(n,s,o,f){return n<0&&(n+=o,s+=4-(o+4&7)),s<0&&(s+=f,n+=4-(f+4&7)),this.readMappingMatrix.set(s,n),this.mappingBitMatrix.get(s,n)}readUtah(n,s,o,f){let l=0;return this.readModule(n-2,s-2,o,f)&&(l|=1),l<<=1,this.readModule(n-2,s-1,o,f)&&(l|=1),l<<=1,this.readModule(n-1,s-2,o,f)&&(l|=1),l<<=1,this.readModule(n-1,s-1,o,f)&&(l|=1),l<<=1,this.readModule(n-1,s,o,f)&&(l|=1),l<<=1,this.readModule(n,s-2,o,f)&&(l|=1),l<<=1,this.readModule(n,s-1,o,f)&&(l|=1),l<<=1,this.readModule(n,s,o,f)&&(l|=1),l}readCorner1(n,s){let o=0;return this.readModule(n-1,0,n,s)&&(o|=1),o<<=1,this.readModule(n-1,1,n,s)&&(o|=1),o<<=1,this.readModule(n-1,2,n,s)&&(o|=1),o<<=1,this.readModule(0,s-2,n,s)&&(o|=1),o<<=1,this.readModule(0,s-1,n,s)&&(o|=1),o<<=1,this.readModule(1,s-1,n,s)&&(o|=1),o<<=1,this.readModule(2,s-1,n,s)&&(o|=1),o<<=1,this.readModule(3,s-1,n,s)&&(o|=1),o}readCorner2(n,s){let o=0;return this.readModule(n-3,0,n,s)&&(o|=1),o<<=1,this.readModule(n-2,0,n,s)&&(o|=1),o<<=1,this.readModule(n-1,0,n,s)&&(o|=1),o<<=1,this.readModule(0,s-4,n,s)&&(o|=1),o<<=1,this.readModule(0,s-3,n,s)&&(o|=1),o<<=1,this.readModule(0,s-2,n,s)&&(o|=1),o<<=1,this.readModule(0,s-1,n,s)&&(o|=1),o<<=1,this.readModule(1,s-1,n,s)&&(o|=1),o}readCorner3(n,s){let o=0;return this.readModule(n-1,0,n,s)&&(o|=1),o<<=1,this.readModule(n-1,s-1,n,s)&&(o|=1),o<<=1,this.readModule(0,s-3,n,s)&&(o|=1),o<<=1,this.readModule(0,s-2,n,s)&&(o|=1),o<<=1,this.readModule(0,s-1,n,s)&&(o|=1),o<<=1,this.readModule(1,s-3,n,s)&&(o|=1),o<<=1,this.readModule(1,s-2,n,s)&&(o|=1),o<<=1,this.readModule(1,s-1,n,s)&&(o|=1),o}readCorner4(n,s){let o=0;return this.readModule(n-3,0,n,s)&&(o|=1),o<<=1,this.readModule(n-2,0,n,s)&&(o|=1),o<<=1,this.readModule(n-1,0,n,s)&&(o|=1),o<<=1,this.readModule(0,s-2,n,s)&&(o|=1),o<<=1,this.readModule(0,s-1,n,s)&&(o|=1),o<<=1,this.readModule(1,s-1,n,s)&&(o|=1),o<<=1,this.readModule(2,s-1,n,s)&&(o|=1),o<<=1,this.readModule(3,s-1,n,s)&&(o|=1),o}extractDataRegion(n){const s=this.version.getSymbolSizeRows(),o=this.version.getSymbolSizeColumns();if(n.getHeight()!==s)throw new v("Dimension of bitMatrix must match the version size");const f=this.version.getDataRegionSizeRows(),l=this.version.getDataRegionSizeColumns(),h=s/f|0,x=o/l|0,p=h*f,E=x*l,T=new Ee(E,p);for(let k=0;k<h;++k){const R=k*f;for(let G=0;G<x;++G){const J=G*l;for(let re=0;re<f;++re){const fe=k*(f+2)+1+re,pe=R+re;for(let Re=0;Re<l;++Re){const De=G*(l+2)+1+Re;if(n.get(De,fe)){const ke=J+Re;T.set(ke,pe)}}}}}return T}}class Ks{constructor(n,s){this.numDataCodewords=n,this.codewords=s}static getDataBlocks(n,s){const o=s.getECBlocks();let f=0;const l=o.getECBlocks();for(let re of l)f+=re.getCount();const h=new Array(f);let x=0;for(let re of l)for(let fe=0;fe<re.getCount();fe++){const pe=re.getDataCodewords(),Re=o.getECCodewords()+pe;h[x++]=new Ks(pe,new Uint8Array(Re))}const E=h[0].codewords.length-o.getECCodewords(),T=E-1;let k=0;for(let re=0;re<T;re++)for(let fe=0;fe<x;fe++)h[fe].codewords[re]=n[k++];const R=s.getVersionNumber()===24,G=R?8:x;for(let re=0;re<G;re++)h[re].codewords[E-1]=n[k++];const J=h[0].codewords.length;for(let re=E;re<J;re++)for(let fe=0;fe<x;fe++){const pe=R?(fe+8)%x:fe,Re=R&&pe>7?re-1:re;h[pe].codewords[Re]=n[k++]}if(k!==n.length)throw new v;return h}getNumDataCodewords(){return this.numDataCodewords}getCodewords(){return this.codewords}}class js{constructor(n){this.bytes=n,this.byteOffset=0,this.bitOffset=0}getBitOffset(){return this.bitOffset}getByteOffset(){return this.byteOffset}readBits(n){if(n<1||n>32||n>this.available())throw new v(""+n);let s=0,o=this.bitOffset,f=this.byteOffset;const l=this.bytes;if(o>0){const h=8-o,x=n<h?n:h,p=h-x,E=255>>8-x<<p;s=(l[f]&E)>>p,n-=x,o+=x,o===8&&(o=0,f++)}if(n>0){for(;n>=8;)s=s<<8|l[f]&255,f++,n-=8;if(n>0){const h=8-n,x=255>>h<<h;s=s<<n|(l[f]&x)>>h,o+=n}}return this.bitOffset=o,this.byteOffset=f,s}available(){return 8*(this.bytes.length-this.byteOffset)-this.bitOffset}}var cr;(function(I){I[I.PAD_ENCODE=0]="PAD_ENCODE",I[I.ASCII_ENCODE=1]="ASCII_ENCODE",I[I.C40_ENCODE=2]="C40_ENCODE",I[I.TEXT_ENCODE=3]="TEXT_ENCODE",I[I.ANSIX12_ENCODE=4]="ANSIX12_ENCODE",I[I.EDIFACT_ENCODE=5]="EDIFACT_ENCODE",I[I.BASE256_ENCODE=6]="BASE256_ENCODE"})(cr||(cr={}));class Zn{static decode(n){const s=new js(n),o=new ie,f=new ie,l=new Array;let h=cr.ASCII_ENCODE;do if(h===cr.ASCII_ENCODE)h=this.decodeAsciiSegment(s,o,f);else{switch(h){case cr.C40_ENCODE:this.decodeC40Segment(s,o);break;case cr.TEXT_ENCODE:this.decodeTextSegment(s,o);break;case cr.ANSIX12_ENCODE:this.decodeAnsiX12Segment(s,o);break;case cr.EDIFACT_ENCODE:this.decodeEdifactSegment(s,o);break;case cr.BASE256_ENCODE:this.decodeBase256Segment(s,o,l);break;default:throw new N}h=cr.ASCII_ENCODE}while(h!==cr.PAD_ENCODE&&s.available()>0);return f.length()>0&&o.append(f.toString()),new Te(n,o.toString(),l.length===0?null:l,null)}static decodeAsciiSegment(n,s,o){let f=!1;do{let l=n.readBits(8);if(l===0)throw new N;if(l<=128)return f&&(l+=128),s.append(String.fromCharCode(l-1)),cr.ASCII_ENCODE;if(l===129)return cr.PAD_ENCODE;if(l<=229){const h=l-130;h<10&&s.append("0"),s.append(""+h)}else switch(l){case 230:return cr.C40_ENCODE;case 231:return cr.BASE256_ENCODE;case 232:s.append("");break;case 233:case 234:break;case 235:f=!0;break;case 236:s.append("[)>05"),o.insert(0,"");break;case 237:s.append("[)>06"),o.insert(0,"");break;case 238:return cr.ANSIX12_ENCODE;case 239:return cr.TEXT_ENCODE;case 240:return cr.EDIFACT_ENCODE;case 241:break;default:if(l!==254||n.available()!==0)throw new N;break}}while(n.available()>0);return cr.ASCII_ENCODE}static decodeC40Segment(n,s){let o=!1;const f=[];let l=0;do{if(n.available()===8)return;const h=n.readBits(8);if(h===254)return;this.parseTwoBytes(h,n.readBits(8),f);for(let x=0;x<3;x++){const p=f[x];switch(l){case 0:if(p<3)l=p+1;else if(p<this.C40_BASIC_SET_CHARS.length){const E=this.C40_BASIC_SET_CHARS[p];o?(s.append(String.fromCharCode(E.charCodeAt(0)+128)),o=!1):s.append(E)}else throw new N;break;case 1:o?(s.append(String.fromCharCode(p+128)),o=!1):s.append(String.fromCharCode(p)),l=0;break;case 2:if(p<this.C40_SHIFT2_SET_CHARS.length){const E=this.C40_SHIFT2_SET_CHARS[p];o?(s.append(String.fromCharCode(E.charCodeAt(0)+128)),o=!1):s.append(E)}else switch(p){case 27:s.append("");break;case 30:o=!0;break;default:throw new N}l=0;break;case 3:o?(s.append(String.fromCharCode(p+224)),o=!1):s.append(String.fromCharCode(p+96)),l=0;break;default:throw new N}}}while(n.available()>0)}static decodeTextSegment(n,s){let o=!1,f=[],l=0;do{if(n.available()===8)return;const h=n.readBits(8);if(h===254)return;this.parseTwoBytes(h,n.readBits(8),f);for(let x=0;x<3;x++){const p=f[x];switch(l){case 0:if(p<3)l=p+1;else if(p<this.TEXT_BASIC_SET_CHARS.length){const E=this.TEXT_BASIC_SET_CHARS[p];o?(s.append(String.fromCharCode(E.charCodeAt(0)+128)),o=!1):s.append(E)}else throw new N;break;case 1:o?(s.append(String.fromCharCode(p+128)),o=!1):s.append(String.fromCharCode(p)),l=0;break;case 2:if(p<this.TEXT_SHIFT2_SET_CHARS.length){const E=this.TEXT_SHIFT2_SET_CHARS[p];o?(s.append(String.fromCharCode(E.charCodeAt(0)+128)),o=!1):s.append(E)}else switch(p){case 27:s.append("");break;case 30:o=!0;break;default:throw new N}l=0;break;case 3:if(p<this.TEXT_SHIFT3_SET_CHARS.length){const E=this.TEXT_SHIFT3_SET_CHARS[p];o?(s.append(String.fromCharCode(E.charCodeAt(0)+128)),o=!1):s.append(E),l=0}else throw new N;break;default:throw new N}}}while(n.available()>0)}static decodeAnsiX12Segment(n,s){const o=[];do{if(n.available()===8)return;const f=n.readBits(8);if(f===254)return;this.parseTwoBytes(f,n.readBits(8),o);for(let l=0;l<3;l++){const h=o[l];switch(h){case 0:s.append("\r");break;case 1:s.append("*");break;case 2:s.append(">");break;case 3:s.append(" ");break;default:if(h<14)s.append(String.fromCharCode(h+44));else if(h<40)s.append(String.fromCharCode(h+51));else throw new N;break}}}while(n.available()>0)}static parseTwoBytes(n,s,o){let f=(n<<8)+s-1,l=Math.floor(f/1600);o[0]=l,f-=l*1600,l=Math.floor(f/40),o[1]=l,o[2]=f-l*40}static decodeEdifactSegment(n,s){do{if(n.available()<=16)return;for(let o=0;o<4;o++){let f=n.readBits(6);if(f===31){const l=8-n.getBitOffset();l!==8&&n.readBits(l);return}(f&32)===0&&(f|=64),s.append(String.fromCharCode(f))}}while(n.available()>0)}static decodeBase256Segment(n,s,o){let f=1+n.getByteOffset();const l=this.unrandomize255State(n.readBits(8),f++);let h;if(l===0?h=n.available()/8|0:l<250?h=l:h=250*(l-249)+this.unrandomize255State(n.readBits(8),f++),h<0)throw new N;const x=new Uint8Array(h);for(let p=0;p<h;p++){if(n.available()<8)throw new N;x[p]=this.unrandomize255State(n.readBits(8),f++)}o.push(x);try{s.append(Q.decode(x,X.ISO88591))}catch(p){throw new mt("Platform does not support required encoding: "+p.message)}}static unrandomize255State(n,s){const o=149*s%255+1,f=n-o;return f>=0?f:f+256}}Zn.C40_BASIC_SET_CHARS=["*","*","*"," ","0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"],Zn.C40_SHIFT2_SET_CHARS=["!",'"',"#","$","%","&","'","(",")","*","+",",","-",".","/",":",";","<","=",">","?","@","[","\\","]","^","_"],Zn.TEXT_BASIC_SET_CHARS=["*","*","*"," ","0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z"],Zn.TEXT_SHIFT2_SET_CHARS=Zn.C40_SHIFT2_SET_CHARS,Zn.TEXT_SHIFT3_SET_CHARS=["`","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","{","|","}","~",""];class Ru{constructor(){this.rsDecoder=new nt(Xe.DATA_MATRIX_FIELD_256)}decode(n){const s=new Kr(n),o=s.getVersion(),f=s.readCodewords(),l=Ks.getDataBlocks(f,o);let h=0;for(let E of l)h+=E.getNumDataCodewords();const x=new Uint8Array(h),p=l.length;for(let E=0;E<p;E++){const T=l[E],k=T.getCodewords(),R=T.getNumDataCodewords();this.correctErrors(k,R);for(let G=0;G<R;G++)x[G*p+E]=k[G]}return Zn.decode(x)}correctErrors(n,s){const o=new Int32Array(n);try{this.rsDecoder.decode(o,n.length-s)}catch{throw new C}for(let f=0;f<s;f++)n[f]=o[f]}}class er{constructor(n){this.image=n,this.rectangleDetector=new Xt(this.image)}detect(){const n=this.rectangleDetector.detect();let s=this.detectSolid1(n);if(s=this.detectSolid2(s),s[3]=this.correctTopRight(s),!s[3])throw new q;s=this.shiftToModuleCenter(s);const o=s[0],f=s[1],l=s[2],h=s[3];let x=this.transitionsBetween(o,h)+1,p=this.transitionsBetween(l,h)+1;(x&1)===1&&(x+=1),(p&1)===1&&(p+=1),4*x<7*p&&4*p<7*x&&(x=p=Math.max(x,p));let E=er.sampleGrid(this.image,o,f,l,h,x,p);return new Tn(E,[o,f,l,h])}static shiftPoint(n,s,o){let f=(s.getX()-n.getX())/(o+1),l=(s.getY()-n.getY())/(o+1);return new Ve(n.getX()+f,n.getY()+l)}static moveAway(n,s,o){let f=n.getX(),l=n.getY();return f<s?f-=1:f+=1,l<o?l-=1:l+=1,new Ve(f,l)}detectSolid1(n){let s=n[0],o=n[1],f=n[3],l=n[2],h=this.transitionsBetween(s,o),x=this.transitionsBetween(o,f),p=this.transitionsBetween(f,l),E=this.transitionsBetween(l,s),T=h,k=[l,s,o,f];return T>x&&(T=x,k[0]=s,k[1]=o,k[2]=f,k[3]=l),T>p&&(T=p,k[0]=o,k[1]=f,k[2]=l,k[3]=s),T>E&&(k[0]=f,k[1]=l,k[2]=s,k[3]=o),k}detectSolid2(n){let s=n[0],o=n[1],f=n[2],l=n[3],h=this.transitionsBetween(s,l),x=er.shiftPoint(o,f,(h+1)*4),p=er.shiftPoint(f,o,(h+1)*4),E=this.transitionsBetween(x,s),T=this.transitionsBetween(p,l);return E<T?(n[0]=s,n[1]=o,n[2]=f,n[3]=l):(n[0]=o,n[1]=f,n[2]=l,n[3]=s),n}correctTopRight(n){let s=n[0],o=n[1],f=n[2],l=n[3],h=this.transitionsBetween(s,l),x=this.transitionsBetween(o,l),p=er.shiftPoint(s,o,(x+1)*4),E=er.shiftPoint(f,o,(h+1)*4);h=this.transitionsBetween(p,l),x=this.transitionsBetween(E,l);let T=new Ve(l.getX()+(f.getX()-o.getX())/(h+1),l.getY()+(f.getY()-o.getY())/(h+1)),k=new Ve(l.getX()+(s.getX()-o.getX())/(x+1),l.getY()+(s.getY()-o.getY())/(x+1));if(!this.isValid(T))return this.isValid(k)?k:null;if(!this.isValid(k))return T;let R=this.transitionsBetween(p,T)+this.transitionsBetween(E,T),G=this.transitionsBetween(p,k)+this.transitionsBetween(E,k);return R>G?T:k}shiftToModuleCenter(n){let s=n[0],o=n[1],f=n[2],l=n[3],h=this.transitionsBetween(s,l)+1,x=this.transitionsBetween(f,l)+1,p=er.shiftPoint(s,o,x*4),E=er.shiftPoint(f,o,h*4);h=this.transitionsBetween(p,l)+1,x=this.transitionsBetween(E,l)+1,(h&1)===1&&(h+=1),(x&1)===1&&(x+=1);let T=(s.getX()+o.getX()+f.getX()+l.getX())/4,k=(s.getY()+o.getY()+f.getY()+l.getY())/4;s=er.moveAway(s,T,k),o=er.moveAway(o,T,k),f=er.moveAway(f,T,k),l=er.moveAway(l,T,k);let R,G;return p=er.shiftPoint(s,o,x*4),p=er.shiftPoint(p,l,h*4),R=er.shiftPoint(o,s,x*4),R=er.shiftPoint(R,f,h*4),E=er.shiftPoint(f,l,x*4),E=er.shiftPoint(E,o,h*4),G=er.shiftPoint(l,f,x*4),G=er.shiftPoint(G,s,h*4),[p,R,E,G]}isValid(n){return n.getX()>=0&&n.getX()<this.image.getWidth()&&n.getY()>0&&n.getY()<this.image.getHeight()}static sampleGrid(n,s,o,f,l,h,x){return Ht.getInstance().sampleGrid(n,h,x,.5,.5,h-.5,.5,h-.5,x-.5,.5,x-.5,s.getX(),s.getY(),l.getX(),l.getY(),f.getX(),f.getY(),o.getX(),o.getY())}transitionsBetween(n,s){let o=Math.trunc(n.getX()),f=Math.trunc(n.getY()),l=Math.trunc(s.getX()),h=Math.trunc(s.getY()),x=Math.abs(h-f)>Math.abs(l-o);if(x){let re=o;o=f,f=re,re=l,l=h,h=re}let p=Math.abs(l-o),E=Math.abs(h-f),T=-p/2,k=f<h?1:-1,R=o<l?1:-1,G=0,J=this.image.get(x?f:o,x?o:f);for(let re=o,fe=f;re!==l;re+=R){let pe=this.image.get(x?fe:re,x?re:fe);if(pe!==J&&(G++,J=pe),T+=E,T>0){if(fe===h)break;fe+=k,T-=p}}return G}}class qn{constructor(){this.decoder=new Ru}decode(n,s=null){let o,f;if(s!=null&&s.has(W.PURE_BARCODE)){const E=qn.extractPureBits(n.getBlackMatrix());o=this.decoder.decode(E),f=qn.NO_POINTS}else{const E=new er(n.getBlackMatrix()).detect();o=this.decoder.decode(E.getBits()),f=E.getPoints()}const l=o.getRawBytes(),h=new Z(o.getText(),l,8*l.length,f,oe.DATA_MATRIX,A.currentTimeMillis()),x=o.getByteSegments();x!=null&&h.putMetadata(Ae.BYTE_SEGMENTS,x);const p=o.getECLevel();return p!=null&&h.putMetadata(Ae.ERROR_CORRECTION_LEVEL,p),h}reset(){}static extractPureBits(n){const s=n.getTopLeftOnBit(),o=n.getBottomRightOnBit();if(s==null||o==null)throw new q;const f=this.moduleSize(s,n);let l=s[1];const h=o[1];let x=s[0];const E=(o[0]-x+1)/f,T=(h-l+1)/f;if(E<=0||T<=0)throw new q;const k=f/2;l+=k,x+=k;const R=new Ee(E,T);for(let G=0;G<T;G++){const J=l+G*f;for(let re=0;re<E;re++)n.get(x+re*f,J)&&R.set(re,G)}return R}static moduleSize(n,s){const o=s.getWidth();let f=n[0];const l=n[1];for(;f<o&&s.get(f,l);)f++;if(f===o)throw new q;const h=f-n[0];if(h===0)throw new q;return h}}qn.NO_POINTS=[];class Ou extends ne{constructor(n=500){super(new qn,n)}}var Ua;(function(I){I[I.L=0]="L",I[I.M=1]="M",I[I.Q=2]="Q",I[I.H=3]="H"})(Ua||(Ua={}));class Bt{constructor(n,s,o){this.value=n,this.stringValue=s,this.bits=o,Bt.FOR_BITS.set(o,this),Bt.FOR_VALUE.set(n,this)}getValue(){return this.value}getBits(){return this.bits}static fromString(n){switch(n){case"L":return Bt.L;case"M":return Bt.M;case"Q":return Bt.Q;case"H":return Bt.H;default:throw new w(n+"not available")}}toString(){return this.stringValue}equals(n){if(!(n instanceof Bt))return!1;const s=n;return this.value===s.value}static forBits(n){if(n<0||n>=Bt.FOR_BITS.size)throw new v;return Bt.FOR_BITS.get(n)}}Bt.FOR_BITS=new Map,Bt.FOR_VALUE=new Map,Bt.L=new Bt(Ua.L,"L",1),Bt.M=new Bt(Ua.M,"M",0),Bt.Q=new Bt(Ua.Q,"Q",3),Bt.H=new Bt(Ua.H,"H",2);class Sr{constructor(n){this.errorCorrectionLevel=Bt.forBits(n>>3&3),this.dataMask=n&7}static numBitsDiffering(n,s){return b.bitCount(n^s)}static decodeFormatInformation(n,s){const o=Sr.doDecodeFormatInformation(n,s);return o!==null?o:Sr.doDecodeFormatInformation(n^Sr.FORMAT_INFO_MASK_QR,s^Sr.FORMAT_INFO_MASK_QR)}static doDecodeFormatInformation(n,s){let o=Number.MAX_SAFE_INTEGER,f=0;for(const l of Sr.FORMAT_INFO_DECODE_LOOKUP){const h=l[0];if(h===n||h===s)return new Sr(l[1]);let x=Sr.numBitsDiffering(n,h);x<o&&(f=l[1],o=x),n!==s&&(x=Sr.numBitsDiffering(s,h),x<o&&(f=l[1],o=x))}return o<=3?new Sr(f):null}getErrorCorrectionLevel(){return this.errorCorrectionLevel}getDataMask(){return this.dataMask}hashCode(){return this.errorCorrectionLevel.getBits()<<3|this.dataMask}equals(n){if(!(n instanceof Sr))return!1;const s=n;return this.errorCorrectionLevel===s.errorCorrectionLevel&&this.dataMask===s.dataMask}}Sr.FORMAT_INFO_MASK_QR=21522,Sr.FORMAT_INFO_DECODE_LOOKUP=[Int32Array.from([21522,0]),Int32Array.from([20773,1]),Int32Array.from([24188,2]),Int32Array.from([23371,3]),Int32Array.from([17913,4]),Int32Array.from([16590,5]),Int32Array.from([20375,6]),Int32Array.from([19104,7]),Int32Array.from([30660,8]),Int32Array.from([29427,9]),Int32Array.from([32170,10]),Int32Array.from([30877,11]),Int32Array.from([26159,12]),Int32Array.from([25368,13]),Int32Array.from([27713,14]),Int32Array.from([26998,15]),Int32Array.from([5769,16]),Int32Array.from([5054,17]),Int32Array.from([7399,18]),Int32Array.from([6608,19]),Int32Array.from([1890,20]),Int32Array.from([597,21]),Int32Array.from([3340,22]),Int32Array.from([2107,23]),Int32Array.from([13663,24]),Int32Array.from([12392,25]),Int32Array.from([16177,26]),Int32Array.from([14854,27]),Int32Array.from([9396,28]),Int32Array.from([8579,29]),Int32Array.from([11994,30]),Int32Array.from([11245,31])];class le{constructor(n,...s){this.ecCodewordsPerBlock=n,this.ecBlocks=s}getECCodewordsPerBlock(){return this.ecCodewordsPerBlock}getNumBlocks(){let n=0;const s=this.ecBlocks;for(const o of s)n+=o.getCount();return n}getTotalECCodewords(){return this.ecCodewordsPerBlock*this.getNumBlocks()}getECBlocks(){return this.ecBlocks}}class U{constructor(n,s){this.count=n,this.dataCodewords=s}getCount(){return this.count}getDataCodewords(){return this.dataCodewords}}class ze{constructor(n,s,...o){this.versionNumber=n,this.alignmentPatternCenters=s,this.ecBlocks=o;let f=0;const l=o[0].getECCodewordsPerBlock(),h=o[0].getECBlocks();for(const x of h)f+=x.getCount()*(x.getDataCodewords()+l);this.totalCodewords=f}getVersionNumber(){return this.versionNumber}getAlignmentPatternCenters(){return this.alignmentPatternCenters}getTotalCodewords(){return this.totalCodewords}getDimensionForVersion(){return 17+4*this.versionNumber}getECBlocksForLevel(n){return this.ecBlocks[n.getValue()]}static getProvisionalVersionForDimension(n){if(n%4!==1)throw new N;try{return this.getVersionForNumber((n-17)/4)}catch{throw new N}}static getVersionForNumber(n){if(n<1||n>40)throw new v;return ze.VERSIONS[n-1]}static decodeVersionInformation(n){let s=Number.MAX_SAFE_INTEGER,o=0;for(let f=0;f<ze.VERSION_DECODE_INFO.length;f++){const l=ze.VERSION_DECODE_INFO[f];if(l===n)return ze.getVersionForNumber(f+7);const h=Sr.numBitsDiffering(n,l);h<s&&(o=f+7,s=h)}return s<=3?ze.getVersionForNumber(o):null}buildFunctionPattern(){const n=this.getDimensionForVersion(),s=new Ee(n);s.setRegion(0,0,9,9),s.setRegion(n-8,0,8,9),s.setRegion(0,n-8,9,8);const o=this.alignmentPatternCenters.length;for(let f=0;f<o;f++){const l=this.alignmentPatternCenters[f]-2;for(let h=0;h<o;h++)f===0&&(h===0||h===o-1)||f===o-1&&h===0||s.setRegion(this.alignmentPatternCenters[h]-2,l,5,5)}return s.setRegion(6,9,1,n-17),s.setRegion(9,6,n-17,1),this.versionNumber>6&&(s.setRegion(n-11,0,3,6),s.setRegion(0,n-11,6,3)),s}toString(){return""+this.versionNumber}}ze.VERSION_DECODE_INFO=Int32Array.from([31892,34236,39577,42195,48118,51042,55367,58893,63784,68472,70749,76311,79154,84390,87683,92361,96236,102084,102881,110507,110734,117786,119615,126325,127568,133589,136944,141498,145311,150283,152622,158308,161089,167017]),ze.VERSIONS=[new ze(1,new Int32Array(0),new le(7,new U(1,19)),new le(10,new U(1,16)),new le(13,new U(1,13)),new le(17,new U(1,9))),new ze(2,Int32Array.from([6,18]),new le(10,new U(1,34)),new le(16,new U(1,28)),new le(22,new U(1,22)),new le(28,new U(1,16))),new ze(3,Int32Array.from([6,22]),new le(15,new U(1,55)),new le(26,new U(1,44)),new le(18,new U(2,17)),new le(22,new U(2,13))),new ze(4,Int32Array.from([6,26]),new le(20,new U(1,80)),new le(18,new U(2,32)),new le(26,new U(2,24)),new le(16,new U(4,9))),new ze(5,Int32Array.from([6,30]),new le(26,new U(1,108)),new le(24,new U(2,43)),new le(18,new U(2,15),new U(2,16)),new le(22,new U(2,11),new U(2,12))),new ze(6,Int32Array.from([6,34]),new le(18,new U(2,68)),new le(16,new U(4,27)),new le(24,new U(4,19)),new le(28,new U(4,15))),new ze(7,Int32Array.from([6,22,38]),new le(20,new U(2,78)),new le(18,new U(4,31)),new le(18,new U(2,14),new U(4,15)),new le(26,new U(4,13),new U(1,14))),new ze(8,Int32Array.from([6,24,42]),new le(24,new U(2,97)),new le(22,new U(2,38),new U(2,39)),new le(22,new U(4,18),new U(2,19)),new le(26,new U(4,14),new U(2,15))),new ze(9,Int32Array.from([6,26,46]),new le(30,new U(2,116)),new le(22,new U(3,36),new U(2,37)),new le(20,new U(4,16),new U(4,17)),new le(24,new U(4,12),new U(4,13))),new ze(10,Int32Array.from([6,28,50]),new le(18,new U(2,68),new U(2,69)),new le(26,new U(4,43),new U(1,44)),new le(24,new U(6,19),new U(2,20)),new le(28,new U(6,15),new U(2,16))),new ze(11,Int32Array.from([6,30,54]),new le(20,new U(4,81)),new le(30,new U(1,50),new U(4,51)),new le(28,new U(4,22),new U(4,23)),new le(24,new U(3,12),new U(8,13))),new ze(12,Int32Array.from([6,32,58]),new le(24,new U(2,92),new U(2,93)),new le(22,new U(6,36),new U(2,37)),new le(26,new U(4,20),new U(6,21)),new le(28,new U(7,14),new U(4,15))),new ze(13,Int32Array.from([6,34,62]),new le(26,new U(4,107)),new le(22,new U(8,37),new U(1,38)),new le(24,new U(8,20),new U(4,21)),new le(22,new U(12,11),new U(4,12))),new ze(14,Int32Array.from([6,26,46,66]),new le(30,new U(3,115),new U(1,116)),new le(24,new U(4,40),new U(5,41)),new le(20,new U(11,16),new U(5,17)),new le(24,new U(11,12),new U(5,13))),new ze(15,Int32Array.from([6,26,48,70]),new le(22,new U(5,87),new U(1,88)),new le(24,new U(5,41),new U(5,42)),new le(30,new U(5,24),new U(7,25)),new le(24,new U(11,12),new U(7,13))),new ze(16,Int32Array.from([6,26,50,74]),new le(24,new U(5,98),new U(1,99)),new le(28,new U(7,45),new U(3,46)),new le(24,new U(15,19),new U(2,20)),new le(30,new U(3,15),new U(13,16))),new ze(17,Int32Array.from([6,30,54,78]),new le(28,new U(1,107),new U(5,108)),new le(28,new U(10,46),new U(1,47)),new le(28,new U(1,22),new U(15,23)),new le(28,new U(2,14),new U(17,15))),new ze(18,Int32Array.from([6,30,56,82]),new le(30,new U(5,120),new U(1,121)),new le(26,new U(9,43),new U(4,44)),new le(28,new U(17,22),new U(1,23)),new le(28,new U(2,14),new U(19,15))),new ze(19,Int32Array.from([6,30,58,86]),new le(28,new U(3,113),new U(4,114)),new le(26,new U(3,44),new U(11,45)),new le(26,new U(17,21),new U(4,22)),new le(26,new U(9,13),new U(16,14))),new ze(20,Int32Array.from([6,34,62,90]),new le(28,new U(3,107),new U(5,108)),new le(26,new U(3,41),new U(13,42)),new le(30,new U(15,24),new U(5,25)),new le(28,new U(15,15),new U(10,16))),new ze(21,Int32Array.from([6,28,50,72,94]),new le(28,new U(4,116),new U(4,117)),new le(26,new U(17,42)),new le(28,new U(17,22),new U(6,23)),new le(30,new U(19,16),new U(6,17))),new ze(22,Int32Array.from([6,26,50,74,98]),new le(28,new U(2,111),new U(7,112)),new le(28,new U(17,46)),new le(30,new U(7,24),new U(16,25)),new le(24,new U(34,13))),new ze(23,Int32Array.from([6,30,54,78,102]),new le(30,new U(4,121),new U(5,122)),new le(28,new U(4,47),new U(14,48)),new le(30,new U(11,24),new U(14,25)),new le(30,new U(16,15),new U(14,16))),new ze(24,Int32Array.from([6,28,54,80,106]),new le(30,new U(6,117),new U(4,118)),new le(28,new U(6,45),new U(14,46)),new le(30,new U(11,24),new U(16,25)),new le(30,new U(30,16),new U(2,17))),new ze(25,Int32Array.from([6,32,58,84,110]),new le(26,new U(8,106),new U(4,107)),new le(28,new U(8,47),new U(13,48)),new le(30,new U(7,24),new U(22,25)),new le(30,new U(22,15),new U(13,16))),new ze(26,Int32Array.from([6,30,58,86,114]),new le(28,new U(10,114),new U(2,115)),new le(28,new U(19,46),new U(4,47)),new le(28,new U(28,22),new U(6,23)),new le(30,new U(33,16),new U(4,17))),new ze(27,Int32Array.from([6,34,62,90,118]),new le(30,new U(8,122),new U(4,123)),new le(28,new U(22,45),new U(3,46)),new le(30,new U(8,23),new U(26,24)),new le(30,new U(12,15),new U(28,16))),new ze(28,Int32Array.from([6,26,50,74,98,122]),new le(30,new U(3,117),new U(10,118)),new le(28,new U(3,45),new U(23,46)),new le(30,new U(4,24),new U(31,25)),new le(30,new U(11,15),new U(31,16))),new ze(29,Int32Array.from([6,30,54,78,102,126]),new le(30,new U(7,116),new U(7,117)),new le(28,new U(21,45),new U(7,46)),new le(30,new U(1,23),new U(37,24)),new le(30,new U(19,15),new U(26,16))),new ze(30,Int32Array.from([6,26,52,78,104,130]),new le(30,new U(5,115),new U(10,116)),new le(28,new U(19,47),new U(10,48)),new le(30,new U(15,24),new U(25,25)),new le(30,new U(23,15),new U(25,16))),new ze(31,Int32Array.from([6,30,56,82,108,134]),new le(30,new U(13,115),new U(3,116)),new le(28,new U(2,46),new U(29,47)),new le(30,new U(42,24),new U(1,25)),new le(30,new U(23,15),new U(28,16))),new ze(32,Int32Array.from([6,34,60,86,112,138]),new le(30,new U(17,115)),new le(28,new U(10,46),new U(23,47)),new le(30,new U(10,24),new U(35,25)),new le(30,new U(19,15),new U(35,16))),new ze(33,Int32Array.from([6,30,58,86,114,142]),new le(30,new U(17,115),new U(1,116)),new le(28,new U(14,46),new U(21,47)),new le(30,new U(29,24),new U(19,25)),new le(30,new U(11,15),new U(46,16))),new ze(34,Int32Array.from([6,34,62,90,118,146]),new le(30,new U(13,115),new U(6,116)),new le(28,new U(14,46),new U(23,47)),new le(30,new U(44,24),new U(7,25)),new le(30,new U(59,16),new U(1,17))),new ze(35,Int32Array.from([6,30,54,78,102,126,150]),new le(30,new U(12,121),new U(7,122)),new le(28,new U(12,47),new U(26,48)),new le(30,new U(39,24),new U(14,25)),new le(30,new U(22,15),new U(41,16))),new ze(36,Int32Array.from([6,24,50,76,102,128,154]),new le(30,new U(6,121),new U(14,122)),new le(28,new U(6,47),new U(34,48)),new le(30,new U(46,24),new U(10,25)),new le(30,new U(2,15),new U(64,16))),new ze(37,Int32Array.from([6,28,54,80,106,132,158]),new le(30,new U(17,122),new U(4,123)),new le(28,new U(29,46),new U(14,47)),new le(30,new U(49,24),new U(10,25)),new le(30,new U(24,15),new U(46,16))),new ze(38,Int32Array.from([6,32,58,84,110,136,162]),new le(30,new U(4,122),new U(18,123)),new le(28,new U(13,46),new U(32,47)),new le(30,new U(48,24),new U(14,25)),new le(30,new U(42,15),new U(32,16))),new ze(39,Int32Array.from([6,26,54,82,110,138,166]),new le(30,new U(20,117),new U(4,118)),new le(28,new U(40,47),new U(7,48)),new le(30,new U(43,24),new U(22,25)),new le(30,new U(10,15),new U(67,16))),new ze(40,Int32Array.from([6,30,58,86,114,142,170]),new le(30,new U(19,118),new U(6,119)),new le(28,new U(18,47),new U(31,48)),new le(30,new U(34,24),new U(34,25)),new le(30,new U(20,15),new U(61,16)))];var dr;(function(I){I[I.DATA_MASK_000=0]="DATA_MASK_000",I[I.DATA_MASK_001=1]="DATA_MASK_001",I[I.DATA_MASK_010=2]="DATA_MASK_010",I[I.DATA_MASK_011=3]="DATA_MASK_011",I[I.DATA_MASK_100=4]="DATA_MASK_100",I[I.DATA_MASK_101=5]="DATA_MASK_101",I[I.DATA_MASK_110=6]="DATA_MASK_110",I[I.DATA_MASK_111=7]="DATA_MASK_111"})(dr||(dr={}));class nn{constructor(n,s){this.value=n,this.isMasked=s}unmaskBitMatrix(n,s){for(let o=0;o<s;o++)for(let f=0;f<s;f++)this.isMasked(o,f)&&n.flip(f,o)}}nn.values=new Map([[dr.DATA_MASK_000,new nn(dr.DATA_MASK_000,(I,n)=>(I+n&1)===0)],[dr.DATA_MASK_001,new nn(dr.DATA_MASK_001,(I,n)=>(I&1)===0)],[dr.DATA_MASK_010,new nn(dr.DATA_MASK_010,(I,n)=>n%3===0)],[dr.DATA_MASK_011,new nn(dr.DATA_MASK_011,(I,n)=>(I+n)%3===0)],[dr.DATA_MASK_100,new nn(dr.DATA_MASK_100,(I,n)=>(Math.floor(I/2)+Math.floor(n/3)&1)===0)],[dr.DATA_MASK_101,new nn(dr.DATA_MASK_101,(I,n)=>I*n%6===0)],[dr.DATA_MASK_110,new nn(dr.DATA_MASK_110,(I,n)=>I*n%6<3)],[dr.DATA_MASK_111,new nn(dr.DATA_MASK_111,(I,n)=>(I+n+I*n%3&1)===0)]]);class Du{constructor(n){const s=n.getHeight();if(s<21||(s&3)!==1)throw new N;this.bitMatrix=n}readFormatInformation(){if(this.parsedFormatInfo!==null&&this.parsedFormatInfo!==void 0)return this.parsedFormatInfo;let n=0;for(let l=0;l<6;l++)n=this.copyBit(l,8,n);n=this.copyBit(7,8,n),n=this.copyBit(8,8,n),n=this.copyBit(8,7,n);for(let l=5;l>=0;l--)n=this.copyBit(8,l,n);const s=this.bitMatrix.getHeight();let o=0;const f=s-7;for(let l=s-1;l>=f;l--)o=this.copyBit(8,l,o);for(let l=s-8;l<s;l++)o=this.copyBit(l,8,o);if(this.parsedFormatInfo=Sr.decodeFormatInformation(n,o),this.parsedFormatInfo!==null)return this.parsedFormatInfo;throw new N}readVersion(){if(this.parsedVersion!==null&&this.parsedVersion!==void 0)return this.parsedVersion;const n=this.bitMatrix.getHeight(),s=Math.floor((n-17)/4);if(s<=6)return ze.getVersionForNumber(s);let o=0;const f=n-11;for(let h=5;h>=0;h--)for(let x=n-9;x>=f;x--)o=this.copyBit(x,h,o);let l=ze.decodeVersionInformation(o);if(l!==null&&l.getDimensionForVersion()===n)return this.parsedVersion=l,l;o=0;for(let h=5;h>=0;h--)for(let x=n-9;x>=f;x--)o=this.copyBit(h,x,o);if(l=ze.decodeVersionInformation(o),l!==null&&l.getDimensionForVersion()===n)return this.parsedVersion=l,l;throw new N}copyBit(n,s,o){return(this.isMirror?this.bitMatrix.get(s,n):this.bitMatrix.get(n,s))?o<<1|1:o<<1}readCodewords(){const n=this.readFormatInformation(),s=this.readVersion(),o=nn.values.get(n.getDataMask()),f=this.bitMatrix.getHeight();o.unmaskBitMatrix(this.bitMatrix,f);const l=s.buildFunctionPattern();let h=!0;const x=new Uint8Array(s.getTotalCodewords());let p=0,E=0,T=0;for(let k=f-1;k>0;k-=2){k===6&&k--;for(let R=0;R<f;R++){const G=h?f-1-R:R;for(let J=0;J<2;J++)l.get(k-J,G)||(T++,E<<=1,this.bitMatrix.get(k-J,G)&&(E|=1),T===8&&(x[p++]=E,T=0,E=0))}h=!h}if(p!==s.getTotalCodewords())throw new N;return x}remask(){if(this.parsedFormatInfo===null)return;const n=nn.values[this.parsedFormatInfo.getDataMask()],s=this.bitMatrix.getHeight();n.unmaskBitMatrix(this.bitMatrix,s)}setMirror(n){this.parsedVersion=null,this.parsedFormatInfo=null,this.isMirror=n}mirror(){const n=this.bitMatrix;for(let s=0,o=n.getWidth();s<o;s++)for(let f=s+1,l=n.getHeight();f<l;f++)n.get(s,f)!==n.get(f,s)&&(n.flip(f,s),n.flip(s,f))}}class Zs{constructor(n,s){this.numDataCodewords=n,this.codewords=s}static getDataBlocks(n,s,o){if(n.length!==s.getTotalCodewords())throw new v;const f=s.getECBlocksForLevel(o);let l=0;const h=f.getECBlocks();for(const J of h)l+=J.getCount();const x=new Array(l);let p=0;for(const J of h)for(let re=0;re<J.getCount();re++){const fe=J.getDataCodewords(),pe=f.getECCodewordsPerBlock()+fe;x[p++]=new Zs(fe,new Uint8Array(pe))}const E=x[0].codewords.length;let T=x.length-1;for(;T>=0&&x[T].codewords.length!==E;)T--;T++;const k=E-f.getECCodewordsPerBlock();let R=0;for(let J=0;J<k;J++)for(let re=0;re<p;re++)x[re].codewords[J]=n[R++];for(let J=T;J<p;J++)x[J].codewords[k]=n[R++];const G=x[0].codewords.length;for(let J=k;J<G;J++)for(let re=0;re<p;re++){const fe=re<T?J:J+1;x[re].codewords[fe]=n[R++]}return x}getNumDataCodewords(){return this.numDataCodewords}getCodewords(){return this.codewords}}var an;(function(I){I[I.TERMINATOR=0]="TERMINATOR",I[I.NUMERIC=1]="NUMERIC",I[I.ALPHANUMERIC=2]="ALPHANUMERIC",I[I.STRUCTURED_APPEND=3]="STRUCTURED_APPEND",I[I.BYTE=4]="BYTE",I[I.ECI=5]="ECI",I[I.KANJI=6]="KANJI",I[I.FNC1_FIRST_POSITION=7]="FNC1_FIRST_POSITION",I[I.FNC1_SECOND_POSITION=8]="FNC1_SECOND_POSITION",I[I.HANZI=9]="HANZI"})(an||(an={}));class je{constructor(n,s,o,f){this.value=n,this.stringValue=s,this.characterCountBitsForVersions=o,this.bits=f,je.FOR_BITS.set(f,this),je.FOR_VALUE.set(n,this)}static forBits(n){const s=je.FOR_BITS.get(n);if(s===void 0)throw new v;return s}getCharacterCountBits(n){const s=n.getVersionNumber();let o;return s<=9?o=0:s<=26?o=1:o=2,this.characterCountBitsForVersions[o]}getValue(){return this.value}getBits(){return this.bits}equals(n){if(!(n instanceof je))return!1;const s=n;return this.value===s.value}toString(){return this.stringValue}}je.FOR_BITS=new Map,je.FOR_VALUE=new Map,je.TERMINATOR=new je(an.TERMINATOR,"TERMINATOR",Int32Array.from([0,0,0]),0),je.NUMERIC=new je(an.NUMERIC,"NUMERIC",Int32Array.from([10,12,14]),1),je.ALPHANUMERIC=new je(an.ALPHANUMERIC,"ALPHANUMERIC",Int32Array.from([9,11,13]),2),je.STRUCTURED_APPEND=new je(an.STRUCTURED_APPEND,"STRUCTURED_APPEND",Int32Array.from([0,0,0]),3),je.BYTE=new je(an.BYTE,"BYTE",Int32Array.from([8,16,16]),4),je.ECI=new je(an.ECI,"ECI",Int32Array.from([0,0,0]),7),je.KANJI=new je(an.KANJI,"KANJI",Int32Array.from([8,10,12]),8),je.FNC1_FIRST_POSITION=new je(an.FNC1_FIRST_POSITION,"FNC1_FIRST_POSITION",Int32Array.from([0,0,0]),5),je.FNC1_SECOND_POSITION=new je(an.FNC1_SECOND_POSITION,"FNC1_SECOND_POSITION",Int32Array.from([0,0,0]),9),je.HANZI=new je(an.HANZI,"HANZI",Int32Array.from([8,10,12]),13);class zt{static decode(n,s,o,f){const l=new js(n);let h=new ie;const x=new Array;let p=-1,E=-1;try{let T=null,k=!1,R;do{if(l.available()<4)R=je.TERMINATOR;else{const G=l.readBits(4);R=je.forBits(G)}switch(R){case je.TERMINATOR:break;case je.FNC1_FIRST_POSITION:case je.FNC1_SECOND_POSITION:k=!0;break;case je.STRUCTURED_APPEND:if(l.available()<16)throw new N;p=l.readBits(8),E=l.readBits(8);break;case je.ECI:const G=zt.parseECIValue(l);if(T=O.getCharacterSetECIByValue(G),T===null)throw new N;break;case je.HANZI:const J=l.readBits(4),re=l.readBits(R.getCharacterCountBits(s));J===zt.GB2312_SUBSET&&zt.decodeHanziSegment(l,h,re);break;default:const fe=l.readBits(R.getCharacterCountBits(s));switch(R){case je.NUMERIC:zt.decodeNumericSegment(l,h,fe);break;case je.ALPHANUMERIC:zt.decodeAlphanumericSegment(l,h,fe,k);break;case je.BYTE:zt.decodeByteSegment(l,h,fe,T,x,f);break;case je.KANJI:zt.decodeKanjiSegment(l,h,fe);break;default:throw new N}break}}while(R!==je.TERMINATOR)}catch{throw new N}return new Te(n,h.toString(),x.length===0?null:x,o===null?null:o.toString(),p,E)}static decodeHanziSegment(n,s,o){if(o*13>n.available())throw new N;const f=new Uint8Array(2*o);let l=0;for(;o>0;){const h=n.readBits(13);let x=h/96<<8&4294967295|h%96;x<959?x+=41377:x+=42657,f[l]=x>>8&255,f[l+1]=x&255,l+=2,o--}try{s.append(Q.decode(f,X.GB2312))}catch(h){throw new N(h)}}static decodeKanjiSegment(n,s,o){if(o*13>n.available())throw new N;const f=new Uint8Array(2*o);let l=0;for(;o>0;){const h=n.readBits(13);let x=h/192<<8&4294967295|h%192;x<7936?x+=33088:x+=49472,f[l]=x>>8,f[l+1]=x,l+=2,o--}try{s.append(Q.decode(f,X.SHIFT_JIS))}catch(h){throw new N(h)}}static decodeByteSegment(n,s,o,f,l,h){if(8*o>n.available())throw new N;const x=new Uint8Array(o);for(let E=0;E<o;E++)x[E]=n.readBits(8);let p;f===null?p=X.guessEncoding(x,h):p=f.getName();try{s.append(Q.decode(x,p))}catch(E){throw new N(E)}l.push(x)}static toAlphaNumericChar(n){if(n>=zt.ALPHANUMERIC_CHARS.length)throw new N;return zt.ALPHANUMERIC_CHARS[n]}static decodeAlphanumericSegment(n,s,o,f){const l=s.length();for(;o>1;){if(n.available()<11)throw new N;const h=n.readBits(11);s.append(zt.toAlphaNumericChar(Math.floor(h/45))),s.append(zt.toAlphaNumericChar(h%45)),o-=2}if(o===1){if(n.available()<6)throw new N;s.append(zt.toAlphaNumericChar(n.readBits(6)))}if(f)for(let h=l;h<s.length();h++)s.charAt(h)==="%"&&(h<s.length()-1&&s.charAt(h+1)==="%"?s.deleteCharAt(h+1):s.setCharAt(h,""))}static decodeNumericSegment(n,s,o){for(;o>=3;){if(n.available()<10)throw new N;const f=n.readBits(10);if(f>=1e3)throw new N;s.append(zt.toAlphaNumericChar(Math.floor(f/100))),s.append(zt.toAlphaNumericChar(Math.floor(f/10)%10)),s.append(zt.toAlphaNumericChar(f%10)),o-=3}if(o===2){if(n.available()<7)throw new N;const f=n.readBits(7);if(f>=100)throw new N;s.append(zt.toAlphaNumericChar(Math.floor(f/10))),s.append(zt.toAlphaNumericChar(f%10))}else if(o===1){if(n.available()<4)throw new N;const f=n.readBits(4);if(f>=10)throw new N;s.append(zt.toAlphaNumericChar(f))}}static parseECIValue(n){const s=n.readBits(8);if((s&128)===0)return s&127;if((s&192)===128){const o=n.readBits(8);return(s&63)<<8&4294967295|o}if((s&224)===192){const o=n.readBits(16);return(s&31)<<16&4294967295|o}throw new N}}zt.ALPHANUMERIC_CHARS="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ $%*+-./:",zt.GB2312_SUBSET=1;class $o{constructor(n){this.mirrored=n}isMirrored(){return this.mirrored}applyMirroredCorrection(n){if(!this.mirrored||n===null||n.length<3)return;const s=n[0];n[0]=n[2],n[2]=s}}class Bu{constructor(){this.rsDecoder=new nt(Xe.QR_CODE_FIELD_256)}decodeBooleanArray(n,s){return this.decodeBitMatrix(Ee.parseFromBooleanArray(n),s)}decodeBitMatrix(n,s){const o=new Du(n);let f=null;try{return this.decodeBitMatrixParser(o,s)}catch(l){f=l}try{o.remask(),o.setMirror(!0),o.readVersion(),o.readFormatInformation(),o.mirror();const l=this.decodeBitMatrixParser(o,s);return l.setOther(new $o(!0)),l}catch(l){throw f!==null?f:l}}decodeBitMatrixParser(n,s){const o=n.readVersion(),f=n.readFormatInformation().getErrorCorrectionLevel(),l=n.readCodewords(),h=Zs.getDataBlocks(l,o,f);let x=0;for(const T of h)x+=T.getNumDataCodewords();const p=new Uint8Array(x);let E=0;for(const T of h){const k=T.getCodewords(),R=T.getNumDataCodewords();this.correctErrors(k,R);for(let G=0;G<R;G++)p[E++]=k[G]}return zt.decode(p,o,f,s)}correctErrors(n,s){const o=new Int32Array(n);try{this.rsDecoder.decode(o,n.length-s)}catch{throw new C}for(let f=0;f<s;f++)n[f]=o[f]}}class qs extends Ve{constructor(n,s,o){super(n,s),this.estimatedModuleSize=o}aboutEquals(n,s,o){if(Math.abs(s-this.getY())<=n&&Math.abs(o-this.getX())<=n){const f=Math.abs(n-this.estimatedModuleSize);return f<=1||f<=this.estimatedModuleSize}return!1}combineEstimate(n,s,o){const f=(this.getX()+s)/2,l=(this.getY()+n)/2,h=(this.estimatedModuleSize+o)/2;return new qs(f,l,h)}}class rs{constructor(n,s,o,f,l,h,x){this.image=n,this.startX=s,this.startY=o,this.width=f,this.height=l,this.moduleSize=h,this.resultPointCallback=x,this.possibleCenters=[],this.crossCheckStateCount=new Int32Array(3)}find(){const n=this.startX,s=this.height,o=this.width,f=n+o,l=this.startY+s/2,h=new Int32Array(3),x=this.image;for(let p=0;p<s;p++){const E=l+((p&1)===0?Math.floor((p+1)/2):-Math.floor((p+1)/2));h[0]=0,h[1]=0,h[2]=0;let T=n;for(;T<f&&!x.get(T,E);)T++;let k=0;for(;T<f;){if(x.get(T,E))if(k===1)h[1]++;else if(k===2){if(this.foundPatternCross(h)){const R=this.handlePossibleCenter(h,E,T);if(R!==null)return R}h[0]=h[2],h[1]=1,h[2]=0,k=1}else h[++k]++;else k===1&&k++,h[k]++;T++}if(this.foundPatternCross(h)){const R=this.handlePossibleCenter(h,E,f);if(R!==null)return R}}if(this.possibleCenters.length!==0)return this.possibleCenters[0];throw new q}static centerFromEnd(n,s){return s-n[2]-n[1]/2}foundPatternCross(n){const s=this.moduleSize,o=s/2;for(let f=0;f<3;f++)if(Math.abs(s-n[f])>=o)return!1;return!0}crossCheckVertical(n,s,o,f){const l=this.image,h=l.getHeight(),x=this.crossCheckStateCount;x[0]=0,x[1]=0,x[2]=0;let p=n;for(;p>=0&&l.get(s,p)&&x[1]<=o;)x[1]++,p--;if(p<0||x[1]>o)return NaN;for(;p>=0&&!l.get(s,p)&&x[0]<=o;)x[0]++,p--;if(x[0]>o)return NaN;for(p=n+1;p<h&&l.get(s,p)&&x[1]<=o;)x[1]++,p++;if(p===h||x[1]>o)return NaN;for(;p<h&&!l.get(s,p)&&x[2]<=o;)x[2]++,p++;if(x[2]>o)return NaN;const E=x[0]+x[1]+x[2];return 5*Math.abs(E-f)>=2*f?NaN:this.foundPatternCross(x)?rs.centerFromEnd(x,p):NaN}handlePossibleCenter(n,s,o){const f=n[0]+n[1]+n[2],l=rs.centerFromEnd(n,o),h=this.crossCheckVertical(s,l,2*n[1],f);if(!isNaN(h)){const x=(n[0]+n[1]+n[2])/3;for(const E of this.possibleCenters)if(E.aboutEquals(x,h,l))return E.combineEstimate(h,l,x);const p=new qs(l,h,x);this.possibleCenters.push(p),this.resultPointCallback!==null&&this.resultPointCallback!==void 0&&this.resultPointCallback.foundPossibleResultPoint(p)}return null}}class Js extends Ve{constructor(n,s,o,f){super(n,s),this.estimatedModuleSize=o,this.count=f,f===void 0&&(this.count=1)}getEstimatedModuleSize(){return this.estimatedModuleSize}getCount(){return this.count}aboutEquals(n,s,o){if(Math.abs(s-this.getY())<=n&&Math.abs(o-this.getX())<=n){const f=Math.abs(n-this.estimatedModuleSize);return f<=1||f<=this.estimatedModuleSize}return!1}combineEstimate(n,s,o){const f=this.count+1,l=(this.count*this.getX()+s)/f,h=(this.count*this.getY()+n)/f,x=(this.count*this.estimatedModuleSize+o)/f;return new Js(l,h,x,f)}}class Mu{constructor(n){this.bottomLeft=n[0],this.topLeft=n[1],this.topRight=n[2]}getBottomLeft(){return this.bottomLeft}getTopLeft(){return this.topLeft}getTopRight(){return this.topRight}}class xr{constructor(n,s){this.image=n,this.resultPointCallback=s,this.possibleCenters=[],this.crossCheckStateCount=new Int32Array(5),this.resultPointCallback=s}getImage(){return this.image}getPossibleCenters(){return this.possibleCenters}find(n){const s=n!=null&&n.get(W.TRY_HARDER)!==void 0,o=n!=null&&n.get(W.PURE_BARCODE)!==void 0,f=this.image,l=f.getHeight(),h=f.getWidth();let x=Math.floor(3*l/(4*xr.MAX_MODULES));(x<xr.MIN_SKIP||s)&&(x=xr.MIN_SKIP);let p=!1;const E=new Int32Array(5);for(let k=x-1;k<l&&!p;k+=x){E[0]=0,E[1]=0,E[2]=0,E[3]=0,E[4]=0;let R=0;for(let G=0;G<h;G++)if(f.get(G,k))(R&1)===1&&R++,E[R]++;else if((R&1)===0)if(R===4)if(xr.foundPatternCross(E)){if(this.handlePossibleCenter(E,k,G,o)===!0)if(x=2,this.hasSkipped===!0)p=this.haveMultiplyConfirmedCenters();else{const re=this.findRowSkip();re>E[2]&&(k+=re-E[2]-x,G=h-1)}else{E[0]=E[2],E[1]=E[3],E[2]=E[4],E[3]=1,E[4]=0,R=3;continue}R=0,E[0]=0,E[1]=0,E[2]=0,E[3]=0,E[4]=0}else E[0]=E[2],E[1]=E[3],E[2]=E[4],E[3]=1,E[4]=0,R=3;else E[++R]++;else E[R]++;xr.foundPatternCross(E)&&this.handlePossibleCenter(E,k,h,o)===!0&&(x=E[0],this.hasSkipped&&(p=this.haveMultiplyConfirmedCenters()))}const T=this.selectBestPatterns();return Ve.orderBestPatterns(T),new Mu(T)}static centerFromEnd(n,s){return s-n[4]-n[3]-n[2]/2}static foundPatternCross(n){let s=0;for(let l=0;l<5;l++){const h=n[l];if(h===0)return!1;s+=h}if(s<7)return!1;const o=s/7,f=o/2;return Math.abs(o-n[0])<f&&Math.abs(o-n[1])<f&&Math.abs(3*o-n[2])<3*f&&Math.abs(o-n[3])<f&&Math.abs(o-n[4])<f}getCrossCheckStateCount(){const n=this.crossCheckStateCount;return n[0]=0,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n}crossCheckDiagonal(n,s,o,f){const l=this.getCrossCheckStateCount();let h=0;const x=this.image;for(;n>=h&&s>=h&&x.get(s-h,n-h);)l[2]++,h++;if(n<h||s<h)return!1;for(;n>=h&&s>=h&&!x.get(s-h,n-h)&&l[1]<=o;)l[1]++,h++;if(n<h||s<h||l[1]>o)return!1;for(;n>=h&&s>=h&&x.get(s-h,n-h)&&l[0]<=o;)l[0]++,h++;if(l[0]>o)return!1;const p=x.getHeight(),E=x.getWidth();for(h=1;n+h<p&&s+h<E&&x.get(s+h,n+h);)l[2]++,h++;if(n+h>=p||s+h>=E)return!1;for(;n+h<p&&s+h<E&&!x.get(s+h,n+h)&&l[3]<o;)l[3]++,h++;if(n+h>=p||s+h>=E||l[3]>=o)return!1;for(;n+h<p&&s+h<E&&x.get(s+h,n+h)&&l[4]<o;)l[4]++,h++;if(l[4]>=o)return!1;const T=l[0]+l[1]+l[2]+l[3]+l[4];return Math.abs(T-f)<2*f&&xr.foundPatternCross(l)}crossCheckVertical(n,s,o,f){const l=this.image,h=l.getHeight(),x=this.getCrossCheckStateCount();let p=n;for(;p>=0&&l.get(s,p);)x[2]++,p--;if(p<0)return NaN;for(;p>=0&&!l.get(s,p)&&x[1]<=o;)x[1]++,p--;if(p<0||x[1]>o)return NaN;for(;p>=0&&l.get(s,p)&&x[0]<=o;)x[0]++,p--;if(x[0]>o)return NaN;for(p=n+1;p<h&&l.get(s,p);)x[2]++,p++;if(p===h)return NaN;for(;p<h&&!l.get(s,p)&&x[3]<o;)x[3]++,p++;if(p===h||x[3]>=o)return NaN;for(;p<h&&l.get(s,p)&&x[4]<o;)x[4]++,p++;if(x[4]>=o)return NaN;const E=x[0]+x[1]+x[2]+x[3]+x[4];return 5*Math.abs(E-f)>=2*f?NaN:xr.foundPatternCross(x)?xr.centerFromEnd(x,p):NaN}crossCheckHorizontal(n,s,o,f){const l=this.image,h=l.getWidth(),x=this.getCrossCheckStateCount();let p=n;for(;p>=0&&l.get(p,s);)x[2]++,p--;if(p<0)return NaN;for(;p>=0&&!l.get(p,s)&&x[1]<=o;)x[1]++,p--;if(p<0||x[1]>o)return NaN;for(;p>=0&&l.get(p,s)&&x[0]<=o;)x[0]++,p--;if(x[0]>o)return NaN;for(p=n+1;p<h&&l.get(p,s);)x[2]++,p++;if(p===h)return NaN;for(;p<h&&!l.get(p,s)&&x[3]<o;)x[3]++,p++;if(p===h||x[3]>=o)return NaN;for(;p<h&&l.get(p,s)&&x[4]<o;)x[4]++,p++;if(x[4]>=o)return NaN;const E=x[0]+x[1]+x[2]+x[3]+x[4];return 5*Math.abs(E-f)>=f?NaN:xr.foundPatternCross(x)?xr.centerFromEnd(x,p):NaN}handlePossibleCenter(n,s,o,f){const l=n[0]+n[1]+n[2]+n[3]+n[4];let h=xr.centerFromEnd(n,o),x=this.crossCheckVertical(s,Math.floor(h),n[2],l);if(!isNaN(x)&&(h=this.crossCheckHorizontal(Math.floor(h),Math.floor(x),n[2],l),!isNaN(h)&&(!f||this.crossCheckDiagonal(Math.floor(x),Math.floor(h),n[2],l)))){const p=l/7;let E=!1;const T=this.possibleCenters;for(let k=0,R=T.length;k<R;k++){const G=T[k];if(G.aboutEquals(p,x,h)){T[k]=G.combineEstimate(x,h,p),E=!0;break}}if(!E){const k=new Js(h,x,p);T.push(k),this.resultPointCallback!==null&&this.resultPointCallback!==void 0&&this.resultPointCallback.foundPossibleResultPoint(k)}return!0}return!1}findRowSkip(){if(this.possibleCenters.length<=1)return 0;let s=null;for(const o of this.possibleCenters)if(o.getCount()>=xr.CENTER_QUORUM)if(s==null)s=o;else return this.hasSkipped=!0,Math.floor((Math.abs(s.getX()-o.getX())-Math.abs(s.getY()-o.getY()))/2);return 0}haveMultiplyConfirmedCenters(){let n=0,s=0;const o=this.possibleCenters.length;for(const h of this.possibleCenters)h.getCount()>=xr.CENTER_QUORUM&&(n++,s+=h.getEstimatedModuleSize());if(n<3)return!1;const f=s/o;let l=0;for(const h of this.possibleCenters)l+=Math.abs(h.getEstimatedModuleSize()-f);return l<=.05*s}selectBestPatterns(){const n=this.possibleCenters.length;if(n<3)throw new q;const s=this.possibleCenters;let o;if(n>3){let f=0,l=0;for(const p of this.possibleCenters){const E=p.getEstimatedModuleSize();f+=E,l+=E*E}o=f/n;let h=Math.sqrt(l/n-o*o);s.sort((p,E)=>{const T=Math.abs(E.getEstimatedModuleSize()-o),k=Math.abs(p.getEstimatedModuleSize()-o);return T<k?-1:T>k?1:0});const x=Math.max(.2*o,h);for(let p=0;p<s.length&&s.length>3;p++){const E=s[p];Math.abs(E.getEstimatedModuleSize()-o)>x&&(s.splice(p,1),p--)}}if(s.length>3){let f=0;for(const l of s)f+=l.getEstimatedModuleSize();o=f/s.length,s.sort((l,h)=>{if(h.getCount()===l.getCount()){const x=Math.abs(h.getEstimatedModuleSize()-o),p=Math.abs(l.getEstimatedModuleSize()-o);return x<p?1:x>p?-1:0}else return h.getCount()-l.getCount()}),s.splice(3)}return[s[0],s[1],s[2]]}}xr.CENTER_QUORUM=2,xr.MIN_SKIP=3,xr.MAX_MODULES=57;class ui{constructor(n){this.image=n}getImage(){return this.image}getResultPointCallback(){return this.resultPointCallback}detect(n){this.resultPointCallback=n==null?null:n.get(W.NEED_RESULT_POINT_CALLBACK);const o=new xr(this.image,this.resultPointCallback).find(n);return this.processFinderPatternInfo(o)}processFinderPatternInfo(n){const s=n.getTopLeft(),o=n.getTopRight(),f=n.getBottomLeft(),l=this.calculateModuleSize(s,o,f);if(l<1)throw new q("No pattern found in proccess finder.");const h=ui.computeDimension(s,o,f,l),x=ze.getProvisionalVersionForDimension(h),p=x.getDimensionForVersion()-7;let E=null;if(x.getAlignmentPatternCenters().length>0){const G=o.getX()-s.getX()+f.getX(),J=o.getY()-s.getY()+f.getY(),re=1-3/p,fe=Math.floor(s.getX()+re*(G-s.getX())),pe=Math.floor(s.getY()+re*(J-s.getY()));for(let Re=4;Re<=16;Re<<=1)try{E=this.findAlignmentInRegion(l,fe,pe,Re);break}catch(De){if(!(De instanceof q))throw De}}const T=ui.createTransform(s,o,f,E,h),k=ui.sampleGrid(this.image,T,h);let R;return E===null?R=[f,s,o]:R=[f,s,o,E],new Tn(k,R)}static createTransform(n,s,o,f,l){const h=l-3.5;let x,p,E,T;return f!==null?(x=f.getX(),p=f.getY(),E=h-3,T=E):(x=s.getX()-n.getX()+o.getX(),p=s.getY()-n.getY()+o.getY(),E=h,T=h),ar.quadrilateralToQuadrilateral(3.5,3.5,h,3.5,E,T,3.5,h,n.getX(),n.getY(),s.getX(),s.getY(),x,p,o.getX(),o.getY())}static sampleGrid(n,s,o){return Ht.getInstance().sampleGridWithTransform(n,o,o,s)}static computeDimension(n,s,o,f){const l=rt.round(Ve.distance(n,s)/f),h=rt.round(Ve.distance(n,o)/f);let x=Math.floor((l+h)/2)+7;switch(x&3){case 0:x++;break;case 2:x--;break;case 3:throw new q("Dimensions could be not found.")}return x}calculateModuleSize(n,s,o){return(this.calculateModuleSizeOneWay(n,s)+this.calculateModuleSizeOneWay(n,o))/2}calculateModuleSizeOneWay(n,s){const o=this.sizeOfBlackWhiteBlackRunBothWays(Math.floor(n.getX()),Math.floor(n.getY()),Math.floor(s.getX()),Math.floor(s.getY())),f=this.sizeOfBlackWhiteBlackRunBothWays(Math.floor(s.getX()),Math.floor(s.getY()),Math.floor(n.getX()),Math.floor(n.getY()));return isNaN(o)?f/7:isNaN(f)?o/7:(o+f)/14}sizeOfBlackWhiteBlackRunBothWays(n,s,o,f){let l=this.sizeOfBlackWhiteBlackRun(n,s,o,f),h=1,x=n-(o-n);x<0?(h=n/(n-x),x=0):x>=this.image.getWidth()&&(h=(this.image.getWidth()-1-n)/(x-n),x=this.image.getWidth()-1);let p=Math.floor(s-(f-s)*h);return h=1,p<0?(h=s/(s-p),p=0):p>=this.image.getHeight()&&(h=(this.image.getHeight()-1-s)/(p-s),p=this.image.getHeight()-1),x=Math.floor(n+(x-n)*h),l+=this.sizeOfBlackWhiteBlackRun(n,s,x,p),l-1}sizeOfBlackWhiteBlackRun(n,s,o,f){const l=Math.abs(f-s)>Math.abs(o-n);if(l){let G=n;n=s,s=G,G=o,o=f,f=G}const h=Math.abs(o-n),x=Math.abs(f-s);let p=-h/2;const E=n<o?1:-1,T=s<f?1:-1;let k=0;const R=o+E;for(let G=n,J=s;G!==R;G+=E){const re=l?J:G,fe=l?G:J;if(k===1===this.image.get(re,fe)){if(k===2)return rt.distance(G,J,n,s);k++}if(p+=x,p>0){if(J===f)break;J+=T,p-=h}}return k===2?rt.distance(o+E,f,n,s):NaN}findAlignmentInRegion(n,s,o,f){const l=Math.floor(f*n),h=Math.max(0,s-l),x=Math.min(this.image.getWidth()-1,s+l);if(x-h<n*3)throw new q("Alignment top exceeds estimated module size.");const p=Math.max(0,o-l),E=Math.min(this.image.getHeight()-1,o+l);if(E-p<n*3)throw new q("Alignment bottom exceeds estimated module size.");return new rs(this.image,h,p,x-h,E-p,n,this.resultPointCallback).find()}}class Jn{constructor(){this.decoder=new Bu}getDecoder(){return this.decoder}decode(n,s){let o,f;if(s!=null&&s.get(W.PURE_BARCODE)!==void 0){const p=Jn.extractPureBits(n.getBlackMatrix());o=this.decoder.decodeBitMatrix(p,s),f=Jn.NO_POINTS}else{const p=new ui(n.getBlackMatrix()).detect(s);o=this.decoder.decodeBitMatrix(p.getBits(),s),f=p.getPoints()}o.getOther()instanceof $o&&o.getOther().applyMirroredCorrection(f);const l=new Z(o.getText(),o.getRawBytes(),void 0,f,oe.QR_CODE,void 0),h=o.getByteSegments();h!==null&&l.putMetadata(Ae.BYTE_SEGMENTS,h);const x=o.getECLevel();return x!==null&&l.putMetadata(Ae.ERROR_CORRECTION_LEVEL,x),o.hasStructuredAppend()&&(l.putMetadata(Ae.STRUCTURED_APPEND_SEQUENCE,o.getStructuredAppendSequenceNumber()),l.putMetadata(Ae.STRUCTURED_APPEND_PARITY,o.getStructuredAppendParity())),l}reset(){}static extractPureBits(n){const s=n.getTopLeftOnBit(),o=n.getBottomRightOnBit();if(s===null||o===null)throw new q;const f=this.moduleSize(s,n);let l=s[1],h=o[1],x=s[0],p=o[0];if(x>=p||l>=h)throw new q;if(h-l!==p-x&&(p=x+(h-l),p>=n.getWidth()))throw new q;const E=Math.round((p-x+1)/f),T=Math.round((h-l+1)/f);if(E<=0||T<=0)throw new q;if(T!==E)throw new q;const k=Math.floor(f/2);l+=k,x+=k;const R=x+Math.floor((E-1)*f)-p;if(R>0){if(R>k)throw new q;x-=R}const G=l+Math.floor((T-1)*f)-h;if(G>0){if(G>k)throw new q;l-=G}const J=new Ee(E,T);for(let re=0;re<T;re++){const fe=l+Math.floor(re*f);for(let pe=0;pe<E;pe++)n.get(x+Math.floor(pe*f),fe)&&J.set(pe,re)}return J}static moduleSize(n,s){const o=s.getHeight(),f=s.getWidth();let l=n[0],h=n[1],x=!0,p=0;for(;l<f&&h<o;){if(x!==s.get(l,h)){if(++p===5)break;x=!x}l++,h++}if(l===f||h===o)throw new q;return(l-n[0])/7}}Jn.NO_POINTS=new Array;class Je{PDF417Common(){}static getBitCountSum(n){return rt.sum(n)}static toIntArray(n){if(n==null||!n.length)return Je.EMPTY_INT_ARRAY;const s=new Int32Array(n.length);let o=0;for(const f of n)s[o++]=f;return s}static getCodeword(n){const s=P.binarySearch(Je.SYMBOL_TABLE,n&262143);return s<0?-1:(Je.CODEWORD_TABLE[s]-1)%Je.NUMBER_OF_CODEWORDS}}Je.NUMBER_OF_CODEWORDS=929,Je.MAX_CODEWORDS_IN_BARCODE=Je.NUMBER_OF_CODEWORDS-1,Je.MIN_ROWS_IN_BARCODE=3,Je.MAX_ROWS_IN_BARCODE=90,Je.MODULES_IN_CODEWORD=17,Je.MODULES_IN_STOP_PATTERN=18,Je.BARS_IN_MODULE=8,Je.EMPTY_INT_ARRAY=new Int32Array([]),Je.SYMBOL_TABLE=Int32Array.from([66142,66170,66206,66236,66290,66292,66350,66382,66396,66454,66470,66476,66594,66600,66614,66626,66628,66632,66640,66654,66662,66668,66682,66690,66718,66720,66748,66758,66776,66798,66802,66804,66820,66824,66832,66846,66848,66876,66880,66936,66950,66956,66968,66992,67006,67022,67036,67042,67044,67048,67062,67118,67150,67164,67214,67228,67256,67294,67322,67350,67366,67372,67398,67404,67416,67438,67474,67476,67490,67492,67496,67510,67618,67624,67650,67656,67664,67678,67686,67692,67706,67714,67716,67728,67742,67744,67772,67782,67788,67800,67822,67826,67828,67842,67848,67870,67872,67900,67904,67960,67974,67992,68016,68030,68046,68060,68066,68068,68072,68086,68104,68112,68126,68128,68156,68160,68216,68336,68358,68364,68376,68400,68414,68448,68476,68494,68508,68536,68546,68548,68552,68560,68574,68582,68588,68654,68686,68700,68706,68708,68712,68726,68750,68764,68792,68802,68804,68808,68816,68830,68838,68844,68858,68878,68892,68920,68976,68990,68994,68996,69e3,69008,69022,69024,69052,69062,69068,69080,69102,69106,69108,69142,69158,69164,69190,69208,69230,69254,69260,69272,69296,69310,69326,69340,69386,69394,69396,69410,69416,69430,69442,69444,69448,69456,69470,69478,69484,69554,69556,69666,69672,69698,69704,69712,69726,69754,69762,69764,69776,69790,69792,69820,69830,69836,69848,69870,69874,69876,69890,69918,69920,69948,69952,70008,70022,70040,70064,70078,70094,70108,70114,70116,70120,70134,70152,70174,70176,70264,70384,70412,70448,70462,70496,70524,70542,70556,70584,70594,70600,70608,70622,70630,70636,70664,70672,70686,70688,70716,70720,70776,70896,71136,71180,71192,71216,71230,71264,71292,71360,71416,71452,71480,71536,71550,71554,71556,71560,71568,71582,71584,71612,71622,71628,71640,71662,71726,71732,71758,71772,71778,71780,71784,71798,71822,71836,71864,71874,71880,71888,71902,71910,71916,71930,71950,71964,71992,72048,72062,72066,72068,72080,72094,72096,72124,72134,72140,72152,72174,72178,72180,72206,72220,72248,72304,72318,72416,72444,72456,72464,72478,72480,72508,72512,72568,72588,72600,72624,72638,72654,72668,72674,72676,72680,72694,72726,72742,72748,72774,72780,72792,72814,72838,72856,72880,72894,72910,72924,72930,72932,72936,72950,72966,72972,72984,73008,73022,73056,73084,73102,73116,73144,73156,73160,73168,73182,73190,73196,73210,73226,73234,73236,73250,73252,73256,73270,73282,73284,73296,73310,73318,73324,73346,73348,73352,73360,73374,73376,73404,73414,73420,73432,73454,73498,73518,73522,73524,73550,73564,73570,73572,73576,73590,73800,73822,73858,73860,73872,73886,73888,73916,73944,73970,73972,73992,74014,74016,74044,74048,74104,74118,74136,74160,74174,74210,74212,74216,74230,74244,74256,74270,74272,74360,74480,74502,74508,74544,74558,74592,74620,74638,74652,74680,74690,74696,74704,74726,74732,74782,74784,74812,74992,75232,75288,75326,75360,75388,75456,75512,75576,75632,75646,75650,75652,75664,75678,75680,75708,75718,75724,75736,75758,75808,75836,75840,75896,76016,76256,76736,76824,76848,76862,76896,76924,76992,77048,77296,77340,77368,77424,77438,77536,77564,77572,77576,77584,77600,77628,77632,77688,77702,77708,77720,77744,77758,77774,77788,77870,77902,77916,77922,77928,77966,77980,78008,78018,78024,78032,78046,78060,78074,78094,78136,78192,78206,78210,78212,78224,78238,78240,78268,78278,78284,78296,78322,78324,78350,78364,78448,78462,78560,78588,78600,78622,78624,78652,78656,78712,78726,78744,78768,78782,78798,78812,78818,78820,78824,78838,78862,78876,78904,78960,78974,79072,79100,79296,79352,79368,79376,79390,79392,79420,79424,79480,79600,79628,79640,79664,79678,79712,79740,79772,79800,79810,79812,79816,79824,79838,79846,79852,79894,79910,79916,79942,79948,79960,79982,79988,80006,80024,80048,80062,80078,80092,80098,80100,80104,80134,80140,80176,80190,80224,80252,80270,80284,80312,80328,80336,80350,80358,80364,80378,80390,80396,80408,80432,80446,80480,80508,80576,80632,80654,80668,80696,80752,80766,80776,80784,80798,80800,80828,80844,80856,80878,80882,80884,80914,80916,80930,80932,80936,80950,80962,80968,80976,80990,80998,81004,81026,81028,81040,81054,81056,81084,81094,81100,81112,81134,81154,81156,81160,81168,81182,81184,81212,81216,81272,81286,81292,81304,81328,81342,81358,81372,81380,81384,81398,81434,81454,81458,81460,81486,81500,81506,81508,81512,81526,81550,81564,81592,81602,81604,81608,81616,81630,81638,81644,81702,81708,81722,81734,81740,81752,81774,81778,81780,82050,82078,82080,82108,82180,82184,82192,82206,82208,82236,82240,82296,82316,82328,82352,82366,82402,82404,82408,82440,82448,82462,82464,82492,82496,82552,82672,82694,82700,82712,82736,82750,82784,82812,82830,82882,82884,82888,82896,82918,82924,82952,82960,82974,82976,83004,83008,83064,83184,83424,83468,83480,83504,83518,83552,83580,83648,83704,83740,83768,83824,83838,83842,83844,83848,83856,83872,83900,83910,83916,83928,83950,83984,84e3,84028,84032,84088,84208,84448,84928,85040,85054,85088,85116,85184,85240,85488,85560,85616,85630,85728,85756,85764,85768,85776,85790,85792,85820,85824,85880,85894,85900,85912,85936,85966,85980,86048,86080,86136,86256,86496,86976,88160,88188,88256,88312,88560,89056,89200,89214,89312,89340,89536,89592,89608,89616,89632,89664,89720,89840,89868,89880,89904,89952,89980,89998,90012,90040,90190,90204,90254,90268,90296,90306,90308,90312,90334,90382,90396,90424,90480,90494,90500,90504,90512,90526,90528,90556,90566,90572,90584,90610,90612,90638,90652,90680,90736,90750,90848,90876,90884,90888,90896,90910,90912,90940,90944,91e3,91014,91020,91032,91056,91070,91086,91100,91106,91108,91112,91126,91150,91164,91192,91248,91262,91360,91388,91584,91640,91664,91678,91680,91708,91712,91768,91888,91928,91952,91966,92e3,92028,92046,92060,92088,92098,92100,92104,92112,92126,92134,92140,92188,92216,92272,92384,92412,92608,92664,93168,93200,93214,93216,93244,93248,93304,93424,93664,93720,93744,93758,93792,93820,93888,93944,93980,94008,94064,94078,94084,94088,94096,94110,94112,94140,94150,94156,94168,94246,94252,94278,94284,94296,94318,94342,94348,94360,94384,94398,94414,94428,94440,94470,94476,94488,94512,94526,94560,94588,94606,94620,94648,94658,94660,94664,94672,94686,94694,94700,94714,94726,94732,94744,94768,94782,94816,94844,94912,94968,94990,95004,95032,95088,95102,95112,95120,95134,95136,95164,95180,95192,95214,95218,95220,95244,95256,95280,95294,95328,95356,95424,95480,95728,95758,95772,95800,95856,95870,95968,95996,96008,96016,96030,96032,96060,96064,96120,96152,96176,96190,96220,96226,96228,96232,96290,96292,96296,96310,96322,96324,96328,96336,96350,96358,96364,96386,96388,96392,96400,96414,96416,96444,96454,96460,96472,96494,96498,96500,96514,96516,96520,96528,96542,96544,96572,96576,96632,96646,96652,96664,96688,96702,96718,96732,96738,96740,96744,96758,96772,96776,96784,96798,96800,96828,96832,96888,97008,97030,97036,97048,97072,97086,97120,97148,97166,97180,97208,97220,97224,97232,97246,97254,97260,97326,97330,97332,97358,97372,97378,97380,97384,97398,97422,97436,97464,97474,97476,97480,97488,97502,97510,97516,97550,97564,97592,97648,97666,97668,97672,97680,97694,97696,97724,97734,97740,97752,97774,97830,97836,97850,97862,97868,97880,97902,97906,97908,97926,97932,97944,97968,97998,98012,98018,98020,98024,98038,98618,98674,98676,98838,98854,98874,98892,98904,98926,98930,98932,98968,99006,99042,99044,99048,99062,99166,99194,99246,99286,99350,99366,99372,99386,99398,99416,99438,99442,99444,99462,99504,99518,99534,99548,99554,99556,99560,99574,99590,99596,99608,99632,99646,99680,99708,99726,99740,99768,99778,99780,99784,99792,99806,99814,99820,99834,99858,99860,99874,99880,99894,99906,99920,99934,99962,99970,99972,99976,99984,99998,1e5,100028,100038,100044,100056,100078,100082,100084,100142,100174,100188,100246,100262,100268,100306,100308,100390,100396,100410,100422,100428,100440,100462,100466,100468,100486,100504,100528,100542,100558,100572,100578,100580,100584,100598,100620,100656,100670,100704,100732,100750,100792,100802,100808,100816,100830,100838,100844,100858,100888,100912,100926,100960,100988,101056,101112,101148,101176,101232,101246,101250,101252,101256,101264,101278,101280,101308,101318,101324,101336,101358,101362,101364,101410,101412,101416,101430,101442,101448,101456,101470,101478,101498,101506,101508,101520,101534,101536,101564,101580,101618,101620,101636,101640,101648,101662,101664,101692,101696,101752,101766,101784,101838,101858,101860,101864,101934,101938,101940,101966,101980,101986,101988,101992,102030,102044,102072,102082,102084,102088,102096,102138,102166,102182,102188,102214,102220,102232,102254,102282,102290,102292,102306,102308,102312,102326,102444,102458,102470,102476,102488,102514,102516,102534,102552,102576,102590,102606,102620,102626,102632,102646,102662,102668,102704,102718,102752,102780,102798,102812,102840,102850,102856,102864,102878,102886,102892,102906,102936,102974,103008,103036,103104,103160,103224,103280,103294,103298,103300,103312,103326,103328,103356,103366,103372,103384,103406,103410,103412,103472,103486,103520,103548,103616,103672,103920,103992,104048,104062,104160,104188,104194,104196,104200,104208,104224,104252,104256,104312,104326,104332,104344,104368,104382,104398,104412,104418,104420,104424,104482,104484,104514,104520,104528,104542,104550,104570,104578,104580,104592,104606,104608,104636,104652,104690,104692,104706,104712,104734,104736,104764,104768,104824,104838,104856,104910,104930,104932,104936,104968,104976,104990,104992,105020,105024,105080,105200,105240,105278,105312,105372,105410,105412,105416,105424,105446,105518,105524,105550,105564,105570,105572,105576,105614,105628,105656,105666,105672,105680,105702,105722,105742,105756,105784,105840,105854,105858,105860,105864,105872,105888,105932,105970,105972,106006,106022,106028,106054,106060,106072,106100,106118,106124,106136,106160,106174,106190,106210,106212,106216,106250,106258,106260,106274,106276,106280,106306,106308,106312,106320,106334,106348,106394,106414,106418,106420,106566,106572,106610,106612,106630,106636,106648,106672,106686,106722,106724,106728,106742,106758,106764,106776,106800,106814,106848,106876,106894,106908,106936,106946,106948,106952,106960,106974,106982,106988,107032,107056,107070,107104,107132,107200,107256,107292,107320,107376,107390,107394,107396,107400,107408,107422,107424,107452,107462,107468,107480,107502,107506,107508,107544,107568,107582,107616,107644,107712,107768,108016,108060,108088,108144,108158,108256,108284,108290,108292,108296,108304,108318,108320,108348,108352,108408,108422,108428,108440,108464,108478,108494,108508,108514,108516,108520,108592,108640,108668,108736,108792,109040,109536,109680,109694,109792,109820,110016,110072,110084,110088,110096,110112,110140,110144,110200,110320,110342,110348,110360,110384,110398,110432,110460,110478,110492,110520,110532,110536,110544,110558,110658,110686,110714,110722,110724,110728,110736,110750,110752,110780,110796,110834,110836,110850,110852,110856,110864,110878,110880,110908,110912,110968,110982,111e3,111054,111074,111076,111080,111108,111112,111120,111134,111136,111164,111168,111224,111344,111372,111422,111456,111516,111554,111556,111560,111568,111590,111632,111646,111648,111676,111680,111736,111856,112096,112152,112224,112252,112320,112440,112514,112516,112520,112528,112542,112544,112588,112686,112718,112732,112782,112796,112824,112834,112836,112840,112848,112870,112890,112910,112924,112952,113008,113022,113026,113028,113032,113040,113054,113056,113100,113138,113140,113166,113180,113208,113264,113278,113376,113404,113416,113424,113440,113468,113472,113560,113614,113634,113636,113640,113686,113702,113708,113734,113740,113752,113778,113780,113798,113804,113816,113840,113854,113870,113890,113892,113896,113926,113932,113944,113968,113982,114016,114044,114076,114114,114116,114120,114128,114150,114170,114194,114196,114210,114212,114216,114242,114244,114248,114256,114270,114278,114306,114308,114312,114320,114334,114336,114364,114380,114420,114458,114478,114482,114484,114510,114524,114530,114532,114536,114842,114866,114868,114970,114994,114996,115042,115044,115048,115062,115130,115226,115250,115252,115278,115292,115298,115300,115304,115318,115342,115394,115396,115400,115408,115422,115430,115436,115450,115478,115494,115514,115526,115532,115570,115572,115738,115758,115762,115764,115790,115804,115810,115812,115816,115830,115854,115868,115896,115906,115912,115920,115934,115942,115948,115962,115996,116024,116080,116094,116098,116100,116104,116112,116126,116128,116156,116166,116172,116184,116206,116210,116212,116246,116262,116268,116282,116294,116300,116312,116334,116338,116340,116358,116364,116376,116400,116414,116430,116444,116450,116452,116456,116498,116500,116514,116520,116534,116546,116548,116552,116560,116574,116582,116588,116602,116654,116694,116714,116762,116782,116786,116788,116814,116828,116834,116836,116840,116854,116878,116892,116920,116930,116936,116944,116958,116966,116972,116986,117006,117048,117104,117118,117122,117124,117136,117150,117152,117180,117190,117196,117208,117230,117234,117236,117304,117360,117374,117472,117500,117506,117508,117512,117520,117536,117564,117568,117624,117638,117644,117656,117680,117694,117710,117724,117730,117732,117736,117750,117782,117798,117804,117818,117830,117848,117874,117876,117894,117936,117950,117966,117986,117988,117992,118022,118028,118040,118064,118078,118112,118140,118172,118210,118212,118216,118224,118238,118246,118266,118306,118312,118338,118352,118366,118374,118394,118402,118404,118408,118416,118430,118432,118460,118476,118514,118516,118574,118578,118580,118606,118620,118626,118628,118632,118678,118694,118700,118730,118738,118740,118830,118834,118836,118862,118876,118882,118884,118888,118902,118926,118940,118968,118978,118980,118984,118992,119006,119014,119020,119034,119068,119096,119152,119166,119170,119172,119176,119184,119198,119200,119228,119238,119244,119256,119278,119282,119284,119324,119352,119408,119422,119520,119548,119554,119556,119560,119568,119582,119584,119612,119616,119672,119686,119692,119704,119728,119742,119758,119772,119778,119780,119784,119798,119920,119934,120032,120060,120256,120312,120324,120328,120336,120352,120384,120440,120560,120582,120588,120600,120624,120638,120672,120700,120718,120732,120760,120770,120772,120776,120784,120798,120806,120812,120870,120876,120890,120902,120908,120920,120946,120948,120966,120972,120984,121008,121022,121038,121058,121060,121064,121078,121100,121112,121136,121150,121184,121212,121244,121282,121284,121288,121296,121318,121338,121356,121368,121392,121406,121440,121468,121536,121592,121656,121730,121732,121736,121744,121758,121760,121804,121842,121844,121890,121922,121924,121928,121936,121950,121958,121978,121986,121988,121992,122e3,122014,122016,122044,122060,122098,122100,122116,122120,122128,122142,122144,122172,122176,122232,122246,122264,122318,122338,122340,122344,122414,122418,122420,122446,122460,122466,122468,122472,122510,122524,122552,122562,122564,122568,122576,122598,122618,122646,122662,122668,122694,122700,122712,122738,122740,122762,122770,122772,122786,122788,122792,123018,123026,123028,123042,123044,123048,123062,123098,123146,123154,123156,123170,123172,123176,123190,123202,123204,123208,123216,123238,123244,123258,123290,123314,123316,123402,123410,123412,123426,123428,123432,123446,123458,123464,123472,123486,123494,123500,123514,123522,123524,123528,123536,123552,123580,123590,123596,123608,123630,123634,123636,123674,123698,123700,123740,123746,123748,123752,123834,123914,123922,123924,123938,123944,123958,123970,123976,123984,123998,124006,124012,124026,124034,124036,124048,124062,124064,124092,124102,124108,124120,124142,124146,124148,124162,124164,124168,124176,124190,124192,124220,124224,124280,124294,124300,124312,124336,124350,124366,124380,124386,124388,124392,124406,124442,124462,124466,124468,124494,124508,124514,124520,124558,124572,124600,124610,124612,124616,124624,124646,124666,124694,124710,124716,124730,124742,124748,124760,124786,124788,124818,124820,124834,124836,124840,124854,124946,124948,124962,124964,124968,124982,124994,124996,125e3,125008,125022,125030,125036,125050,125058,125060,125064,125072,125086,125088,125116,125126,125132,125144,125166,125170,125172,125186,125188,125192,125200,125216,125244,125248,125304,125318,125324,125336,125360,125374,125390,125404,125410,125412,125416,125430,125444,125448,125456,125472,125504,125560,125680,125702,125708,125720,125744,125758,125792,125820,125838,125852,125880,125890,125892,125896,125904,125918,125926,125932,125978,125998,126002,126004,126030,126044,126050,126052,126056,126094,126108,126136,126146,126148,126152,126160,126182,126202,126222,126236,126264,126320,126334,126338,126340,126344,126352,126366,126368,126412,126450,126452,126486,126502,126508,126522,126534,126540,126552,126574,126578,126580,126598,126604,126616,126640,126654,126670,126684,126690,126692,126696,126738,126754,126756,126760,126774,126786,126788,126792,126800,126814,126822,126828,126842,126894,126898,126900,126934,127126,127142,127148,127162,127178,127186,127188,127254,127270,127276,127290,127302,127308,127320,127342,127346,127348,127370,127378,127380,127394,127396,127400,127450,127510,127526,127532,127546,127558,127576,127598,127602,127604,127622,127628,127640,127664,127678,127694,127708,127714,127716,127720,127734,127754,127762,127764,127778,127784,127810,127812,127816,127824,127838,127846,127866,127898,127918,127922,127924,128022,128038,128044,128058,128070,128076,128088,128110,128114,128116,128134,128140,128152,128176,128190,128206,128220,128226,128228,128232,128246,128262,128268,128280,128304,128318,128352,128380,128398,128412,128440,128450,128452,128456,128464,128478,128486,128492,128506,128522,128530,128532,128546,128548,128552,128566,128578,128580,128584,128592,128606,128614,128634,128642,128644,128648,128656,128670,128672,128700,128716,128754,128756,128794,128814,128818,128820,128846,128860,128866,128868,128872,128886,128918,128934,128940,128954,128978,128980,129178,129198,129202,129204,129238,129258,129306,129326,129330,129332,129358,129372,129378,129380,129384,129398,129430,129446,129452,129466,129482,129490,129492,129562,129582,129586,129588,129614,129628,129634,129636,129640,129654,129678,129692,129720,129730,129732,129736,129744,129758,129766,129772,129814,129830,129836,129850,129862,129868,129880,129902,129906,129908,129930,129938,129940,129954,129956,129960,129974,130010]),Je.CODEWORD_TABLE=Int32Array.from([2627,1819,2622,2621,1813,1812,2729,2724,2723,2779,2774,2773,902,896,908,868,865,861,859,2511,873,871,1780,835,2493,825,2491,842,837,844,1764,1762,811,810,809,2483,807,2482,806,2480,815,814,813,812,2484,817,816,1745,1744,1742,1746,2655,2637,2635,2626,2625,2623,2628,1820,2752,2739,2737,2728,2727,2725,2730,2785,2783,2778,2777,2775,2780,787,781,747,739,736,2413,754,752,1719,692,689,681,2371,678,2369,700,697,694,703,1688,1686,642,638,2343,631,2341,627,2338,651,646,643,2345,654,652,1652,1650,1647,1654,601,599,2322,596,2321,594,2319,2317,611,610,608,606,2324,603,2323,615,614,612,1617,1616,1614,1612,616,1619,1618,2575,2538,2536,905,901,898,909,2509,2507,2504,870,867,864,860,2512,875,872,1781,2490,2489,2487,2485,1748,836,834,832,830,2494,827,2492,843,841,839,845,1765,1763,2701,2676,2674,2653,2648,2656,2634,2633,2631,2629,1821,2638,2636,2770,2763,2761,2750,2745,2753,2736,2735,2733,2731,1848,2740,2738,2786,2784,591,588,576,569,566,2296,1590,537,534,526,2276,522,2274,545,542,539,548,1572,1570,481,2245,466,2242,462,2239,492,485,482,2249,496,494,1534,1531,1528,1538,413,2196,406,2191,2188,425,419,2202,415,2199,432,430,427,1472,1467,1464,433,1476,1474,368,367,2160,365,2159,362,2157,2155,2152,378,377,375,2166,372,2165,369,2162,383,381,379,2168,1419,1418,1416,1414,385,1411,384,1423,1422,1420,1424,2461,802,2441,2439,790,786,783,794,2409,2406,2403,750,742,738,2414,756,753,1720,2367,2365,2362,2359,1663,693,691,684,2373,680,2370,702,699,696,704,1690,1687,2337,2336,2334,2332,1624,2329,1622,640,637,2344,634,2342,630,2340,650,648,645,2346,655,653,1653,1651,1649,1655,2612,2597,2595,2571,2568,2565,2576,2534,2529,2526,1787,2540,2537,907,904,900,910,2503,2502,2500,2498,1768,2495,1767,2510,2508,2506,869,866,863,2513,876,874,1782,2720,2713,2711,2697,2694,2691,2702,2672,2670,2664,1828,2678,2675,2647,2646,2644,2642,1823,2639,1822,2654,2652,2650,2657,2771,1855,2765,2762,1850,1849,2751,2749,2747,2754,353,2148,344,342,336,2142,332,2140,345,1375,1373,306,2130,299,2128,295,2125,319,314,311,2132,1354,1352,1349,1356,262,257,2101,253,2096,2093,274,273,267,2107,263,2104,280,278,275,1316,1311,1308,1320,1318,2052,202,2050,2044,2040,219,2063,212,2060,208,2055,224,221,2066,1260,1258,1252,231,1248,229,1266,1264,1261,1268,155,1998,153,1996,1994,1991,1988,165,164,2007,162,2006,159,2003,2e3,172,171,169,2012,166,2010,1186,1184,1182,1179,175,1176,173,1192,1191,1189,1187,176,1194,1193,2313,2307,2305,592,589,2294,2292,2289,578,572,568,2297,580,1591,2272,2267,2264,1547,538,536,529,2278,525,2275,547,544,541,1574,1571,2237,2235,2229,1493,2225,1489,478,2247,470,2244,465,2241,493,488,484,2250,498,495,1536,1533,1530,1539,2187,2186,2184,2182,1432,2179,1430,2176,1427,414,412,2197,409,2195,405,2193,2190,426,424,421,2203,418,2201,431,429,1473,1471,1469,1466,434,1477,1475,2478,2472,2470,2459,2457,2454,2462,803,2437,2432,2429,1726,2443,2440,792,789,785,2401,2399,2393,1702,2389,1699,2411,2408,2405,745,741,2415,758,755,1721,2358,2357,2355,2353,1661,2350,1660,2347,1657,2368,2366,2364,2361,1666,690,687,2374,683,2372,701,698,705,1691,1689,2619,2617,2610,2608,2605,2613,2593,2588,2585,1803,2599,2596,2563,2561,2555,1797,2551,1795,2573,2570,2567,2577,2525,2524,2522,2520,1786,2517,1785,2514,1783,2535,2533,2531,2528,1788,2541,2539,906,903,911,2721,1844,2715,2712,1838,1836,2699,2696,2693,2703,1827,1826,1824,2673,2671,2669,2666,1829,2679,2677,1858,1857,2772,1854,1853,1851,1856,2766,2764,143,1987,139,1986,135,133,131,1984,128,1983,125,1981,138,137,136,1985,1133,1132,1130,112,110,1974,107,1973,104,1971,1969,122,121,119,117,1977,114,1976,124,1115,1114,1112,1110,1117,1116,84,83,1953,81,1952,78,1950,1948,1945,94,93,91,1959,88,1958,85,1955,99,97,95,1961,1086,1085,1083,1081,1078,100,1090,1089,1087,1091,49,47,1917,44,1915,1913,1910,1907,59,1926,56,1925,53,1922,1919,66,64,1931,61,1929,1042,1040,1038,71,1035,70,1032,68,1048,1047,1045,1043,1050,1049,12,10,1869,1867,1864,1861,21,1880,19,1877,1874,1871,28,1888,25,1886,22,1883,982,980,977,974,32,30,991,989,987,984,34,995,994,992,2151,2150,2147,2146,2144,356,355,354,2149,2139,2138,2136,2134,1359,343,341,338,2143,335,2141,348,347,346,1376,1374,2124,2123,2121,2119,1326,2116,1324,310,308,305,2131,302,2129,298,2127,320,318,316,313,2133,322,321,1355,1353,1351,1357,2092,2091,2089,2087,1276,2084,1274,2081,1271,259,2102,256,2100,252,2098,2095,272,269,2108,266,2106,281,279,277,1317,1315,1313,1310,282,1321,1319,2039,2037,2035,2032,1203,2029,1200,1197,207,2053,205,2051,201,2049,2046,2043,220,218,2064,215,2062,211,2059,228,226,223,2069,1259,1257,1254,232,1251,230,1267,1265,1263,2316,2315,2312,2311,2309,2314,2304,2303,2301,2299,1593,2308,2306,590,2288,2287,2285,2283,1578,2280,1577,2295,2293,2291,579,577,574,571,2298,582,581,1592,2263,2262,2260,2258,1545,2255,1544,2252,1541,2273,2271,2269,2266,1550,535,532,2279,528,2277,546,543,549,1575,1573,2224,2222,2220,1486,2217,1485,2214,1482,1479,2238,2236,2234,2231,1496,2228,1492,480,477,2248,473,2246,469,2243,490,487,2251,497,1537,1535,1532,2477,2476,2474,2479,2469,2468,2466,2464,1730,2473,2471,2453,2452,2450,2448,1729,2445,1728,2460,2458,2456,2463,805,804,2428,2427,2425,2423,1725,2420,1724,2417,1722,2438,2436,2434,2431,1727,2444,2442,793,791,788,795,2388,2386,2384,1697,2381,1696,2378,1694,1692,2402,2400,2398,2395,1703,2392,1701,2412,2410,2407,751,748,744,2416,759,757,1807,2620,2618,1806,1805,2611,2609,2607,2614,1802,1801,1799,2594,2592,2590,2587,1804,2600,2598,1794,1793,1791,1789,2564,2562,2560,2557,1798,2554,1796,2574,2572,2569,2578,1847,1846,2722,1843,1842,1840,1845,2716,2714,1835,1834,1832,1830,1839,1837,2700,2698,2695,2704,1817,1811,1810,897,862,1777,829,826,838,1760,1758,808,2481,1741,1740,1738,1743,2624,1818,2726,2776,782,740,737,1715,686,679,695,1682,1680,639,628,2339,647,644,1645,1643,1640,1648,602,600,597,595,2320,593,2318,609,607,604,1611,1610,1608,1606,613,1615,1613,2328,926,924,892,886,899,857,850,2505,1778,824,823,821,819,2488,818,2486,833,831,828,840,1761,1759,2649,2632,2630,2746,2734,2732,2782,2781,570,567,1587,531,527,523,540,1566,1564,476,467,463,2240,486,483,1524,1521,1518,1529,411,403,2192,399,2189,423,416,1462,1457,1454,428,1468,1465,2210,366,363,2158,360,2156,357,2153,376,373,370,2163,1410,1409,1407,1405,382,1402,380,1417,1415,1412,1421,2175,2174,777,774,771,784,732,725,722,2404,743,1716,676,674,668,2363,665,2360,685,1684,1681,626,624,622,2335,620,2333,617,2330,641,635,649,1646,1644,1642,2566,928,925,2530,2527,894,891,888,2501,2499,2496,858,856,854,851,1779,2692,2668,2665,2645,2643,2640,2651,2768,2759,2757,2744,2743,2741,2748,352,1382,340,337,333,1371,1369,307,300,296,2126,315,312,1347,1342,1350,261,258,250,2097,246,2094,271,268,264,1306,1301,1298,276,1312,1309,2115,203,2048,195,2045,191,2041,213,209,2056,1246,1244,1238,225,1234,222,1256,1253,1249,1262,2080,2079,154,1997,150,1995,147,1992,1989,163,160,2004,156,2001,1175,1174,1172,1170,1167,170,1164,167,1185,1183,1180,1177,174,1190,1188,2025,2024,2022,587,586,564,559,556,2290,573,1588,520,518,512,2268,508,2265,530,1568,1565,461,457,2233,450,2230,446,2226,479,471,489,1526,1523,1520,397,395,2185,392,2183,389,2180,2177,410,2194,402,422,1463,1461,1459,1456,1470,2455,799,2433,2430,779,776,773,2397,2394,2390,734,728,724,746,1717,2356,2354,2351,2348,1658,677,675,673,670,667,688,1685,1683,2606,2589,2586,2559,2556,2552,927,2523,2521,2518,2515,1784,2532,895,893,890,2718,2709,2707,2689,2687,2684,2663,2662,2660,2658,1825,2667,2769,1852,2760,2758,142,141,1139,1138,134,132,129,126,1982,1129,1128,1126,1131,113,111,108,105,1972,101,1970,120,118,115,1109,1108,1106,1104,123,1113,1111,82,79,1951,75,1949,72,1946,92,89,86,1956,1077,1076,1074,1072,98,1069,96,1084,1082,1079,1088,1968,1967,48,45,1916,42,1914,39,1911,1908,60,57,54,1923,50,1920,1031,1030,1028,1026,67,1023,65,1020,62,1041,1039,1036,1033,69,1046,1044,1944,1943,1941,11,9,1868,7,1865,1862,1859,20,1878,16,1875,13,1872,970,968,966,963,29,960,26,23,983,981,978,975,33,971,31,990,988,985,1906,1904,1902,993,351,2145,1383,331,330,328,326,2137,323,2135,339,1372,1370,294,293,291,289,2122,286,2120,283,2117,309,303,317,1348,1346,1344,245,244,242,2090,239,2088,236,2085,2082,260,2099,249,270,1307,1305,1303,1300,1314,189,2038,186,2036,183,2033,2030,2026,206,198,2047,194,216,1247,1245,1243,1240,227,1237,1255,2310,2302,2300,2286,2284,2281,565,563,561,558,575,1589,2261,2259,2256,2253,1542,521,519,517,514,2270,511,533,1569,1567,2223,2221,2218,2215,1483,2211,1480,459,456,453,2232,449,474,491,1527,1525,1522,2475,2467,2465,2451,2449,2446,801,800,2426,2424,2421,2418,1723,2435,780,778,775,2387,2385,2382,2379,1695,2375,1693,2396,735,733,730,727,749,1718,2616,2615,2604,2603,2601,2584,2583,2581,2579,1800,2591,2550,2549,2547,2545,1792,2542,1790,2558,929,2719,1841,2710,2708,1833,1831,2690,2688,2686,1815,1809,1808,1774,1756,1754,1737,1736,1734,1739,1816,1711,1676,1674,633,629,1638,1636,1633,1641,598,1605,1604,1602,1600,605,1609,1607,2327,887,853,1775,822,820,1757,1755,1584,524,1560,1558,468,464,1514,1511,1508,1519,408,404,400,1452,1447,1444,417,1458,1455,2208,364,361,358,2154,1401,1400,1398,1396,374,1393,371,1408,1406,1403,1413,2173,2172,772,726,723,1712,672,669,666,682,1678,1675,625,623,621,618,2331,636,632,1639,1637,1635,920,918,884,880,889,849,848,847,846,2497,855,852,1776,2641,2742,2787,1380,334,1367,1365,301,297,1340,1338,1335,1343,255,251,247,1296,1291,1288,265,1302,1299,2113,204,196,192,2042,1232,1230,1224,214,1220,210,1242,1239,1235,1250,2077,2075,151,148,1993,144,1990,1163,1162,1160,1158,1155,161,1152,157,1173,1171,1168,1165,168,1181,1178,2021,2020,2018,2023,585,560,557,1585,516,509,1562,1559,458,447,2227,472,1516,1513,1510,398,396,393,390,2181,386,2178,407,1453,1451,1449,1446,420,1460,2209,769,764,720,712,2391,729,1713,664,663,661,659,2352,656,2349,671,1679,1677,2553,922,919,2519,2516,885,883,881,2685,2661,2659,2767,2756,2755,140,1137,1136,130,127,1125,1124,1122,1127,109,106,102,1103,1102,1100,1098,116,1107,1105,1980,80,76,73,1947,1068,1067,1065,1063,90,1060,87,1075,1073,1070,1080,1966,1965,46,43,40,1912,36,1909,1019,1018,1016,1014,58,1011,55,1008,51,1029,1027,1024,1021,63,1037,1034,1940,1939,1937,1942,8,1866,4,1863,1,1860,956,954,952,949,946,17,14,969,967,964,961,27,957,24,979,976,972,1901,1900,1898,1896,986,1905,1903,350,349,1381,329,327,324,1368,1366,292,290,287,284,2118,304,1341,1339,1337,1345,243,240,237,2086,233,2083,254,1297,1295,1293,1290,1304,2114,190,187,184,2034,180,2031,177,2027,199,1233,1231,1229,1226,217,1223,1241,2078,2076,584,555,554,552,550,2282,562,1586,507,506,504,502,2257,499,2254,515,1563,1561,445,443,441,2219,438,2216,435,2212,460,454,475,1517,1515,1512,2447,798,797,2422,2419,770,768,766,2383,2380,2376,721,719,717,714,731,1714,2602,2582,2580,2548,2546,2543,923,921,2717,2706,2705,2683,2682,2680,1771,1752,1750,1733,1732,1731,1735,1814,1707,1670,1668,1631,1629,1626,1634,1599,1598,1596,1594,1603,1601,2326,1772,1753,1751,1581,1554,1552,1504,1501,1498,1509,1442,1437,1434,401,1448,1445,2206,1392,1391,1389,1387,1384,359,1399,1397,1394,1404,2171,2170,1708,1672,1669,619,1632,1630,1628,1773,1378,1363,1361,1333,1328,1336,1286,1281,1278,248,1292,1289,2111,1218,1216,1210,197,1206,193,1228,1225,1221,1236,2073,2071,1151,1150,1148,1146,152,1143,149,1140,145,1161,1159,1156,1153,158,1169,1166,2017,2016,2014,2019,1582,510,1556,1553,452,448,1506,1500,394,391,387,1443,1441,1439,1436,1450,2207,765,716,713,1709,662,660,657,1673,1671,916,914,879,878,877,882,1135,1134,1121,1120,1118,1123,1097,1096,1094,1092,103,1101,1099,1979,1059,1058,1056,1054,77,1051,74,1066,1064,1061,1071,1964,1963,1007,1006,1004,1002,999,41,996,37,1017,1015,1012,1009,52,1025,1022,1936,1935,1933,1938,942,940,938,935,932,5,2,955,953,950,947,18,943,15,965,962,958,1895,1894,1892,1890,973,1899,1897,1379,325,1364,1362,288,285,1334,1332,1330,241,238,234,1287,1285,1283,1280,1294,2112,188,185,181,178,2028,1219,1217,1215,1212,200,1209,1227,2074,2072,583,553,551,1583,505,503,500,513,1557,1555,444,442,439,436,2213,455,451,1507,1505,1502,796,763,762,760,767,711,710,708,706,2377,718,715,1710,2544,917,915,2681,1627,1597,1595,2325,1769,1749,1747,1499,1438,1435,2204,1390,1388,1385,1395,2169,2167,1704,1665,1662,1625,1623,1620,1770,1329,1282,1279,2109,1214,1207,1222,2068,2065,1149,1147,1144,1141,146,1157,1154,2013,2011,2008,2015,1579,1549,1546,1495,1487,1433,1431,1428,1425,388,1440,2205,1705,658,1667,1664,1119,1095,1093,1978,1057,1055,1052,1062,1962,1960,1005,1003,1e3,997,38,1013,1010,1932,1930,1927,1934,941,939,936,933,6,930,3,951,948,944,1889,1887,1884,1881,959,1893,1891,35,1377,1360,1358,1327,1325,1322,1331,1277,1275,1272,1269,235,1284,2110,1205,1204,1201,1198,182,1195,179,1213,2070,2067,1580,501,1551,1548,440,437,1497,1494,1490,1503,761,709,707,1706,913,912,2198,1386,2164,2161,1621,1766,2103,1208,2058,2054,1145,1142,2005,2002,1999,2009,1488,1429,1426,2200,1698,1659,1656,1975,1053,1957,1954,1001,998,1924,1921,1918,1928,937,934,931,1879,1876,1873,1870,945,1885,1882,1323,1273,1270,2105,1202,1199,1196,1211,2061,2057,1576,1543,1540,1484,1481,1478,1491,1700]);class Pu{constructor(n,s){this.bits=n,this.points=s}getBits(){return this.bits}getPoints(){return this.points}}class lt{static detectMultiple(n,s,o){let f=n.getBlackMatrix(),l=lt.detect(o,f);return l.length||(f=f.clone(),f.rotate180(),l=lt.detect(o,f)),new Pu(f,l)}static detect(n,s){const o=new Array;let f=0,l=0,h=!1;for(;f<s.getHeight();){const x=lt.findVertices(s,f,l);if(x[0]==null&&x[3]==null){if(!h)break;h=!1,l=0;for(const p of o)p[1]!=null&&(f=Math.trunc(Math.max(f,p[1].getY()))),p[3]!=null&&(f=Math.max(f,Math.trunc(p[3].getY())));f+=lt.ROW_STEP;continue}if(h=!0,o.push(x),!n)break;x[2]!=null?(l=Math.trunc(x[2].getX()),f=Math.trunc(x[2].getY())):(l=Math.trunc(x[4].getX()),f=Math.trunc(x[4].getY()))}return o}static findVertices(n,s,o){const f=n.getHeight(),l=n.getWidth(),h=new Array(8);return lt.copyToResult(h,lt.findRowsWithPattern(n,f,l,s,o,lt.START_PATTERN),lt.INDEXES_START_PATTERN),h[4]!=null&&(o=Math.trunc(h[4].getX()),s=Math.trunc(h[4].getY())),lt.copyToResult(h,lt.findRowsWithPattern(n,f,l,s,o,lt.STOP_PATTERN),lt.INDEXES_STOP_PATTERN),h}static copyToResult(n,s,o){for(let f=0;f<o.length;f++)n[o[f]]=s[f]}static findRowsWithPattern(n,s,o,f,l,h){const x=new Array(4);let p=!1;const E=new Int32Array(h.length);for(;f<s;f+=lt.ROW_STEP){let k=lt.findGuardPattern(n,l,f,o,!1,h,E);if(k!=null){for(;f>0;){const R=lt.findGuardPattern(n,l,--f,o,!1,h,E);if(R!=null)k=R;else{f++;break}}x[0]=new Ve(k[0],f),x[1]=new Ve(k[1],f),p=!0;break}}let T=f+1;if(p){let k=0,R=Int32Array.from([Math.trunc(x[0].getX()),Math.trunc(x[1].getX())]);for(;T<s;T++){const G=lt.findGuardPattern(n,R[0],T,o,!1,h,E);if(G!=null&&Math.abs(R[0]-G[0])<lt.MAX_PATTERN_DRIFT&&Math.abs(R[1]-G[1])<lt.MAX_PATTERN_DRIFT)R=G,k=0;else{if(k>lt.SKIPPED_ROW_COUNT_MAX)break;k++}}T-=k+1,x[2]=new Ve(R[0],T),x[3]=new Ve(R[1],T)}return T-f<lt.BARCODE_MIN_HEIGHT&&P.fill(x,null),x}static findGuardPattern(n,s,o,f,l,h,x){P.fillWithin(x,0,x.length,0);let p=s,E=0;for(;n.get(p,o)&&p>0&&E++<lt.MAX_PIXEL_DRIFT;)p--;let T=p,k=0,R=h.length;for(let G=l;T<f;T++)if(n.get(T,o)!==G)x[k]++;else{if(k===R-1){if(lt.patternMatchVariance(x,h,lt.MAX_INDIVIDUAL_VARIANCE)<lt.MAX_AVG_VARIANCE)return new Int32Array([p,T]);p+=x[0]+x[1],A.arraycopy(x,2,x,0,k-1),x[k-1]=0,x[k]=0,k--}else k++;x[k]=1,G=!G}return k===R-1&&lt.patternMatchVariance(x,h,lt.MAX_INDIVIDUAL_VARIANCE)<lt.MAX_AVG_VARIANCE?new Int32Array([p,T-1]):null}static patternMatchVariance(n,s,o){let f=n.length,l=0,h=0;for(let E=0;E<f;E++)l+=n[E],h+=s[E];if(l<h)return 1/0;let x=l/h;o*=x;let p=0;for(let E=0;E<f;E++){let T=n[E],k=s[E]*x,R=T>k?T-k:k-T;if(R>o)return 1/0;p+=R}return p/l}}lt.INDEXES_START_PATTERN=Int32Array.from([0,4,1,5]),lt.INDEXES_STOP_PATTERN=Int32Array.from([6,2,7,3]),lt.MAX_AVG_VARIANCE=.42,lt.MAX_INDIVIDUAL_VARIANCE=.8,lt.START_PATTERN=Int32Array.from([8,1,1,1,1,1,1,3]),lt.STOP_PATTERN=Int32Array.from([7,1,1,3,1,1,1,2,1]),lt.MAX_PIXEL_DRIFT=3,lt.MAX_PATTERN_DRIFT=5,lt.SKIPPED_ROW_COUNT_MAX=25,lt.ROW_STEP=5,lt.BARCODE_MIN_HEIGHT=10;class wr{constructor(n,s){if(s.length===0)throw new v;this.field=n;let o=s.length;if(o>1&&s[0]===0){let f=1;for(;f<o&&s[f]===0;)f++;f===o?this.coefficients=new Int32Array([0]):(this.coefficients=new Int32Array(o-f),A.arraycopy(s,f,this.coefficients,0,this.coefficients.length))}else this.coefficients=s}getCoefficients(){return this.coefficients}getDegree(){return this.coefficients.length-1}isZero(){return this.coefficients[0]===0}getCoefficient(n){return this.coefficients[this.coefficients.length-1-n]}evaluateAt(n){if(n===0)return this.getCoefficient(0);if(n===1){let f=0;for(let l of this.coefficients)f=this.field.add(f,l);return f}let s=this.coefficients[0],o=this.coefficients.length;for(let f=1;f<o;f++)s=this.field.add(this.field.multiply(n,s),this.coefficients[f]);return s}add(n){if(!this.field.equals(n.field))throw new v("ModulusPolys do not have same ModulusGF field");if(this.isZero())return n;if(n.isZero())return this;let s=this.coefficients,o=n.coefficients;if(s.length>o.length){let h=s;s=o,o=h}let f=new Int32Array(o.length),l=o.length-s.length;A.arraycopy(o,0,f,0,l);for(let h=l;h<o.length;h++)f[h]=this.field.add(s[h-l],o[h]);return new wr(this.field,f)}subtract(n){if(!this.field.equals(n.field))throw new v("ModulusPolys do not have same ModulusGF field");return n.isZero()?this:this.add(n.negative())}multiply(n){return n instanceof wr?this.multiplyOther(n):this.multiplyScalar(n)}multiplyOther(n){if(!this.field.equals(n.field))throw new v("ModulusPolys do not have same ModulusGF field");if(this.isZero()||n.isZero())return new wr(this.field,new Int32Array([0]));let s=this.coefficients,o=s.length,f=n.coefficients,l=f.length,h=new Int32Array(o+l-1);for(let x=0;x<o;x++){let p=s[x];for(let E=0;E<l;E++)h[x+E]=this.field.add(h[x+E],this.field.multiply(p,f[E]))}return new wr(this.field,h)}negative(){let n=this.coefficients.length,s=new Int32Array(n);for(let o=0;o<n;o++)s[o]=this.field.subtract(0,this.coefficients[o]);return new wr(this.field,s)}multiplyScalar(n){if(n===0)return new wr(this.field,new Int32Array([0]));if(n===1)return this;let s=this.coefficients.length,o=new Int32Array(s);for(let f=0;f<s;f++)o[f]=this.field.multiply(this.coefficients[f],n);return new wr(this.field,o)}multiplyByMonomial(n,s){if(n<0)throw new v;if(s===0)return new wr(this.field,new Int32Array([0]));let o=this.coefficients.length,f=new Int32Array(o+n);for(let l=0;l<o;l++)f[l]=this.field.multiply(this.coefficients[l],s);return new wr(this.field,f)}toString(){let n=new ie;for(let s=this.getDegree();s>=0;s--){let o=this.getCoefficient(s);o!==0&&(o<0?(n.append(" - "),o=-o):n.length()>0&&n.append(" + "),(s===0||o!==1)&&n.append(o),s!==0&&(s===1?n.append("x"):(n.append("x^"),n.append(s))))}return n.toString()}}class Lu{add(n,s){return(n+s)%this.modulus}subtract(n,s){return(this.modulus+n-s)%this.modulus}exp(n){return this.expTable[n]}log(n){if(n===0)throw new v;return this.logTable[n]}inverse(n){if(n===0)throw new K;return this.expTable[this.modulus-this.logTable[n]-1]}multiply(n,s){return n===0||s===0?0:this.expTable[(this.logTable[n]+this.logTable[s])%(this.modulus-1)]}getSize(){return this.modulus}equals(n){return n===this}}class Qs extends Lu{constructor(n,s){super(),this.modulus=n,this.expTable=new Int32Array(n),this.logTable=new Int32Array(n);let o=1;for(let f=0;f<n;f++)this.expTable[f]=o,o=o*s%n;for(let f=0;f<n-1;f++)this.logTable[this.expTable[f]]=f;this.zero=new wr(this,new Int32Array([0])),this.one=new wr(this,new Int32Array([1]))}getZero(){return this.zero}getOne(){return this.one}buildMonomial(n,s){if(n<0)throw new v;if(s===0)return this.zero;let o=new Int32Array(n+1);return o[0]=s,new wr(this,o)}}Qs.PDF417_GF=new Qs(Je.NUMBER_OF_CODEWORDS,3);class ec{constructor(){this.field=Qs.PDF417_GF}decode(n,s,o){let f=new wr(this.field,n),l=new Int32Array(s),h=!1;for(let J=s;J>0;J--){let re=f.evaluateAt(this.field.exp(J));l[s-J]=re,re!==0&&(h=!0)}if(!h)return 0;let x=this.field.getOne();if(o!=null)for(const J of o){let re=this.field.exp(n.length-1-J),fe=new wr(this.field,new Int32Array([this.field.subtract(0,re),1]));x=x.multiply(fe)}let p=new wr(this.field,l),E=this.runEuclideanAlgorithm(this.field.buildMonomial(s,1),p,s),T=E[0],k=E[1],R=this.findErrorLocations(T),G=this.findErrorMagnitudes(k,T,R);for(let J=0;J<R.length;J++){let re=n.length-1-this.field.log(R[J]);if(re<0)throw C.getChecksumInstance();n[re]=this.field.subtract(n[re],G[J])}return R.length}runEuclideanAlgorithm(n,s,o){if(n.getDegree()<s.getDegree()){let R=n;n=s,s=R}let f=n,l=s,h=this.field.getZero(),x=this.field.getOne();for(;l.getDegree()>=Math.round(o/2);){let R=f,G=h;if(f=l,h=x,f.isZero())throw C.getChecksumInstance();l=R;let J=this.field.getZero(),re=f.getCoefficient(f.getDegree()),fe=this.field.inverse(re);for(;l.getDegree()>=f.getDegree()&&!l.isZero();){let pe=l.getDegree()-f.getDegree(),Re=this.field.multiply(l.getCoefficient(l.getDegree()),fe);J=J.add(this.field.buildMonomial(pe,Re)),l=l.subtract(f.multiplyByMonomial(pe,Re))}x=J.multiply(h).subtract(G).negative()}let p=x.getCoefficient(0);if(p===0)throw C.getChecksumInstance();let E=this.field.inverse(p),T=x.multiply(E),k=l.multiply(E);return[T,k]}findErrorLocations(n){let s=n.getDegree(),o=new Int32Array(s),f=0;for(let l=1;l<this.field.getSize()&&f<s;l++)n.evaluateAt(l)===0&&(o[f]=this.field.inverse(l),f++);if(f!==s)throw C.getChecksumInstance();return o}findErrorMagnitudes(n,s,o){let f=s.getDegree(),l=new Int32Array(f);for(let E=1;E<=f;E++)l[f-E]=this.field.multiply(E,s.getCoefficient(E));let h=new wr(this.field,l),x=o.length,p=new Int32Array(x);for(let E=0;E<x;E++){let T=this.field.inverse(o[E]),k=this.field.subtract(0,n.evaluateAt(T)),R=this.field.inverse(h.evaluateAt(T));p[E]=this.field.multiply(k,R)}return p}}class xa{constructor(n,s,o,f,l){n instanceof xa?this.constructor_2(n):this.constructor_1(n,s,o,f,l)}constructor_1(n,s,o,f,l){const h=s==null||o==null,x=f==null||l==null;if(h&&x)throw new q;h?(s=new Ve(0,f.getY()),o=new Ve(0,l.getY())):x&&(f=new Ve(n.getWidth()-1,s.getY()),l=new Ve(n.getWidth()-1,o.getY())),this.image=n,this.topLeft=s,this.bottomLeft=o,this.topRight=f,this.bottomRight=l,this.minX=Math.trunc(Math.min(s.getX(),o.getX())),this.maxX=Math.trunc(Math.max(f.getX(),l.getX())),this.minY=Math.trunc(Math.min(s.getY(),f.getY())),this.maxY=Math.trunc(Math.max(o.getY(),l.getY()))}constructor_2(n){this.image=n.image,this.topLeft=n.getTopLeft(),this.bottomLeft=n.getBottomLeft(),this.topRight=n.getTopRight(),this.bottomRight=n.getBottomRight(),this.minX=n.getMinX(),this.maxX=n.getMaxX(),this.minY=n.getMinY(),this.maxY=n.getMaxY()}static merge(n,s){return n==null?s:s==null?n:new xa(n.image,n.topLeft,n.bottomLeft,s.topRight,s.bottomRight)}addMissingRows(n,s,o){let f=this.topLeft,l=this.bottomLeft,h=this.topRight,x=this.bottomRight;if(n>0){let p=o?this.topLeft:this.topRight,E=Math.trunc(p.getY()-n);E<0&&(E=0);let T=new Ve(p.getX(),E);o?f=T:h=T}if(s>0){let p=o?this.bottomLeft:this.bottomRight,E=Math.trunc(p.getY()+s);E>=this.image.getHeight()&&(E=this.image.getHeight()-1);let T=new Ve(p.getX(),E);o?l=T:x=T}return new xa(this.image,f,l,h,x)}getMinX(){return this.minX}getMaxX(){return this.maxX}getMinY(){return this.minY}getMaxY(){return this.maxY}getTopLeft(){return this.topLeft}getTopRight(){return this.topRight}getBottomLeft(){return this.bottomLeft}getBottomRight(){return this.bottomRight}}class Uu{constructor(n,s,o,f){this.columnCount=n,this.errorCorrectionLevel=f,this.rowCountUpperPart=s,this.rowCountLowerPart=o,this.rowCount=s+o}getColumnCount(){return this.columnCount}getErrorCorrectionLevel(){return this.errorCorrectionLevel}getRowCount(){return this.rowCount}getRowCountUpperPart(){return this.rowCountUpperPart}getRowCountLowerPart(){return this.rowCountLowerPart}}class hi{constructor(){this.buffer=""}static form(n,s){let o=-1;function f(h,x,p,E,T,k){if(h==="%%")return"%";if(s[++o]===void 0)return;h=E?parseInt(E.substr(1)):void 0;let R=T?parseInt(T.substr(1)):void 0,G;switch(k){case"s":G=s[o];break;case"c":G=s[o][0];break;case"f":G=parseFloat(s[o]).toFixed(h);break;case"p":G=parseFloat(s[o]).toPrecision(h);break;case"e":G=parseFloat(s[o]).toExponential(h);break;case"x":G=parseInt(s[o]).toString(R||16);break;case"d":G=parseFloat(parseInt(s[o],R||10).toPrecision(h)).toFixed(0);break}G=typeof G=="object"?JSON.stringify(G):(+G).toString(R);let J=parseInt(p),re=p&&p[0]+""=="0"?"0":" ";for(;G.length<J;)G=x!==void 0?G+re:re+G;return G}let l=/%(-)?(0?[0-9]+)?([.][0-9]+)?([#][0-9]+)?([scfpexd%])/g;return n.replace(l,f)}format(n,...s){this.buffer+=hi.form(n,s)}toString(){return this.buffer}}class di{constructor(n){this.boundingBox=new xa(n),this.codewords=new Array(n.getMaxY()-n.getMinY()+1)}getCodewordNearby(n){let s=this.getCodeword(n);if(s!=null)return s;for(let o=1;o<di.MAX_NEARBY_DISTANCE;o++){let f=this.imageRowToCodewordIndex(n)-o;if(f>=0&&(s=this.codewords[f],s!=null)||(f=this.imageRowToCodewordIndex(n)+o,f<this.codewords.length&&(s=this.codewords[f],s!=null)))return s}return null}imageRowToCodewordIndex(n){return n-this.boundingBox.getMinY()}setCodeword(n,s){this.codewords[this.imageRowToCodewordIndex(n)]=s}getCodeword(n){return this.codewords[this.imageRowToCodewordIndex(n)]}getBoundingBox(){return this.boundingBox}getCodewords(){return this.codewords}toString(){const n=new hi;let s=0;for(const o of this.codewords){if(o==null){n.format("%3d:    |   %n",s++);continue}n.format("%3d: %3d|%3d%n",s++,o.getRowNumber(),o.getValue())}return n.toString()}}di.MAX_NEARBY_DISTANCE=5;class xi{constructor(){this.values=new Map}setValue(n){n=Math.trunc(n);let s=this.values.get(n);s==null&&(s=0),s++,this.values.set(n,s)}getValue(){let n=-1,s=new Array;for(const[o,f]of this.values.entries()){const l={getKey:()=>o,getValue:()=>f};l.getValue()>n?(n=l.getValue(),s=[],s.push(l.getKey())):l.getValue()===n&&s.push(l.getKey())}return Je.toIntArray(s)}getConfidence(n){return this.values.get(n)}}class tc extends di{constructor(n,s){super(n),this._isLeft=s}setRowNumbers(){for(let n of this.getCodewords())n?.setRowNumberAsRowIndicatorColumn()}adjustCompleteIndicatorColumnRowNumbers(n){let s=this.getCodewords();this.setRowNumbers(),this.removeIncorrectCodewords(s,n);let o=this.getBoundingBox(),f=this._isLeft?o.getTopLeft():o.getTopRight(),l=this._isLeft?o.getBottomLeft():o.getBottomRight(),h=this.imageRowToCodewordIndex(Math.trunc(f.getY())),x=this.imageRowToCodewordIndex(Math.trunc(l.getY())),p=-1,E=1,T=0;for(let k=h;k<x;k++){if(s[k]==null)continue;let R=s[k],G=R.getRowNumber()-p;if(G===0)T++;else if(G===1)E=Math.max(E,T),T=1,p=R.getRowNumber();else if(G<0||R.getRowNumber()>=n.getRowCount()||G>k)s[k]=null;else{let J;E>2?J=(E-2)*G:J=G;let re=J>=k;for(let fe=1;fe<=J&&!re;fe++)re=s[k-fe]!=null;re?s[k]=null:(p=R.getRowNumber(),T=1)}}}getRowHeights(){let n=this.getBarcodeMetadata();if(n==null)return null;this.adjustIncompleteIndicatorColumnRowNumbers(n);let s=new Int32Array(n.getRowCount());for(let o of this.getCodewords())if(o!=null){let f=o.getRowNumber();if(f>=s.length)continue;s[f]++}return s}adjustIncompleteIndicatorColumnRowNumbers(n){let s=this.getBoundingBox(),o=this._isLeft?s.getTopLeft():s.getTopRight(),f=this._isLeft?s.getBottomLeft():s.getBottomRight(),l=this.imageRowToCodewordIndex(Math.trunc(o.getY())),h=this.imageRowToCodewordIndex(Math.trunc(f.getY())),x=this.getCodewords(),p=-1;for(let E=l;E<h;E++){if(x[E]==null)continue;let T=x[E];T.setRowNumberAsRowIndicatorColumn();let k=T.getRowNumber()-p;k===0||(k===1?p=T.getRowNumber():T.getRowNumber()>=n.getRowCount()?x[E]=null:p=T.getRowNumber())}}getBarcodeMetadata(){let n=this.getCodewords(),s=new xi,o=new xi,f=new xi,l=new xi;for(let x of n){if(x==null)continue;x.setRowNumberAsRowIndicatorColumn();let p=x.getValue()%30,E=x.getRowNumber();switch(this._isLeft||(E+=2),E%3){case 0:o.setValue(p*3+1);break;case 1:l.setValue(p/3),f.setValue(p%3);break;case 2:s.setValue(p+1);break}}if(s.getValue().length===0||o.getValue().length===0||f.getValue().length===0||l.getValue().length===0||s.getValue()[0]<1||o.getValue()[0]+f.getValue()[0]<Je.MIN_ROWS_IN_BARCODE||o.getValue()[0]+f.getValue()[0]>Je.MAX_ROWS_IN_BARCODE)return null;let h=new Uu(s.getValue()[0],o.getValue()[0],f.getValue()[0],l.getValue()[0]);return this.removeIncorrectCodewords(n,h),h}removeIncorrectCodewords(n,s){for(let o=0;o<n.length;o++){let f=n[o];if(n[o]==null)continue;let l=f.getValue()%30,h=f.getRowNumber();if(h>s.getRowCount()){n[o]=null;continue}switch(this._isLeft||(h+=2),h%3){case 0:l*3+1!==s.getRowCountUpperPart()&&(n[o]=null);break;case 1:(Math.trunc(l/3)!==s.getErrorCorrectionLevel()||l%3!==s.getRowCountLowerPart())&&(n[o]=null);break;case 2:l+1!==s.getColumnCount()&&(n[o]=null);break}}}isLeft(){return this._isLeft}toString(){return"IsLeft: "+this._isLeft+`
`+super.toString()}}class gi{constructor(n,s){this.ADJUST_ROW_NUMBER_SKIP=2,this.barcodeMetadata=n,this.barcodeColumnCount=n.getColumnCount(),this.boundingBox=s,this.detectionResultColumns=new Array(this.barcodeColumnCount+2)}getDetectionResultColumns(){this.adjustIndicatorColumnRowNumbers(this.detectionResultColumns[0]),this.adjustIndicatorColumnRowNumbers(this.detectionResultColumns[this.barcodeColumnCount+1]);let n=Je.MAX_CODEWORDS_IN_BARCODE,s;do s=n,n=this.adjustRowNumbersAndGetCount();while(n>0&&n<s);return this.detectionResultColumns}adjustIndicatorColumnRowNumbers(n){n?.adjustCompleteIndicatorColumnRowNumbers(this.barcodeMetadata)}adjustRowNumbersAndGetCount(){let n=this.adjustRowNumbersByRow();if(n===0)return 0;for(let s=1;s<this.barcodeColumnCount+1;s++){let o=this.detectionResultColumns[s].getCodewords();for(let f=0;f<o.length;f++)o[f]!=null&&(o[f].hasValidRowNumber()||this.adjustRowNumbers(s,f,o))}return n}adjustRowNumbersByRow(){return this.adjustRowNumbersFromBothRI(),this.adjustRowNumbersFromLRI()+this.adjustRowNumbersFromRRI()}adjustRowNumbersFromBothRI(){if(this.detectionResultColumns[0]==null||this.detectionResultColumns[this.barcodeColumnCount+1]==null)return;let n=this.detectionResultColumns[0].getCodewords(),s=this.detectionResultColumns[this.barcodeColumnCount+1].getCodewords();for(let o=0;o<n.length;o++)if(n[o]!=null&&s[o]!=null&&n[o].getRowNumber()===s[o].getRowNumber())for(let f=1;f<=this.barcodeColumnCount;f++){let l=this.detectionResultColumns[f].getCodewords()[o];l!=null&&(l.setRowNumber(n[o].getRowNumber()),l.hasValidRowNumber()||(this.detectionResultColumns[f].getCodewords()[o]=null))}}adjustRowNumbersFromRRI(){if(this.detectionResultColumns[this.barcodeColumnCount+1]==null)return 0;let n=0,s=this.detectionResultColumns[this.barcodeColumnCount+1].getCodewords();for(let o=0;o<s.length;o++){if(s[o]==null)continue;let f=s[o].getRowNumber(),l=0;for(let h=this.barcodeColumnCount+1;h>0&&l<this.ADJUST_ROW_NUMBER_SKIP;h--){let x=this.detectionResultColumns[h].getCodewords()[o];x!=null&&(l=gi.adjustRowNumberIfValid(f,l,x),x.hasValidRowNumber()||n++)}}return n}adjustRowNumbersFromLRI(){if(this.detectionResultColumns[0]==null)return 0;let n=0,s=this.detectionResultColumns[0].getCodewords();for(let o=0;o<s.length;o++){if(s[o]==null)continue;let f=s[o].getRowNumber(),l=0;for(let h=1;h<this.barcodeColumnCount+1&&l<this.ADJUST_ROW_NUMBER_SKIP;h++){let x=this.detectionResultColumns[h].getCodewords()[o];x!=null&&(l=gi.adjustRowNumberIfValid(f,l,x),x.hasValidRowNumber()||n++)}}return n}static adjustRowNumberIfValid(n,s,o){return o==null||o.hasValidRowNumber()||(o.isValidRowNumber(n)?(o.setRowNumber(n),s=0):++s),s}adjustRowNumbers(n,s,o){if(!this.detectionResultColumns[n-1])return;let f=o[s],l=this.detectionResultColumns[n-1].getCodewords(),h=l;this.detectionResultColumns[n+1]!=null&&(h=this.detectionResultColumns[n+1].getCodewords());let x=new Array(14);x[2]=l[s],x[3]=h[s],s>0&&(x[0]=o[s-1],x[4]=l[s-1],x[5]=h[s-1]),s>1&&(x[8]=o[s-2],x[10]=l[s-2],x[11]=h[s-2]),s<o.length-1&&(x[1]=o[s+1],x[6]=l[s+1],x[7]=h[s+1]),s<o.length-2&&(x[9]=o[s+2],x[12]=l[s+2],x[13]=h[s+2]);for(let p of x)if(gi.adjustRowNumber(f,p))return}static adjustRowNumber(n,s){return s==null?!1:s.hasValidRowNumber()&&s.getBucket()===n.getBucket()?(n.setRowNumber(s.getRowNumber()),!0):!1}getBarcodeColumnCount(){return this.barcodeColumnCount}getBarcodeRowCount(){return this.barcodeMetadata.getRowCount()}getBarcodeECLevel(){return this.barcodeMetadata.getErrorCorrectionLevel()}setBoundingBox(n){this.boundingBox=n}getBoundingBox(){return this.boundingBox}setDetectionResultColumn(n,s){this.detectionResultColumns[n]=s}getDetectionResultColumn(n){return this.detectionResultColumns[n]}toString(){let n=this.detectionResultColumns[0];n==null&&(n=this.detectionResultColumns[this.barcodeColumnCount+1]);let s=new hi;for(let o=0;o<n.getCodewords().length;o++){s.format("CW %3d:",o);for(let f=0;f<this.barcodeColumnCount+2;f++){if(this.detectionResultColumns[f]==null){s.format("    |   ");continue}let l=this.detectionResultColumns[f].getCodewords()[o];if(l==null){s.format("    |   ");continue}s.format(" %3d|%3d",l.getRowNumber(),l.getValue())}s.format("%n")}return s.toString()}}class mi{constructor(n,s,o,f){this.rowNumber=mi.BARCODE_ROW_UNKNOWN,this.startX=Math.trunc(n),this.endX=Math.trunc(s),this.bucket=Math.trunc(o),this.value=Math.trunc(f)}hasValidRowNumber(){return this.isValidRowNumber(this.rowNumber)}isValidRowNumber(n){return n!==mi.BARCODE_ROW_UNKNOWN&&this.bucket===n%3*3}setRowNumberAsRowIndicatorColumn(){this.rowNumber=Math.trunc(Math.trunc(this.value/30)*3+Math.trunc(this.bucket/3))}getWidth(){return this.endX-this.startX}getStartX(){return this.startX}getEndX(){return this.endX}getBucket(){return this.bucket}getValue(){return this.value}getRowNumber(){return this.rowNumber}setRowNumber(n){this.rowNumber=n}toString(){return this.rowNumber+"|"+this.value}}mi.BARCODE_ROW_UNKNOWN=-1;class Ur{static initialize(){for(let n=0;n<Je.SYMBOL_TABLE.length;n++){let s=Je.SYMBOL_TABLE[n],o=s&1;for(let f=0;f<Je.BARS_IN_MODULE;f++){let l=0;for(;(s&1)===o;)l+=1,s>>=1;o=s&1,Ur.RATIOS_TABLE[n]||(Ur.RATIOS_TABLE[n]=new Array(Je.BARS_IN_MODULE)),Ur.RATIOS_TABLE[n][Je.BARS_IN_MODULE-f-1]=Math.fround(l/Je.MODULES_IN_CODEWORD)}}this.bSymbolTableReady=!0}static getDecodedValue(n){let s=Ur.getDecodedCodewordValue(Ur.sampleBitCounts(n));return s!==-1?s:Ur.getClosestDecodedValue(n)}static sampleBitCounts(n){let s=rt.sum(n),o=new Int32Array(Je.BARS_IN_MODULE),f=0,l=0;for(let h=0;h<Je.MODULES_IN_CODEWORD;h++){let x=s/(2*Je.MODULES_IN_CODEWORD)+h*s/Je.MODULES_IN_CODEWORD;l+n[f]<=x&&(l+=n[f],f++),o[f]++}return o}static getDecodedCodewordValue(n){let s=Ur.getBitValue(n);return Je.getCodeword(s)===-1?-1:s}static getBitValue(n){let s=0;for(let o=0;o<n.length;o++)for(let f=0;f<n[o];f++)s=s<<1|(o%2===0?1:0);return Math.trunc(s)}static getClosestDecodedValue(n){let s=rt.sum(n),o=new Array(Je.BARS_IN_MODULE);if(s>1)for(let h=0;h<o.length;h++)o[h]=Math.fround(n[h]/s);let f=Dr.MAX_VALUE,l=-1;this.bSymbolTableReady||Ur.initialize();for(let h=0;h<Ur.RATIOS_TABLE.length;h++){let x=0,p=Ur.RATIOS_TABLE[h];for(let E=0;E<Je.BARS_IN_MODULE;E++){let T=Math.fround(p[E]-o[E]);if(x+=Math.fround(T*T),x>=f)break}x<f&&(f=x,l=Je.SYMBOL_TABLE[h])}return l}}Ur.bSymbolTableReady=!1,Ur.RATIOS_TABLE=new Array(Je.SYMBOL_TABLE.length).map(I=>new Array(Je.BARS_IN_MODULE));class rc{constructor(){this.segmentCount=-1,this.fileSize=-1,this.timestamp=-1,this.checksum=-1}getSegmentIndex(){return this.segmentIndex}setSegmentIndex(n){this.segmentIndex=n}getFileId(){return this.fileId}setFileId(n){this.fileId=n}getOptionalData(){return this.optionalData}setOptionalData(n){this.optionalData=n}isLastSegment(){return this.lastSegment}setLastSegment(n){this.lastSegment=n}getSegmentCount(){return this.segmentCount}setSegmentCount(n){this.segmentCount=n}getSender(){return this.sender||null}setSender(n){this.sender=n}getAddressee(){return this.addressee||null}setAddressee(n){this.addressee=n}getFileName(){return this.fileName}setFileName(n){this.fileName=n}getFileSize(){return this.fileSize}setFileSize(n){this.fileSize=n}getChecksum(){return this.checksum}setChecksum(n){this.checksum=n}getTimestamp(){return this.timestamp}setTimestamp(n){this.timestamp=n}}class nc{static parseLong(n,s=void 0){return parseInt(n,s)}}class ac extends m{}ac.kind="NullPointerException";class Wu{writeBytes(n){this.writeBytesOffset(n,0,n.length)}writeBytesOffset(n,s,o){if(n==null)throw new ac;if(s<0||s>n.length||o<0||s+o>n.length||s+o<0)throw new y;if(o===0)return;for(let f=0;f<o;f++)this.write(n[s+f])}flush(){}close(){}}class Vu extends m{}class Hu extends Wu{constructor(n=32){if(super(),this.count=0,n<0)throw new v("Negative initial size: "+n);this.buf=new Uint8Array(n)}ensureCapacity(n){n-this.buf.length>0&&this.grow(n)}grow(n){let o=this.buf.length<<1;if(o-n<0&&(o=n),o<0){if(n<0)throw new Vu;o=b.MAX_VALUE}this.buf=P.copyOfUint8Array(this.buf,o)}write(n){this.ensureCapacity(this.count+1),this.buf[this.count]=n,this.count+=1}writeBytesOffset(n,s,o){if(s<0||s>n.length||o<0||s+o-n.length>0)throw new y;this.ensureCapacity(this.count+o),A.arraycopy(n,s,this.buf,this.count,o),this.count+=o}writeTo(n){n.writeBytesOffset(this.buf,0,this.count)}reset(){this.count=0}toByteArray(){return P.copyOfUint8Array(this.buf,this.count)}size(){return this.count}toString(n){return n?typeof n=="string"?this.toString_string(n):this.toString_number(n):this.toString_void()}toString_void(){return new String(this.buf).toString()}toString_string(n){return new String(this.buf).toString()}toString_number(n){return new String(this.buf).toString()}close(){}}var bt;(function(I){I[I.ALPHA=0]="ALPHA",I[I.LOWER=1]="LOWER",I[I.MIXED=2]="MIXED",I[I.PUNCT=3]="PUNCT",I[I.ALPHA_SHIFT=4]="ALPHA_SHIFT",I[I.PUNCT_SHIFT=5]="PUNCT_SHIFT"})(bt||(bt={}));function ic(){if(typeof window<"u")return window.BigInt||null;if(typeof cs<"u")return cs.BigInt||null;if(typeof self<"u")return self.BigInt||null;throw new Error("Can't search globals for BigInt!")}let ns;function Qn(I){if(typeof ns>"u"&&(ns=ic()),ns===null)throw new Error("BigInt is not supported!");return ns(I)}function Gu(){let I=[];I[0]=Qn(1);let n=Qn(900);I[1]=n;for(let s=2;s<16;s++)I[s]=I[s-1]*n;return I}class me{static decode(n,s){let o=new ie(""),f=O.ISO8859_1;o.enableDecoding(f);let l=1,h=n[l++],x=new rc;for(;l<n[0];){switch(h){case me.TEXT_COMPACTION_MODE_LATCH:l=me.textCompaction(n,l,o);break;case me.BYTE_COMPACTION_MODE_LATCH:case me.BYTE_COMPACTION_MODE_LATCH_6:l=me.byteCompaction(h,n,f,l,o);break;case me.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:o.append(n[l++]);break;case me.NUMERIC_COMPACTION_MODE_LATCH:l=me.numericCompaction(n,l,o);break;case me.ECI_CHARSET:O.getCharacterSetECIByValue(n[l++]);break;case me.ECI_GENERAL_PURPOSE:l+=2;break;case me.ECI_USER_DEFINED:l++;break;case me.BEGIN_MACRO_PDF417_CONTROL_BLOCK:l=me.decodeMacroBlock(n,l,x);break;case me.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case me.MACRO_PDF417_TERMINATOR:throw new N;default:l--,l=me.textCompaction(n,l,o);break}if(l<n.length)h=n[l++];else throw N.getFormatInstance()}if(o.length()===0)throw N.getFormatInstance();let p=new Te(null,o.toString(),null,s);return p.setOther(x),p}static decodeMacroBlock(n,s,o){if(s+me.NUMBER_OF_SEQUENCE_CODEWORDS>n[0])throw N.getFormatInstance();let f=new Int32Array(me.NUMBER_OF_SEQUENCE_CODEWORDS);for(let x=0;x<me.NUMBER_OF_SEQUENCE_CODEWORDS;x++,s++)f[x]=n[s];o.setSegmentIndex(b.parseInt(me.decodeBase900toBase10(f,me.NUMBER_OF_SEQUENCE_CODEWORDS)));let l=new ie;s=me.textCompaction(n,s,l),o.setFileId(l.toString());let h=-1;for(n[s]===me.BEGIN_MACRO_PDF417_OPTIONAL_FIELD&&(h=s+1);s<n[0];)switch(n[s]){case me.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:switch(s++,n[s]){case me.MACRO_PDF417_OPTIONAL_FIELD_FILE_NAME:let x=new ie;s=me.textCompaction(n,s+1,x),o.setFileName(x.toString());break;case me.MACRO_PDF417_OPTIONAL_FIELD_SENDER:let p=new ie;s=me.textCompaction(n,s+1,p),o.setSender(p.toString());break;case me.MACRO_PDF417_OPTIONAL_FIELD_ADDRESSEE:let E=new ie;s=me.textCompaction(n,s+1,E),o.setAddressee(E.toString());break;case me.MACRO_PDF417_OPTIONAL_FIELD_SEGMENT_COUNT:let T=new ie;s=me.numericCompaction(n,s+1,T),o.setSegmentCount(b.parseInt(T.toString()));break;case me.MACRO_PDF417_OPTIONAL_FIELD_TIME_STAMP:let k=new ie;s=me.numericCompaction(n,s+1,k),o.setTimestamp(nc.parseLong(k.toString()));break;case me.MACRO_PDF417_OPTIONAL_FIELD_CHECKSUM:let R=new ie;s=me.numericCompaction(n,s+1,R),o.setChecksum(b.parseInt(R.toString()));break;case me.MACRO_PDF417_OPTIONAL_FIELD_FILE_SIZE:let G=new ie;s=me.numericCompaction(n,s+1,G),o.setFileSize(nc.parseLong(G.toString()));break;default:throw N.getFormatInstance()}break;case me.MACRO_PDF417_TERMINATOR:s++,o.setLastSegment(!0);break;default:throw N.getFormatInstance()}if(h!==-1){let x=s-h;o.isLastSegment()&&x--,o.setOptionalData(P.copyOfRange(n,h,h+x))}return s}static textCompaction(n,s,o){let f=new Int32Array((n[0]-s)*2),l=new Int32Array((n[0]-s)*2),h=0,x=!1;for(;s<n[0]&&!x;){let p=n[s++];if(p<me.TEXT_COMPACTION_MODE_LATCH)f[h]=p/30,f[h+1]=p%30,h+=2;else switch(p){case me.TEXT_COMPACTION_MODE_LATCH:f[h++]=me.TEXT_COMPACTION_MODE_LATCH;break;case me.BYTE_COMPACTION_MODE_LATCH:case me.BYTE_COMPACTION_MODE_LATCH_6:case me.NUMERIC_COMPACTION_MODE_LATCH:case me.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case me.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case me.MACRO_PDF417_TERMINATOR:s--,x=!0;break;case me.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:f[h]=me.MODE_SHIFT_TO_BYTE_COMPACTION_MODE,p=n[s++],l[h]=p,h++;break}}return me.decodeTextCompaction(f,l,h,o),s}static decodeTextCompaction(n,s,o,f){let l=bt.ALPHA,h=bt.ALPHA,x=0;for(;x<o;){let p=n[x],E="";switch(l){case bt.ALPHA:if(p<26)E=String.fromCharCode(65+p);else switch(p){case 26:E=" ";break;case me.LL:l=bt.LOWER;break;case me.ML:l=bt.MIXED;break;case me.PS:h=l,l=bt.PUNCT_SHIFT;break;case me.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:f.append(s[x]);break;case me.TEXT_COMPACTION_MODE_LATCH:l=bt.ALPHA;break}break;case bt.LOWER:if(p<26)E=String.fromCharCode(97+p);else switch(p){case 26:E=" ";break;case me.AS:h=l,l=bt.ALPHA_SHIFT;break;case me.ML:l=bt.MIXED;break;case me.PS:h=l,l=bt.PUNCT_SHIFT;break;case me.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:f.append(s[x]);break;case me.TEXT_COMPACTION_MODE_LATCH:l=bt.ALPHA;break}break;case bt.MIXED:if(p<me.PL)E=me.MIXED_CHARS[p];else switch(p){case me.PL:l=bt.PUNCT;break;case 26:E=" ";break;case me.LL:l=bt.LOWER;break;case me.AL:l=bt.ALPHA;break;case me.PS:h=l,l=bt.PUNCT_SHIFT;break;case me.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:f.append(s[x]);break;case me.TEXT_COMPACTION_MODE_LATCH:l=bt.ALPHA;break}break;case bt.PUNCT:if(p<me.PAL)E=me.PUNCT_CHARS[p];else switch(p){case me.PAL:l=bt.ALPHA;break;case me.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:f.append(s[x]);break;case me.TEXT_COMPACTION_MODE_LATCH:l=bt.ALPHA;break}break;case bt.ALPHA_SHIFT:if(l=h,p<26)E=String.fromCharCode(65+p);else switch(p){case 26:E=" ";break;case me.TEXT_COMPACTION_MODE_LATCH:l=bt.ALPHA;break}break;case bt.PUNCT_SHIFT:if(l=h,p<me.PAL)E=me.PUNCT_CHARS[p];else switch(p){case me.PAL:l=bt.ALPHA;break;case me.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:f.append(s[x]);break;case me.TEXT_COMPACTION_MODE_LATCH:l=bt.ALPHA;break}break}E!==""&&f.append(E),x++}}static byteCompaction(n,s,o,f,l){let h=new Hu,x=0,p=0,E=!1;switch(n){case me.BYTE_COMPACTION_MODE_LATCH:let T=new Int32Array(6),k=s[f++];for(;f<s[0]&&!E;)switch(T[x++]=k,p=900*p+k,k=s[f++],k){case me.TEXT_COMPACTION_MODE_LATCH:case me.BYTE_COMPACTION_MODE_LATCH:case me.NUMERIC_COMPACTION_MODE_LATCH:case me.BYTE_COMPACTION_MODE_LATCH_6:case me.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case me.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case me.MACRO_PDF417_TERMINATOR:f--,E=!0;break;default:if(x%5===0&&x>0){for(let R=0;R<6;++R)h.write(Number(Qn(p)>>Qn(8*(5-R))));p=0,x=0}break}f===s[0]&&k<me.TEXT_COMPACTION_MODE_LATCH&&(T[x++]=k);for(let R=0;R<x;R++)h.write(T[R]);break;case me.BYTE_COMPACTION_MODE_LATCH_6:for(;f<s[0]&&!E;){let R=s[f++];if(R<me.TEXT_COMPACTION_MODE_LATCH)x++,p=900*p+R;else switch(R){case me.TEXT_COMPACTION_MODE_LATCH:case me.BYTE_COMPACTION_MODE_LATCH:case me.NUMERIC_COMPACTION_MODE_LATCH:case me.BYTE_COMPACTION_MODE_LATCH_6:case me.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case me.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case me.MACRO_PDF417_TERMINATOR:f--,E=!0;break}if(x%5===0&&x>0){for(let G=0;G<6;++G)h.write(Number(Qn(p)>>Qn(8*(5-G))));p=0,x=0}}break}return l.append(Q.decode(h.toByteArray(),o)),f}static numericCompaction(n,s,o){let f=0,l=!1,h=new Int32Array(me.MAX_NUMERIC_CODEWORDS);for(;s<n[0]&&!l;){let x=n[s++];if(s===n[0]&&(l=!0),x<me.TEXT_COMPACTION_MODE_LATCH)h[f]=x,f++;else switch(x){case me.TEXT_COMPACTION_MODE_LATCH:case me.BYTE_COMPACTION_MODE_LATCH:case me.BYTE_COMPACTION_MODE_LATCH_6:case me.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case me.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case me.MACRO_PDF417_TERMINATOR:s--,l=!0;break}(f%me.MAX_NUMERIC_CODEWORDS===0||x===me.NUMERIC_COMPACTION_MODE_LATCH||l)&&f>0&&(o.append(me.decodeBase900toBase10(h,f)),f=0)}return s}static decodeBase900toBase10(n,s){let o=Qn(0);for(let l=0;l<s;l++)o+=me.EXP900[s-l-1]*Qn(n[l]);let f=o.toString();if(f.charAt(0)!=="1")throw new N;return f.substring(1)}}me.TEXT_COMPACTION_MODE_LATCH=900,me.BYTE_COMPACTION_MODE_LATCH=901,me.NUMERIC_COMPACTION_MODE_LATCH=902,me.BYTE_COMPACTION_MODE_LATCH_6=924,me.ECI_USER_DEFINED=925,me.ECI_GENERAL_PURPOSE=926,me.ECI_CHARSET=927,me.BEGIN_MACRO_PDF417_CONTROL_BLOCK=928,me.BEGIN_MACRO_PDF417_OPTIONAL_FIELD=923,me.MACRO_PDF417_TERMINATOR=922,me.MODE_SHIFT_TO_BYTE_COMPACTION_MODE=913,me.MAX_NUMERIC_CODEWORDS=15,me.MACRO_PDF417_OPTIONAL_FIELD_FILE_NAME=0,me.MACRO_PDF417_OPTIONAL_FIELD_SEGMENT_COUNT=1,me.MACRO_PDF417_OPTIONAL_FIELD_TIME_STAMP=2,me.MACRO_PDF417_OPTIONAL_FIELD_SENDER=3,me.MACRO_PDF417_OPTIONAL_FIELD_ADDRESSEE=4,me.MACRO_PDF417_OPTIONAL_FIELD_FILE_SIZE=5,me.MACRO_PDF417_OPTIONAL_FIELD_CHECKSUM=6,me.PL=25,me.LL=27,me.AS=27,me.ML=28,me.AL=28,me.PS=29,me.PAL=29,me.PUNCT_CHARS=`;<>@[\\]_\`~!\r	,:
-.$/"|*()?{}'`,me.MIXED_CHARS="0123456789&\r	,:#-.$/+%*=^",me.EXP900=ic()?Gu():[],me.NUMBER_OF_SEQUENCE_CODEWORDS=2;class xt{constructor(){}static decode(n,s,o,f,l,h,x){let p=new xa(n,s,o,f,l),E=null,T=null,k;for(let J=!0;;J=!1){if(s!=null&&(E=xt.getRowIndicatorColumn(n,p,s,!0,h,x)),f!=null&&(T=xt.getRowIndicatorColumn(n,p,f,!1,h,x)),k=xt.merge(E,T),k==null)throw q.getNotFoundInstance();let re=k.getBoundingBox();if(J&&re!=null&&(re.getMinY()<p.getMinY()||re.getMaxY()>p.getMaxY()))p=re;else break}k.setBoundingBox(p);let R=k.getBarcodeColumnCount()+1;k.setDetectionResultColumn(0,E),k.setDetectionResultColumn(R,T);let G=E!=null;for(let J=1;J<=R;J++){let re=G?J:R-J;if(k.getDetectionResultColumn(re)!==void 0)continue;let fe;re===0||re===R?fe=new tc(p,re===0):fe=new di(p),k.setDetectionResultColumn(re,fe);let pe=-1,Re=pe;for(let De=p.getMinY();De<=p.getMaxY();De++){if(pe=xt.getStartColumn(k,re,De,G),pe<0||pe>p.getMaxX()){if(Re===-1)continue;pe=Re}let ke=xt.detectCodeword(n,p.getMinX(),p.getMaxX(),G,pe,De,h,x);ke!=null&&(fe.setCodeword(De,ke),Re=pe,h=Math.min(h,ke.getWidth()),x=Math.max(x,ke.getWidth()))}}return xt.createDecoderResult(k)}static merge(n,s){if(n==null&&s==null)return null;let o=xt.getBarcodeMetadata(n,s);if(o==null)return null;let f=xa.merge(xt.adjustBoundingBox(n),xt.adjustBoundingBox(s));return new gi(o,f)}static adjustBoundingBox(n){if(n==null)return null;let s=n.getRowHeights();if(s==null)return null;let o=xt.getMax(s),f=0;for(let x of s)if(f+=o-x,x>0)break;let l=n.getCodewords();for(let x=0;f>0&&l[x]==null;x++)f--;let h=0;for(let x=s.length-1;x>=0&&(h+=o-s[x],!(s[x]>0));x--);for(let x=l.length-1;h>0&&l[x]==null;x--)h--;return n.getBoundingBox().addMissingRows(f,h,n.isLeft())}static getMax(n){let s=-1;for(let o of n)s=Math.max(s,o);return s}static getBarcodeMetadata(n,s){let o;if(n==null||(o=n.getBarcodeMetadata())==null)return s==null?null:s.getBarcodeMetadata();let f;return s==null||(f=s.getBarcodeMetadata())==null?o:o.getColumnCount()!==f.getColumnCount()&&o.getErrorCorrectionLevel()!==f.getErrorCorrectionLevel()&&o.getRowCount()!==f.getRowCount()?null:o}static getRowIndicatorColumn(n,s,o,f,l,h){let x=new tc(s,f);for(let p=0;p<2;p++){let E=p===0?1:-1,T=Math.trunc(Math.trunc(o.getX()));for(let k=Math.trunc(Math.trunc(o.getY()));k<=s.getMaxY()&&k>=s.getMinY();k+=E){let R=xt.detectCodeword(n,0,n.getWidth(),f,T,k,l,h);R!=null&&(x.setCodeword(k,R),f?T=R.getStartX():T=R.getEndX())}}return x}static adjustCodewordCount(n,s){let o=s[0][1],f=o.getValue(),l=n.getBarcodeColumnCount()*n.getBarcodeRowCount()-xt.getNumberOfECCodeWords(n.getBarcodeECLevel());if(f.length===0){if(l<1||l>Je.MAX_CODEWORDS_IN_BARCODE)throw q.getNotFoundInstance();o.setValue(l)}else f[0]!==l&&o.setValue(l)}static createDecoderResult(n){let s=xt.createBarcodeMatrix(n);xt.adjustCodewordCount(n,s);let o=new Array,f=new Int32Array(n.getBarcodeRowCount()*n.getBarcodeColumnCount()),l=[],h=new Array;for(let p=0;p<n.getBarcodeRowCount();p++)for(let E=0;E<n.getBarcodeColumnCount();E++){let T=s[p][E+1].getValue(),k=p*n.getBarcodeColumnCount()+E;T.length===0?o.push(k):T.length===1?f[k]=T[0]:(h.push(k),l.push(T))}let x=new Array(l.length);for(let p=0;p<x.length;p++)x[p]=l[p];return xt.createDecoderResultFromAmbiguousValues(n.getBarcodeECLevel(),f,Je.toIntArray(o),Je.toIntArray(h),x)}static createDecoderResultFromAmbiguousValues(n,s,o,f,l){let h=new Int32Array(f.length),x=100;for(;x-- >0;){for(let p=0;p<h.length;p++)s[f[p]]=l[p][h[p]];try{return xt.decodeCodewords(s,n,o)}catch(p){if(!(p instanceof C))throw p}if(h.length===0)throw C.getChecksumInstance();for(let p=0;p<h.length;p++)if(h[p]<l[p].length-1){h[p]++;break}else if(h[p]=0,p===h.length-1)throw C.getChecksumInstance()}throw C.getChecksumInstance()}static createBarcodeMatrix(n){let s=Array.from({length:n.getBarcodeRowCount()},()=>new Array(n.getBarcodeColumnCount()+2));for(let f=0;f<s.length;f++)for(let l=0;l<s[f].length;l++)s[f][l]=new xi;let o=0;for(let f of n.getDetectionResultColumns()){if(f!=null){for(let l of f.getCodewords())if(l!=null){let h=l.getRowNumber();if(h>=0){if(h>=s.length)continue;s[h][o].setValue(l.getValue())}}}o++}return s}static isValidBarcodeColumn(n,s){return s>=0&&s<=n.getBarcodeColumnCount()+1}static getStartColumn(n,s,o,f){let l=f?1:-1,h=null;if(xt.isValidBarcodeColumn(n,s-l)&&(h=n.getDetectionResultColumn(s-l).getCodeword(o)),h!=null)return f?h.getEndX():h.getStartX();if(h=n.getDetectionResultColumn(s).getCodewordNearby(o),h!=null)return f?h.getStartX():h.getEndX();if(xt.isValidBarcodeColumn(n,s-l)&&(h=n.getDetectionResultColumn(s-l).getCodewordNearby(o)),h!=null)return f?h.getEndX():h.getStartX();let x=0;for(;xt.isValidBarcodeColumn(n,s-l);){s-=l;for(let p of n.getDetectionResultColumn(s).getCodewords())if(p!=null)return(f?p.getEndX():p.getStartX())+l*x*(p.getEndX()-p.getStartX());x++}return f?n.getBoundingBox().getMinX():n.getBoundingBox().getMaxX()}static detectCodeword(n,s,o,f,l,h,x,p){l=xt.adjustCodewordStartColumn(n,s,o,f,l,h);let E=xt.getModuleBitCount(n,s,o,f,l,h);if(E==null)return null;let T,k=rt.sum(E);if(f)T=l+k;else{for(let J=0;J<E.length/2;J++){let re=E[J];E[J]=E[E.length-1-J],E[E.length-1-J]=re}T=l,l=T-k}if(!xt.checkCodewordSkew(k,x,p))return null;let R=Ur.getDecodedValue(E),G=Je.getCodeword(R);return G===-1?null:new mi(l,T,xt.getCodewordBucketNumber(R),G)}static getModuleBitCount(n,s,o,f,l,h){let x=l,p=new Int32Array(8),E=0,T=f?1:-1,k=f;for(;(f?x<o:x>=s)&&E<p.length;)n.get(x,h)===k?(p[E]++,x+=T):(E++,k=!k);return E===p.length||x===(f?o:s)&&E===p.length-1?p:null}static getNumberOfECCodeWords(n){return 2<<n}static adjustCodewordStartColumn(n,s,o,f,l,h){let x=l,p=f?-1:1;for(let E=0;E<2;E++){for(;(f?x>=s:x<o)&&f===n.get(x,h);){if(Math.abs(l-x)>xt.CODEWORD_SKEW_SIZE)return l;x+=p}p=-p,f=!f}return x}static checkCodewordSkew(n,s,o){return s-xt.CODEWORD_SKEW_SIZE<=n&&n<=o+xt.CODEWORD_SKEW_SIZE}static decodeCodewords(n,s,o){if(n.length===0)throw N.getFormatInstance();let f=1<<s+1,l=xt.correctErrors(n,o,f);xt.verifyCodewordCount(n,f);let h=me.decode(n,""+s);return h.setErrorsCorrected(l),h.setErasures(o.length),h}static correctErrors(n,s,o){if(s!=null&&s.length>o/2+xt.MAX_ERRORS||o<0||o>xt.MAX_EC_CODEWORDS)throw C.getChecksumInstance();return xt.errorCorrection.decode(n,o,s)}static verifyCodewordCount(n,s){if(n.length<4)throw N.getFormatInstance();let o=n[0];if(o>n.length)throw N.getFormatInstance();if(o===0)if(s<n.length)n[0]=n.length-s;else throw N.getFormatInstance()}static getBitCountForCodeword(n){let s=new Int32Array(8),o=0,f=s.length-1;for(;!((n&1)!==o&&(o=n&1,f--,f<0));)s[f]++,n>>=1;return s}static getCodewordBucketNumber(n){return n instanceof Int32Array?this.getCodewordBucketNumber_Int32Array(n):this.getCodewordBucketNumber_number(n)}static getCodewordBucketNumber_number(n){return xt.getCodewordBucketNumber(xt.getBitCountForCodeword(n))}static getCodewordBucketNumber_Int32Array(n){return(n[0]-n[2]+n[4]-n[6]+9)%9}static toString(n){let s=new hi;for(let o=0;o<n.length;o++){s.format("Row %2d: ",o);for(let f=0;f<n[o].length;f++){let l=n[o][f];l.getValue().length===0?s.format("        ",null):s.format("%4d(%2d)",l.getValue()[0],l.getConfidence(l.getValue()[0]))}s.format("%n")}return s.toString()}}xt.CODEWORD_SKEW_SIZE=2,xt.MAX_ERRORS=3,xt.MAX_EC_CODEWORDS=512,xt.errorCorrection=new ec;class Er{decode(n,s=null){let o=Er.decode(n,s,!1);if(o==null||o.length===0||o[0]==null)throw q.getNotFoundInstance();return o[0]}decodeMultiple(n,s=null){try{return Er.decode(n,s,!0)}catch(o){throw o instanceof N||o instanceof C?q.getNotFoundInstance():o}}static decode(n,s,o){const f=new Array,l=lt.detectMultiple(n,s,o);for(const h of l.getPoints()){const x=xt.decode(l.getBits(),h[4],h[5],h[6],h[7],Er.getMinCodewordWidth(h),Er.getMaxCodewordWidth(h)),p=new Z(x.getText(),x.getRawBytes(),void 0,h,oe.PDF_417);p.putMetadata(Ae.ERROR_CORRECTION_LEVEL,x.getECLevel());const E=x.getOther();E!=null&&p.putMetadata(Ae.PDF417_EXTRA_METADATA,E),f.push(p)}return f.map(h=>h)}static getMaxWidth(n,s){return n==null||s==null?0:Math.trunc(Math.abs(n.getX()-s.getX()))}static getMinWidth(n,s){return n==null||s==null?b.MAX_VALUE:Math.trunc(Math.abs(n.getX()-s.getX()))}static getMaxCodewordWidth(n){return Math.floor(Math.max(Math.max(Er.getMaxWidth(n[0],n[4]),Er.getMaxWidth(n[6],n[2])*Je.MODULES_IN_CODEWORD/Je.MODULES_IN_STOP_PATTERN),Math.max(Er.getMaxWidth(n[1],n[5]),Er.getMaxWidth(n[7],n[3])*Je.MODULES_IN_CODEWORD/Je.MODULES_IN_STOP_PATTERN)))}static getMinCodewordWidth(n){return Math.floor(Math.min(Math.min(Er.getMinWidth(n[0],n[4]),Er.getMinWidth(n[6],n[2])*Je.MODULES_IN_CODEWORD/Je.MODULES_IN_STOP_PATTERN),Math.min(Er.getMinWidth(n[1],n[5]),Er.getMinWidth(n[7],n[3])*Je.MODULES_IN_CODEWORD/Je.MODULES_IN_STOP_PATTERN)))}reset(){}}class as extends m{}as.kind="ReaderException";class sc{constructor(n,s){this.verbose=n===!0,s&&this.setHints(s)}decode(n,s){return s&&this.setHints(s),this.decodeInternal(n)}decodeWithState(n){return(this.readers===null||this.readers===void 0)&&this.setHints(null),this.decodeInternal(n)}setHints(n){this.hints=n;const s=!a(n)&&n.get(W.TRY_HARDER)===!0,o=a(n)?null:n.get(W.POSSIBLE_FORMATS),f=new Array;if(!a(o)){const l=o.some(h=>h===oe.UPC_A||h===oe.UPC_E||h===oe.EAN_13||h===oe.EAN_8||h===oe.CODABAR||h===oe.CODE_39||h===oe.CODE_93||h===oe.CODE_128||h===oe.ITF||h===oe.RSS_14||h===oe.RSS_EXPANDED);l&&!s&&f.push(new rn(n,this.verbose)),o.includes(oe.QR_CODE)&&f.push(new Jn),o.includes(oe.DATA_MATRIX)&&f.push(new qn),o.includes(oe.AZTEC)&&f.push(new Dt),o.includes(oe.PDF_417)&&f.push(new Er),l&&s&&f.push(new rn(n,this.verbose))}f.length===0&&(s||f.push(new rn(n,this.verbose)),f.push(new Jn),f.push(new qn),f.push(new Dt),f.push(new Er),s&&f.push(new rn(n,this.verbose))),this.readers=f}reset(){if(this.readers!==null)for(const n of this.readers)n.reset()}decodeInternal(n){if(this.readers===null)throw new as("No readers where selected, nothing can be read.");for(const s of this.readers)try{return s.decode(n,this.hints)}catch(o){if(o instanceof as)continue}throw new q("No MultiFormat Readers were able to detect the code.")}}class Xu extends ne{constructor(n=null,s=500){const o=new sc;o.setHints(n),super(o,s)}decodeBitmap(n){return this.reader.decodeWithState(n)}}class zu extends ne{constructor(n=500){super(new Er,n)}}class Yu extends ne{constructor(n=500){super(new Jn,n)}}var $s;(function(I){I[I.ERROR_CORRECTION=0]="ERROR_CORRECTION",I[I.CHARACTER_SET=1]="CHARACTER_SET",I[I.DATA_MATRIX_SHAPE=2]="DATA_MATRIX_SHAPE",I[I.MIN_SIZE=3]="MIN_SIZE",I[I.MAX_SIZE=4]="MAX_SIZE",I[I.MARGIN=5]="MARGIN",I[I.PDF417_COMPACT=6]="PDF417_COMPACT",I[I.PDF417_COMPACTION=7]="PDF417_COMPACTION",I[I.PDF417_DIMENSIONS=8]="PDF417_DIMENSIONS",I[I.AZTEC_LAYERS=9]="AZTEC_LAYERS",I[I.QR_VERSION=10]="QR_VERSION"})($s||($s={}));var fr=$s;class e0{constructor(n){this.field=n,this.cachedGenerators=[],this.cachedGenerators.push(new Ye(n,Int32Array.from([1])))}buildGenerator(n){const s=this.cachedGenerators;if(n>=s.length){let o=s[s.length-1];const f=this.field;for(let l=s.length;l<=n;l++){const h=o.multiply(new Ye(f,Int32Array.from([1,f.exp(l-1+f.getGeneratorBase())])));s.push(h),o=h}}return s[n]}encode(n,s){if(s===0)throw new v("No error correction bytes");const o=n.length-s;if(o<=0)throw new v("No data bytes provided");const f=this.buildGenerator(s),l=new Int32Array(o);A.arraycopy(n,0,l,0,o);let h=new Ye(this.field,l);h=h.multiplyByMonomial(s,1);const p=h.divide(f)[1].getCoefficients(),E=s-p.length;for(let T=0;T<E;T++)n[o+T]=0;A.arraycopy(p,0,n,o+E,p.length)}}class Zt{constructor(){}static applyMaskPenaltyRule1(n){return Zt.applyMaskPenaltyRule1Internal(n,!0)+Zt.applyMaskPenaltyRule1Internal(n,!1)}static applyMaskPenaltyRule2(n){let s=0;const o=n.getArray(),f=n.getWidth(),l=n.getHeight();for(let h=0;h<l-1;h++){const x=o[h];for(let p=0;p<f-1;p++){const E=x[p];E===x[p+1]&&E===o[h+1][p]&&E===o[h+1][p+1]&&s++}}return Zt.N2*s}static applyMaskPenaltyRule3(n){let s=0;const o=n.getArray(),f=n.getWidth(),l=n.getHeight();for(let h=0;h<l;h++)for(let x=0;x<f;x++){const p=o[h];x+6<f&&p[x]===1&&p[x+1]===0&&p[x+2]===1&&p[x+3]===1&&p[x+4]===1&&p[x+5]===0&&p[x+6]===1&&(Zt.isWhiteHorizontal(p,x-4,x)||Zt.isWhiteHorizontal(p,x+7,x+11))&&s++,h+6<l&&o[h][x]===1&&o[h+1][x]===0&&o[h+2][x]===1&&o[h+3][x]===1&&o[h+4][x]===1&&o[h+5][x]===0&&o[h+6][x]===1&&(Zt.isWhiteVertical(o,x,h-4,h)||Zt.isWhiteVertical(o,x,h+7,h+11))&&s++}return s*Zt.N3}static isWhiteHorizontal(n,s,o){s=Math.max(s,0),o=Math.min(o,n.length);for(let f=s;f<o;f++)if(n[f]===1)return!1;return!0}static isWhiteVertical(n,s,o,f){o=Math.max(o,0),f=Math.min(f,n.length);for(let l=o;l<f;l++)if(n[l][s]===1)return!1;return!0}static applyMaskPenaltyRule4(n){let s=0;const o=n.getArray(),f=n.getWidth(),l=n.getHeight();for(let p=0;p<l;p++){const E=o[p];for(let T=0;T<f;T++)E[T]===1&&s++}const h=n.getHeight()*n.getWidth();return Math.floor(Math.abs(s*2-h)*10/h)*Zt.N4}static getDataMaskBit(n,s,o){let f,l;switch(n){case 0:f=o+s&1;break;case 1:f=o&1;break;case 2:f=s%3;break;case 3:f=(o+s)%3;break;case 4:f=Math.floor(o/2)+Math.floor(s/3)&1;break;case 5:l=o*s,f=(l&1)+l%3;break;case 6:l=o*s,f=(l&1)+l%3&1;break;case 7:l=o*s,f=l%3+(o+s&1)&1;break;default:throw new v("Invalid mask pattern: "+n)}return f===0}static applyMaskPenaltyRule1Internal(n,s){let o=0;const f=s?n.getHeight():n.getWidth(),l=s?n.getWidth():n.getHeight(),h=n.getArray();for(let x=0;x<f;x++){let p=0,E=-1;for(let T=0;T<l;T++){const k=s?h[x][T]:h[T][x];k===E?p++:(p>=5&&(o+=Zt.N1+(p-5)),p=1,E=k)}p>=5&&(o+=Zt.N1+(p-5))}return o}}Zt.N1=3,Zt.N2=3,Zt.N3=40,Zt.N4=10;class is{constructor(n,s){this.width=n,this.height=s;const o=new Array(s);for(let f=0;f!==s;f++)o[f]=new Uint8Array(n);this.bytes=o}getHeight(){return this.height}getWidth(){return this.width}get(n,s){return this.bytes[s][n]}getArray(){return this.bytes}setNumber(n,s,o){this.bytes[s][n]=o}setBoolean(n,s,o){this.bytes[s][n]=o?1:0}clear(n){for(const s of this.bytes)P.fill(s,n)}equals(n){if(!(n instanceof is))return!1;const s=n;if(this.width!==s.width||this.height!==s.height)return!1;for(let o=0,f=this.height;o<f;++o){const l=this.bytes[o],h=s.bytes[o];for(let x=0,p=this.width;x<p;++x)if(l[x]!==h[x])return!1}return!0}toString(){const n=new ie;for(let s=0,o=this.height;s<o;++s){const f=this.bytes[s];for(let l=0,h=this.width;l<h;++l)switch(f[l]){case 0:n.append(" 0");break;case 1:n.append(" 1");break;default:n.append("  ");break}n.append(`
`)}return n.toString()}}class ga{constructor(){this.maskPattern=-1}getMode(){return this.mode}getECLevel(){return this.ecLevel}getVersion(){return this.version}getMaskPattern(){return this.maskPattern}getMatrix(){return this.matrix}toString(){const n=new ie;return n.append(`<<
`),n.append(" mode: "),n.append(this.mode?this.mode.toString():"null"),n.append(`
 ecLevel: `),n.append(this.ecLevel?this.ecLevel.toString():"null"),n.append(`
 version: `),n.append(this.version?this.version.toString():"null"),n.append(`
 maskPattern: `),n.append(this.maskPattern.toString()),this.matrix?(n.append(`
 matrix:
`),n.append(this.matrix.toString())):n.append(`
 matrix: null
`),n.append(`>>
`),n.toString()}setMode(n){this.mode=n}setECLevel(n){this.ecLevel=n}setVersion(n){this.version=n}setMaskPattern(n){this.maskPattern=n}setMatrix(n){this.matrix=n}static isValidMaskPattern(n){return n>=0&&n<ga.NUM_MASK_PATTERNS}}ga.NUM_MASK_PATTERNS=8;class Ft extends m{}Ft.kind="WriterException";class Ze{constructor(){}static clearMatrix(n){n.clear(255)}static buildMatrix(n,s,o,f,l){Ze.clearMatrix(l),Ze.embedBasicPatterns(o,l),Ze.embedTypeInfo(s,f,l),Ze.maybeEmbedVersionInfo(o,l),Ze.embedDataBits(n,f,l)}static embedBasicPatterns(n,s){Ze.embedPositionDetectionPatternsAndSeparators(s),Ze.embedDarkDotAtLeftBottomCorner(s),Ze.maybeEmbedPositionAdjustmentPatterns(n,s),Ze.embedTimingPatterns(s)}static embedTypeInfo(n,s,o){const f=new V;Ze.makeTypeInfoBits(n,s,f);for(let l=0,h=f.getSize();l<h;++l){const x=f.get(f.getSize()-1-l),p=Ze.TYPE_INFO_COORDINATES[l],E=p[0],T=p[1];if(o.setBoolean(E,T,x),l<8){const k=o.getWidth()-l-1;o.setBoolean(k,8,x)}else{const R=o.getHeight()-7+(l-8);o.setBoolean(8,R,x)}}}static maybeEmbedVersionInfo(n,s){if(n.getVersionNumber()<7)return;const o=new V;Ze.makeVersionInfoBits(n,o);let f=17;for(let l=0;l<6;++l)for(let h=0;h<3;++h){const x=o.get(f);f--,s.setBoolean(l,s.getHeight()-11+h,x),s.setBoolean(s.getHeight()-11+h,l,x)}}static embedDataBits(n,s,o){let f=0,l=-1,h=o.getWidth()-1,x=o.getHeight()-1;for(;h>0;){for(h===6&&(h-=1);x>=0&&x<o.getHeight();){for(let p=0;p<2;++p){const E=h-p;if(!Ze.isEmpty(o.get(E,x)))continue;let T;f<n.getSize()?(T=n.get(f),++f):T=!1,s!==255&&Zt.getDataMaskBit(s,E,x)&&(T=!T),o.setBoolean(E,x,T)}x+=l}l=-l,x+=l,h-=2}if(f!==n.getSize())throw new Ft("Not all bits consumed: "+f+"/"+n.getSize())}static findMSBSet(n){return 32-b.numberOfLeadingZeros(n)}static calculateBCHCode(n,s){if(s===0)throw new v("0 polynomial");const o=Ze.findMSBSet(s);for(n<<=o-1;Ze.findMSBSet(n)>=o;)n^=s<<Ze.findMSBSet(n)-o;return n}static makeTypeInfoBits(n,s,o){if(!ga.isValidMaskPattern(s))throw new Ft("Invalid mask pattern");const f=n.getBits()<<3|s;o.appendBits(f,5);const l=Ze.calculateBCHCode(f,Ze.TYPE_INFO_POLY);o.appendBits(l,10);const h=new V;if(h.appendBits(Ze.TYPE_INFO_MASK_PATTERN,15),o.xor(h),o.getSize()!==15)throw new Ft("should not happen but we got: "+o.getSize())}static makeVersionInfoBits(n,s){s.appendBits(n.getVersionNumber(),6);const o=Ze.calculateBCHCode(n.getVersionNumber(),Ze.VERSION_INFO_POLY);if(s.appendBits(o,12),s.getSize()!==18)throw new Ft("should not happen but we got: "+s.getSize())}static isEmpty(n){return n===255}static embedTimingPatterns(n){for(let s=8;s<n.getWidth()-8;++s){const o=(s+1)%2;Ze.isEmpty(n.get(s,6))&&n.setNumber(s,6,o),Ze.isEmpty(n.get(6,s))&&n.setNumber(6,s,o)}}static embedDarkDotAtLeftBottomCorner(n){if(n.get(8,n.getHeight()-8)===0)throw new Ft;n.setNumber(8,n.getHeight()-8,1)}static embedHorizontalSeparationPattern(n,s,o){for(let f=0;f<8;++f){if(!Ze.isEmpty(o.get(n+f,s)))throw new Ft;o.setNumber(n+f,s,0)}}static embedVerticalSeparationPattern(n,s,o){for(let f=0;f<7;++f){if(!Ze.isEmpty(o.get(n,s+f)))throw new Ft;o.setNumber(n,s+f,0)}}static embedPositionAdjustmentPattern(n,s,o){for(let f=0;f<5;++f){const l=Ze.POSITION_ADJUSTMENT_PATTERN[f];for(let h=0;h<5;++h)o.setNumber(n+h,s+f,l[h])}}static embedPositionDetectionPattern(n,s,o){for(let f=0;f<7;++f){const l=Ze.POSITION_DETECTION_PATTERN[f];for(let h=0;h<7;++h)o.setNumber(n+h,s+f,l[h])}}static embedPositionDetectionPatternsAndSeparators(n){const s=Ze.POSITION_DETECTION_PATTERN[0].length;Ze.embedPositionDetectionPattern(0,0,n),Ze.embedPositionDetectionPattern(n.getWidth()-s,0,n),Ze.embedPositionDetectionPattern(0,n.getWidth()-s,n);const o=8;Ze.embedHorizontalSeparationPattern(0,o-1,n),Ze.embedHorizontalSeparationPattern(n.getWidth()-o,o-1,n),Ze.embedHorizontalSeparationPattern(0,n.getWidth()-o,n);const f=7;Ze.embedVerticalSeparationPattern(f,0,n),Ze.embedVerticalSeparationPattern(n.getHeight()-f-1,0,n),Ze.embedVerticalSeparationPattern(f,n.getHeight()-f,n)}static maybeEmbedPositionAdjustmentPatterns(n,s){if(n.getVersionNumber()<2)return;const o=n.getVersionNumber()-1,f=Ze.POSITION_ADJUSTMENT_PATTERN_COORDINATE_TABLE[o];for(let l=0,h=f.length;l!==h;l++){const x=f[l];if(x>=0)for(let p=0;p!==h;p++){const E=f[p];E>=0&&Ze.isEmpty(s.get(E,x))&&Ze.embedPositionAdjustmentPattern(E-2,x-2,s)}}}}Ze.POSITION_DETECTION_PATTERN=Array.from([Int32Array.from([1,1,1,1,1,1,1]),Int32Array.from([1,0,0,0,0,0,1]),Int32Array.from([1,0,1,1,1,0,1]),Int32Array.from([1,0,1,1,1,0,1]),Int32Array.from([1,0,1,1,1,0,1]),Int32Array.from([1,0,0,0,0,0,1]),Int32Array.from([1,1,1,1,1,1,1])]),Ze.POSITION_ADJUSTMENT_PATTERN=Array.from([Int32Array.from([1,1,1,1,1]),Int32Array.from([1,0,0,0,1]),Int32Array.from([1,0,1,0,1]),Int32Array.from([1,0,0,0,1]),Int32Array.from([1,1,1,1,1])]),Ze.POSITION_ADJUSTMENT_PATTERN_COORDINATE_TABLE=Array.from([Int32Array.from([-1,-1,-1,-1,-1,-1,-1]),Int32Array.from([6,18,-1,-1,-1,-1,-1]),Int32Array.from([6,22,-1,-1,-1,-1,-1]),Int32Array.from([6,26,-1,-1,-1,-1,-1]),Int32Array.from([6,30,-1,-1,-1,-1,-1]),Int32Array.from([6,34,-1,-1,-1,-1,-1]),Int32Array.from([6,22,38,-1,-1,-1,-1]),Int32Array.from([6,24,42,-1,-1,-1,-1]),Int32Array.from([6,26,46,-1,-1,-1,-1]),Int32Array.from([6,28,50,-1,-1,-1,-1]),Int32Array.from([6,30,54,-1,-1,-1,-1]),Int32Array.from([6,32,58,-1,-1,-1,-1]),Int32Array.from([6,34,62,-1,-1,-1,-1]),Int32Array.from([6,26,46,66,-1,-1,-1]),Int32Array.from([6,26,48,70,-1,-1,-1]),Int32Array.from([6,26,50,74,-1,-1,-1]),Int32Array.from([6,30,54,78,-1,-1,-1]),Int32Array.from([6,30,56,82,-1,-1,-1]),Int32Array.from([6,30,58,86,-1,-1,-1]),Int32Array.from([6,34,62,90,-1,-1,-1]),Int32Array.from([6,28,50,72,94,-1,-1]),Int32Array.from([6,26,50,74,98,-1,-1]),Int32Array.from([6,30,54,78,102,-1,-1]),Int32Array.from([6,28,54,80,106,-1,-1]),Int32Array.from([6,32,58,84,110,-1,-1]),Int32Array.from([6,30,58,86,114,-1,-1]),Int32Array.from([6,34,62,90,118,-1,-1]),Int32Array.from([6,26,50,74,98,122,-1]),Int32Array.from([6,30,54,78,102,126,-1]),Int32Array.from([6,26,52,78,104,130,-1]),Int32Array.from([6,30,56,82,108,134,-1]),Int32Array.from([6,34,60,86,112,138,-1]),Int32Array.from([6,30,58,86,114,142,-1]),Int32Array.from([6,34,62,90,118,146,-1]),Int32Array.from([6,30,54,78,102,126,150]),Int32Array.from([6,24,50,76,102,128,154]),Int32Array.from([6,28,54,80,106,132,158]),Int32Array.from([6,32,58,84,110,136,162]),Int32Array.from([6,26,54,82,110,138,166]),Int32Array.from([6,30,58,86,114,142,170])]),Ze.TYPE_INFO_COORDINATES=Array.from([Int32Array.from([8,0]),Int32Array.from([8,1]),Int32Array.from([8,2]),Int32Array.from([8,3]),Int32Array.from([8,4]),Int32Array.from([8,5]),Int32Array.from([8,7]),Int32Array.from([8,8]),Int32Array.from([7,8]),Int32Array.from([5,8]),Int32Array.from([4,8]),Int32Array.from([3,8]),Int32Array.from([2,8]),Int32Array.from([1,8]),Int32Array.from([0,8])]),Ze.VERSION_INFO_POLY=7973,Ze.TYPE_INFO_POLY=1335,Ze.TYPE_INFO_MASK_PATTERN=21522;class Ku{constructor(n,s){this.dataBytes=n,this.errorCorrectionBytes=s}getDataBytes(){return this.dataBytes}getErrorCorrectionBytes(){return this.errorCorrectionBytes}}class Pt{constructor(){}static calculateMaskPenalty(n){return Zt.applyMaskPenaltyRule1(n)+Zt.applyMaskPenaltyRule2(n)+Zt.applyMaskPenaltyRule3(n)+Zt.applyMaskPenaltyRule4(n)}static encode(n,s,o=null){let f=Pt.DEFAULT_BYTE_MODE_ENCODING;const l=o!==null&&o.get(fr.CHARACTER_SET)!==void 0;l&&(f=o.get(fr.CHARACTER_SET).toString());const h=this.chooseMode(n,f),x=new V;if(h===je.BYTE&&(l||Pt.DEFAULT_BYTE_MODE_ENCODING!==f)){const De=O.getCharacterSetECIByName(f);De!==void 0&&this.appendECI(De,x)}this.appendModeInfo(h,x);const p=new V;this.appendBytes(n,h,p,f);let E;if(o!==null&&o.get(fr.QR_VERSION)!==void 0){const De=Number.parseInt(o.get(fr.QR_VERSION).toString(),10);E=ze.getVersionForNumber(De);const ke=this.calculateBitsNeeded(h,x,p,E);if(!this.willFit(ke,E,s))throw new Ft("Data too big for requested version")}else E=this.recommendVersion(s,h,x,p);const T=new V;T.appendBitArray(x);const k=h===je.BYTE?p.getSizeInBytes():n.length;this.appendLengthInfo(k,E,h,T),T.appendBitArray(p);const R=E.getECBlocksForLevel(s),G=E.getTotalCodewords()-R.getTotalECCodewords();this.terminateBits(G,T);const J=this.interleaveWithECBytes(T,E.getTotalCodewords(),G,R.getNumBlocks()),re=new ga;re.setECLevel(s),re.setMode(h),re.setVersion(E);const fe=E.getDimensionForVersion(),pe=new is(fe,fe),Re=this.chooseMaskPattern(J,s,E,pe);return re.setMaskPattern(Re),Ze.buildMatrix(J,s,E,Re,pe),re.setMatrix(pe),re}static recommendVersion(n,s,o,f){const l=this.calculateBitsNeeded(s,o,f,ze.getVersionForNumber(1)),h=this.chooseVersion(l,n),x=this.calculateBitsNeeded(s,o,f,h);return this.chooseVersion(x,n)}static calculateBitsNeeded(n,s,o,f){return s.getSize()+n.getCharacterCountBits(f)+o.getSize()}static getAlphanumericCode(n){return n<Pt.ALPHANUMERIC_TABLE.length?Pt.ALPHANUMERIC_TABLE[n]:-1}static chooseMode(n,s=null){if(O.SJIS.getName()===s&&this.isOnlyDoubleByteKanji(n))return je.KANJI;let o=!1,f=!1;for(let l=0,h=n.length;l<h;++l){const x=n.charAt(l);if(Pt.isDigit(x))o=!0;else if(this.getAlphanumericCode(x.charCodeAt(0))!==-1)f=!0;else return je.BYTE}return f?je.ALPHANUMERIC:o?je.NUMERIC:je.BYTE}static isOnlyDoubleByteKanji(n){let s;try{s=Q.encode(n,O.SJIS)}catch{return!1}const o=s.length;if(o%2!==0)return!1;for(let f=0;f<o;f+=2){const l=s[f]&255;if((l<129||l>159)&&(l<224||l>235))return!1}return!0}static chooseMaskPattern(n,s,o,f){let l=Number.MAX_SAFE_INTEGER,h=-1;for(let x=0;x<ga.NUM_MASK_PATTERNS;x++){Ze.buildMatrix(n,s,o,x,f);let p=this.calculateMaskPenalty(f);p<l&&(l=p,h=x)}return h}static chooseVersion(n,s){for(let o=1;o<=40;o++){const f=ze.getVersionForNumber(o);if(Pt.willFit(n,f,s))return f}throw new Ft("Data too big")}static willFit(n,s,o){const f=s.getTotalCodewords(),h=s.getECBlocksForLevel(o).getTotalECCodewords(),x=f-h,p=(n+7)/8;return x>=p}static terminateBits(n,s){const o=n*8;if(s.getSize()>o)throw new Ft("data bits cannot fit in the QR Code"+s.getSize()+" > "+o);for(let h=0;h<4&&s.getSize()<o;++h)s.appendBit(!1);const f=s.getSize()&7;if(f>0)for(let h=f;h<8;h++)s.appendBit(!1);const l=n-s.getSizeInBytes();for(let h=0;h<l;++h)s.appendBits((h&1)===0?236:17,8);if(s.getSize()!==o)throw new Ft("Bits size does not equal capacity")}static getNumDataBytesAndNumECBytesForBlockID(n,s,o,f,l,h){if(f>=o)throw new Ft("Block ID too large");const x=n%o,p=o-x,E=Math.floor(n/o),T=E+1,k=Math.floor(s/o),R=k+1,G=E-k,J=T-R;if(G!==J)throw new Ft("EC bytes mismatch");if(o!==p+x)throw new Ft("RS blocks mismatch");if(n!==(k+G)*p+(R+J)*x)throw new Ft("Total bytes mismatch");f<p?(l[0]=k,h[0]=G):(l[0]=R,h[0]=J)}static interleaveWithECBytes(n,s,o,f){if(n.getSizeInBytes()!==o)throw new Ft("Number of bits and data bytes does not match");let l=0,h=0,x=0;const p=new Array;for(let T=0;T<f;++T){const k=new Int32Array(1),R=new Int32Array(1);Pt.getNumDataBytesAndNumECBytesForBlockID(s,o,f,T,k,R);const G=k[0],J=new Uint8Array(G);n.toBytes(8*l,J,0,G);const re=Pt.generateECBytes(J,R[0]);p.push(new Ku(J,re)),h=Math.max(h,G),x=Math.max(x,re.length),l+=k[0]}if(o!==l)throw new Ft("Data bytes does not match offset");const E=new V;for(let T=0;T<h;++T)for(const k of p){const R=k.getDataBytes();T<R.length&&E.appendBits(R[T],8)}for(let T=0;T<x;++T)for(const k of p){const R=k.getErrorCorrectionBytes();T<R.length&&E.appendBits(R[T],8)}if(s!==E.getSizeInBytes())throw new Ft("Interleaving error: "+s+" and "+E.getSizeInBytes()+" differ.");return E}static generateECBytes(n,s){const o=n.length,f=new Int32Array(o+s);for(let h=0;h<o;h++)f[h]=n[h]&255;new e0(Xe.QR_CODE_FIELD_256).encode(f,s);const l=new Uint8Array(s);for(let h=0;h<s;h++)l[h]=f[o+h];return l}static appendModeInfo(n,s){s.appendBits(n.getBits(),4)}static appendLengthInfo(n,s,o,f){const l=o.getCharacterCountBits(s);if(n>=1<<l)throw new Ft(n+" is bigger than "+((1<<l)-1));f.appendBits(n,l)}static appendBytes(n,s,o,f){switch(s){case je.NUMERIC:Pt.appendNumericBytes(n,o);break;case je.ALPHANUMERIC:Pt.appendAlphanumericBytes(n,o);break;case je.BYTE:Pt.append8BitBytes(n,o,f);break;case je.KANJI:Pt.appendKanjiBytes(n,o);break;default:throw new Ft("Invalid mode: "+s)}}static getDigit(n){return n.charCodeAt(0)-48}static isDigit(n){const s=Pt.getDigit(n);return s>=0&&s<=9}static appendNumericBytes(n,s){const o=n.length;let f=0;for(;f<o;){const l=Pt.getDigit(n.charAt(f));if(f+2<o){const h=Pt.getDigit(n.charAt(f+1)),x=Pt.getDigit(n.charAt(f+2));s.appendBits(l*100+h*10+x,10),f+=3}else if(f+1<o){const h=Pt.getDigit(n.charAt(f+1));s.appendBits(l*10+h,7),f+=2}else s.appendBits(l,4),f++}}static appendAlphanumericBytes(n,s){const o=n.length;let f=0;for(;f<o;){const l=Pt.getAlphanumericCode(n.charCodeAt(f));if(l===-1)throw new Ft;if(f+1<o){const h=Pt.getAlphanumericCode(n.charCodeAt(f+1));if(h===-1)throw new Ft;s.appendBits(l*45+h,11),f+=2}else s.appendBits(l,6),f++}}static append8BitBytes(n,s,o){let f;try{f=Q.encode(n,o)}catch(l){throw new Ft(l)}for(let l=0,h=f.length;l!==h;l++){const x=f[l];s.appendBits(x,8)}}static appendKanjiBytes(n,s){let o;try{o=Q.encode(n,O.SJIS)}catch(l){throw new Ft(l)}const f=o.length;for(let l=0;l<f;l+=2){const h=o[l]&255,x=o[l+1]&255,p=h<<8&4294967295|x;let E=-1;if(p>=33088&&p<=40956?E=p-33088:p>=57408&&p<=60351&&(E=p-49472),E===-1)throw new Ft("Invalid byte sequence");const T=(E>>8)*192+(E&255);s.appendBits(T,13)}}static appendECI(n,s){s.appendBits(je.ECI.getBits(),4),s.appendBits(n.getValue(),8)}}Pt.ALPHANUMERIC_TABLE=Int32Array.from([-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,36,-1,-1,-1,37,38,-1,-1,-1,-1,39,40,-1,41,42,43,0,1,2,3,4,5,6,7,8,9,44,-1,-1,-1,-1,-1,-1,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,-1,-1,-1,-1,-1]),Pt.DEFAULT_BYTE_MODE_ENCODING=O.UTF8.getName();class ma{write(n,s,o,f=null){if(n.length===0)throw new v("Found empty contents");if(s<0||o<0)throw new v("Requested dimensions are too small: "+s+"x"+o);let l=Bt.L,h=ma.QUIET_ZONE_SIZE;f!==null&&(f.get(fr.ERROR_CORRECTION)!==void 0&&(l=Bt.fromString(f.get(fr.ERROR_CORRECTION).toString())),f.get(fr.MARGIN)!==void 0&&(h=Number.parseInt(f.get(fr.MARGIN).toString(),10)));const x=Pt.encode(n,l,f);return this.renderResult(x,s,o,h)}writeToDom(n,s,o,f,l=null){typeof n=="string"&&(n=document.querySelector(n));const h=this.write(s,o,f,l);n&&n.appendChild(h)}renderResult(n,s,o,f){const l=n.getMatrix();if(l===null)throw new mt;const h=l.getWidth(),x=l.getHeight(),p=h+f*2,E=x+f*2,T=Math.max(s,p),k=Math.max(o,E),R=Math.min(Math.floor(T/p),Math.floor(k/E)),G=Math.floor((T-h*R)/2),J=Math.floor((k-x*R)/2),re=this.createSVGElement(T,k);for(let fe=0,pe=J;fe<x;fe++,pe+=R)for(let Re=0,De=G;Re<h;Re++,De+=R)if(l.get(Re,fe)===1){const ke=this.createSvgRectElement(De,pe,R,R);re.appendChild(ke)}return re}createSVGElement(n,s){const o=document.createElementNS(ma.SVG_NS,"svg");return o.setAttributeNS(null,"height",n.toString()),o.setAttributeNS(null,"width",s.toString()),o}createSvgRectElement(n,s,o,f){const l=document.createElementNS(ma.SVG_NS,"rect");return l.setAttributeNS(null,"x",n.toString()),l.setAttributeNS(null,"y",s.toString()),l.setAttributeNS(null,"height",o.toString()),l.setAttributeNS(null,"width",f.toString()),l.setAttributeNS(null,"fill","#000000"),l}}ma.QUIET_ZONE_SIZE=4,ma.SVG_NS="http://www.w3.org/2000/svg";class Wa{encode(n,s,o,f,l){if(n.length===0)throw new v("Found empty contents");if(s!==oe.QR_CODE)throw new v("Can only encode QR_CODE, but got "+s);if(o<0||f<0)throw new v(`Requested dimensions are too small: ${o}x${f}`);let h=Bt.L,x=Wa.QUIET_ZONE_SIZE;l!==null&&(l.get(fr.ERROR_CORRECTION)!==void 0&&(h=Bt.fromString(l.get(fr.ERROR_CORRECTION).toString())),l.get(fr.MARGIN)!==void 0&&(x=Number.parseInt(l.get(fr.MARGIN).toString(),10)));const p=Pt.encode(n,h,l);return Wa.renderResult(p,o,f,x)}static renderResult(n,s,o,f){const l=n.getMatrix();if(l===null)throw new mt;const h=l.getWidth(),x=l.getHeight(),p=h+f*2,E=x+f*2,T=Math.max(s,p),k=Math.max(o,E),R=Math.min(Math.floor(T/p),Math.floor(k/E)),G=Math.floor((T-h*R)/2),J=Math.floor((k-x*R)/2),re=new Ee(T,k);for(let fe=0,pe=J;fe<x;fe++,pe+=R)for(let Re=0,De=G;Re<h;Re++,De+=R)l.get(Re,fe)===1&&re.setRegion(De,pe,R,R);return re}}Wa.QUIET_ZONE_SIZE=4;class ju{encode(n,s,o,f,l){let h;switch(s){case oe.QR_CODE:h=new Wa;break;default:throw new v("No encoder available for format "+s)}return h.encode(n,s,o,f,l)}}class Sn extends We{constructor(n,s,o,f,l,h,x,p){if(super(h,x),this.yuvData=n,this.dataWidth=s,this.dataHeight=o,this.left=f,this.top=l,f+h>s||l+x>o)throw new v("Crop rectangle does not fit within image data.");p&&this.reverseHorizontal(h,x)}getRow(n,s){if(n<0||n>=this.getHeight())throw new v("Requested row is outside the image: "+n);const o=this.getWidth();(s==null||s.length<o)&&(s=new Uint8ClampedArray(o));const f=(n+this.top)*this.dataWidth+this.left;return A.arraycopy(this.yuvData,f,s,0,o),s}getMatrix(){const n=this.getWidth(),s=this.getHeight();if(n===this.dataWidth&&s===this.dataHeight)return this.yuvData;const o=n*s,f=new Uint8ClampedArray(o);let l=this.top*this.dataWidth+this.left;if(n===this.dataWidth)return A.arraycopy(this.yuvData,l,f,0,o),f;for(let h=0;h<s;h++){const x=h*n;A.arraycopy(this.yuvData,l,f,x,n),l+=this.dataWidth}return f}isCropSupported(){return!0}crop(n,s,o,f){return new Sn(this.yuvData,this.dataWidth,this.dataHeight,this.left+n,this.top+s,o,f,!1)}renderThumbnail(){const n=this.getWidth()/Sn.THUMBNAIL_SCALE_FACTOR,s=this.getHeight()/Sn.THUMBNAIL_SCALE_FACTOR,o=new Int32Array(n*s),f=this.yuvData;let l=this.top*this.dataWidth+this.left;for(let h=0;h<s;h++){const x=h*n;for(let p=0;p<n;p++){const E=f[l+p*Sn.THUMBNAIL_SCALE_FACTOR]&255;o[x+p]=4278190080|E*65793}l+=this.dataWidth*Sn.THUMBNAIL_SCALE_FACTOR}return o}getThumbnailWidth(){return this.getWidth()/Sn.THUMBNAIL_SCALE_FACTOR}getThumbnailHeight(){return this.getHeight()/Sn.THUMBNAIL_SCALE_FACTOR}reverseHorizontal(n,s){const o=this.yuvData;for(let f=0,l=this.top*this.dataWidth+this.left;f<s;f++,l+=this.dataWidth){const h=l+n/2;for(let x=l,p=l+n-1;x<h;x++,p--){const E=o[x];o[x]=o[p],o[p]=E}}}invert(){return new se(this)}}Sn.THUMBNAIL_SCALE_FACTOR=2;class t0 extends We{constructor(n,s,o,f,l,h,x){if(super(s,o),this.dataWidth=f,this.dataHeight=l,this.left=h,this.top=x,n.BYTES_PER_ELEMENT===4){const p=s*o,E=new Uint8ClampedArray(p);for(let T=0;T<p;T++){const k=n[T],R=k>>16&255,G=k>>7&510,J=k&255;E[T]=(R+G+J)/4&255}this.luminances=E}else this.luminances=n;if(f===void 0&&(this.dataWidth=s),l===void 0&&(this.dataHeight=o),h===void 0&&(this.left=0),x===void 0&&(this.top=0),this.left+s>this.dataWidth||this.top+o>this.dataHeight)throw new v("Crop rectangle does not fit within image data.")}getRow(n,s){if(n<0||n>=this.getHeight())throw new v("Requested row is outside the image: "+n);const o=this.getWidth();(s==null||s.length<o)&&(s=new Uint8ClampedArray(o));const f=(n+this.top)*this.dataWidth+this.left;return A.arraycopy(this.luminances,f,s,0,o),s}getMatrix(){const n=this.getWidth(),s=this.getHeight();if(n===this.dataWidth&&s===this.dataHeight)return this.luminances;const o=n*s,f=new Uint8ClampedArray(o);let l=this.top*this.dataWidth+this.left;if(n===this.dataWidth)return A.arraycopy(this.luminances,l,f,0,o),f;for(let h=0;h<s;h++){const x=h*n;A.arraycopy(this.luminances,l,f,x,n),l+=this.dataWidth}return f}isCropSupported(){return!0}crop(n,s,o,f){return new t0(this.luminances,o,f,this.dataWidth,this.dataHeight,this.left+n,this.top+s)}invert(){return new se(this)}}class oc extends O{static forName(n){return this.getCharacterSetECIByName(n)}}class r0{}r0.ISO_8859_1=O.ISO8859_1;class cc{isCompact(){return this.compact}setCompact(n){this.compact=n}getSize(){return this.size}setSize(n){this.size=n}getLayers(){return this.layers}setLayers(n){this.layers=n}getCodeWords(){return this.codeWords}setCodeWords(n){this.codeWords=n}getMatrix(){return this.matrix}setMatrix(n){this.matrix=n}}class fc{static singletonList(n){return[n]}static min(n,s){return n.sort(s)[0]}}class Zu{constructor(n){this.previous=n}getPrevious(){return this.previous}}class Va extends Zu{constructor(n,s,o){super(n),this.value=s,this.bitCount=o}appendTo(n,s){n.appendBits(this.value,this.bitCount)}add(n,s){return new Va(this,n,s)}addBinaryShift(n,s){return console.warn("addBinaryShift on SimpleToken, this simply returns a copy of this token"),new Va(this,n,s)}toString(){let n=this.value&(1<<this.bitCount)-1;return n|=1<<this.bitCount,"<"+b.toBinaryString(n|1<<this.bitCount).substring(1)+">"}}class n0 extends Va{constructor(n,s,o){super(n,0,0),this.binaryShiftStart=s,this.binaryShiftByteCount=o}appendTo(n,s){for(let o=0;o<this.binaryShiftByteCount;o++)(o===0||o===31&&this.binaryShiftByteCount<=62)&&(n.appendBits(31,5),this.binaryShiftByteCount>62?n.appendBits(this.binaryShiftByteCount-31,16):o===0?n.appendBits(Math.min(this.binaryShiftByteCount,31),5):n.appendBits(this.binaryShiftByteCount-31,5)),n.appendBits(s[this.binaryShiftStart+o],8)}addBinaryShift(n,s){return new n0(this,n,s)}toString(){return"<"+this.binaryShiftStart+"::"+(this.binaryShiftStart+this.binaryShiftByteCount-1)+">"}}function qu(I,n,s){return new n0(I,n,s)}function pi(I,n,s){return new Va(I,n,s)}const Ju=["UPPER","LOWER","DIGIT","MIXED","PUNCT"],$n=0,ss=1,sn=2,lc=3,yn=4,Qu=new Va(null,0,0),a0=[Int32Array.from([0,(5<<16)+28,(5<<16)+30,(5<<16)+29,656318]),Int32Array.from([(9<<16)+480+14,0,(5<<16)+30,(5<<16)+29,656318]),Int32Array.from([(4<<16)+14,(9<<16)+448+28,0,(9<<16)+448+29,932798]),Int32Array.from([(5<<16)+29,(5<<16)+28,656318,0,(5<<16)+30]),Int32Array.from([(5<<16)+31,656380,656382,656381,0])];function $u(I){for(let n of I)P.fill(n,-1);return I[$n][yn]=0,I[ss][yn]=0,I[ss][$n]=28,I[lc][yn]=0,I[sn][yn]=0,I[sn][$n]=15,I}const uc=$u(P.createInt32Array(6,6));class In{constructor(n,s,o,f){this.token=n,this.mode=s,this.binaryShiftByteCount=o,this.bitCount=f}getMode(){return this.mode}getToken(){return this.token}getBinaryShiftByteCount(){return this.binaryShiftByteCount}getBitCount(){return this.bitCount}latchAndAppend(n,s){let o=this.bitCount,f=this.token;if(n!==this.mode){let h=a0[this.mode][n];f=pi(f,h&65535,h>>16),o+=h>>16}let l=n===sn?4:5;return f=pi(f,s,l),new In(f,n,0,o+l)}shiftAndAppend(n,s){let o=this.token,f=this.mode===sn?4:5;return o=pi(o,uc[this.mode][n],f),o=pi(o,s,5),new In(o,this.mode,0,this.bitCount+f+5)}addBinaryShiftChar(n){let s=this.token,o=this.mode,f=this.bitCount;if(this.mode===yn||this.mode===sn){let x=a0[o][$n];s=pi(s,x&65535,x>>16),f+=x>>16,o=$n}let l=this.binaryShiftByteCount===0||this.binaryShiftByteCount===31?18:this.binaryShiftByteCount===62?9:8,h=new In(s,o,this.binaryShiftByteCount+1,f+l);return h.binaryShiftByteCount===2078&&(h=h.endBinaryShift(n+1)),h}endBinaryShift(n){if(this.binaryShiftByteCount===0)return this;let s=this.token;return s=qu(s,n-this.binaryShiftByteCount,this.binaryShiftByteCount),new In(s,this.mode,0,this.bitCount)}isBetterThanOrEqualTo(n){let s=this.bitCount+(a0[this.mode][n.mode]>>16);return this.binaryShiftByteCount<n.binaryShiftByteCount?s+=In.calculateBinaryShiftCost(n)-In.calculateBinaryShiftCost(this):this.binaryShiftByteCount>n.binaryShiftByteCount&&n.binaryShiftByteCount>0&&(s+=10),s<=n.bitCount}toBitArray(n){let s=[];for(let f=this.endBinaryShift(n.length).token;f!==null;f=f.getPrevious())s.unshift(f);let o=new V;for(const f of s)f.appendTo(o,n);return o}toString(){return X.format("%s bits=%d bytes=%d",Ju[this.mode],this.bitCount,this.binaryShiftByteCount)}static calculateBinaryShiftCost(n){return n.binaryShiftByteCount>62?21:n.binaryShiftByteCount>31?20:n.binaryShiftByteCount>0?10:0}}In.INITIAL_STATE=new In(Qu,$n,0,0);function eh(I){const n=X.getCharCode(" "),s=X.getCharCode("."),o=X.getCharCode(",");I[$n][n]=1;const f=X.getCharCode("Z"),l=X.getCharCode("A");for(let R=l;R<=f;R++)I[$n][R]=R-l+2;I[ss][n]=1;const h=X.getCharCode("z"),x=X.getCharCode("a");for(let R=x;R<=h;R++)I[ss][R]=R-x+2;I[sn][n]=1;const p=X.getCharCode("9"),E=X.getCharCode("0");for(let R=E;R<=p;R++)I[sn][R]=R-E+2;I[sn][o]=12,I[sn][s]=13;const T=["\0"," ","","","","","","","\x07","\b","	",`
`,"\v","\f","\r","\x1B","","","","","@","\\","^","_","`","|","~",""];for(let R=0;R<T.length;R++)I[lc][X.getCharCode(T[R])]=R;const k=["\0","\r","\0","\0","\0","\0","!","'","#","$","%","&","'","(",")","*","+",",","-",".","/",":",";","<","=",">","?","[","]","{","}"];for(let R=0;R<k.length;R++)X.getCharCode(k[R])>0&&(I[yn][X.getCharCode(k[R])]=R);return I}const i0=eh(P.createInt32Array(5,256));class wi{constructor(n){this.text=n}encode(){const n=X.getCharCode(" "),s=X.getCharCode(`
`);let o=fc.singletonList(In.INITIAL_STATE);for(let l=0;l<this.text.length;l++){let h,x=l+1<this.text.length?this.text[l+1]:0;switch(this.text[l]){case X.getCharCode("\r"):h=x===s?2:0;break;case X.getCharCode("."):h=x===n?3:0;break;case X.getCharCode(","):h=x===n?4:0;break;case X.getCharCode(":"):h=x===n?5:0;break;default:h=0}h>0?(o=wi.updateStateListForPair(o,l,h),l++):o=this.updateStateListForChar(o,l)}return fc.min(o,(l,h)=>l.getBitCount()-h.getBitCount()).toBitArray(this.text)}updateStateListForChar(n,s){const o=[];for(let f of n)this.updateStateForChar(f,s,o);return wi.simplifyStates(o)}updateStateForChar(n,s,o){let f=this.text[s]&255,l=i0[n.getMode()][f]>0,h=null;for(let x=0;x<=yn;x++){let p=i0[x][f];if(p>0){if(h==null&&(h=n.endBinaryShift(s)),!l||x===n.getMode()||x===sn){const E=h.latchAndAppend(x,p);o.push(E)}if(!l&&uc[n.getMode()][x]>=0){const E=h.shiftAndAppend(x,p);o.push(E)}}}if(n.getBinaryShiftByteCount()>0||i0[n.getMode()][f]===0){let x=n.addBinaryShiftChar(s);o.push(x)}}static updateStateListForPair(n,s,o){const f=[];for(let l of n)this.updateStateForPair(l,s,o,f);return this.simplifyStates(f)}static updateStateForPair(n,s,o,f){let l=n.endBinaryShift(s);if(f.push(l.latchAndAppend(yn,o)),n.getMode()!==yn&&f.push(l.shiftAndAppend(yn,o)),o===3||o===4){let h=l.latchAndAppend(sn,16-o).latchAndAppend(sn,1);f.push(h)}if(n.getBinaryShiftByteCount()>0){let h=n.addBinaryShiftChar(s).addBinaryShiftChar(s+1);f.push(h)}}static simplifyStates(n){let s=[];for(const o of n){let f=!0;for(const l of s){if(l.isBetterThanOrEqualTo(o)){f=!1;break}o.isBetterThanOrEqualTo(l)&&(s=s.filter(h=>h!==l))}f&&s.push(o)}return s}}class _t{constructor(){}static encodeBytes(n){return _t.encode(n,_t.DEFAULT_EC_PERCENT,_t.DEFAULT_AZTEC_LAYERS)}static encode(n,s,o){let f=new wi(n).encode(),l=b.truncDivision(f.getSize()*s,100)+11,h=f.getSize()+l,x,p,E,T,k;if(o!==_t.DEFAULT_AZTEC_LAYERS){if(x=o<0,p=Math.abs(o),p>(x?_t.MAX_NB_BITS_COMPACT:_t.MAX_NB_BITS))throw new v(X.format("Illegal value %s for layers",o));E=_t.totalBitsInLayer(p,x),T=_t.WORD_SIZE[p];let ke=E-E%T;if(k=_t.stuffBits(f,T),k.getSize()+l>ke)throw new v("Data to large for user specified layer");if(x&&k.getSize()>T*64)throw new v("Data to large for user specified layer")}else{T=0,k=null;for(let ke=0;;ke++){if(ke>_t.MAX_NB_BITS)throw new v("Data too large for an Aztec code");if(x=ke<=3,p=x?ke+1:ke,E=_t.totalBitsInLayer(p,x),h>E)continue;(k==null||T!==_t.WORD_SIZE[p])&&(T=_t.WORD_SIZE[p],k=_t.stuffBits(f,T));let Et=E-E%T;if(!(x&&k.getSize()>T*64)&&k.getSize()+l<=Et)break}}let R=_t.generateCheckWords(k,E,T),G=k.getSize()/T,J=_t.generateModeMessage(x,p,G),re=(x?11:14)+p*4,fe=new Int32Array(re),pe;if(x){pe=re;for(let ke=0;ke<fe.length;ke++)fe[ke]=ke}else{pe=re+1+2*b.truncDivision(b.truncDivision(re,2)-1,15);let ke=b.truncDivision(re,2),Et=b.truncDivision(pe,2);for(let at=0;at<ke;at++){let Wr=at+b.truncDivision(at,15);fe[ke-at-1]=Et-Wr-1,fe[ke+at]=Et+Wr+1}}let Re=new Ee(pe);for(let ke=0,Et=0;ke<p;ke++){let at=(p-ke)*4+(x?9:12);for(let Wr=0;Wr<at;Wr++){let wn=Wr*2;for(let Vr=0;Vr<2;Vr++)R.get(Et+wn+Vr)&&Re.set(fe[ke*2+Vr],fe[ke*2+Wr]),R.get(Et+at*2+wn+Vr)&&Re.set(fe[ke*2+Wr],fe[re-1-ke*2-Vr]),R.get(Et+at*4+wn+Vr)&&Re.set(fe[re-1-ke*2-Vr],fe[re-1-ke*2-Wr]),R.get(Et+at*6+wn+Vr)&&Re.set(fe[re-1-ke*2-Wr],fe[ke*2+Vr])}Et+=at*8}if(_t.drawModeMessage(Re,x,pe,J),x)_t.drawBullsEye(Re,b.truncDivision(pe,2),5);else{_t.drawBullsEye(Re,b.truncDivision(pe,2),7);for(let ke=0,Et=0;ke<b.truncDivision(re,2)-1;ke+=15,Et+=16)for(let at=b.truncDivision(pe,2)&1;at<pe;at+=2)Re.set(b.truncDivision(pe,2)-Et,at),Re.set(b.truncDivision(pe,2)+Et,at),Re.set(at,b.truncDivision(pe,2)-Et),Re.set(at,b.truncDivision(pe,2)+Et)}let De=new cc;return De.setCompact(x),De.setSize(pe),De.setLayers(p),De.setCodeWords(G),De.setMatrix(Re),De}static drawBullsEye(n,s,o){for(let f=0;f<o;f+=2)for(let l=s-f;l<=s+f;l++)n.set(l,s-f),n.set(l,s+f),n.set(s-f,l),n.set(s+f,l);n.set(s-o,s-o),n.set(s-o+1,s-o),n.set(s-o,s-o+1),n.set(s+o,s-o),n.set(s+o,s-o+1),n.set(s+o,s+o-1)}static generateModeMessage(n,s,o){let f=new V;return n?(f.appendBits(s-1,2),f.appendBits(o-1,6),f=_t.generateCheckWords(f,28,4)):(f.appendBits(s-1,5),f.appendBits(o-1,11),f=_t.generateCheckWords(f,40,4)),f}static drawModeMessage(n,s,o,f){let l=b.truncDivision(o,2);if(s)for(let h=0;h<7;h++){let x=l-3+h;f.get(h)&&n.set(x,l-5),f.get(h+7)&&n.set(l+5,x),f.get(20-h)&&n.set(x,l+5),f.get(27-h)&&n.set(l-5,x)}else for(let h=0;h<10;h++){let x=l-5+h+b.truncDivision(h,5);f.get(h)&&n.set(x,l-7),f.get(h+10)&&n.set(l+7,x),f.get(29-h)&&n.set(x,l+7),f.get(39-h)&&n.set(l-7,x)}}static generateCheckWords(n,s,o){let f=n.getSize()/o,l=new e0(_t.getGF(o)),h=b.truncDivision(s,o),x=_t.bitsToWords(n,o,h);l.encode(x,h-f);let p=s%o,E=new V;E.appendBits(0,p);for(const T of Array.from(x))E.appendBits(T,o);return E}static bitsToWords(n,s,o){let f=new Int32Array(o),l,h;for(l=0,h=n.getSize()/s;l<h;l++){let x=0;for(let p=0;p<s;p++)x|=n.get(l*s+p)?1<<s-p-1:0;f[l]=x}return f}static getGF(n){switch(n){case 4:return Xe.AZTEC_PARAM;case 6:return Xe.AZTEC_DATA_6;case 8:return Xe.AZTEC_DATA_8;case 10:return Xe.AZTEC_DATA_10;case 12:return Xe.AZTEC_DATA_12;default:throw new v("Unsupported word size "+n)}}static stuffBits(n,s){let o=new V,f=n.getSize(),l=(1<<s)-2;for(let h=0;h<f;h+=s){let x=0;for(let p=0;p<s;p++)(h+p>=f||n.get(h+p))&&(x|=1<<s-1-p);(x&l)===l?(o.appendBits(x&l,s),h--):(x&l)===0?(o.appendBits(x|1,s),h--):o.appendBits(x,s)}return o}static totalBitsInLayer(n,s){return((s?88:112)+16*n)*n}}_t.DEFAULT_EC_PERCENT=33,_t.DEFAULT_AZTEC_LAYERS=0,_t.MAX_NB_BITS=32,_t.MAX_NB_BITS_COMPACT=4,_t.WORD_SIZE=Int32Array.from([4,6,6,8,8,8,8,8,8,10,10,10,10,10,10,10,10,10,10,10,10,10,10,12,12,12,12,12,12,12,12,12,12]);class os{encode(n,s,o,f){return this.encodeWithHints(n,s,o,f,null)}encodeWithHints(n,s,o,f,l){let h=r0.ISO_8859_1,x=_t.DEFAULT_EC_PERCENT,p=_t.DEFAULT_AZTEC_LAYERS;return l!=null&&(l.has(fr.CHARACTER_SET)&&(h=oc.forName(l.get(fr.CHARACTER_SET).toString())),l.has(fr.ERROR_CORRECTION)&&(x=b.parseInt(l.get(fr.ERROR_CORRECTION).toString())),l.has(fr.AZTEC_LAYERS)&&(p=b.parseInt(l.get(fr.AZTEC_LAYERS).toString()))),os.encodeLayers(n,s,o,f,h,x,p)}static encodeLayers(n,s,o,f,l,h,x){if(s!==oe.AZTEC)throw new v("Can only encode AZTEC, but got "+s);let p=_t.encode(X.getBytes(n,l),h,x);return os.renderResult(p,o,f)}static renderResult(n,s,o){let f=n.getMatrix();if(f==null)throw new mt;let l=f.getWidth(),h=f.getHeight(),x=Math.max(s,l),p=Math.max(o,h),E=Math.min(x/l,p/h),T=(x-l*E)/2,k=(p-h*E)/2,R=new Ee(x,p);for(let G=0,J=k;G<h;G++,J+=E)for(let re=0,fe=T;re<l;re++,fe+=E)f.get(re,G)&&R.setRegion(fe,J,E,E);return R}}t.AbstractExpandedDecoder=L,t.ArgumentException=w,t.ArithmeticException=K,t.AztecCode=cc,t.AztecCodeReader=Dt,t.AztecCodeWriter=os,t.AztecDecoder=$e,t.AztecDetector=ot,t.AztecDetectorResult=mn,t.AztecEncoder=_t,t.AztecHighLevelEncoder=wi,t.AztecPoint=Ot,t.BarcodeFormat=oe,t.Binarizer=S,t.BinaryBitmap=_,t.BitArray=V,t.BitMatrix=Ee,t.BitSource=js,t.BrowserAztecCodeReader=Lr,t.BrowserBarcodeReader=da,t.BrowserCodeReader=ne,t.BrowserDatamatrixCodeReader=Ou,t.BrowserMultiFormatReader=Xu,t.BrowserPDF417Reader=zu,t.BrowserQRCodeReader=Yu,t.BrowserQRCodeSvgWriter=ma,t.CharacterSetECI=O,t.ChecksumException=C,t.Code128Reader=Be,t.Code39Reader=jt,t.DataMatrixDecodedBitStreamParser=Zn,t.DataMatrixReader=qn,t.DecodeHintType=W,t.DecoderResult=Te,t.DefaultGridSampler=Yn,t.DetectorResult=Tn,t.EAN13Reader=Bn,t.EncodeHintType=fr,t.Exception=m,t.FormatException=N,t.GenericGF=Xe,t.GenericGFPoly=Ye,t.GlobalHistogramBinarizer=ue,t.GridSampler=zr,t.GridSamplerInstance=Ht,t.HTMLCanvasElementLuminanceSource=Le,t.HybridBinarizer=de,t.ITFReader=St,t.IllegalArgumentException=v,t.IllegalStateException=mt,t.InvertedLuminanceSource=se,t.LuminanceSource=We,t.MathUtils=rt,t.MultiFormatOneDReader=rn,t.MultiFormatReader=sc,t.MultiFormatWriter=ju,t.NotFoundException=q,t.OneDReader=ft,t.PDF417DecodedBitStreamParser=me,t.PDF417DecoderErrorCorrection=ec,t.PDF417Reader=Er,t.PDF417ResultMetadata=rc,t.PerspectiveTransform=ar,t.PlanarYUVLuminanceSource=Sn,t.QRCodeByteMatrix=is,t.QRCodeDataMask=nn,t.QRCodeDecodedBitStreamParser=zt,t.QRCodeDecoderErrorCorrectionLevel=Bt,t.QRCodeDecoderFormatInformation=Sr,t.QRCodeEncoder=Pt,t.QRCodeEncoderQRCode=ga,t.QRCodeMaskUtil=Zt,t.QRCodeMatrixUtil=Ze,t.QRCodeMode=je,t.QRCodeReader=Jn,t.QRCodeVersion=ze,t.QRCodeWriter=Wa,t.RGBLuminanceSource=t0,t.RSS14Reader=ut,t.RSSExpandedReader=we,t.ReaderException=as,t.ReedSolomonDecoder=nt,t.ReedSolomonEncoder=e0,t.ReedSolomonException=st,t.Result=Z,t.ResultMetadataType=Ae,t.ResultPoint=Ve,t.StringUtils=X,t.UnsupportedOperationException=ae,t.VideoInputDevice=Ge,t.WhiteRectangleDetector=Xt,t.WriterException=Ft,t.ZXingArrays=P,t.ZXingCharset=oc,t.ZXingInteger=b,t.ZXingStandardCharsets=r0,t.ZXingStringBuilder=ie,t.ZXingStringEncoding=Q,t.ZXingSystem=A,t.createAbstractExpandedDecoder=Oe,Object.defineProperty(t,"__esModule",{value:!0})}))})(Ti,Ti.exports)),Ti.exports}var Lt=H_();const G_=d1(Lt),X_=nh({__proto__:null,default:G_},[Lt]);var s1=(function(){function e(r,t,a){if(this.formatMap=new Map([[He.QR_CODE,Lt.BarcodeFormat.QR_CODE],[He.AZTEC,Lt.BarcodeFormat.AZTEC],[He.CODABAR,Lt.BarcodeFormat.CODABAR],[He.CODE_39,Lt.BarcodeFormat.CODE_39],[He.CODE_93,Lt.BarcodeFormat.CODE_93],[He.CODE_128,Lt.BarcodeFormat.CODE_128],[He.DATA_MATRIX,Lt.BarcodeFormat.DATA_MATRIX],[He.MAXICODE,Lt.BarcodeFormat.MAXICODE],[He.ITF,Lt.BarcodeFormat.ITF],[He.EAN_13,Lt.BarcodeFormat.EAN_13],[He.EAN_8,Lt.BarcodeFormat.EAN_8],[He.PDF_417,Lt.BarcodeFormat.PDF_417],[He.RSS_14,Lt.BarcodeFormat.RSS_14],[He.RSS_EXPANDED,Lt.BarcodeFormat.RSS_EXPANDED],[He.UPC_A,Lt.BarcodeFormat.UPC_A],[He.UPC_E,Lt.BarcodeFormat.UPC_E],[He.UPC_EAN_EXTENSION,Lt.BarcodeFormat.UPC_EAN_EXTENSION]]),this.reverseFormatMap=this.createReverseFormatMap(),!X_)throw"Use html5qrcode.min.js without edit, ZXing not found.";this.verbose=t,this.logger=a;var i=this.createZXingFormats(r),c=new Map;c.set(Lt.DecodeHintType.POSSIBLE_FORMATS,i),c.set(Lt.DecodeHintType.TRY_HARDER,!1),this.hints=c}return e.prototype.decodeAsync=function(r){var t=this;return new Promise(function(a,i){try{a(t.decode(r))}catch(c){i(c)}})},e.prototype.decode=function(r){var t=new Lt.MultiFormatReader(this.verbose,this.hints),a=new Lt.HTMLCanvasElementLuminanceSource(r),i=new Lt.BinaryBitmap(new Lt.HybridBinarizer(a)),c=t.decode(i);return{text:c.text,format:bu.create(this.toHtml5QrcodeSupportedFormats(c.format)),debugData:this.createDebugData()}},e.prototype.createReverseFormatMap=function(){var r=new Map;return this.formatMap.forEach(function(t,a,i){r.set(t,a)}),r},e.prototype.toHtml5QrcodeSupportedFormats=function(r){if(!this.reverseFormatMap.has(r))throw"reverseFormatMap doesn't have ".concat(r);return this.reverseFormatMap.get(r)},e.prototype.createZXingFormats=function(r){for(var t=[],a=0,i=r;a<i.length;a++){var c=i[a];this.formatMap.has(c)?t.push(this.formatMap.get(c)):this.logger.logError("".concat(c," is not supported by")+"ZXingHtml5QrcodeShim")}return t},e.prototype.createDebugData=function(){return{decoderName:"zxing-js"}},e})(),z_=function(e,r,t,a){function i(c){return c instanceof t?c:new t(function(u){u(c)})}return new(t||(t=Promise))(function(c,u){function d(w){try{m(a.next(w))}catch(v){u(v)}}function g(w){try{m(a.throw(w))}catch(v){u(v)}}function m(w){w.done?c(w.value):i(w.value).then(d,g)}m((a=a.apply(e,r||[])).next())})},Y_=function(e,r){var t={label:0,sent:function(){if(c[0]&1)throw c[1];return c[1]},trys:[],ops:[]},a,i,c,u;return u={next:d(0),throw:d(1),return:d(2)},typeof Symbol=="function"&&(u[Symbol.iterator]=function(){return this}),u;function d(m){return function(w){return g([m,w])}}function g(m){if(a)throw new TypeError("Generator is already executing.");for(;u&&(u=0,m[0]&&(t=0)),t;)try{if(a=1,i&&(c=m[0]&2?i.return:m[0]?i.throw||((c=i.return)&&c.call(i),0):i.next)&&!(c=c.call(i,m[1])).done)return c;switch(i=0,c&&(m=[m[0]&2,c.value]),m[0]){case 0:case 1:c=m;break;case 4:return t.label++,{value:m[1],done:!1};case 5:t.label++,i=m[1],m=[0];continue;case 7:m=t.ops.pop(),t.trys.pop();continue;default:if(c=t.trys,!(c=c.length>0&&c[c.length-1])&&(m[0]===6||m[0]===2)){t=0;continue}if(m[0]===3&&(!c||m[1]>c[0]&&m[1]<c[3])){t.label=m[1];break}if(m[0]===6&&t.label<c[1]){t.label=c[1],c=m;break}if(c&&t.label<c[2]){t.label=c[2],t.ops.push(m);break}c[2]&&t.ops.pop(),t.trys.pop();continue}m=r.call(e,t)}catch(w){m=[6,w],i=0}finally{a=c=0}if(m[0]&5)throw m[1];return{value:m[0]?m[1]:void 0,done:!0}}},o1=(function(){function e(r,t,a){if(this.formatMap=new Map([[He.QR_CODE,"qr_code"],[He.AZTEC,"aztec"],[He.CODABAR,"codabar"],[He.CODE_39,"code_39"],[He.CODE_93,"code_93"],[He.CODE_128,"code_128"],[He.DATA_MATRIX,"data_matrix"],[He.ITF,"itf"],[He.EAN_13,"ean_13"],[He.EAN_8,"ean_8"],[He.PDF_417,"pdf417"],[He.UPC_A,"upc_a"],[He.UPC_E,"upc_e"]]),this.reverseFormatMap=this.createReverseFormatMap(),!e.isSupported())throw"Use html5qrcode.min.js without edit, Use BarcodeDetectorDelegate only if it isSupported();";this.verbose=t,this.logger=a;var i=this.createBarcodeDetectorFormats(r);if(this.detector=new BarcodeDetector(i),!this.detector)throw"BarcodeDetector detector not supported"}return e.isSupported=function(){if(!("BarcodeDetector"in window))return!1;var r=new BarcodeDetector({formats:["qr_code"]});return typeof r<"u"},e.prototype.decodeAsync=function(r){return z_(this,void 0,void 0,function(){var t,a;return Y_(this,function(i){switch(i.label){case 0:return[4,this.detector.detect(r)];case 1:if(t=i.sent(),!t||t.length===0)throw"No barcode or QR code detected.";return a=this.selectLargestBarcode(t),[2,{text:a.rawValue,format:bu.create(this.toHtml5QrcodeSupportedFormats(a.format)),debugData:this.createDebugData()}]}})})},e.prototype.selectLargestBarcode=function(r){for(var t=null,a=0,i=0,c=r;i<c.length;i++){var u=c[i],d=u.boundingBox.width*u.boundingBox.height;d>a&&(a=d,t=u)}if(!t)throw"No largest barcode found";return t},e.prototype.createBarcodeDetectorFormats=function(r){for(var t=[],a=0,i=r;a<i.length;a++){var c=i[a];this.formatMap.has(c)?t.push(this.formatMap.get(c)):this.logger.warn("".concat(c," is not supported by")+"BarcodeDetectorDelegate")}return{formats:t}},e.prototype.toHtml5QrcodeSupportedFormats=function(r){if(!this.reverseFormatMap.has(r))throw"reverseFormatMap doesn't have ".concat(r);return this.reverseFormatMap.get(r)},e.prototype.createReverseFormatMap=function(){var r=new Map;return this.formatMap.forEach(function(t,a,i){r.set(t,a)}),r},e.prototype.createDebugData=function(){return{decoderName:"BarcodeDetector"}},e})(),c1=function(e,r,t,a){function i(c){return c instanceof t?c:new t(function(u){u(c)})}return new(t||(t=Promise))(function(c,u){function d(w){try{m(a.next(w))}catch(v){u(v)}}function g(w){try{m(a.throw(w))}catch(v){u(v)}}function m(w){w.done?c(w.value):i(w.value).then(d,g)}m((a=a.apply(e,r||[])).next())})},f1=function(e,r){var t={label:0,sent:function(){if(c[0]&1)throw c[1];return c[1]},trys:[],ops:[]},a,i,c,u;return u={next:d(0),throw:d(1),return:d(2)},typeof Symbol=="function"&&(u[Symbol.iterator]=function(){return this}),u;function d(m){return function(w){return g([m,w])}}function g(m){if(a)throw new TypeError("Generator is already executing.");for(;u&&(u=0,m[0]&&(t=0)),t;)try{if(a=1,i&&(c=m[0]&2?i.return:m[0]?i.throw||((c=i.return)&&c.call(i),0):i.next)&&!(c=c.call(i,m[1])).done)return c;switch(i=0,c&&(m=[m[0]&2,c.value]),m[0]){case 0:case 1:c=m;break;case 4:return t.label++,{value:m[1],done:!1};case 5:t.label++,i=m[1],m=[0];continue;case 7:m=t.ops.pop(),t.trys.pop();continue;default:if(c=t.trys,!(c=c.length>0&&c[c.length-1])&&(m[0]===6||m[0]===2)){t=0;continue}if(m[0]===3&&(!c||m[1]>c[0]&&m[1]<c[3])){t.label=m[1];break}if(m[0]===6&&t.label<c[1]){t.label=c[1],c=m;break}if(c&&t.label<c[2]){t.label=c[2],t.ops.push(m);break}c[2]&&t.ops.pop(),t.trys.pop();continue}m=r.call(e,t)}catch(w){m=[6,w],i=0}finally{a=c=0}if(m[0]&5)throw m[1];return{value:m[0]?m[1]:void 0,done:!0}}},K_=(function(){function e(r,t,a,i){this.EXECUTIONS_TO_REPORT_PERFORMANCE=100,this.executions=0,this.executionResults=[],this.wasPrimaryDecoderUsedInLastDecode=!1,this.verbose=a,t&&o1.isSupported()?(this.primaryDecoder=new o1(r,a,i),this.secondaryDecoder=new s1(r,a,i)):this.primaryDecoder=new s1(r,a,i)}return e.prototype.decodeAsync=function(r){return c1(this,void 0,void 0,function(){var t;return f1(this,function(a){switch(a.label){case 0:t=performance.now(),a.label=1;case 1:return a.trys.push([1,,3,4]),[4,this.getDecoder().decodeAsync(r)];case 2:return[2,a.sent()];case 3:return this.possiblyLogPerformance(t),[7];case 4:return[2]}})})},e.prototype.decodeRobustlyAsync=function(r){return c1(this,void 0,void 0,function(){var t,a;return f1(this,function(i){switch(i.label){case 0:t=performance.now(),i.label=1;case 1:return i.trys.push([1,3,4,5]),[4,this.primaryDecoder.decodeAsync(r)];case 2:return[2,i.sent()];case 3:if(a=i.sent(),this.secondaryDecoder)return[2,this.secondaryDecoder.decodeAsync(r)];throw a;case 4:return this.possiblyLogPerformance(t),[7];case 5:return[2]}})})},e.prototype.getDecoder=function(){return this.secondaryDecoder?this.wasPrimaryDecoderUsedInLastDecode===!1?(this.wasPrimaryDecoderUsedInLastDecode=!0,this.primaryDecoder):(this.wasPrimaryDecoderUsedInLastDecode=!1,this.secondaryDecoder):this.primaryDecoder},e.prototype.possiblyLogPerformance=function(r){if(this.verbose){var t=performance.now()-r;this.executionResults.push(t),this.executions++,this.possiblyFlushPerformanceReport()}},e.prototype.possiblyFlushPerformanceReport=function(){if(!(this.executions<this.EXECUTIONS_TO_REPORT_PERFORMANCE)){for(var r=0,t=0,a=this.executionResults;t<a.length;t++){var i=a[t];r+=i}var c=r/this.executionResults.length;console.log("".concat(c," ms for ").concat(this.executionResults.length," last runs.")),this.executions=0,this.executionResults=[]}},e})(),Qo=(function(){var e=function(r,t){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,i){a.__proto__=i}||function(a,i){for(var c in i)Object.prototype.hasOwnProperty.call(i,c)&&(a[c]=i[c])},e(r,t)};return function(r,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");e(r,t);function a(){this.constructor=r}r.prototype=t===null?Object.create(t):(a.prototype=t.prototype,new a)}})(),Bs=function(e,r,t,a){function i(c){return c instanceof t?c:new t(function(u){u(c)})}return new(t||(t=Promise))(function(c,u){function d(w){try{m(a.next(w))}catch(v){u(v)}}function g(w){try{m(a.throw(w))}catch(v){u(v)}}function m(w){w.done?c(w.value):i(w.value).then(d,g)}m((a=a.apply(e,r||[])).next())})},Ms=function(e,r){var t={label:0,sent:function(){if(c[0]&1)throw c[1];return c[1]},trys:[],ops:[]},a,i,c,u;return u={next:d(0),throw:d(1),return:d(2)},typeof Symbol=="function"&&(u[Symbol.iterator]=function(){return this}),u;function d(m){return function(w){return g([m,w])}}function g(m){if(a)throw new TypeError("Generator is already executing.");for(;u&&(u=0,m[0]&&(t=0)),t;)try{if(a=1,i&&(c=m[0]&2?i.return:m[0]?i.throw||((c=i.return)&&c.call(i),0):i.next)&&!(c=c.call(i,m[1])).done)return c;switch(i=0,c&&(m=[m[0]&2,c.value]),m[0]){case 0:case 1:c=m;break;case 4:return t.label++,{value:m[1],done:!1};case 5:t.label++,i=m[1],m=[0];continue;case 7:m=t.ops.pop(),t.trys.pop();continue;default:if(c=t.trys,!(c=c.length>0&&c[c.length-1])&&(m[0]===6||m[0]===2)){t=0;continue}if(m[0]===3&&(!c||m[1]>c[0]&&m[1]<c[3])){t.label=m[1];break}if(m[0]===6&&t.label<c[1]){t.label=c[1],c=m;break}if(c&&t.label<c[2]){t.label=c[2],t.ops.push(m);break}c[2]&&t.ops.pop(),t.trys.pop();continue}m=r.call(e,t)}catch(w){m=[6,w],i=0}finally{a=c=0}if(m[0]&5)throw m[1];return{value:m[0]?m[1]:void 0,done:!0}}},Fu=(function(){function e(r,t){this.name=r,this.track=t}return e.prototype.isSupported=function(){return this.track.getCapabilities?this.name in this.track.getCapabilities():!1},e.prototype.apply=function(r){var t={};t[this.name]=r;var a={advanced:[t]};return this.track.applyConstraints(a)},e.prototype.value=function(){var r=this.track.getSettings();if(this.name in r){var t=r[this.name];return t}return null},e})(),j_=(function(e){Qo(r,e);function r(t,a){return e.call(this,t,a)||this}return r.prototype.min=function(){return this.getCapabilities().min},r.prototype.max=function(){return this.getCapabilities().max},r.prototype.step=function(){return this.getCapabilities().step},r.prototype.apply=function(t){var a={};a[this.name]=t;var i={advanced:[a]};return this.track.applyConstraints(i)},r.prototype.getCapabilities=function(){this.failIfNotSupported();var t=this.track.getCapabilities(),a=t[this.name];return{min:a.min,max:a.max,step:a.step}},r.prototype.failIfNotSupported=function(){if(!this.isSupported())throw new Error("".concat(this.name," capability not supported"))},r})(Fu),Z_=(function(e){Qo(r,e);function r(t){return e.call(this,"zoom",t)||this}return r})(j_),q_=(function(e){Qo(r,e);function r(t){return e.call(this,"torch",t)||this}return r})(Fu),J_=(function(){function e(r){this.track=r}return e.prototype.zoomFeature=function(){return new Z_(this.track)},e.prototype.torchFeature=function(){return new q_(this.track)},e})(),Q_=(function(){function e(r,t,a){this.isClosed=!1,this.parentElement=r,this.mediaStream=t,this.callbacks=a,this.surface=this.createVideoElement(this.parentElement.clientWidth),r.append(this.surface)}return e.prototype.createVideoElement=function(r){var t=document.createElement("video");return t.style.width="".concat(r,"px"),t.style.display="block",t.muted=!0,t.setAttribute("muted","true"),t.playsInline=!0,t},e.prototype.setupSurface=function(){var r=this;this.surface.onabort=function(){throw"RenderedCameraImpl video surface onabort() called"},this.surface.onerror=function(){throw"RenderedCameraImpl video surface onerror() called"};var t=function(){var a=r.surface.clientWidth,i=r.surface.clientHeight;r.callbacks.onRenderSurfaceReady(a,i),r.surface.removeEventListener("playing",t)};this.surface.addEventListener("playing",t),this.surface.srcObject=this.mediaStream,this.surface.play()},e.create=function(r,t,a,i){return Bs(this,void 0,void 0,function(){var c,u;return Ms(this,function(d){switch(d.label){case 0:return c=new e(r,t,i),a.aspectRatio?(u={aspectRatio:a.aspectRatio},[4,c.getFirstTrackOrFail().applyConstraints(u)]):[3,2];case 1:d.sent(),d.label=2;case 2:return c.setupSurface(),[2,c]}})})},e.prototype.failIfClosed=function(){if(this.isClosed)throw"The RenderedCamera has already been closed."},e.prototype.getFirstTrackOrFail=function(){if(this.failIfClosed(),this.mediaStream.getVideoTracks().length===0)throw"No video tracks found";return this.mediaStream.getVideoTracks()[0]},e.prototype.pause=function(){this.failIfClosed(),this.surface.pause()},e.prototype.resume=function(r){this.failIfClosed();var t=this,a=function(){setTimeout(r,200),t.surface.removeEventListener("playing",a)};this.surface.addEventListener("playing",a),this.surface.play()},e.prototype.isPaused=function(){return this.failIfClosed(),this.surface.paused},e.prototype.getSurface=function(){return this.failIfClosed(),this.surface},e.prototype.getRunningTrackCapabilities=function(){return this.getFirstTrackOrFail().getCapabilities()},e.prototype.getRunningTrackSettings=function(){return this.getFirstTrackOrFail().getSettings()},e.prototype.applyVideoConstraints=function(r){return Bs(this,void 0,void 0,function(){return Ms(this,function(t){if("aspectRatio"in r)throw"Changing 'aspectRatio' in run-time is not yet supported.";return[2,this.getFirstTrackOrFail().applyConstraints(r)]})})},e.prototype.close=function(){if(this.isClosed)return Promise.resolve();var r=this;return new Promise(function(t,a){var i=r.mediaStream.getVideoTracks(),c=i.length,u=0;r.mediaStream.getVideoTracks().forEach(function(d){r.mediaStream.removeTrack(d),d.stop(),++u,u>=c&&(r.isClosed=!0,r.parentElement.removeChild(r.surface),t())})})},e.prototype.getCapabilities=function(){return new J_(this.getFirstTrackOrFail())},e})(),$_=(function(){function e(r){this.mediaStream=r}return e.prototype.render=function(r,t,a){return Bs(this,void 0,void 0,function(){return Ms(this,function(i){return[2,Q_.create(r,this.mediaStream,t,a)]})})},e.create=function(r){return Bs(this,void 0,void 0,function(){var t,a;return Ms(this,function(i){switch(i.label){case 0:if(!navigator.mediaDevices)throw"navigator.mediaDevices not supported";return t={audio:!1,video:r},[4,navigator.mediaDevices.getUserMedia(t)];case 1:return a=i.sent(),[2,new e(a)]}})})},e})(),l1=function(e,r,t,a){function i(c){return c instanceof t?c:new t(function(u){u(c)})}return new(t||(t=Promise))(function(c,u){function d(w){try{m(a.next(w))}catch(v){u(v)}}function g(w){try{m(a.throw(w))}catch(v){u(v)}}function m(w){w.done?c(w.value):i(w.value).then(d,g)}m((a=a.apply(e,r||[])).next())})},u1=function(e,r){var t={label:0,sent:function(){if(c[0]&1)throw c[1];return c[1]},trys:[],ops:[]},a,i,c,u;return u={next:d(0),throw:d(1),return:d(2)},typeof Symbol=="function"&&(u[Symbol.iterator]=function(){return this}),u;function d(m){return function(w){return g([m,w])}}function g(m){if(a)throw new TypeError("Generator is already executing.");for(;u&&(u=0,m[0]&&(t=0)),t;)try{if(a=1,i&&(c=m[0]&2?i.return:m[0]?i.throw||((c=i.return)&&c.call(i),0):i.next)&&!(c=c.call(i,m[1])).done)return c;switch(i=0,c&&(m=[m[0]&2,c.value]),m[0]){case 0:case 1:c=m;break;case 4:return t.label++,{value:m[1],done:!1};case 5:t.label++,i=m[1],m=[0];continue;case 7:m=t.ops.pop(),t.trys.pop();continue;default:if(c=t.trys,!(c=c.length>0&&c[c.length-1])&&(m[0]===6||m[0]===2)){t=0;continue}if(m[0]===3&&(!c||m[1]>c[0]&&m[1]<c[3])){t.label=m[1];break}if(m[0]===6&&t.label<c[1]){t.label=c[1],c=m;break}if(c&&t.label<c[2]){t.label=c[2],t.ops.push(m);break}c[2]&&t.ops.pop(),t.trys.pop();continue}m=r.call(e,t)}catch(w){m=[6,w],i=0}finally{a=c=0}if(m[0]&5)throw m[1];return{value:m[0]?m[1]:void 0,done:!0}}},e8=(function(){function e(){}return e.failIfNotSupported=function(){return l1(this,void 0,void 0,function(){return u1(this,function(r){if(!navigator.mediaDevices)throw"navigator.mediaDevices not supported";return[2,new e]})})},e.prototype.create=function(r){return l1(this,void 0,void 0,function(){return u1(this,function(t){return[2,$_.create(r)]})})},e})(),t8=function(e,r,t,a){function i(c){return c instanceof t?c:new t(function(u){u(c)})}return new(t||(t=Promise))(function(c,u){function d(w){try{m(a.next(w))}catch(v){u(v)}}function g(w){try{m(a.throw(w))}catch(v){u(v)}}function m(w){w.done?c(w.value):i(w.value).then(d,g)}m((a=a.apply(e,r||[])).next())})},r8=function(e,r){var t={label:0,sent:function(){if(c[0]&1)throw c[1];return c[1]},trys:[],ops:[]},a,i,c,u;return u={next:d(0),throw:d(1),return:d(2)},typeof Symbol=="function"&&(u[Symbol.iterator]=function(){return this}),u;function d(m){return function(w){return g([m,w])}}function g(m){if(a)throw new TypeError("Generator is already executing.");for(;u&&(u=0,m[0]&&(t=0)),t;)try{if(a=1,i&&(c=m[0]&2?i.return:m[0]?i.throw||((c=i.return)&&c.call(i),0):i.next)&&!(c=c.call(i,m[1])).done)return c;switch(i=0,c&&(m=[m[0]&2,c.value]),m[0]){case 0:case 1:c=m;break;case 4:return t.label++,{value:m[1],done:!1};case 5:t.label++,i=m[1],m=[0];continue;case 7:m=t.ops.pop(),t.trys.pop();continue;default:if(c=t.trys,!(c=c.length>0&&c[c.length-1])&&(m[0]===6||m[0]===2)){t=0;continue}if(m[0]===3&&(!c||m[1]>c[0]&&m[1]<c[3])){t.label=m[1];break}if(m[0]===6&&t.label<c[1]){t.label=c[1],c=m;break}if(c&&t.label<c[2]){t.label=c[2],t.ops.push(m);break}c[2]&&t.ops.pop(),t.trys.pop();continue}m=r.call(e,t)}catch(w){m=[6,w],i=0}finally{a=c=0}if(m[0]&5)throw m[1];return{value:m[0]?m[1]:void 0,done:!0}}},n8=(function(){function e(){}return e.retrieve=function(){if(navigator.mediaDevices)return e.getCamerasFromMediaDevices();var r=MediaStreamTrack;return MediaStreamTrack&&r.getSources?e.getCamerasFromMediaStreamTrack():e.rejectWithError()},e.rejectWithError=function(){var r=qa.unableToQuerySupportedDevices();return e.isHttpsOrLocalhost()||(r=qa.insecureContextCameraQueryError()),Promise.reject(r)},e.isHttpsOrLocalhost=function(){if(location.protocol==="https:")return!0;var r=location.host.split(":")[0];return r==="127.0.0.1"||r==="localhost"},e.getCamerasFromMediaDevices=function(){return t8(this,void 0,void 0,function(){var r,t,a,i,c,u,d;return r8(this,function(g){switch(g.label){case 0:return r=function(m){for(var w=m.getVideoTracks(),v=0,_=w;v<_.length;v++){var C=_[v];C.enabled=!1,C.stop(),m.removeTrack(C)}},[4,navigator.mediaDevices.getUserMedia({audio:!1,video:!0})];case 1:return t=g.sent(),[4,navigator.mediaDevices.enumerateDevices()];case 2:for(a=g.sent(),i=[],c=0,u=a;c<u.length;c++)d=u[c],d.kind==="videoinput"&&i.push({id:d.deviceId,label:d.label});return r(t),[2,i]}})})},e.getCamerasFromMediaStreamTrack=function(){return new Promise(function(r,t){var a=function(c){for(var u=[],d=0,g=c;d<g.length;d++){var m=g[d];m.kind==="video"&&u.push({id:m.id,label:m.label})}r(u)},i=MediaStreamTrack;i.getSources(a)})},e})(),qt;(function(e){e[e.UNKNOWN=0]="UNKNOWN",e[e.NOT_STARTED=1]="NOT_STARTED",e[e.SCANNING=2]="SCANNING",e[e.PAUSED=3]="PAUSED"})(qt||(qt={}));var a8=(function(){function e(){this.state=qt.NOT_STARTED,this.onGoingTransactionNewState=qt.UNKNOWN}return e.prototype.directTransition=function(r){this.failIfTransitionOngoing(),this.validateTransition(r),this.state=r},e.prototype.startTransition=function(r){return this.failIfTransitionOngoing(),this.validateTransition(r),this.onGoingTransactionNewState=r,this},e.prototype.execute=function(){if(this.onGoingTransactionNewState===qt.UNKNOWN)throw"Transaction is already cancelled, cannot execute().";var r=this.onGoingTransactionNewState;this.onGoingTransactionNewState=qt.UNKNOWN,this.directTransition(r)},e.prototype.cancel=function(){if(this.onGoingTransactionNewState===qt.UNKNOWN)throw"Transaction is already cancelled, cannot cancel().";this.onGoingTransactionNewState=qt.UNKNOWN},e.prototype.getState=function(){return this.state},e.prototype.failIfTransitionOngoing=function(){if(this.onGoingTransactionNewState!==qt.UNKNOWN)throw"Cannot transition to a new state, already under transition"},e.prototype.validateTransition=function(r){switch(this.state){case qt.UNKNOWN:throw"Transition from unknown is not allowed";case qt.NOT_STARTED:this.failIfNewStateIs(r,[qt.PAUSED]);break;case qt.SCANNING:break;case qt.PAUSED:break}},e.prototype.failIfNewStateIs=function(r,t){for(var a=0,i=t;a<i.length;a++){var c=i[a];if(r===c)throw"Cannot transition from ".concat(this.state," to ").concat(r)}},e})(),i8=(function(){function e(r){this.stateManager=r}return e.prototype.startTransition=function(r){return this.stateManager.startTransition(r)},e.prototype.directTransition=function(r){this.stateManager.directTransition(r)},e.prototype.getState=function(){return this.stateManager.getState()},e.prototype.canScanFile=function(){return this.stateManager.getState()===qt.NOT_STARTED},e.prototype.isScanning=function(){return this.stateManager.getState()!==qt.NOT_STARTED},e.prototype.isStrictlyScanning=function(){return this.stateManager.getState()===qt.SCANNING},e.prototype.isPaused=function(){return this.stateManager.getState()===qt.PAUSED},e})(),s8=(function(){function e(){}return e.create=function(){return new i8(new a8)},e})(),o8=(function(){var e=function(r,t){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,i){a.__proto__=i}||function(a,i){for(var c in i)Object.prototype.hasOwnProperty.call(i,c)&&(a[c]=i[c])},e(r,t)};return function(r,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");e(r,t);function a(){this.constructor=r}r.prototype=t===null?Object.create(t):(a.prototype=t.prototype,new a)}})(),Zr=(function(e){o8(r,e);function r(){return e!==null&&e.apply(this,arguments)||this}return r.DEFAULT_WIDTH=300,r.DEFAULT_WIDTH_OFFSET=2,r.FILE_SCAN_MIN_HEIGHT=300,r.FILE_SCAN_HIDDEN_CANVAS_PADDING=100,r.MIN_QR_BOX_SIZE=50,r.SHADED_LEFT=1,r.SHADED_RIGHT=2,r.SHADED_TOP=3,r.SHADED_BOTTOM=4,r.SHADED_REGION_ELEMENT_ID="qr-shaded-region",r.VERBOSE=!1,r.BORDER_SHADER_DEFAULT_COLOR="#ffffff",r.BORDER_SHADER_MATCH_COLOR="rgb(90, 193, 56)",r})(L_),c8=(function(){function e(r,t){this.logger=t,this.fps=Zr.SCAN_DEFAULT_FPS,r?(r.fps&&(this.fps=r.fps),this.disableFlip=r.disableFlip===!0,this.qrbox=r.qrbox,this.aspectRatio=r.aspectRatio,this.videoConstraints=r.videoConstraints):this.disableFlip=Zr.DEFAULT_DISABLE_FLIP}return e.prototype.isMediaStreamConstraintsValid=function(){return this.videoConstraints?Nu.isMediaStreamConstraintsValid(this.videoConstraints,this.logger):(this.logger.logError("Empty videoConstraints",!0),!1)},e.prototype.isShadedBoxEnabled=function(){return!Pn(this.qrbox)},e.create=function(r,t){return new e(r,t)},e})(),x8=(function(){function e(r,t){if(this.element=null,this.canvasElement=null,this.scannerPausedUiElement=null,this.hasBorderShaders=null,this.borderShaders=null,this.qrMatch=null,this.renderedCamera=null,this.qrRegion=null,this.context=null,this.lastScanImageFile=null,this.isScanning=!1,!document.getElementById(r))throw"HTML Element with id=".concat(r," not found");this.elementId=r,this.verbose=!1;var a;typeof t=="boolean"?this.verbose=t===!0:t&&(a=t,this.verbose=a.verbose===!0,a.experimentalFeatures),this.logger=new W_(this.verbose),this.qrcode=new K_(this.getSupportedFormats(t),this.getUseBarCodeDetectorIfSupported(a),this.verbose,this.logger),this.foreverScanTimeout,this.shouldScan=!0,this.stateManagerProxy=s8.create()}return e.prototype.start=function(r,t,a,i){var c=this;if(!r)throw"cameraIdOrConfig is required";if(!a||typeof a!="function")throw"qrCodeSuccessCallback is required and should be a function.";var u;i?u=i:u=this.verbose?this.logger.log:function(){};var d=c8.create(t,this.logger);this.clearElement();var g=!1;d.videoConstraints&&(d.isMediaStreamConstraintsValid()?g=!0:this.logger.logError("'videoConstraints' is not valid 'MediaStreamConstraints, it will be ignored.'",!0));var m=g,w=document.getElementById(this.elementId);w.clientWidth?w.clientWidth:Zr.DEFAULT_WIDTH,w.style.position="relative",this.shouldScan=!0,this.element=w;var v=this,_=this.stateManagerProxy.startTransition(qt.SCANNING);return new Promise(function(C,S){var A=m?d.videoConstraints:v.createVideoConstraints(r);if(!A){_.cancel(),S("videoConstraints should be defined");return}var y={};(!m||d.aspectRatio)&&(y.aspectRatio=d.aspectRatio);var D={onRenderSurfaceReady:function(P,b){v.setupUi(P,b,d),v.isScanning=!0,v.foreverScan(d,a,u)}};e8.failIfNotSupported().then(function(P){P.create(A).then(function(b){return b.render(c.element,y,D).then(function(V){v.renderedCamera=V,_.execute(),C(null)}).catch(function(V){_.cancel(),S(V)})}).catch(function(b){_.cancel(),S(qa.errorGettingUserMedia(b))})}).catch(function(P){_.cancel(),S(qa.cameraStreamingNotSupported())})})},e.prototype.pause=function(r){if(!this.stateManagerProxy.isStrictlyScanning())throw"Cannot pause, scanner is not scanning.";this.stateManagerProxy.directTransition(qt.PAUSED),this.showPausedState(),(Pn(r)||r!==!0)&&(r=!1),r&&this.renderedCamera&&this.renderedCamera.pause()},e.prototype.resume=function(){if(!this.stateManagerProxy.isPaused())throw"Cannot result, scanner is not paused.";if(!this.renderedCamera)throw"renderedCamera doesn't exist while trying resume()";var r=this,t=function(){r.stateManagerProxy.directTransition(qt.SCANNING),r.hidePausedState()};if(!this.renderedCamera.isPaused()){t();return}this.renderedCamera.resume(function(){t()})},e.prototype.getState=function(){return this.stateManagerProxy.getState()},e.prototype.stop=function(){var r=this;if(!this.stateManagerProxy.isScanning())throw"Cannot stop, scanner is not running or paused.";var t=this.stateManagerProxy.startTransition(qt.NOT_STARTED);this.shouldScan=!1,this.foreverScanTimeout&&clearTimeout(this.foreverScanTimeout);var a=function(){if(r.element){var c=document.getElementById(Zr.SHADED_REGION_ELEMENT_ID);c&&r.element.removeChild(c)}},i=this;return this.renderedCamera.close().then(function(){return i.renderedCamera=null,i.element&&(i.element.removeChild(i.canvasElement),i.canvasElement=null),a(),i.qrRegion&&(i.qrRegion=null),i.context&&(i.context=null),t.execute(),i.hidePausedState(),i.isScanning=!1,Promise.resolve()})},e.prototype.scanFile=function(r,t){return this.scanFileV2(r,t).then(function(a){return a.decodedText})},e.prototype.scanFileV2=function(r,t){var a=this;if(!r||!(r instanceof File))throw"imageFile argument is mandatory and should be instance of File. Use 'event.target.files[0]'.";if(Pn(t)&&(t=!0),!this.stateManagerProxy.canScanFile())throw"Cannot start file scan - ongoing camera scan";return new Promise(function(i,c){a.possiblyCloseLastScanImageFile(),a.clearElement(),a.lastScanImageFile=URL.createObjectURL(r);var u=new Image;u.onload=function(){var d=u.width,g=u.height,m=document.getElementById(a.elementId),w=m.clientWidth?m.clientWidth:Zr.DEFAULT_WIDTH,v=Math.max(m.clientHeight?m.clientHeight:g,Zr.FILE_SCAN_MIN_HEIGHT),_=a.computeCanvasDrawConfig(d,g,w,v);if(t){var C=a.createCanvasElement(w,v,"qr-canvas-visible");C.style.display="inline-block",m.appendChild(C);var S=C.getContext("2d");if(!S)throw"Unable to get 2d context from canvas";S.canvas.width=w,S.canvas.height=v,S.drawImage(u,0,0,d,g,_.x,_.y,_.width,_.height)}var A=Zr.FILE_SCAN_HIDDEN_CANVAS_PADDING,y=Math.max(u.width,_.width),D=Math.max(u.height,_.height),P=y+2*A,b=D+2*A,V=a.createCanvasElement(P,b);m.appendChild(V);var te=V.getContext("2d");if(!te)throw"Unable to get 2d context from canvas";te.canvas.width=P,te.canvas.height=b,te.drawImage(u,0,0,d,g,A,A,y,D);try{a.qrcode.decodeRobustlyAsync(V).then(function(W){i(a1.createFromQrcodeResult(W))}).catch(c)}catch(W){c("QR code parse error, error = ".concat(W))}},u.onerror=c,u.onabort=c,u.onstalled=c,u.onsuspend=c,u.src=URL.createObjectURL(r)})},e.prototype.clear=function(){this.clearElement()},e.getCameras=function(){return n8.retrieve()},e.prototype.getRunningTrackCapabilities=function(){return this.getRenderedCameraOrFail().getRunningTrackCapabilities()},e.prototype.getRunningTrackSettings=function(){return this.getRenderedCameraOrFail().getRunningTrackSettings()},e.prototype.getRunningTrackCameraCapabilities=function(){return this.getRenderedCameraOrFail().getCapabilities()},e.prototype.applyVideoConstraints=function(r){if(r){if(!Nu.isMediaStreamConstraintsValid(r,this.logger))throw"invalid videoConstaints passed, check logs for more details"}else throw"videoConstaints is required argument.";return this.getRenderedCameraOrFail().applyVideoConstraints(r)},e.prototype.getRenderedCameraOrFail=function(){if(this.renderedCamera==null)throw"Scanning is not in running state, call this API only when QR code scanning using camera is in running state.";return this.renderedCamera},e.prototype.getSupportedFormats=function(r){var t=[He.QR_CODE,He.AZTEC,He.CODABAR,He.CODE_39,He.CODE_93,He.CODE_128,He.DATA_MATRIX,He.MAXICODE,He.ITF,He.EAN_13,He.EAN_8,He.PDF_417,He.RSS_14,He.RSS_EXPANDED,He.UPC_A,He.UPC_E,He.UPC_EAN_EXTENSION];if(!r||typeof r=="boolean"||!r.formatsToSupport)return t;if(!Array.isArray(r.formatsToSupport))throw"configOrVerbosityFlag.formatsToSupport should be undefined or an array.";if(r.formatsToSupport.length===0)throw"Atleast 1 formatsToSupport is needed.";for(var a=[],i=0,c=r.formatsToSupport;i<c.length;i++){var u=c[i];P_(u)?a.push(u):this.logger.warn("Invalid format: ".concat(u," passed in config, ignoring."))}if(a.length===0)throw"None of formatsToSupport match supported values.";return a},e.prototype.getUseBarCodeDetectorIfSupported=function(r){if(Pn(r))return!0;if(!Pn(r.useBarCodeDetectorIfSupported))return r.useBarCodeDetectorIfSupported!==!1;if(Pn(r.experimentalFeatures))return!0;var t=r.experimentalFeatures;return Pn(t.useBarCodeDetectorIfSupported)?!0:t.useBarCodeDetectorIfSupported!==!1},e.prototype.validateQrboxSize=function(r,t,a){var i=this,c=a.qrbox;this.validateQrboxConfig(c);var u=this.toQrdimensions(r,t,c),d=function(m){if(m<Zr.MIN_QR_BOX_SIZE)throw"minimum size of 'config.qrbox' dimension value is"+" ".concat(Zr.MIN_QR_BOX_SIZE,"px.")},g=function(m){return m>r&&(i.logger.warn("`qrbox.width` or `qrbox` is larger than the width of the root element. The width will be truncated to the width of root element."),m=r),m};d(u.width),d(u.height),u.width=g(u.width)},e.prototype.validateQrboxConfig=function(r){if(typeof r!="number"&&typeof r!="function"&&(r.width===void 0||r.height===void 0))throw"Invalid instance of QrDimensions passed for 'config.qrbox'. Both 'width' and 'height' should be set."},e.prototype.toQrdimensions=function(r,t,a){if(typeof a=="number")return{width:a,height:a};if(typeof a=="function")try{return a(r,t)}catch(i){throw new Error("qrbox config was passed as a function but it failed with unknown error"+i)}return a},e.prototype.setupUi=function(r,t,a){a.isShadedBoxEnabled()&&this.validateQrboxSize(r,t,a);var i=Pn(a.qrbox)?{width:r,height:t}:a.qrbox;this.validateQrboxConfig(i);var c=this.toQrdimensions(r,t,i);c.height>t&&this.logger.warn("[Html5Qrcode] config.qrbox has height that isgreater than the height of the video stream. Shading will be ignored");var u=a.isShadedBoxEnabled()&&c.height<=t,d={x:0,y:0,width:r,height:t},g=u?this.getShadedRegionBounds(r,t,c):d,m=this.createCanvasElement(g.width,g.height),w={willReadFrequently:!0},v=m.getContext("2d",w);v.canvas.width=g.width,v.canvas.height=g.height,this.element.append(m),u&&this.possiblyInsertShadingElement(this.element,r,t,c),this.createScannerPausedUiElement(this.element),this.qrRegion=g,this.context=v,this.canvasElement=m},e.prototype.createScannerPausedUiElement=function(r){var t=document.createElement("div");t.innerText=qa.scannerPaused(),t.style.display="none",t.style.position="absolute",t.style.top="0px",t.style.zIndex="1",t.style.background="rgba(9, 9, 9, 0.46)",t.style.color="#FFECEC",t.style.textAlign="center",t.style.width="100%",r.appendChild(t),this.scannerPausedUiElement=t},e.prototype.scanContext=function(r,t){var a=this;return this.stateManagerProxy.isPaused()?Promise.resolve(!1):this.qrcode.decodeAsync(this.canvasElement).then(function(i){return r(i.text,a1.createFromQrcodeResult(i)),a.possiblyUpdateShaders(!0),!0}).catch(function(i){a.possiblyUpdateShaders(!1);var c=qa.codeParseError(i);return t(c,U_.createFrom(c)),!1})},e.prototype.foreverScan=function(r,t,a){var i=this;if(this.shouldScan&&this.renderedCamera){var c=this.renderedCamera.getSurface(),u=c.videoWidth/c.clientWidth,d=c.videoHeight/c.clientHeight;if(!this.qrRegion)throw"qrRegion undefined when localMediaStream is ready.";var g=this.qrRegion.width*u,m=this.qrRegion.height*d,w=this.qrRegion.x*u,v=this.qrRegion.y*d;this.context.drawImage(c,w,v,g,m,0,0,this.qrRegion.width,this.qrRegion.height);var _=function(){i.foreverScanTimeout=setTimeout(function(){i.foreverScan(r,t,a)},i.getTimeoutFps(r.fps))};this.scanContext(t,a).then(function(C){!C&&r.disableFlip!==!0?(i.context.translate(i.context.canvas.width,0),i.context.scale(-1,1),i.scanContext(t,a).finally(function(){_()})):_()}).catch(function(C){i.logger.logError("Error happend while scanning context",C),_()})}},e.prototype.createVideoConstraints=function(r){if(typeof r=="string")return{deviceId:{exact:r}};if(typeof r=="object"){var t="facingMode",a="deviceId",i={user:!0,environment:!0},c="exact",u=function(S){if(S in i)return!0;throw"config has invalid 'facingMode' value = "+"'".concat(S,"'")},d=Object.keys(r);if(d.length!==1)throw"'cameraIdOrConfig' object should have exactly 1 key,"+" if passed as an object, found ".concat(d.length," keys");var g=Object.keys(r)[0];if(g!==t&&g!==a)throw"Only '".concat(t,"' and '").concat(a,"' ")+" are supported for 'cameraIdOrConfig'";if(g===t){var m=r.facingMode;if(typeof m=="string"){if(u(m))return{facingMode:m}}else if(typeof m=="object")if(c in m){if(u(m["".concat(c)]))return{facingMode:{exact:m["".concat(c)]}}}else throw"'facingMode' should be string or object with"+" ".concat(c," as key.");else{var w=typeof m;throw"Invalid type of 'facingMode' = ".concat(w)}}else{var v=r.deviceId;if(typeof v=="string")return{deviceId:v};if(typeof v=="object"){if(c in v)return{deviceId:{exact:v["".concat(c)]}};throw"'deviceId' should be string or object with"+" ".concat(c," as key.")}else{var _=typeof v;throw"Invalid type of 'deviceId' = ".concat(_)}}}var C=typeof r;throw"Invalid type of 'cameraIdOrConfig' = ".concat(C)},e.prototype.computeCanvasDrawConfig=function(r,t,a,i){if(r<=a&&t<=i){var c=(a-r)/2,u=(i-t)/2;return{x:c,y:u,width:r,height:t}}else{var d=r,g=t;return r>a&&(t=a/r*t,r=a),t>i&&(r=i/t*r,t=i),this.logger.log("Image downsampled from "+"".concat(d,"X").concat(g)+" to ".concat(r,"X").concat(t,".")),this.computeCanvasDrawConfig(r,t,a,i)}},e.prototype.clearElement=function(){if(this.stateManagerProxy.isScanning())throw"Cannot clear while scan is ongoing, close it first.";var r=document.getElementById(this.elementId);r&&(r.innerHTML="")},e.prototype.possiblyUpdateShaders=function(r){this.qrMatch!==r&&(this.hasBorderShaders&&this.borderShaders&&this.borderShaders.length&&this.borderShaders.forEach(function(t){t.style.backgroundColor=r?Zr.BORDER_SHADER_MATCH_COLOR:Zr.BORDER_SHADER_DEFAULT_COLOR}),this.qrMatch=r)},e.prototype.possiblyCloseLastScanImageFile=function(){this.lastScanImageFile&&(URL.revokeObjectURL(this.lastScanImageFile),this.lastScanImageFile=null)},e.prototype.createCanvasElement=function(r,t,a){var i=r,c=t,u=document.createElement("canvas");return u.style.width="".concat(i,"px"),u.style.height="".concat(c,"px"),u.style.display="none",u.id=Pn(a)?"qr-canvas":a,u},e.prototype.getShadedRegionBounds=function(r,t,a){if(a.width>r||a.height>t)throw"'config.qrbox' dimensions should not be greater than the dimensions of the root HTML element.";return{x:(r-a.width)/2,y:(t-a.height)/2,width:a.width,height:a.height}},e.prototype.possiblyInsertShadingElement=function(r,t,a,i){if(!(t-i.width<1||a-i.height<1)){var c=document.createElement("div");c.style.position="absolute";var u=(t-i.width)/2,d=(a-i.height)/2;if(c.style.borderLeft="".concat(u,"px solid rgba(0, 0, 0, 0.48)"),c.style.borderRight="".concat(u,"px solid rgba(0, 0, 0, 0.48)"),c.style.borderTop="".concat(d,"px solid rgba(0, 0, 0, 0.48)"),c.style.borderBottom="".concat(d,"px solid rgba(0, 0, 0, 0.48)"),c.style.boxSizing="border-box",c.style.top="0px",c.style.bottom="0px",c.style.left="0px",c.style.right="0px",c.id="".concat(Zr.SHADED_REGION_ELEMENT_ID),t-i.width<11||a-i.height<11)this.hasBorderShaders=!1;else{var g=5,m=40;this.insertShaderBorders(c,m,g,-g,null,0,!0),this.insertShaderBorders(c,m,g,-g,null,0,!1),this.insertShaderBorders(c,m,g,null,-g,0,!0),this.insertShaderBorders(c,m,g,null,-g,0,!1),this.insertShaderBorders(c,g,m+g,-g,null,-g,!0),this.insertShaderBorders(c,g,m+g,null,-g,-g,!0),this.insertShaderBorders(c,g,m+g,-g,null,-g,!1),this.insertShaderBorders(c,g,m+g,null,-g,-g,!1),this.hasBorderShaders=!0}r.append(c)}},e.prototype.insertShaderBorders=function(r,t,a,i,c,u,d){var g=document.createElement("div");g.style.position="absolute",g.style.backgroundColor=Zr.BORDER_SHADER_DEFAULT_COLOR,g.style.width="".concat(t,"px"),g.style.height="".concat(a,"px"),i!==null&&(g.style.top="".concat(i,"px")),c!==null&&(g.style.bottom="".concat(c,"px")),d?g.style.left="".concat(u,"px"):g.style.right="".concat(u,"px"),this.borderShaders||(this.borderShaders=[]),this.borderShaders.push(g),r.appendChild(g)},e.prototype.showPausedState=function(){if(!this.scannerPausedUiElement)throw"[internal error] scanner paused UI element not found";this.scannerPausedUiElement.style.display="block"},e.prototype.hidePausedState=function(){if(!this.scannerPausedUiElement)throw"[internal error] scanner paused UI element not found";this.scannerPausedUiElement.style.display="none"},e.prototype.getTimeoutFps=function(r){return 1e3/r},e})(),h1;(function(e){e[e.STATUS_DEFAULT=0]="STATUS_DEFAULT",e[e.STATUS_SUCCESS=1]="STATUS_SUCCESS",e[e.STATUS_WARNING=2]="STATUS_WARNING",e[e.STATUS_REQUESTING_PERMISSION=3]="STATUS_REQUESTING_PERMISSION"})(h1||(h1={}));export{x8 as H,d8 as Q,yf as a,He as b,d1 as g,l8 as o,f8 as r,h8 as u,u8 as w};
